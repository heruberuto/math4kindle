%% Lineární algebra // úvod do algebry, zejména lineární     
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Petr Ol¹ák

% Zmeny zde by mohly vest ke druhemu vydani

% Toto je zdrojový text ke skriptu "úvod do algebry, zejména lineární"
% (\booktrue) i k veøejnému textu "Lineární algebra" (\bookfalse).

\input utf8off

\nonstopmode

\hoffset=-4mm
\chyph % pou¾ijte formát csplain
\advance\vsize by12pt
\font\mathbf=cmmib10
\newfam\bfmath
\textfont\bfmath=\mathbf
\font\bbf=csbx12
\font\bigf=csbx12 scaled\magstep3
\font\logocvut=lev
\def\vcerejsiverze{\advance\day by-1 }


\newcount\kapnum \newcount\odstnum \newcount\rcenum \newcount\numlink
\newcount\okrajnum \newcount\tempnum
\newdimen\colwidth
\newif\ifladeni
\newif\iftwoside
\newwrite\fileref \newread\testin
\newif\ifbook     
\newif\ifcviceni  
\newif\ifpouzereseni
\newif\ifkindle

%\newif\ifbetafix
%	\betafixfalse
%	\ifbetafix
%		\let\tmp=\beta
%		\def\kindlebeta{{\kern0.8em\tmp}}
%		\let\beta=\kindlebeta
%	\fi


%\ladenitrue %%%%%%%%%%% tiskne odkazovací slova k jednotlivým objektùm
%\vcerejsiverze %%%%%%%% text jsem pøipravil doma veèer a TeXuji ráno v práci
%\twosidetrue %%%%%%%%%% pro oboustranný tisk
%\booktrue      %%%%%%%% text vcetne cviceni pro tistena skripta
%\cvicenitrue   %%%%%%%% pouze tisk cviceni vcetne reseni
%\pouzeresenitrue %%%%%% tisk pouze reseni bez textu cviceni
\kindletrue %%%%%%%%%%% formatovat pro kindle a mobilni zarizeni

\def\resenilist {\reseni 1 \reseni 2 
  \reseni 3 \reseni 4 \reseni 5 \reseni 6 \reseni 7 \reseni 8 \reseni 10 
  \reseni 11 
}

\def\nazevskripta {Úvod do algebry, zejména lineární}
\ifbook
   \let\nazevdila=\nazevskripta
   \mag 970 % skripta nejsou presne formatu A4, ale mensi
   \def\offsetvalue{7mm}
   \let\orimakeheadline=\makeheadline 
   \def\makeheadline{\orimakeheadline\medskip\nointerlineskip}
\else
   \def\nazevdila {Lineární algebra}
   \def\offsetvalue{4mm}
\fi

\def\skipcm#1{\ifkindle\vskip0.5cm\else\vskip#1cm\fi}
\ifkindle %%VERZE VSEOBECNYCH MAKER POUZIVANE PRI EXPORTU NA KINDLE
	\input opmac_margins.tex
	\sdef{pgs:kindle5landscape}{(148,100)mm}  
	\sdef{pgs:kindleDX}{(148,210)mm}
	\margins/1 kindle5landscape (3,3,5,5)mm
	\hfuzz=2em
	\nopagenumbers
	\parindent=0pt
	\emergencystretch=5em
	\parindent=0.7em
	\pdfcompresslevel=9
  \def\offsetvalue{1mm}
\fi
\def\unlessKindle#1{
\ifkindle\else#1\fi
}
\def\breakOnKindle{
\ifkindle\break\fi
}
\def\collapsible #1 #2{
\ifkindle#2\else#2\break
}

\def\breakeqonkindle{
\ifkindle
\cr &=
\fi
}


\def\beglink#1{}
\def\endlink{}
\def\aimlink#1{}
\def\urllink#1{{\tt#1}}
\def\zalozka#1{} \let\kapzalozka=\zalozka
\def\Brown{}\def\Black{}

\def\ifnextchar#1#2#3{\let\tznak=#1\def\bodyA{#2}\def\bodyB{#3}%
    \futurelet\znak\testuj}
\def\testuj{\ifx\znak\tznak\let\next=\bodyA\else\let\next=\bodyB\fi\next}
\def\ignorechar#1#2 {#1}

\def\kapitola{\advance\kapnum by 1 \odstnum=0 \rcenum=0 \okrajnum=0
     \ifnextchar[{\kaplabel}{\def\dolink{}\def\kaplabelik{}\inkapitola}}
\def\inkapitola #1 | #2 \par {\vfil\break
    \bigskip\noindent\raise15pt\hbox{\kapzalozka{#2}\dolink}%
    {\bbf\ifnum\kapnum=0\else\the\kapnum. \fi#1}\par\nobreak\bigskip
    \xdef\headtext{\ifnum\kapnum=0 \else\the\kapnum. \fi#1}\xdef\lmark{}
    \immediate\write\fileref{\string\refkapitola{\the\pageno}{\headtext}}
    \ifx\kaplabelik\empty \else
      \immediate\write\fileref { \space\space\space
         \string\refodstavec [\kaplabelik]{\the\kapnum}}\fi
   \global\headline={\hfil\starthead}}
\def\kaplabel[#1] {%\expandafter\ifx\csname c:#1\endcsname\relax
   \def\kaplabelik{#1}\def\dolink{\aimlink{c:#1}}%
   \inkapitola}
\def\starthead{\ifodd\pageno\else\xdef\lmark{\firstmark}\fi
   \global\headline={\vbox{%
   \iftwoside\ifodd\pageno
      \line{\strut\it \hfil\nazevodstavcu}%
   \else
      \line{\strut\it \xdef\lmark{\firstmark}\headtext\hfil}%
   \fi\else
      \line{\strut\it \nazevdila\hfil\headtext}%
   \fi
   \smallskip\hrule}}}
\def\dalsiodstavec#1{%
   \ifnextchar*{\def\nazevodstavce{#1.\kern-2pt*}\ignorechar\doodstavec}%
               {\def\nazevodstavce{#1.}\doodstavec}}
\def\doodstavec{\endpar \advance\odstnum by 1
   \def\start{\noindent\leftsymbol
    {\bf\the\kapnum.\the\odstnum. \nazevodstavce}\space\barva}
   \aimlink{o:\the\kapnum.\the\odstnum}%
   \ifnextchar[{\ulozlabel}{\start}}
\def\normalendpar{\par\removelastskip \penalty-200\bigskip}
\let\endpar=\normalendpar
\def\barva{} \def\leftsymbol{}
\def\ulozlabel[#1]{\aimlink{c:#1}%
     \immediate\write\fileref { \space\space\space
         \string\refodstavec [#1]{\the\kapnum.\the\odstnum}}%
   \ifladeni \noindent\llap{[#1]\ \ifcviceni\quad\fi}\fi
   \start\ignorespaces}
\def\rce(#1){\expandafter\ifx\csname r:#1\endcsname\relax
     \global\advance\rcenum by1
     \expandafter\xdef\csname r:#1\endcsname {\the\kapnum.\the\rcenum}%
     \aimlink{r:#1}%
   \else\errmessage{duplikace labelu rce(#1)}%
   \fi  \eqno (\the\kapnum.\the\rcenum)}
\def\pozn{\dalsiodstavec{Poznámka}}
\let\poznamka=\pozn
\def\priklad{\dalsiodstavec{Pøíklad}}
\def\cviceni{\dalsiodstavec{Cvièení}}
\def\pozorovani{\dalsiodstavec{Pozorování}}
\def\algoritmus{\ifnextchar({\nazvanyalgoritmus}{\dalsiodstavec{Algoritmus}}}
\def\nazvanyalgoritmus(#1) {\dalsiodstavec{Algoritmus (#1)}}
\def\shrnuti{\dalsiodstavec{Shrnutí}}
\def\definice{\dalsiodstavec{Definice}}
\def\veta{\ifnextchar({\nazvanaveta}{\dalsiodstavec{Vìta}}}
\def\nazvanaveta(#1) {\ifnextchar*{\ignorechar{\dalsiodstavec{Vìta* (#1)}}}%
                                  {\dalsiodstavec{Vìta (#1)}}}
\def\dukaz{\removelastskip\bigskip\noindent{\bf Dùkaz.}\space\ignorespaces}
\def\exdukaz{\removelastskip\bigskip\noindent
     {\bf Dùkaz }(pro hloubavé ètenáøe).\space\ignorespaces}
\let\nodukaz=\relax
\def\bod(#1){({\rm#1})&\quad}
\let\em=\it
\def\eng{\medskip\hrule width .15\hsize\medskip\noindent\llap*}
\def\eng#1\par{}
\def\ncite{\ifnextchar({\citerce}{\citeodst}}
\def\lcite[#1]{~/\ncite[#1]/}
\def\kcite#1{~\let\patvar=#1\citeodst}
\def\cite{~\ncite}
\def\citeodst[#1]{\expandafter\ifx\csname c:#1\endcsname\relax ??%
   \message{odkaz [#1] neni deklarovan.}%
   \else \beglink{c:#1}\patvar{\csname c:#1\endcsname}\endlink\fi
   \let\patvar=\relax}
\def\citerce(#1){\expandafter\ifx\csname r:#1\endcsname\relax (??)%
   \else \beglink{r:#1}(\csname r:#1\endcsname)\endlink\fi}
\def\okraj #1 | #2 \par {\par
   \global\advance\okrajnum by 1
   \global\setbox0=\hbox to0pt{\def\hb{\break}\line
      \iftwoside
      \ifodd 0\csname ok:\the\kapnum:\the\okrajnum\endcsname    
         {\hfil\rlap{\hskip1em\vtop
         {\hsize=.8in\noindent\raise15pt\hbox{\zalozka{#2}}\raggedright
          \it\Brown#1\Black}}}%
      \else {\llap{\vtop
          {\hsize=.8in
          \leftskip=0pt plus4em \parfillskip=0pt 
          \noindent\raise15pt\hbox{\zalozka{#2}}%
          \it\Brown#1\Black}\hskip1em}\hfil}%
      \fi\else
         {\hfil\rlap{\hskip1em\vtop
         {\hsize=.8in\noindent\raise15pt\hbox{\zalozka{#2}}\raggedright
          \it\Brown#1\Black}}}%
      \fi          
          \hss}%
   \ht0=3.5pt\dp0=3.5pt
   \global\everypar={\setbox2=\lastbox
       \write\fileref{ \space\string\refokraj{\the\pageno}{#1}}%
       {\def\uv##1{\clqq##1\crqq}\def\hb{\space}\mark{#1}}%
       \global\everypar={}\strut\box0\box2 }
   }
\def\nazevodstavcu{\edef\rmark{\botmark}%
   \ifx\lmark\empty \let\lmark=\rmark \fi
   \ifx\lmark\rmark 
       \ifx\lmark\empty \else \lowerfirst\lmark \lmark \fi
   \else 
       \lowerfirst\lmark \lowerfirst\rmark
       {\lmark} --- {\rmark}\fi
}
\def\lowerfirst#1{\def\temp{#1}\expandafter\sejmiprvni#1::}
\def\sejmiprvni#1#2::{\expandafter\def\temp{\lowercase{#1}#2}}

\def\ktere#1{\ifcase#1 nulté\or první\or druhé\or tøetí\or 
   ètvrté\or páté\or ¹esté\or sedmé\or osmé\or deváté\or desáté\or 
   jedenácté\or dvanácté\or tøinácté\or ètrnácté\or patnácté\or
   ¹estnácté\or sedmnácté\or osmnácté\else ??\fi}
\def\ktera#1{\ifcase#1 nulté\or první\or druhá\or tøetí\or 
   ètvrtá\or pátá\or ¹está\or sedmá\or osmá\or devátá\or desátá\or 
   jedenáctá\or dvanáctá\or tøináctá\or ètrnáctá\or patnáctá\or
   ¹estnáctá\or sedmnáctá\or osmnáctá\else ??\fi}
\let\patvar=\relax

\def\hb{\space}
\def\R{{\bf R}}
\def\N{{\bf N}}
\def\A{{\bf A}}
\def\B{{\bf B}}
\def\C{{\bf C}}
\def\D{{\bf D}}
\def\E{{\bf E}}
\def\G{{\bf G}}
\def\H{{\bf H}}
\def\O{{\bf O}}
\def\P{{\bf P}}
\def\L{{\bf L}}
\def\U{{\bf U}}
\def\Q{{\bf Q}}
\def\X{{\bf X}}
\def\Y{{\bf Y}}
\def\Z{{\bf Z}}
\let\phi=\varphi
\let\oodot=\odot \def\odot{{\oodot}}
\def\Circ{\mathbin{\raise.1em\hbox{$\scriptscriptstyle\bigcirc$}}}
\def\konv{\mathbin{\ast}}
\let\impl=\Rightarrow
\let\equiv=\Leftrightarrow
\def\lob<#1>{\langle#1\rangle}
\def\lobr<#1>{\langle\hbox{\rm r:}\,#1\rangle}
\def\lobb<#1>{\bigl\langle#1\bigr\rangle}
\def\hod{\mathop{\rm hod}}
\def\sgn{\mathop{\rm sgn}}
\def\diag{\mathop{\rm diag}}
\def\a{{\cal A}}
\def\b{{\cal B}}
\def\c{{\cal C}}
\def\m{{\cal M}}
\def\i{{\cal I}}
\def\d{{\rm d}}
\def\ker{\mathop{\rm Ker}}
\def\nullsp{\mathop{\rm Null}}
\def\defekt{\mathop{\rm def}}
\def\kolmy{\mathbin{\bot}}
\def\df#1{\buildrel\hbox{\sevenrm df}\over#1}
\let\vector\overrightarrow
\def\vec#1{{\fam\bfmath#1}}
\def\vecc #1_#2{\vec#1_1, \vec#1_2, \ldots, \vec#1_{#2}}
\def\lkvecc #1.#2_#3{#1_1\,\vec#2_1+#1_2\,\vec#2_2+\cdots+#1_#3\,\vec#2_#3}
\def\odsun{\hskip4em{}}
\def\teckacarka{\mathcode`\.="013B }
\def\soustava#1{\vcenter{\bigspaces\def\1{\hphantom1}\def\.{\rlap.}%
   \ialign{&\hfil${}##{}$\cr#1\crcr}}}
\def\bigspaces{\thickmuskip=10mu\medmuskip=7mu\relax}
\def\nobigspaces{\let\bigspaces=\relax}
\def\matice#1{\left(\kern-3pt\vcenter
  {\tabskip=5pt\halign{&\strut\hfil$##$\cr#1\crcr}}\kern-3pt\right)}
\def\bb#1 {\par\indent\llap{#1 }\hang\ignorespaces}
\def\+{\phantom+}
\def\dotfill{\cleaders\hbox to.5em{\hfil.\hfil}\hfill}
{\catcode`\:=13 \gdef:{\,\mathchar"003A\;}}
\mathcode`\:="8000

\input epsf
\def\noendpar{\def\endpar{\let\endpar=\normalendpar}}%
\def\obrazek #1+#2 #3 #4 #5{\endpar 
% #1 [zlomek \hsize] = sirka obrazku + #2 = okraj, #3 = vyska obrazku v radcich
% #4 = nazev souboru bez pripony, #5 = sada prikazu \p
   \colwidth=\hsize
   \advance\colwidth by-#1\hsize
   \nointerlineskip\moveright\colwidth\vbox to0pt{\offinterlineskip 
       \ifx\endpar\normalendpar \else \bigskip\fi    
       \kern4pt
       \kern\shiftpic
       \vbox to0pt{\pic{#1\hsize}{#4}\vss}#5\vss}
   \def\shiftpic{0pt}\noendpar   
   \colwidth=#1\hsize
   \advance\colwidth by#2\hsize
   \hangindent-\colwidth \hangafter=-#3
   \nobreak}
\def\p #1 #2 #3 {\vbox to0pt{\kern#1pt
   \setbox0=\hbox to0pt{\kern #2pt $#3$\hss}\ht0=0pt \dp0=0pt \box0\vss}}
\def\ha #1 {\hangindent=-\colwidth \hangafter=-#1 }
\def\dolu #1 {\def\shiftpic{#1}}
\def\shiftpic{0pt}

\ifx\pdfoutput\undefined 
  \def\pic #1#2{\epsfxsize=#1\hbox{\epsfbox{#2.eps}}}
\else
  \def\pic #1#2{\pdfximage width#1{#2.pdf}\pdfrefximage\pdflastximage}
\fi

\def\tocfill{\leaders\hbox{ . }\hfill}
\def\refkapitola#1#2{\advance\kapnum by1
  \bigskip\line{#2 \tocfill\space#1}\nobreak}
\def\refokraj#1#2{\advanceokraj
  \expandafter\xdef\csname ok:\the\kapnum:\the\okrajnum\endcsname{#1}%
  \line{\hskip3em #2 \tocfill\space#1}}
\def\refodstavec [#1]#2{%
  \expandafter\ifx\csname c:#1\endcsname\relax
     \expandafter\gdef\csname c:#1\endcsname {#2}%
   \else\errmessage{duplikace labelu [#1]}%
   \fi} 
\def\pocetokraju{
   \expandafter\ifx \csname kapokraj:\the\kapnum \endcsname \relax
      0\else \csname kapokraj:\the\kapnum \endcsname \fi}
\def\advanceokraj{\okrajnum=\pocetokraju
  \advance \okrajnum by1
  \expandafter \xdef \csname kapokraj:\the\kapnum \endcsname{\the\okrajnum}}
\def\softinput #1 {\let\next=\relax \openin\testin=#1
  \ifeof\testin \message{\warninginput}%
  \else \closein\testin \def\next{\input #1 }\fi
  \next}  
\def\delejobsah{\bgroup \kapnum=-1
%  \advance\vsize by-4\baselineskip
  \noindent {\bbf Obsah} %\bigskip
  \def\warninginput{VAROVÁNÍ: pro vytvoøení obsahu TeXujte je¹tì jednou.}%
  \softinput \jobname.ref
  \immediate\openout\fileref\jobname.ref
  \egroup}
\output={\iftwoside
  \ifodd\pageno \hoffset=-4mm \else \hoffset =\offsetvalue \fi\fi
  \let\uv=\relax \let~=\relax \let\lobr=\relax \plainoutput}

\ifbook            %%%%%%%%%%% makra pro cteni cviceni.tex %%%%%%%%%%%%%%
  \def\icviceni #1 {\okraj Cvièení | Cviceni \par
    \immediate\write\fileref{\string\startcviceni{\the\kapnum}{\the\odstnum}}
    \long\def\skipcv ##1\cvikap #1{}
    \expandafter \skipcv \input cviceni }
\else
  \def\icviceni #1 {} % cviceni nejsou ve verejne verzi textu k dispozici
\fi
\def\startcviceni#1#2{\expandafter\gdef\csname cv:#1\endcsname{#2}}

\let\ekap=\endinput
\long\def\vy #1\evy {}
\let\epar=\relax

\def\za#1){\par\indent\llap{#1) }\ignorespaces}
\def\diza#1){\hbox{#1)}\ }
\def\nza#1){ #1)~\ignorespaces}

\newif\ifipage  \ipagetrue                 %%%%%%%%%%%%%% rejstrik
\newwrite\fileidx
\ifcviceni \else 
\ifpouzereseni \else \immediate\openout\fileidx=\jobname.idx \fi\fi
\def\inl[#1]{\ifhmode\unskip\fi\doinl#1,,}  
\def\doinl#1,{\if?#1?\let\next=\relax\else
   \def\next{\bezmezery#1<<}\fi \next}
\def\bezmezery #1#2<<{\toidxfile[#1#2]\doinl}
\def\toidxfile[#1]{\ifipage\else \immediate\fi 
   \write\fileidx{\string\idx{#1}{\ifipage \the\pageno\else \the\kapnum\theodstnum\fi}}}
\def\theodstnum{\ifnum\odstnum<10 0\fi\ifnum\odstnum<100 0\fi\the\odstnum}

\def\trindef#1#2{\expandafter\def\csname x:#1\endcsname{#2}}

% lineární prostor: viz té¾ prostor

\trindef{R9n}{$\R^n$}
\trindef{R}{$\R$}
\trindef{R2}{$\R^2$}
\trindef{R3}{$\R^3$}
\trindef{v Rn}{v~$\R^n$}
\trindef{v R3}{v~$\R^3$}
\trindef{UO}{$U_O$}
\trindef{C}{$\C$}
\trindef{C0n}{$\C^n$}
\trindef{Z2}{$\Z_2$}
\trindef{GF2}{${\rm GF}(2)$}
\trindef{Z9p}{$\Z_p$}
\trindef{Z2n}{$\Z_2^n$}
\trindef{GFp}{${\rm GF}(p)$}
\trindef{GFpm}{${\rm GF}(p^m)$}
\trindef{0sim}{$\sim$}
\trindef{detA}{$\det\A$}
\trindef{rA}{$\hbox{r:}\,\A$}
\trindef{rA0lobrA}{$\lobr<\A>$}
\trindef{0lobM}{$\lob<\,.\,>$}
\trindef{1AT}{$\A^T$}
\trindef{1A1}{$\A^{-1}$}
\trindef{0MveeN}{$\vee$}
\trindef{0kolm}{$\kolmy$}
\trindef{1a}{$\a$}
\trindef{KerA}{$\ker\a$} 
\trindef{defA}{$\defekt\a$}
\trindef{hodA}{$\hod\A$}
\trindef{hoda}{$\hod\a$}
\trindef{0circ}{$\circ$}
\trindef{0normx}{$\|\,.\,\|$}
\trindef{E3}{$\E_3$}
\trindef{V3}{$V_3$}
\trindef{Vietovy}{Vi\`etovy}
\trindef{dimL}{$\dim L$}
\trindef{0times}{$\times$}
\trindef{0to}{$\to$}
\trindef{lp}{$l_p$}
\trindef{Lp}{$L_p$}

\immediate\write\fileidx{\string\idx{lineární: prostor}{11333}}
\trindef{11333}{viz té¾ {\it prostor}}

\def\delejrejstrik{\kapitola [rejstrik] Rejstøík | Rejstrik \par
  \pozn Na rozdíl od bì¾ných rejstøíkù tento neodkazuje na èísla
  stran, ale na èísla odstavcù. To by mìlo ètenáøi umo¾nit rychleji
  najít slovo z rejstøíku v textu, proto¾e cíl odkazu je pøesnìj¹í: 
  text odstavce je typicky men¹í ne¾ text celé strany.
  \par
  A¾ na výjimky nejsou v rejstøíku
  pojmy odkazovány na v¹echna místa, kde se vyskytují. Napøíklad pojem
  \uv{lineární prostor} nebo \uv{matice} by asi musel obsahovat 
  odkazy na skoro v¹echny odstavce. To by ztratilo smysl. 
  Èasto pou¾ívané pojmy jsou tedy v~rejstøíku odkazovány jen na místa, 
  kde jsou definovány nebo kde jsou uvedeny jejich dùle¾ité vlastnosti.
  \par
  \def\warninginput{VAROVÁNÍ: pro vytvoøení rejstøíku pou¾ijte \space
      csindex -s linal.icf -z il2 linal .}
  \begmulti 2
  \softinput \jobname.ind 
  \endmulti
}

\def\ind#1, {\def\bodyind{#1}\def\bodyindp{#1}%
   \ifnextchar\subind{}{\normalind#1, }}
\def\normalind#1, {\par\noindent\mark{\trind{\bodyindp}}\hangpar
   \trind{#1}\nobreak\enspace\printnums}
\def\subind#1, {\def\subbody{#1}\def\subbodyp{#1}%
   \ifnextchar\subsubind{}{\normalsubind#1, }}
\def\normalsubind#1, {\par\noindent\mark{\trind{\bodyindp}}\hangpar
   \trind{\bodyind}\space\trind{#1}%
   \def\bodyind{---}\nobreak\enspace\printnums}
\def\subsubind#1, {\par\noindent\mark{\trind{\bodyindp}}\hangpar
   \trind{\bodyind}\space\trind{\subbody}\space\trind{#1}%
   \def\bodyind{---}\def\subbody{---}\nobreak\enspace\printnums}
\def\hangpar{\hangindent=2em}
\def\trind#1{\expandafter\ifx\csname x:#1\endcsname\relax #1\else
   {\csname x:#1\endcsname}\fi}

\def\printnums{\afterassignment\printonenum\tempnum=}
\def\printonenum{\shownum\ifnextchar,%
    {, \afterassignment\printnums\let\temp=}{\ifnextchar-{\printft}{}}}
\def\shownum{%
  \expandafter \ifx \csname x:\the\tempnum\endcsname \relax
  \ifnum\tempnum<1000 (str.~\the\tempnum)%
  \else \odstnum=\tempnum \divide\tempnum by1000
        \edef\tmp{\the\tempnum}%
        \multiply\tempnum by1000 \advance\odstnum by-\tempnum
        \beglink{o:\tmp.\the\odstnum}\tmp.\the\odstnum\endlink
  \fi
  \else
     \csname x:\the\tempnum\endcsname
  \fi}
\def\printft--{--\afterassignment\onlyodstnum\odstnum=}
\def\onlyodstnum{\advance\odstnum by-\tempnum \the\odstnum
   \ifnextchar,{, \afterassignment\printnums\let\temp=}{}}

\newdimen\colsep  \colsep=2em % horiz. mezera mezi sloupci 
\newcount\tempnum             % pracovní promìnná
\splittopskip=\baselineskip
\def\roundtolines #1{%% zaokrouhlí na celé násobky vel. øádku
   \divide #1 by\baselineskip \multiply #1 by\baselineskip}
\def\corrsize #1{%% #1 := #1 + \splittopskip - \topskip
   \advance #1 by \splittopskip \advance #1 by-\topskip}
\def\begmulti #1 {\par\bigskip\penalty0 \def\Ncols{#1}
   \setbox0=\vbox\bgroup\penalty0
   %% \hsize := ¹íøka sloupce = (\hsize+\colsep) / n - \colsep
   \advance\hsize by\colsep \rightskip=0pt plus 2em
   \divide\hsize by\Ncols  \advance\hsize by-\colsep}
\def\endmulti{\vfil\egroup \setbox1=\vsplit0 to0pt
   %% \dimen1 := velikost zbylého místa na stránce
   \ifdim\pagegoal=\maxdimen \dimen1=\vsize \corrsize{\dimen1}
   \else \dimen1=\pagegoal \advance\dimen1 by-\pagetotal \fi
   \ifdim \dimen1<2\baselineskip
     \vfil\break \dimen1=\vsize \corrsize{\dimen1} \fi
   %% \dimen0 := vý¹ka n sloupcové sazby po rozdìlení do sloupcù
   %% = (\ht0 + (n-1)\baselineskip) / n, zaokruhleno na øádky
   \dimen0=\Ncols\baselineskip \advance\dimen0 by-\baselineskip
   \advance\dimen0 by \ht0 \divide\dimen0 by\Ncols
   \roundtolines{\dimen0}
   %% Rozdìlit sazbu n sloupcù do stránek nebo nerozdìlit ?
   \ifdim \dimen0>\dimen1 \splitpart  
   \else \makecolumns{\dimen0} \fi
   \ifvoid0 \else \box0\message{ERROR: ztracený text ve sloupcích?} \fi
   \bigskip}
\def\makecolumns#1{\setbox1=\hbox{}\tempnum=0
   \xdef\smark{}
   \loop \ifnum\Ncols>\tempnum
      \setbox1=\hbox{\unhbox1 \vsplit0 to#1 \hss
               \ifx\smark\empty\xdef\smark{\splitfirstmark}\fi}
      \advance\tempnum by1
   \repeat
   \hbox{}\nobreak\vskip-\splittopskip \nointerlineskip
   \line{\unhbox1\unskip\mark{{}\smark}\mark{{}\splitbotmark}}}
\def\splitpart{\roundtolines{\dimen1}
   \makecolumns{\dimen1} \advance\dimen0 by-\dimen1
   %% \dimen0 := vý¹ka _zbylé_ n sloupcové sazby
   %% \dimen1 := prázdné místo na stránce = (cca) \vsize
   \vfil\break
   \dimen1=\vsize \corrsize{\dimen1}
   %% Rozdìlit zbylou sazbu n sloupcù do více stránek ?
   \ifvoid0 \else
      \ifdim \dimen0>\dimen1 \splitpart
      \else 
        \dimen0=\Ncols\baselineskip \advance\dimen0 by-.5\baselineskip
        \advance\dimen0 by \ht0 \divide\dimen0 by\Ncols
        \roundtolines{\dimen0}
        \makecolumns{\dimen0} \fi \fi}

\newcount\bibnum \newwrite\filebr
\def\bibitem#1#2{\expandafter\def\csname br:#1\endcsname{#2}}
\def\warninginput{VAROVÁNÍ: kvùli odkazùm na literaturu TeXujte je¹tì jednou.}
\softinput \jobname.br
\ifcviceni \else 
\ifpouzereseni \else \immediate\openout\filebr=\jobname.br \fi\fi
\def\bib [#1]{\advance\bibnum by1
  \immediate\write\filebr{\string\bibitem{#1}{\the\bibnum}}%
  \smallskip\hangindent\parindent\indent\llap{[\the\bibnum]\enspace}\ignorespaces}
\def\bcite[#1]{\expandafter\ifx\csname br:#1\endcsname \relax
  \message{bib.odkaz [#1] není deklarován.}~[??]%
  \else ~[\csname br:#1\endcsname]\fi}

    %%%%%%%%%%% makra pro sazbu soustav ve cviceni.tex %%%%%%%%%%%%%%%
\def\sous {\vcenter\bgroup \def\hhead{}\sousa}
\def\sousa #1 {\ifx\\#1\relax
    \expandafter\sousb
  \else
    \ifx\hhead\empty 
       \def\hhead{\hfil${}\param#1$&}%
    \else
       \expandafter\def\expandafter\hhead
       \expandafter{\hhead ${}\param\hfil#1$&}%
    \fi
       \expandafter\sousa
  \fi
}
\def\sousb #1 \esous{\def\param{########}%
   \edef\hhead{\hhead}%
   \halign{\span\hhead ${}=\hfil##$\cr \\ #1 \crcr}\egroup}
\def\\ #1 {\if=#1%
    \expandafter \sousc
  \else \if!#1\else   % je mozne psat !\multispan4\dotfill\cr nebo tak neco
    \if0#1\expandafter\omit\else
      \def\tmp{#1}%
      \ifx\tmp\plusjedna+\else 
      \ifx\tmp\minusjedna-\else 
      \ifx\tmp\normaljedna \else #1\fi\fi\fi\fi
  &\fi\expandafter\expandafter\expandafter\\\expandafter\space
  \fi
}
\def\sousc #1 {#1 \cr}
\def\0{\phantom0}
\def\plusjedna{+1}
\def\minusjedna{-1}
\def\normaljedna{1}

\def\mmaticei#1{\vcenter{\baselineskip=.7\baselineskip
   \lineskip=0pt
   \halign{\hfil$\scriptstyle##$\hfil&&\enspace
   \hfil$\scriptstyle##$\hfil\crcr#1\crcr}}}
\def\mmatice#1{\left(\mmaticei{#1}\right)}
\def\dmmatice#1{\left|\mmaticei{#1}\right|}
\def\setbar{\catcode`|=13 }
{\setbar \gdef|{\kern-2pt&\vrule height1.35ex depth.6ex&\kern-2pt}}

\ifx\pdfoutput\undefined \else %%%%%%%%%%% makra pro pdfTeX %%%%%%%%%%%%%%%%
\pdfcompresslevel=9
\ifx\pdfannotlink\undefined  % Verze pdfTeXu >= 14
   \let\pdfannotlink=\pdfstartlink
\fi
\def\pdfsetcmykcolor#1{\special{PDF:#1 k}}
\def\Blue{\pdfsetcmykcolor{0.9 0.9 0.1 0}}
\def\Red{\pdfsetcmykcolor{0.1 0.9 0.9 0}}
\def\Brown{\pdfsetcmykcolor{0 0.85 0.87 0.5}}
\def\Green{\pdfsetcmykcolor{0.9 0.1 0.9 0}}
\def\Black{\pdfsetcmykcolor{0 0 0 1}}
\def\definice{\dalsiodstavec{\Blue Definice\Black}}
\def\veta{\def\barva{\Blue}%
   \ifnextchar({\nazvanaveta}{\dalsiodstavec{\Red Vìta\Black}}}
\def\nazvanaveta(#1) {\dalsiodstavec{\Red Vìta\Black\ (#1)}}
\def\em{\leavevmode\aftergroup\Black\Red\it}
\def\dukaz{\removelastskip\bigskip
   \noindent\Black\def\barva{}{\bf Dùkaz.}\space\ignorespaces}
\def\exdukaz{\removelastskip\bigskip
   \noindent\Black\def\barva{}%
   {\bf Dùkaz }(pro hloubavé ètenáøe).\space\ignorespaces}
\def\nodukaz{\Black\def\barva{}}
\pdfinfo{/Author (Petr Olsak)
         /CreationDate (/\the\month/\the\year) 
         /ModDate (\the\day. \the\month. \the\year)
         /Creator (TeX)
         /Producer (pdfTeX)
         /Title (Linearni algebra)
         /Subject (ucebni text)
         /Keywords (linearita, algebra)
}
\def\beglink#1{%          % Zaèátek textu odkazu, #1 je klíè odkazu
   \Green \pdfannotlink height9pt depth3pt 
     attr{/Border[0 0 0]} goto name{#1}\relax}
\def\endlink{\pdfendlink\ifx\barva\empty\Black\else\barva\fi}  
\def\aimlink#1{%          % Místo cíle odkazu, #1 je klíè odkazu
   \pdfdest name{#1} fith\relax}
\def\urllink#1{\pdfannotlink height 10pt depth 3pt 
   user{/Border[0 0 0]/Subtype/Link/A << /Type/Action/S/URI/URI(#1)>>}\relax
   \Green{\tt #1}\Black\pdfendlink}
\def\zalozka#1{\global\advance\numlink by1
   \pdfdest num\numlink fith\relax
   {\let~=\space\pdfoutline goto num\numlink {#1}}}
\def\kapzalozka#1{\global\advance\numlink by1
   \pdfdest num\numlink fith\relax
   {\let~=\space\pdfoutline goto num\numlink count-\pocetokraju {#1}}}  
\pdfcatalog{/PageMode /UseOutlines}\relax


\ifkindle %%VERZE VSEOBECNYCH MAKER POUZIVANE PRI EXPORTU NA KINDLE
	\def\bb#1 {\par\noindent{\bf #1} }
	\def\starthead{}
	\def\barva{} \def\leftsymbol{}

\fi %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% konec maker pro pdfTeX %%%%%%%%%%%%%%%


\def\poznamkakreseni{
\noindent Vá¾ení studenti,

tento dokument obsahuje øe¹ení ke cvièením, která najdete ve skriptu
{\it Úvod od algebry, zejména lineární}. Zatím nejsou uvedena øe¹ení
v¹echna, ov¹em postupnì bìhem semestru budu pøidávat dal¹í. V~textu se
znovu neopakuje zadání cvièení, abychom u¹etøili místo na papíru. V
pøípadì, ¾e byste si to chtìli tisknout, jistì uvítáte, ¾e je stránek
co nejménì. Ze stejného dùvodu je text psán velmi struènì
a \uv{hustì}, tak¾e v ¾ádném pøípadì nemù¾e slou¾it jako ukázka, jak
má vypadat dobrá typografie. ©lo mi skuteènì hlavnì o úsporu místa.

Po pravé stranì ka¾dého èísla pøíkladu (jako horní index) je uveden 
èíselný údaj v rozsahu 0--5, kterým naznaèuji dùle¾itost tohoto 
pøíkladu v na¹em pøedmìtu {\it Úvod do algebry}. Pìtka znamená pøíklad zásadní
dùle¾itosti a nula znamená, ¾e pøíklad mù¾ete ignorovat. Proè jsou ve
skriptech pøíklady \uv{nulové dùle¾itosti}? 
Skripta toti¾ obsahují vìci, které se dají pou¾ít pozdìji v dal¹ích
pøedmìtech souvisejících s algebrou, ale nejsou souèástí osnovy na¹eho
úvodního pøedmìtu. 

Èísla oznaèující dùle¾itost pøíkladu v sobì zahrnují do jisté míry
i obtí¾nost pøíkladu. Lapidárnì se dá øíci, ¾e pokud neumíte samostatnì
odpovìdìt na cvièení oznaèené èíslem 5, pak je zbyteèné chodit na
zkou¹ku. S~úèastí na zkou¹ce byste si to mìli rozmyslet i pøi
problémech se cvièeními oznaèenými èíslem~4. Cvièení s èísly 3 a 2
by nemìla uniknout Va¹í pozornosti, pokud chcete získat vìt¹í pøehled 
o~pøedmìtu a chcete u zkou¹ky dosáhnout na lep¹í známku ne¾ 3.

Tento text (narozdíl od skript samotných) nepro¹el redakèní úpravou. 
Dá se bohu¾el tedy pøedpokládat, ¾e v nìm budou i nìjaké chyby a
pøeklepy. Prosím o toleranci k tìmto jevùm a o pøípadné upozornìní na
chyby, abych je pak mohl v dal¹í verzi textu opravit.
\medskip
\noindent Verze textu: \the\day. \the\month. \the\year \hfill Petr Ol¹ák
\bigskip
}

\ifpouzereseni
  \hoffset=4mm
  \global\headline={\vbox{%
      \line{\strut\it \nazevskripta \hfil Øe¹ení cvièení}%
      \smallskip\hrule}}
  \def\skippar #1#2{\advance\odstnum by1
    \long\def\doskippar ##1#1{}
    \def\next{#2}\expandafter\next\doskippar}
  \def\cviceni {\skippar\vy\vy}
  \def\veta {\skippar\epar\relax}
  \def\definice {\skippar\epar\relax}
  \def\priklad {\skippar\epar\relax}
  \def\poznamka {\skippar\epar\relax}
  \def\vy#1 {\bgroup
     \def\za##1){\par\noindent\llap{$\rightarrow$ }(##1)}
     \def\nza##1){(##1)~\ignorespaces}
     \medskip\noindent
     \llap{\bf\the\kapnum.\the\odstnum.$^{#1}$\enspace}%
     {\bf Øe¹ení.} }
  \def\du#1{${}^#1$}
  \def\evy{\egroup}
  \let\ekap=\endinput
  \def\okraj #1 \par {} 
  \def\write#1#2{}\let\immediate=\relax
  \def\refkapitola#1#2{}
  \def\refokraj#1#2{}{}
  \softinput \jobname.ref
  \def\reseni #1 {
    \kapnum=#1 \odstnum=\csname cv:#1\endcsname
    \long\def\skipcv ##1\cvikap #1{}
    \expandafter \skipcv \input cviceni }
  \poznamkakreseni
  \resenilist
  \expandafter \end
\fi

\ifcviceni  
  \def\cvikap #1 {\bigskip 
     {\bf KAPITOLA #1}\par\nobreak\medskip
     \kapnum=#1 \odstnum=\csname cv:#1\endcsname
  }
  \def\vy #1 {\bgroup
     \def\za##1){\par\noindent\llap{$\rightarrow$ }(##1)}
     \def\nza##1){(##1)~\ignorespaces}
     \medskip\noindent\llap{(#1) }{\bf Øe¹ení.} }
  \def\du#1{${}^#1$}
  \def\evy{\egroup}
  \let\ekap=\relax
  \def\okraj #1 \par {}
  \def\leftsymbol{\llap{$\bullet\bullet$\kern5pt}}
  \def\write#1#2{}\let\immediate=\relax
  \def\refkapitola#1#2{}
  \def\refokraj#1#2{}{}
  \softinput \jobname.ref
  \input cviceni 
  \expandafter \end
\fi


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% zacina text %%%%%%%%%%%%%%%%%%%%%%%%%%

{\nopagenumbers \parindent=0pt
\null\vskip3cm
\centerline{\bigf Petr Ol¹ák}
\skipcm2
\centerline{\bigf \nazevdila}
\skipcm2
\ifbook
   \centerline{\bbf FEL ÈVUT Praha, 2007}
\else
   \centerline{\bbf Praha, druhé vydání 2010}
\fi
\skipcm2
\unlessKindle{\centerline{\logocvut E}}


\vfil\break

\null
\vskip2cm

\ifbook %%%%%%% text pro tistena skripta

Významná èást tohoto textu je od roku 2000
¹íøena volnì pod jménem {\em Lineární algebra} podle licence
\urllink{ftp://math.feld.cvut.cz/pub/olsak/linal/licence.txt}.

Na rozdíl od volnì ¹íøené pøedlohy je zde doplnìna rozsáhlá sbírka úloh pro
ka¾dou kapitolu a dále je pøidána kapitola o~polynomech.

\vskip 3cm

\input epsf

\hbox{\epsfysize=13.25mm \lower.25mm\hbox{\epsfbox{esf.eps}}\kern1.5mm
      \epsfysize=13mm \epsfbox{eu.eps}\kern2mm
      \epsfysize=13mm \epsfbox{praha.eps}\kern2mm
      \epsfysize=13mm \epsfbox{vlajka.eps}}

\medskip\noindent
Pøíprava tohoto uèebního textu byla spolufinancována evropským
sociálním fondem, státním rozpoètem~ÈR a rozpoètem hl. m. Prahy.


\vfill
Lektor: prof. RNDr. Pavel Pták, DrSc.

\bigskip
Toto skriptum vy¹lo nákladem Fakulty elektrotechnické ÈVUT. 
%nikoli v nakladatelství~ÈVUT. 
%Citace:
%
%\bigskip
%Petr Ol¹ák, {\it Úvod do algebry, zejména lineární.} FEL ÈVUT, Praha 2007.

\bigskip
Autor upozoròuje nakladatelství ÈVUT, ¾e dnes je zcela obvyklé kromì
kni¾ního vydání díla zveøejnit k~volnému pou¾ití tøeba i doslovný text díla na
internetu. Pokud to edièní rada ÈVUT pøehlédla, mù¾eme
uvést tøeba\bcite[beezer],\bcite[hefferon],\bcite[zahradnik],\bcite[TBN]. Pøíkladù paralelního vydání
papírového a internetového by se na¹lo více.
\bigskip
Za jazykovou a vìcnou správnost obsahu odpovídá autor.

\bigskip\bigskip
Copyright \copyright{} RNDr. Petr Ol¹ák, 2007
\bigskip
ISBN 978-80-01-03775-1
\vskip1cm
\break

{\parskip=\bigskipamount
\input predmluva
\vfil\break
}

\else %%%%%%%% text pro volne siritelnou variantu

Text je ¹íøen volnì podle licence
\urllink{ftp://math.feld.cvut.cz/pub/olsak/linal/licence.txt}.

Text ve formátech \TeX{} (csplain), PostScript, {\tt dvi}, PDF najdete na
adrese\hfil\break
\urllink{ftp://math.feld.cvut.cz/pub/olsak/linal/}.

\bigskip
Verze textu: \the\day. \the\month. \the\year\ (beta verze druhého vydání)
\bigskip
{\bf Upozornìní:} Tento dokument je v rozpracovaném stavu. Bude se
je¹tì bìhem roku 2010 výraznì mìnit.

\bigskip
Text vznikal postupnì od roku 2000 a je od té doby volnì ¹íøen
na uvedených stránkách. Nové partie jsem a¾ do roku 2007 pøipojoval na
konce stávajících kapitol, abych neporu¹il èíslování ji¾ existujících
odstavcù. V èervnu 2007 jsem tento text pou¾il ve skriptech\bcite[olsak-ua]. 
Tam je navíc ke ka¾dé kapitole pøipojena rozsáhlá sbírka
cvièení a je pøidána kapitola o polynomech. Tyto vìci ve verzi volnì
¹íøené na internetu nejsou.

\bigskip
V roce 2010 jsem zaèal pracovat na \uv{druhém vydání} tohoto textu,
který se výraznì li¹í od pøedchozího. V nìkterých partiích jsem zaèal
pou¾ívat (domnívám se) u¾iteènìj¹í znaèení, ale pøedev¹ím jsem text
rozèlenil do kapitol výraznì jiným zpùsobem a opustil jsem od zpìtné
kompatibility èíslování odstavcù s první verzí. Druhé vydání má
zdrojový soubor {\tt linal2.tex}.

K teoretickému úvodu (lineární prostor, lineární závislost, obaly,
báze) pøidávám pojem souøadnice vzhledem k bázi a v následující
kapitole o zobrazeních uká¾u, ¾e souøadnice vzhledem k bázi jsou
izomorfismem na $\R^n$. Tím vytvoøím motivaci podrobnìji studovat
vlastnosti v $\R^n$ vèetnì popisu algoritmù. Tak¾e a¾ poté pøicházejí
na øadu kapitoly o maticích. K lineárním zobrazením se pak vracím
podruhé, abych uvedl jejich souvislost s maticemi.

V druhém vydání jsem zcela pøepracoval kapitoly o lineárních zobrazeních
a dále jsem pøidal mnoho dal¹ích partií, které souvisejí s praktickými
aplikacemi: vy¹etøování lineárních obalù, LU rozklad, blokový maticový
souèin, Strassenùv 
algoritmus, geometrická interpretace mno¾iny øe¹ení soustavy rovnic,
matice afinního zobrazení v homogenních souøadnicích. 
Na konec ka¾dé kapitoly 
jsem pøipojil odstavec \uv{shrnutí}, který lapidárním jazykem shrnuje,
co bylo v kapitole øeèeno.

Nìkteré odstavce jsem novì oznaèil hvìzdièkou. Tím je øeèeno, ¾e
odstavec obsahuje dùle¾itý výsledek lineární algebry, který rozhodnì
stojí za pov¹imnutí. To umo¾ní ètenáøi se rychleji orientovat v tom,
které partie textu obsahují skuteènì zásadní informace a urèitì 
by je nemìl pøeskoèit.


\vfill
Copyright \copyright{} RNDr. Petr Ol¹ák, 2000, 2001, 2002, 2003, 2005,
                                         2006, 2007, 2010
\vskip2cm
\break

\fi %%%%%%%%% konec \ifbook

\delejobsah

\vfill\break
\ifodd\pageno \else \null\vfill\break \fi

}

%\ifbook \else \pageno=1 \fi
\kapnum=-1


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\kapitola [GEM] Gaussova eliminaèní metoda | Gaussova eliminacni metoda
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Ne¾ se pustíme do studia lineárních prostorù a podprostorù, závislosti
a nezávislosti vektorù, bází a lineárních obalù, uvedeme si v této
úvodní kapitole metodu, která se nám bude èasto hodit. Proto¾e se 
k~øe¹ení soustav vrátíme podrobnìji v kapitole\kcite\ktere[soustavy], øekneme
si zde jen to nejnutnìj¹í a budeme se v~nìkterých pøípadech vyjadøovat
mo¾ná ponìkud tì¾kopádnì. V¹e napravíme v\kcite\ktere[soustavy] kapitole.

{\em Gaussova eliminaèní metoda\/} je metoda usnadòující øe¹ení soustav
lineárních rovnic. {\em Soustava lineárních rovnic\/} je jedna nebo
(obvykle) více lineárních rovnic, které mají být splnìny v¹echny
souèasnì. {\em Lineární rovnice\/} je rovnice, ve které se jedna nebo
(obvykle) více neznámých vyskytuje pouze v první mocninì. Neznámé
mohou být násobené rùznými konstantami a tyto násobky se v souètu mají
rovnat dané konstantì, tzv.~{\em pravé stranì}. {\em Øe¹it soustavu
rovnic\/} znamená najít øe¹ení, tj.~najít taková reálná èísla, která po
dosazení za neznámé v rovnicích splòují v¹echny rovnice
souèasnì. Takové øe¹ení mù¾e existovat pro danou soustavu jediné, mù¾e se
ale stát, ¾e je takových øe¹ení více nebo není ¾ádné.
\inl[GEM, Gaussova: eliminaèní metoda, metoda: eliminaèní: Gaussova]
\inl[eliminaèní metoda: Gaussova]
\inl[soustava: lineárních: rovnic]

\okraj Úvodní\hb pøíklad | Uvodni priklad

Metodu si nejprve vysvìtlíme na jednoduchém pøíkladì následující
soustavy dvou lineárních rovnic o~dvou neznámých $x$, $y$:
$$
  \soustava{ 2x - 5y =& 16 \cr
           {-}x + 2y =&\!\! {-}7 }
$$
Ze støední ¹koly asi znáte dvì metody, jak takové soustavy øe¹it: buï
postupným dosazením, nebo násobením rovnic konstantami a vzájemným 
sèítáním rovnic. Metoda postupného dosazení by mohla vypadat takto:
$$\nobigspaces \let\en=\enspace
  \soustava{2x-5y =& 16&                &
       \impl\en 2(2y+7)-5y = 14-y = 16 \en\impl\en \underline{y=-2} & \cr 
          {}-x+2y =&\!-7&{}\en\impl\en x = 2y+7 &&
               , }
$$
$$\nobigspaces \let\en=\enspace
	\en\impl\en x = 2(-2) + 7 \en\impl\en \underline{x=3}$$
ale nemá s Gaussovou eliminaèní metodou moc spoleèného. Pro
rozsáhlej¹í soustavy (mnoho rovnic, mnoho neznámých) se moc nehodí.
Zamìøíme se proto na druhou metodu \uv{sèítání rovnic}. V této metodì
mìníme postupnì soustavu rovnic na jinou soustavu se stejným
øe¹ením. Zmìny soustavy, které nemìní øe¹ení, jsou následující:

\medskip
\bb (1) Prohození rovnic mezi sebou.\par
\bb (2) Vynásobení rovnice nenulovou konstantou.\par
\bb (3) Pøiètení libovolného násobku nìjaké rovnice k jiné.
\medskip

Pomocí tìchto úprav pøevedeme soustavu rovnic na jinou soustavu, ze
které je ji¾ øe¹ení snadno èitelné. Jednotlivé modifikace na¹í
soustavy od sebe oddìlujeme znakem \uv{$\sim$}.\inl[0sim]
$$\nobigspaces\def\en{\kern1em}
  \soustava{ 2x - 5y =& 16 \cr
           {}-x + 2y =&\! -7 } \en\sim
  \soustava{ 2x - 5y =& 16 \cr
          {}-2x + 4y =&\!\! -14 } \en\sim\en
  \soustava{ 2x - 5y =& 16 \cr
             0x -\1y =&  2 } \en\sim\en
  \soustava{ 2x - 5y =& 16 \cr
                   y =&\! -2 }\en\sim\en$$
$$\nobigspaces\def\en{\kern1em} \en\sim\en
  \soustava{ 2x + 0y =& 6 \cr
                   y =&\! -2 } 
									\en\sim\en
  \soustava{ x =& 3 \cr
             y =&\! -2 }
$$
Nejprve jsme vynásobili druhou rovnici dvìma, pak jsme obì rovnice
seèetli a výsledek napsali na místo druhé rovnice, dále jsme druhou
rovnici vynásobili èíslem $-1$, pak jsme pìtinásobek druhé rovnice
pøièetli k první a nakonec jsme první rovnici vynásobili èíslem 
$1/2$. Z poslední soustavy èteme pøímo øe¹ení.

Gaussova eliminaèní metoda je vlastnì shodná s právì pou¾itou metodou
\uv{sèítání rovnic}. Navíc Gaussova metoda upøesòuje postup, jak
rovnice násobit a sèítat mezi sebou, abychom se cílenì dobrali 
k výsledku i u rozsáhlých soustav mnoha rovnic s mnoha neznámými. 
Ne¾ tento postup popí¹eme, zamyslíme se nad tím, jak struènì mù¾eme
soustavy rovnic zapisovat. V soustavì rovnic není pøi
hledání øe¹ení podstatné, zda se neznámé jmenují $x,y,z$ nebo tøeba
$\alpha,\beta,\gamma$. Podstatné jsou jen koeficienty, které násobí
jednotlivé neznámé, a samozøejmì je¹tì hodnoty na pravých stranách
rovnic. Oddìlíme tedy \uv{zrno od plev} a vypí¹eme z na¹í soustavy jen
to podstatné (koeficienty u neznámých a hodnoty pravých stran) 
do tabulky èísel, které budeme øíkat {\em matice}:
\inl[matice]
$$
  \def\|{\kern3pt\strut\vrule}
  \matice{2 & -5 \|& 16 \cr -1 & 2 \|& -7}
$$
Pokud chceme prohodit rovnice, v novém znaèení to znamená prohodit øádky
matice. Vynásobení rovnice nenulovou konstantou odpovídá vynásobení
øádku matice touto konstantou. Koneènì pøiètení násobku jedné rovnice
k druhé je toto¾né s pøiètením násobku jednoho øádku ke
druhému. Postup øe¹ení na¹eho pøíkladu tedy mù¾eme zapsat takto:
$$
\def\+{\kern3pt} \def\|{\kern3pt\strut\vrule}
  \matice{2 & -5 \|&\+16 \cr -1 & 2 \|& -7} \sim
  \matice{2 & -5 \|&  16 \cr -2 & 4 \|& -14} \sim
  \matice{2 & -5 \|&  16 \cr  0 &-1 \|&   2} \sim
  \matice{2 & -5 \|&  16 \cr  0 & 1 \|&  -2} \sim\cr&\sim
  \matice{2 &  0 \|&   6 \cr  0 &\+1\|&  -2} \sim
  \matice{1 &  0 \|&   3 \cr  0 &\+1\|&  -2}
$$

\okraj Dal¹í pøíklad | Dalsi priklad

Pøed výkladem Gaussovy eliminaèní metody na obecné
soustavì lineárních rovnic si uká¾eme postup je¹tì na jednom
pøíkladu, který bude mít ètyøi rovnice a pìt neznámých.
Pøíklad je zvolen zámìrnì tak, aby vycházela malá celá èísla, tak¾e se
nám to bude dobøe poèítat bez pou¾ití výpoèetní techniky. To je
obvyklé v~tzv. {\em modelových pøíkladech}, 
které mají za úkol ilustrovat obecné algebraické postupy a se kterými
se setkáte pøi øe¹ení úloh ze skript. Jakmile se ale dostanete k úlohám
z praxe, budete postaveni pøed soustavy tøeba s~tisíci rovnicemi a se zhruba 
stejným poètem neznámých. Na malá celá èísla budete muset zapomenout.
Bez výpoèetní techniky se to pak øe¹it nedá. Pamatujte tedy, ¾e 
øe¹ení modelových pøíkladù ze skript není koneèným cílem na¹í teorie,
ale jen pomùckou k pochopení rozsáhlej¹ích souvislostí.
\inl[pøíklad: modelový, modelový pøíklad]

Máme øe¹it následující soustavu lineárních rovnic
$$
  \soustava{ -4 x_1 + 4 x_2 -\1 x_3 &+\1 x_4 &- 7 x_5 =& {-11} \cr  
              2 x_1 - 2 x_2 +\1 x_3 &        &+ 3 x_5 =& 4  \cr
              4 x_1 - 4 x_2 + 5 x_3 &+\1 x_4 &+ 7 x_5 =& -3 \cr
             -6 x_1 + 6 x_2 - 4 x_3 &+\1 x_4 &-12 x_5 =& {-7} }
$$ 
Koeficienty této soustavy pøepí¹eme do matice a matici budeme
upravovat pomocí tzv. krokù Gaussovy eliminaèní metody, mezi které
patøí prohození øádkù mezi sebou, vynásobení øádku nenulovou
konstantou nebo pøiètení libovolného násobku nìjakého øádku k jinému.
$$
  \def\text#1\nl{&\vcenter{\normalbaselines\hsize=.6\hsize\noindent #1}%
      \cr\noalign{\medskip}}
  \def\+{\kern6pt}\def\|{\kern3pt\strut\vrule}
  \halign to\hsize{\hfil$#$\hfil\tabskip=10pt plus 1fil&$#$\tabskip=0pt\cr
  \hphantom{\sim}
  \matice{-4 & 4 &-1 &\+1 & -7 \|& -11 \cr
           2 &-2 & 1 &  0 &  3 \|&  4 \cr
           4 &-4 & 5 &  1 &  7 \|& -3 \cr
          -6 & 6 &-4 &  1 &-12 \|& -7} \sim
  \text 
     Nejprve potøebujeme sèítáním násobkù øádkù dostat nulu pod
     první prvek v~prvním sloupci. Aby se nám to lépe dìlalo,
     prohodíme první øádek s druhým. 
  \nl \sim
  \matice{ 2 &-2 & 1 &  0 &  3 \|&  4 \cr
          -4 & 4 &-1 &\+1 & -7 \|& -11 \cr
           4 &-4 & 5 &  1 &  7 \|& -3 \cr
          -6 & 6 &-4 &  1 &-12 \|& -7} \sim
  \text 
     Pod dvojkou v prvním sloupci budeme postupnì vytváøet nuly.
     Vezmeme dvojnásobek prvního øádku a pøièteme jej ke druhému.
  \nl \sim
  \matice{ 2 &-2 & 1 &  0 &  3 \|&  4 \cr
           0 & 0 & 1 &\+1 & -1 \|& -3 \cr
           4 &-4 & 5 &  1 &  7 \|& -3 \cr
          -6 & 6 &-4 &  1 &-12 \|& -7} \sim
  \text
     Zatím nemáme v prvním sloupci pod dvojkou v¹ude nuly. Budeme si
     stále \uv{pomáhat} násobky prvního øádku, který opí¹eme.
     Minus dvojnásobek prvního øádku pøièteme ke tøetímu a trojnásobek
     prvního øádku pøièteme ke ètvrtému.
  \nl \sim
  \matice{ 2 &-2 & 1 &  0 &  3 \|&  4 \cr
           0 & 0 & 1 &\+1 & -1 \|& -3 \cr
           0 & 0 & 3 &  1 &  1 \|& -11 \cr
           0 & 0 &-1 &  1 & -3 \|& 5} \sim
  \text
     Nyní bychom mìli vytváøet nuly ve druhém sloupci. To se v~tomto
     pøípadì stalo (výjimeènì) samo, tak¾e se zamìøíme na tøetí
     sloupec. Tam pod první jednièkou v druhém øádku vytvoøíme nuly takto:
     minus trojnásobek druhého øádku pøièteme ke tøetímu a dále druhý
     øádek pøièteme ke ètvrtému. První a druhý øádek opisujeme.
  \nl \sim
  \matice{ 2 &-2 &\+1 &  0 &  3 \|&  4 \cr
           0 & 0 &  1 &  1 & -1 \|& -3 \cr
           0 & 0 &  0 & -2 &  4 \|& -2 \cr
           0 & 0 &  0 &  2 & -4 \|&  2} \sim
  \text
     Znovu se pøesuneme na dal¹í sloupec (tentokrát ètvrtý) a
     vytvoøíme nulu pod minus dvojkou ze tøetího øádku. K tomu staèí
     seèíst tøetí øádek se ètvrtým a výsledek napsat na místo
     ètvrtého øádku.
  \nl \sim
  \matice{ 2 &-2 &\+1 &  0 &  3 \|&  4 \cr
           0 & 0 &  1 &  1 & -1 \|& -3 \cr
           0 & 0 &  0 & -2 &  4 \|& -2 \cr
           0 & 0 &  0 &  0 &  0 \|&  0} \sim
  \text
     Tøetí øádek je¹tì (spí¹e pro parádu) vynásobíme èíslem $-1/2$.
     Ètvrtý øádek nemusíme psát, proto¾e tento øádek odpovídá rovnici
     $0x_1+0x_2+0x_3+0x_4+0x_5 = 0$, která je zøejmì splnìna pro
     libovolná $x_1,x_2,x_3,x_4,x_5$.
  \nl \sim
  \matice{ 2 &-2 &\+1 &  0 &  3 \|&  4 \cr
           0 & 0 &  1 &\+1 & -1 \|& -3 \cr
           0 & 0 &  0 &  1 & -2 \|&  1} \hphantom{\sim}
  \text
     Dostáváme tzv. {\em schodovitou\/} matici, která má ve svém \uv{dolním levém koutì}
     nuly. Pøesnìji: ka¾dý dal¹í øádek má zleva aspoò o jednu nulu
     více ne¾ pøede¹lý. To je cílem tzv. {\em pøímého chodu\/} Gaussovy
     eliminaèní metody, který jsme právì ukonèili.%
     \inl[matice: schodovitá, schodovitá matice]%
     \inl[pøímý chod GEM]
  \nl}
$$
Na¹i matici koeficientù pùvodní soustavy jsme pøevedli pomocí Gaussovy
eliminaèní metody na matici odpovídající nové soustavì, která má
stejnou mno¾inu øe¹ení, jako pùvodní. Staèí se proto dále zabývat
touto novou soustavou. Pro názornost si ji zde zapí¹eme
$$
  \soustava{ 2x_1 - 2x_2 + x_3 &       & + 3x_5 = & 4    \cr
                           x_3 & + x_4 & -\1x_5 = & \!-3 \cr
                               &   x_4 & - 2x_5 = & 1 }
$$
Ka¾dá rovnice umo¾ní spoèítat hodnotu jedné neznámé, pokud jsou dány hodnoty
ostatních. Máme tøi rovnice o pìti neznámých, umíme tedy spoèítat jen
tøi neznámé. Pomocí poslední rovnice budeme poèítat napøíklad $x_4$,
pomocí pøedposlední rovnice budeme poèítat $x_3$ a z první rovnice
spoèítáme napøíklad $x_1$. Ostatní neznámé nejsou tìmito rovnicemi
urèeny a mohou nabývat libovolných hodnot. To dáme najevo napøíklad
takto: $x_5=u$, $x_2=v$, $u\in\R$, $v\in\R$. 
Nyní budeme poèítat hodnoty ostatních neznámých
dosazovací metodou, postupujeme od poslední rovnice k první:
$$\def\qimpl{\quad\impl\quad} \def\\{\hfill\cr}
  \soustava{ && x_5 =& u \\ && x_2 =& v \\
             x_4 - 2u =& 1 &\qimpl x_4 =& 1 + 2u \\
             x_3 + (1 + 2u) - u =& \!\!\!-3 &\qimpl x_3 =& {-4} - u \\
             2x_1 - 2v + (-4 - u) + 3u =& 4 &\qimpl x_1 =& 4 - u + v }
$$
Øe¹ení jsme zapsali pomocí dvou parametrù $u,v$, které mohou nabývat
libovolných hodnot. V¹imneme si, ¾e poèet parametrù, kterými popí¹eme
øe¹ení libovolné soustavy lineárních rovnic je roven poètu neznámých
mínus poèet nenulových rovnic, které získáme po pøímém chodu Gaussovy eliminaèní
metody. V na¹em pøípadì: poèet parametrù $= 5 - 3$. Zadaná soustava má
sice ètyøi rovnice, ale po eliminaci se nám soustava redukovala na 
pouhé tøi nenulové rovnice.

Pokud bychom se rozhodli napøíklad z první rovnice poèítat $x_2$, pak
by neznámá $x_1$ mohla nabývat libovolných hodnot a výsledek by byl
formálnì zapsán ponìkud jinak: $x_1=w$, $x_2=-8+2u+2w$, $x_3=-4-u$,
$x_4=1+2u$, $x_5=u$, $u\in\R$, $w\in\R$. Vidíme tedy, ¾e neexistuje 
jednoznaèný zápis výsledku. Oba zápisy popisují stejnou mno¾inu 
øe¹ení, ka¾dý trochu jiným zpùsobem. 

\medskip

\okraj Popis\hb metody | Popis metody

Nyní se pustíme do výkladu Gaussovy eliminaèní metody pro obecnou
soustavu lineárních rovnic. Nejprve vysvìtlíme proceduru, kterou
budeme v této metodì s prvky matice mnohokrát opakovat. Tato
procedura vytvoøí nuly v $s$-tém sloupci pod nenulovým prvkem matice 
v $r$-tém øádku. Názornì:
$$\def\p{\raise1.2pt\hbox{$\scriptstyle\bullet$}}
  \def\|{\kern3pt\strut\vrule}
  \def\Vdots{\hfill\vdots\hfill}\lineskip=0pt 
  \lineskip=0pt\let\normalbaselines=\relax
  \vrule height69pt width 0pt
  \pmatrix{\p& \cdots & \p & 
           \vbox to 0pt{\vss\hbox to0pt{\hss sloupec $s$\hss}
                            \hbox to 0pt{\hss$\downarrow$\hss}\kern10pt}
                 \kern-1.7pt \p & \p & \cdots \|& \p \cr
             & \vdots &    &    &    & \Vdots \|& \p \cr
 \llap{øádek $r\to\quad$ }
           0 & \cdots &  0 &  a & \p & \cdots \|& \p \cr
           0 & \cdots &  0 & b_1& \p & \cdots \|& \p \cr
             & \vdots &    & \vdots& & \Vdots \|&    \cr
           0 & \cdots &  0 & b_k& \p & \cdots \|& \p \cr} \enspace\sim\enspace
  \pmatrix{\p& \cdots & \p & 
           \vbox to 0pt{\vss\hbox to0pt{\hss sloupec $s$\hss}
                            \hbox to 0pt{\hss$\downarrow$\hss}\kern10pt}
                 \kern-1.7pt \p & \p & \cdots \|& \p \cr
             & \vdots &    &    &    & \Vdots \|& \p \cr
           0 & \cdots &  0 &  a & \p & \cdots \|& \p 
 \rlap{ $\quad\leftarrow$ øádek $r$} \cr
           0 & \cdots &  0 &  0 & \p & \cdots \|& \p \cr
             & \vdots &    &\vdots & & \Vdots \|&    \cr
           0 & \cdots &  0 &  0 & \p & \cdots \|& \p \cr}
$$
Teèkami jsou v tomto obrázku vyznaèeny prvky matice, jejich¾ hodnoty
nás momentálnì nezajímají. Prvek $a$ musí být nenulový. Procedura
\uv{vytvoøení nul pod prvkem $a$} se provede takto: 

\medskip
\bb K1. Øádky~1 a¾ $r$ opí¹eme beze zmìny.
\bb K2. K~øádku $r+1$ pøièítáme 
       $(-b_1/a)$~násobek øádku $r$, k
       øádku $r+2$ pøièítáme $(-b_2/a)$~násobek øádku~$r$, atd., 
       a¾ koneènì k øádku poslednímu pøièítáme $(-b_k/a)$~násobek øádku $r$. 
\medskip

Tímto úkonem se neporu¹í nulové prvky ve sloupcích vlevo od sloupce
$s$ a vzniknou nové nuly pod prvkem $a$ ve sloupci $s$.

Nyní popí¹eme pøímý chod Gaussovy eliminaèní metody,
který pøevede libovolnou matici na schodovitou matici, která má 
\uv{v levém dolním rohu} nuly. Matice bude mít v ka¾dém
øádku zleva aspoò o~jednu nulu více v souvislé øadì nul, ne¾
v pøedchozím øádku. V algoritmu se pracuje s promìnnou $r$ oznaèující
aktuální øádek a s~promìnnou $s$, která znamená
sloupec, ve kterém v daném okam¾iku vytváøíme nuly. 
Pokud se v algoritmu zvìt¹uje $r$, a pøitom $r$ ji¾ oznaèuje 
poslední øádek matice, ukonèíme èinnost. Pokud by se mìlo zvìt¹it $s$, a
pøitom $s$ u¾ oznaèuje poslední sloupec matice, ukonèíme èinnost.
V tìchto pøípadech je u¾ matice pøevedena do po¾adovaného tvaru.

\medskip
\bb G1. Nastavíme $r=1$, $s=1$.
\bb G2. Nech» $a$ je prvek matice z $s$-tého sloupce a $r$-tého øádku.
       Pokud je $a=0$ a v¹echny prvky pod prvkem $a$ v $s$-tém
       sloupci jsou také nulové,
       zvìt¹íme $s$ o jednièku a opakujeme krok G2.
\bb G3. Je-li $a=0$, a pøitom existuje nenulový prvek pod prvkem
       $a$ v $s$-tém sloupci na øádku $r_1$, prohodíme øádek $r$ s
       øádkem $r_1$. Od této chvíle je v~nové matici prvek na $r$-tém 
       øádku a $s$-tém sloupci nenulový.
\bb G4. Vytvoøíme nuly pod nenulovým prvkem $a$ z~$r$-tého øádku a 
       $s$-tého sloupce
       zpùsobem, popsaným v~krocích K1 a K2.  
\bb G5. Existují-li v matici øádky celé nulové, z matice je odstraníme. 
\bb G6. Zvìt¹íme $r$ o jednièku a $s$ o jednièku a celou èinnost
       opakujeme od kroku~G2 znova.
\par\penalty-200
\medskip 

Pøi eliminaèní metodì jsme pøevedli matici koeficientù soustavy na
jinou matici odpovídající jiné soustavì, ale se stejnou 
mno¾inou øe¹ení, proto¾e pøi úpravách jsme pou¾ili jen tyto
elementární kroky:

\medskip
\bb (1) Prohození øádkù matice.
\bb (2) Pronásobení øádku nenulovou konstantou.
\bb (3) Pøiètení násobku øádku k jinému.
\bb (4) Odstranìní nulového øádku.
\medskip

\okraj Diskuse po pøevedení matice | Diskuse po prevedeni matice

Ji¾ døíve jsme vysvìtlili, ¾e tím dostáváme modifikovanou matici
odpovídající nové soustavì se stejnou mno¾inou øe¹ení. Staèí se tedy
zamìøit na tuto novou soustavu.
Nejprve rozhodneme, zda soustava má vùbec nìjaké øe¹ení. 
Pokud je poslední øádek ve tvaru:
$$
   (0\quad 0\quad\cdots\quad 0 \enspace|\enspace c), \quad c\not=0
$$
soustava nemá øe¹ení. Tento øádek toti¾ odpovídá rovnici
$$
   0x_1 + 0x_2 + \cdots + 0x_n = c, \quad c\not=0,
$$
kterou nelze splnit pro ¾ádná $x_1, x_2, \ldots, x_n$.

Pokud poslední øádek obsahuje nenulový prvek mezi koeficienty
soustavy (vlevo od svislé èáry), soustava má øe¹ení. V takovém pøípadì
mù¾eme øíci, kolik tìch øe¹ení bude:
pokud má soustava (po úpravì eliminaèní metodou) stejný poèet rovnic,
jako neznámých, má jediné øe¹ení. Je-li poèet rovnic men¹í, ne¾ poèet
neznámých, je øe¹ení nekoneènì mnoho. 

Poèet rovnic po eliminaci nemù¾e nikdy
pøesáhnout poèet neznámých, vylouèíme-li pøípad øádku
$(0\;\cdots\;0\;|\;c)$, $c\not=0$. Rozmyslete si, proè.
Zadaná soustava mù¾e mít podstatnì více rovnic ne¾ neznámých, ale po
eliminaci se v takovém pøípadì zákonitì poèet rovnic zmen¹í.

Má-li soustava øe¹ení, pak pro ka¾dou rovnici rozhodneme, kterou
neznámou budeme pou¾itím této rovnice poèítat (v dané rovnici musí
být tato neznámá násobena nenulovým koeficientem). 
V~ka¾dé rovnici je nejprve zleva skupina 
nulových koeficientù a pak existuje nìjaký první nenulový
koeficient. Doporuèujeme poèítat tu neznámou, 
která je násobena tímto prvním nenulovým koeficientem. 
Neznámé, které nebudeme poèítat pomocí ¾ádné rovnice, 
mohou nabývat libovolných
hodnot. Takové neznámé dále pova¾ujeme za parametry. Pro poèet
parametrù tedy platí:
$$
  \hbox{poèet parametrù} = \hbox{poèet neznámých celkem} - 
  \hbox{poèet rovnic po eliminaci}
$$
Spoèítáme nejprve neznámou z poslední rovnice a výsledek 
dosadíme do ostatních rovnic. Pak spoèítáme dal¹í neznámou 
z pøedposlední rovnice atd. a¾ se dostaneme k první rovnici.
Tím máme vyjádøena v¹echna øe¹ení dané soustavy lineárních rovnic.  

\okraj Pøíklad, kdy soustava nemá øe¹ení | Priklad, kdy soustava nema reseni

\medskip\noindent{\bf Pøíklad.}
Gaussovou eliminaèní metodou budeme øe¹it následující soustavu ètyø
rovnic o ètyøech neznámých $\alpha, \beta, \gamma, \delta$.
$$
  \soustava {  \alpha &+ 2\beta +&  3\gamma &+\1\delta =& 1 \cr
              2\alpha &+ 4\beta +&  7\gamma &+ 7\delta =& 4 \cr
               \alpha &         +&  2\gamma &          =& \!\! -2 \cr
              3\alpha &+ 7\beta +& 10\gamma &+ 6\delta =& 7}
$$
Zapí¹eme koeficienty soustavy a hodnoty pravých stran do matice a
zaèneme tuto matici eliminovat zpùsobem popsaným vý¹e.
$$
  \def\+{\kern6pt}\def\|{\kern6pt\strut\vrule\kern2pt}\jot=0pt
\displaylines{
  \matice {1 &\+2 &\+3 &\+1 \|&  1 \cr
           2 & 4 & 7 & 7 \|&  4 \cr
           1 & 0 & 2 & 0 \|& -2 \cr
           3 & 7 &10 & 6 \|&  7} \buildrel (1)\over \sim
  \matice {1 & 2 & 3 & 1 \|&  1 \cr
           0 & 0 & 1 & 5 \|&  2 \cr
           0 &-2 &-1 &-1 \|& -3 \cr
           0 & 1 & 1 & 3 \|&  4} \buildrel (2)\over \sim
  \matice {1 & 2 & 3 & 1 \|&  1 \cr
           0 & 1 & 1 & 3 \|&  4 \cr
           0 &-2 &-1 &-1 \|& -3 \cr
           0 & 0 & 1 & 5 \|&  2} \buildrel (3)\over\sim \cr
                                 \noalign{\medskip} \sim
  \matice {1 & \+2 & \+3 & \+1 \|&  1 \cr
           0 & 1 & 1 & 3 \|&  4 \cr
           0 & 0 & 1 & 5 \|&  5 \cr
           0 & 0 & 1 & 5 \|&  2} \buildrel (4)\over \sim
  \matice {1 & \+2 & \+3 & \+1 \|&  1 \cr
           0 & 1 & 1 & 3 \|&  4 \cr
           0 & 0 & 1 & 5 \|&  5 \cr
           0 & 0 & 0 & 0 \|&  3}}
$$
V úpravì (1) jsme vytvoøili nuly pod jednièkou z prvního sloupce a
prvního øádku. V úpravì (2) jsme pøehodili druhý øádek se ètvrtým 
v souladu s krokem G3 na¹eho algoritmu (na druhém øádku a druhém
sloupci toti¾ byl nulový prvek). V úpravì (3) jsme vytvoøili nuly pod
jednièkou z druhého øádku v druhém sloupci. V poslední úpravì (4) jsme
vytvoøili nulu pod jednièkou v tøetím sloupci z tøetího øádku. Tím
máme matici v po¾adovaném tvaru. Pohledem na poslední øádek okam¾itì
vidíme, ¾e soustava nemá øe¹ení.

\ipagefalse


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\kapitola Lineární prostor | Linearni prostor
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\pozn[dvd] {\it O~formì definice-vìta-dùkaz.}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
V~tomto textu narazíte na tøi základní \uv{slohové útvary}: definice,
vìta a dùkaz. Vesmìs ka¾dé solidní matematické sdìlení pou¾ívá tyto
pojmy. Pøitom je mo¾né, ¾e s~takto systematickým pou¾itím pojmù
definice, vìta, dùkaz se setkáváte poprvé. Proto si tyto pojmy
vysvìtlíme.


\okraj Definice | Co je definice

{\em Definice} vysvìtluje (definuje) nový pojem, který bude dále
v~teorii pou¾íván. Definice se opírá o~pojmy, které byly definovány
v~pøedchozích definicích.  V~pøísnì exaktních teoriích bychom museli na
zaèátku vyjmenovat pojmy, které nedefinujeme, ale budeme s~nimi
pracovat, proto¾e jinak bychom nebyli schopni zapsat první definici.
V~tomto textu nebudeme takto pøísnì exaktní a budeme se opírat o~mateøský
jazyk a o~pojmy známé ze støední ¹koly (pøedpokládáme, ¾e jsou známé 
pojmy mno¾ina, reálné èíslo apod.). Novì definovaný pojem bude 
v~definici vyznaèen kurzívou.
\inl[definice]

\okraj Vìta | Co je veta

{\em Vìta} je tvrzení, které nám sdìluje nìjakou vlastnost týkající se
definovaných pojmù. Dosti èasto se vìta dá formálnì rozèlenit na
pøedpoklady a vlastní tvrzení. Pøedpoklady bývají uvozeny slovy
\uv{nech»}, \uv{budi¾}, \uv{jestli¾e}, \uv{pøedpokládejme} atd. 
Vlastní tvrzení obvykle zaèíná slovem \uv{pak} nebo \uv{potom}. Vìta
se musí dokázat. Proto se hned za vìtu pøipojuje dal¹í slohový útvar:
dùkaz. Po dokázání vìty se v~následujícím textu dá vìta {\it
pou¾ít}. To bývá obvykle provedeno tak, ¾e se ovìøí v~daném kontextu
platnost pøedpokladù vìty a na základì toho se prohlásí, ¾e platí
vlastní tvrzení vìty.
\inl[vìta]

\okraj Dùkaz | Co je dukaz

{\em Dùkaz} je obhajoba platnosti vìty. Pøi této obhajobì mù¾eme
pou¾ít pøedchozí definice (zamìníme pou¾itý pojem ve vìtì skupinou
pojmù, kterými je pojem definován) a dále mù¾eme pou¾ít døíve dokázané
vìty (ovìøíme pøedpoklady døíve dokázané vìty a pou¾ijeme pak její
vlastní tvrzení). Dále se v~dùkazech pou¾ívá logických obratù, které
byste mìli znát ze støední ¹koly (napøíklad výrok \uv{není pravda, ¾e
existuje prvek, pro který platí tvrzení~$A$} lze pøeformulovat na toto¾ný
výrok: \uv{pro v¹echny prvky neplatí tvrzení~$A$}).
\inl[dùkaz]

V~exaktních teoriích se ke skupinì nedefinovaných pojmù na
zaèátku teorie pøipojuje i nìkolik tvrzení, která nelze prostøedky
teorie dokázat, ale pro dùkazy dal¹ích vìt je nutné jejich platnost
pøedpokládat. Takovým tvrzením se øíká axiomy. V~na¹em textu nebudeme
teorii stavìt jen na axiomech, ale nìkdy pou¾ijeme spí¹e intuitivní
pøístup. Není nutné být za ka¾dou cenu pøísnì exaktní.

Pro matematické sdìlení nových poznatkù je obvykle èlenìní textu
na definice, vìty a dùkazy dostaèující. V~této uèebnici si navíc budeme
ilustrovat novou problematiku na {\em pøíkladech} a obèas prohodíme
nìjakou {\em poznámku}. Dokladem toho je i tato poznámka\cite[dvd].
\inl[pøíklad, poznámka, axiomy]

\pozn
%%%%%
V~následující definici lineárního prostoru\cite[dlp]
se pracuje
s~mno¾inami blí¾e nespecifikovaných objektù. Jediné, co s~tìmi objekty
umíme dìlat, je vzájemnì objekty sèítat a násobit objekt reálným
èíslem. Pøitom tyto operace (sèítání a násobení reálným èíslem) je
potøeba pro konkrétní mno¾iny objektù definovat. Pro ka¾dou mno¾inu
objektù mohou tyto operace vypadat jinak. Skuteènost, ¾e není øeèeno,
jak objekty a operace s~nimi konkrétnì vypadají, mù¾e být pro nìkteré
ètenáøe ponìkud frustrující. Proto pøed definicí uvedeme pøíklady
mno¾in objektù, které lze sèítat a násobit konstantou.

\priklad [dvojice]
%%%%%%%%%%%%%%%%%%
Nech» $\R^2$ je mno¾ina v¹ech uspoøádaných dvojic reálných èísel.
Uspoøádanou dvojici zapisujeme ve tvaru $(a,b)$. 
Vyznaèujeme ji tedy kulatou závorkou a
její slo¾ky $a,b$ pí¹eme oddìleny èárkou. Tak¾e
$\R^2 = \{(a,b);\, a\in\nobreak\R,\penalty0 b\in\nobreak\R\}$. 
Symbol $\R$ znaèí reálná èísla a zápisem
$\{X;\, \hbox{vlastnost $X$}\}$ znaèíme mno¾inu objektù $X$,
které mají specifikovanou vlastnost. 
Definujme sèítání dvou uspoøádaných dvojic:
$$
  (a, b) \oplus (c, d) \df= (a+c, b+d) \rce(plusdvojice)
$$
a násobení uspoøádané dvojice reálným èíslem $\alpha\in\R$: 
$$
  \alpha\odot(a, b) \df= (\alpha\,a, \alpha\,b).\rce(kratdvojice)
$$ 

V¹imneme si, ¾e jsme definovali operaci $\oplus$ sèítání objektù tak,
¾e výsledek sèítání je zase uspoøádaná dvojice. Stejnì souèin $\odot$
reálného èísla s~uspoøádanou dvojicí je zase uspoøádaná dvojice, tedy
prvek mno¾iny $\R^2$. Na¹e sèítání je tedy operace, do které vstupují
dva prvky mno¾iny $\R^2$ a vystupuje z~ní prvek mno¾iny $\R^2$. Na¹e
násobení je operace, do které vstupuje reálné èíslo a prvek z~$\R^2$ a
vystupuje z~ní prvek z~$\R^2$. Tuto skuteènost zapí¹eme pomocí
kartézského souèinu mno¾in: 
$$\oplus: \R^2\times\R^2 \to \R^2, \qquad  
  \odot: \R\times\R^2 \to \R^2 . \rce(pluskratdomena)
$$
\par\inl[dvojice: uspoøádaná, uspoøádaná: dvojice]
\inl[0times, 0to]

V¹imneme si dále, ¾e jsme definovali nové operace $\oplus$ a $\odot$
prostøednictvím operací sèítání a násobení reálných èísel,
tj. prostøednicvím operací, jejich¾ vlastnosti jsou známy ze støední
¹koly. Pøíkladem takové vlastnosti je komutativní zákon (pro
reálná èísla $x$ a $y$ platí: $x+y = y+x$). Na¹e novì definovaná operace
$\oplus$ má také tuto vlastnost: 
$$
  (a, b) \oplus (c, d) = (c, d) \oplus (a, b), 
$$
proto¾e podle definice je $(a, b) \oplus (c, d) = (a+c, b+d)$ a
$(c, d) \oplus (a, b) = (c+a, d+b)$, ov¹em dvì uspoøádané dvojice se
rovnají, pokud se rovnají odpovídající slo¾ky. V~tomto pøípadì první
slo¾ka první dvojice $a+b$ se rovná první slo¾ce druhé dvojice $b+a$,
nebo» pro sèítání reálných èísel platí komutativní zákon. Podobnì
ovìøíme i druhou slo¾ku.

Uvìdomíme si, ¾e není vùbec automaticky zaruèeno, ¾e novì definované
operace musejí tyto zákony splòovat. Pokud bychom napøíklad definovali
jiné sèítání dvou uspoøádaných dvojic pøedpisem:
$$
  (a, b) \mathbin{\underline\oplus} (c, d) \df= (2a + d, b + c),
  \rce(plusdvojicejinak)
$$
pak se dá snadno ukázat, ¾e pro $\underline\oplus$ není splnìn
komutativní zákon (ovìøte si sami).

\priklad [polynomy]
%%%%%%%%%%%%%%%%%%%
Oznaème $P$ mno¾inu v¹ech reálných polynomù, tedy funkcí $p: \R\to\R$,
které pro $x\in\R$ mají hodnotu danou vzorcem:
$$ 
  p(x) = a_n x^n + a_{n-1} x^{n-1} + \cdots+ a_1 x + a_0, \quad
  (a_n, a_{n-1},\ldots, a_1, a_0 \hbox{ jsou nìjaká reálná èísla}).
  \rce(polynom)
$$
Na této mno¾inì polynomù definujeme sèítání $\oplus: P\times P \to P$
a násobení $\odot: \R\times P \to P$ takto: pro ka¾dé $p\in P$,
$q\in P$, $\alpha\in\R$ je 
$$\eqalign{
      (p\oplus q) (x) &\df= p(x) + q(x) \qquad \forall x\in\R, \cr
  (\alpha\odot p) (x) &\df= \alpha\, p(x) \qquad \forall x\in\R. \cr }
$$
Øeèeno peèlivìji: v~definici jsme zavedli novou funkci $p\oplus q: \R\to\R$
tak, ¾e jsme øekli, jakou bude tato funkce mít hodnotu v~ka¾dém bodì
$x$ jejího definièního oboru. Tuto hodnotu podle definice poèítáme
jako souèet hodnoty funkce $p$ a hodnoty funkce $q$ v~bodì $x$. Tyto
hodnoty jsou reálná èísla, tak¾e sèítání funkcí (nové sèítání nových
objektù) vlastnì definujeme pomocí sèítání reálných èísel (sèítání,
které známe ze støední ¹koly). Podobnì definujeme násobek funkce
reálným èíslem.
\inl[polynom, sèítání: polynomù, násobek: polynomu]

Dá se ovìøit, ¾e pro $p\in P$, $q\in P$, $\alpha\in\R$ je $p\oplus q$
zase polynom a $\alpha\odot p$ je také polynom. Rovnì¾ se dá ovìøit, ¾e
pro operaci $\oplus$ platí komutativní zákon.

\pozn[pretezovani]
%%%%%%%%%%%%%%%%%%
V~pøedchozích dvou pøíkladech jsme definovali na mno¾inì nìjakých
objektù sèítání a násobení reálným èíslem. Pro vìt¹í pøehlednost jsme
novì definované operace zapisovali do krou¾ku, abychom je odli¹ili od
operací sèítání a násobení reálných èísel. To ale není
potøeba. Staèí pou¾ívat tyté¾ znaky, proto¾e podle typu objektù, které
do operace vstupují, okam¾itì poznáme, jakou operaci máme pou¾ít (zda
novì definovanou nebo známou operaci na reálných èíslech). Takové
automatické pøizpùsobení operace podle typu operandù znají
programátoøi objektovì orientovaných jazykù. Tam se tomu øíká
\uv{pøetì¾ování operátorù}.
\inl[pøetì¾ování operátorù]

Definici sèítání uspoøádaných dvojic tedy staèí zapsat takto: 
Pro v¹echna $(a,b)\in\R^2, (c,d)\in\R^2$ je 
$(a, b) + (c, d) \df= (a+c, b+d)$. Pøitom poznáme, ¾e první znak
\uv{$+$} v~uvedeném vzorci oznaèuje sèítání uspoøádaných dvojic a 
ostatní dva znaky~\uv{$+$} znamenají sèítání reálných èísel.
{\lineskiplimit=-10pt \par}

V~dal¹ím textu budeme skoro v¾dy pou¾ívat znaky \uv{$+$} a
\uv{$\cdot$} i pro novì definované operace, proto¾e podle typu
operandù nemù¾e dojít k~nedorozumìní. Také znak násobení 
\uv{$\cdot$} budeme nìkdy vynechávat, jako jsme zvyklí jej vynechávat
pøi zápisu násobení reálných èísel.

\okraj Definice\hb lineárního prostoru | Definice linearniho prostoru

\definice* [dlp]
%%%%%%%%%%%%%%
{\em Lineárním prostorem} nazýváme ka¾dou neprázdnou mno¾inu $L$, 
na které je definováno sèítání  $+: L\times L \to L$ a násobení
reálným  èíslem $\cdot: \R\times L \to L$ a tyto operace splòují pro ka¾dé 
$\vec x\in L, \vec y\in L, \vec z\in L, \alpha\in\R, \beta\in\R$ vlastnosti:
$$\null\indent\vcenter{\openup\jot
  \ialign{\strut$#$&\quad$\displaystyle{#}$\hfil&\quad#\unskip\hfil\cr
  (1)  &  \vec x + \vec y = \vec y + \vec x  & (komutativní zákon sèítání), \cr
  (2)  &  (\vec x + \vec y) + \vec z = \vec x + (\vec y + \vec z) 
                     & (asociativní zákon sèítání), \cr
  (3)  &  \alpha\cdot(\beta\cdot\vec x) = (\alpha\beta)\cdot\vec x
                     & (asociativní zákon násobení), \cr
  (4)  &  \alpha\cdot(\vec x + \vec y) = \alpha\cdot\vec x + \alpha\cdot\vec y
             & (distributivní \ifkindle{zák.}\else{zákon}\fi pro sèítání \ifkindle{vektorù}\else{prvkù z $L$}\fi), \cr
  (5)  &  (\alpha+\beta)\cdot\vec x = \alpha\cdot\vec x + \beta\cdot\vec x
             & (distributivní zákon pro sèítání èísel), \cr 
  (6)  &  1 \cdot\vec x = \vec x     & (vlastnost reálného èísla 1), \cr 
  (7)  &  \hbox{existuje $\vec o\in L$, ¾e pro ka¾dé $\vec x\in L$ je }
              0\cdot\vec x = \vec o
                            & (existence nulového prvku). \cr 
}}
$$
Prvky lineárního prostoru nazýváme {\em vektory}. Reálnému èíslu
v~kontextu násobení $\cdot: \R\times L \to L$ øíkáme {\em skalár}.
Prvku $\vec o\in L$ z~vlastnosti (7) øíkáme {\em nulový prvek} nebo 
{\em nulový vektor}. 
\inl[prostor: lineární, lineární: prostor] 
\inl[axiomy: lineárního prostoru]
\inl[vektor: nulový, nulový: vektor, prvek: nulový, nulový: prvek]
\inl[zákon: asociativní, asociativní: zákon]
\inl[zákon: komutativní, komutativní: zákon]
\inl[zákon: distributivní, distributivní: zákon]
\inl[vektor, skalár]

\veta [nulprvek]
%%%%%%%%%%%%%%%%
Pro nulový prvek $\vec o$ lineárního prostoru $L$ platí vlastnosti:
$$\eqalign{
\bod (1) \vec x + \vec o = \vec x   \qquad \forall\, \vec x \in L, \cr
\bod (2) \alpha\cdot\vec o = \vec o \qquad \forall\, \alpha\in\R, \cr
\bod (3) \hbox{Nech» $\vec x\in L$}. \quad
         \hbox{Je-li}\quad \alpha\cdot\vec x = \vec o
         \quad\hbox{a}\quad \alpha\ne0, \quad
         \hbox{pak}\quad \vec x = \vec o. \cr}
$$

\dukaz
Pou¾ijeme vlastnosti z~definice\cite[dlp]. Pro pøehlednost pí¹eme nad
rovnítka èíslo pou¾ité vlastnosti.
$$\eqalign{
\bod (1)  \vec x + \vec o \buildrel(7)\over= \vec x + 0\cdot\vec x
     \buildrel(6)\over= 1\cdot\vec x +  0\cdot\vec x
     \buildrel(5)\over= (1 + 0) \cdot\vec x = 1 \cdot\vec x 
     \buildrel(6)\over= \vec x. \cr
\bod (2) \alpha\cdot\vec o \buildrel(7)\over= 
     \alpha\cdot(0\cdot\vec x)
     \buildrel(3)\over= (\alpha\cdot0)\cdot\vec x = 0\cdot\vec x
     \buildrel(7)\over= \vec o. \cr
\bod (3) \vec x \buildrel(6)\over= 1 \cdot \vec x =
     \left({1\over\alpha}\,\alpha\right)\cdot \vec x \buildrel(3)\over=
     {1\over\alpha}\cdot(\alpha\cdot\vec x) 
     \buildrel\rm(z~pøedpokladu)\over= {1\over\alpha}\cdot \vec o
     \buildrel\hbox{\the\scriptfont0(vlastnost~(2)~vìty\cite[nulprvek])}
     \over= \vec o.
     \cr}
$$

\poznamka
%%%%%%%%%
Ve vlastnostech (1) a¾ (7) v~definici\cite[dlp] se pracuje se znaky
\uv{$+$} a \uv{$\cdot$} v~souladu s~poznámkou\cite[pretezovani] 
ve dvojím významu. Buï to jsou operace s~prvky mno¾iny $L$ nebo operace
s~reálnými èísly. Napøíklad ve vlastnosti (5) je první symbol \uv{$+$}
pou¾it ve významu sèítání na mno¾inì reálných èísel, zatímco druhý
symbol \uv{$+$} je pou¾it ve významu sèítání na mno¾inì $L$. Jako cvièení
zkuste o~ka¾dé pou¾ité operaci ve vzorcích (1) a¾ (7) rozhodnout,
jakého je druhu.

\poznamka
%%%%%%%%%
Proto¾e lineární prostor obsahuje vektory, v literatuøe se èasto
setkáváme s pojmem {\em vektorový prostor}, který je pou¾it v naprosto
stejném smyslu, jako zde pou¾íváme pojem {\em lineární prostor}.
Je tøeba si uvìdomit, ¾e {\em vektory} v tomto pojetí nejsou
jen \uv{¹ipky}, ale jakékoli matematické objekty, které umíme mezi
sebou sèítat a násobit skalárem tak, ¾e tyto operace splòují {\em axiomy
linearity}~(1) a¾~(7) z definice\cite[dlp]. Následující pøíklady ukazují, ¾e lze
v~matematice najít skuteènì rozlièné pøípady lineárních (vektorových)
prostorù.  
\inl[prostor: vektorový, vektorový prostor]
\inl[axiomy: linearity]

\okraj Prostor $\R^2$ | Prostor R2

\priklad [LPdvojice]
%%%%%%%%%%%%%%%%%%%%
Uká¾eme, ¾e mno¾ina $\R^2$ z~pøíkladu\cite[dvojice] se sèítáním a
násobením skalárem podle definic\cite(plusdvojice) a\cite(kratdvojice)
tvoøí lineární prostor. Místo znakù \uv{$\oplus$} a \uv{$\odot$}
budeme nadále pou¾ívat znaky\uv{$+$}~a~\uv{$\cdot$}.
\inl[dvojice: uspoøádaná, uspoøádaná: dvojice]
\inl[prostor: R2, R2]

Nejprve je tøeba zjistit, zda operace \uv{$+$}~a~\uv{$\cdot$} jsou skuteènì
definovány zpùsobem, jak po¾aduje definice\cite[dlp], 
tj.~zda platí $+: \R^2\times\R^2 \to \R^2$ a $\cdot: \R\times\R^2 \to \R^2$.
To jsme ale u¾ ovìøili døíve, viz\cite(pluskratdomena).

Dále zjistíme platnost vlastností (1) a¾ (7) z~definice\cite[dlp].
Vlastnost (1) jsme podrobnì ovìøovali v~pøíkladu\cite[dvojice].
Pokraèujeme tedy vlastností (2). Pro ka¾dé $a,b,c,d,e,f\in\R$ platí:
$$\eqalign{
  \bigl( (a, b) + (c, d)\bigr) + (e, f) &=
  (a+c, b+d) + (e, f) = \bigl((a+c)+e, (b+d)+f\bigr) = \cr
  &=  \bigl(a+(c+e), b+(d+f)\bigr) = (a, b) + (c+e, d+f) = \breakeqonkindle
  (a, b) + \bigl( (c,d) + (e,f) \bigr). \cr}
$$
Pøi úpravách jsme nejprve dvakrát pou¾ili definici\cite(plusdvojice),
pak jsme v~jednotlivých slo¾kách vyu¾ili toho, ¾e pro sèítání reálných
èísel platí asociativní zákon a koneènì jsme zase dvakrát pou¾ili
definici\cite(plusdvojice). Nyní doká¾eme dal¹í vlastnosti. Pro ka¾dé 
$a,b,c,d,\alpha,\beta\in\R$ platí:
$$\eqalign{
\bod (3) \alpha\cdot\bigl(\beta\cdot(a,b)\bigr) = 
      \alpha\cdot\bigl(\beta\,a,\beta\,b\bigr) =
      \bigl(\alpha\,(\beta\,a), \alpha\,(\beta\,b)\bigr) =
      \bigl((\alpha\,\beta)\,a, (\alpha\,\beta)\,b\bigr) =
      (\alpha\,\beta)\,(a,b), \cr
\bod (4) \alpha\cdot\bigl((a,b) + (c,d)\bigr) =
      \alpha\cdot (a+c, b+d) = 
      \bigl(\alpha\,(a+c), \alpha\,(b+d)\bigr) =
      (\alpha\,a+\alpha\,c, \alpha\,b+\alpha\,d) = \cr &\odsun=
      (\alpha\,a, \alpha\,b) + (\alpha\,c, \alpha\,d) =
      \alpha\,(a,b) + \alpha\,(c,d), \cr
\bod (5) (\alpha+\beta)\cdot(a,b) = 
     \bigl((\alpha+\beta)\,a, (\alpha+\beta)\, b\bigr) =
     (\alpha\,a + \beta\,a, \alpha\,b + \beta\,b) =
     (\alpha\,a, \alpha\,b) + (\beta\,a, \beta\,b) =\cr &\odsun=
     \alpha\,(a, b) + \beta\,(a, b), \cr
\bod (6) 1\cdot(a,b) = (1\,a, 1\,b) = (a, b), \cr
\bod (7) \hbox{dvojice $(0, 0)$ splòuje: } (0, 0) = 0 \cdot (a, b),
     \hbox{proto¾e } 0 \cdot (a, b) = (0\,a, 0\,b) = (0, 0).
\cr}
$$
Pou¾ili jsme nejprve definice\cite(plusdvojice)
a\cite(kratdvojice), pak jsme vyu¾ili vlastnosti reálných èísel
v~jednotlivých slo¾kách dvojice. Nakonec jsme znovu pou¾ili
definice\cite(plusdvojice) a\cite(kratdvojice).   

Vidíme, ¾e nulovým vektorem lineárního prostoru $\R^2$ je dvojice
$(0,0)$. Podle konvence ze závìru definice\cite[dlp] jsme oprávnìni uspoøádaným
dvojicím se sèítáním a násobením podle definic\cite(plusdvojice) 
a\cite(kratdvojice) øíkat vektory.

\priklad
%%%%%%%%
Mno¾ina $\R^2$ se sèítáním $\underline\oplus$ podle 
definice\cite(plusdvojicejinak) a násobením $\odot$
podle\cite(kratdvojice) netvoøí lineární prostor. Není toti¾ splnìna
napøíklad vlastnost (1) z~definice\cite[dlp].

\okraj Prostor $\R^n$ | Prostor Rn

\priklad* [LPRn]
%%%%%%%%%%%%%%%
Znakem $\R^n$ oznaèíme mno¾inu v¹ech uspoøádaných $n$-tic reálných
èísel, ($n$ je nìjaké pøirozené èíslo, $n\geq1$). Jinými slovy:
$$\R^n=\{(a_1,a_2,\ldots,a_n); \,a_1\in\R,\,a_2\in\R,\ldots,\,a_n\in\R\}.$$
Definujme $+: \R^n\times\R^n \to \R^n$, $\cdot: \R\times\R^n \to
\R^n$ takto: pro ka¾dé $(a_1,\ldots,a_n)\in\R^n$,
$(b_1,\ldots,b_n)\in\R^n$, $\alpha\in\R$ je
$$\eqalign{
(a_1,\ldots,a_n) + (b_1,\ldots,b_n) &\df= (a_1+b_1,\ldots,a_n+b_n),\cr
\alpha\cdot (a_1,\ldots,a_n) &\df= (\alpha\,a_1,\ldots,\alpha\,a_n).\cr}
$$
Mno¾ina $\R^n$ s~takto definovanými operacemi tvoøí lineární prostor.
\inl[prostor: R9n, R9n]

Dùkaz bychom provedli analogicky jako v~pøíkladu\cite[LPdvojice],
ale pro úsporu místa to ji¾ nebudeme opakovat. Vidíme tedy, ¾e
uspoøádané $n$-tice s~takto definovaným sèítáním a násobením skalárem
mù¾eme nazývat vektory. Speciálnì v pøípadì uspoøádaných $n$-tic
mluvíme o {\em aritmetických vektorech}. Èíslo $a_i$ 
nazýváme {\em $i$-tou slo¾kou vektoru\/} $\vec a=(a_1,a_2,\ldots,a_n)$.
\inl[vektor: aritmetický, aritmetický: vektor, slo¾ka: vektoru]

\priklad [LPR]
%%%%%%%%
Mno¾ina $\R$ s~obvyklým sèítáním reálných èísel a násobením reálného
èísla reálným èíslem tvoøí lineární prostor. To je zøejmé. Sèítání a
násobení reálných èísel toti¾ splòuje vlastnosti (1) a¾ (7)
z~definice\cite[dlp]. Tento poznatek si jistì pøiná¹íte ze støední ¹koly.
V~tomto textu jsme jej u¾ pou¾ili, kdy¾ jsme ovìøovali, ¾e $\R^2$ nebo $\R^n$ 
je lineární prostor.
\inl[prostor: R, R]

Nulovým prvkem lineárního prostoru $\R$ je èíslo~$0$. V~kontextu
sèítání a násobení mù¾eme tedy øíkat reálným èíslùm vektory, ale obvykle to
nedìláme.

\okraj Prostor orientovaných úseèek | Prostor orientovanych usecek

\priklad [lpvv]
%%%%%%%%%%%%%%%
Zvolme jeden bod v~prostoru, který nás obklopuje, a oznaème jej
písmenem $O$. Udìláme to tøeba tak, ¾e nakreslíme na papír køí¾ek a
prohlásíme jej za bod $O$. Uva¾ujme v¹echny
orientované úseèky, které zaèínají v~bodì $O$ a konèí v~nìjakém jiném
bodì v~prostoru. Pøidejme k~tomu \uv{degenerovanou} úseèku, která zaèíná i konèí
v~bodì $O$ a oznaème mno¾inu v¹ech tìchto úseèek znakem~$U_O$.
\inl[prostor: UO, prostor: orientovaných úseèek]

Definujme nyní sèítání $+: U_O \times U_O \to U_O$ ryze konstruktivnì
takto: Úseèky $\vec u\in U_O$, $\vec v\in U_O$ doplníme na rovnobì¾ník.
Úhlopøíèku, která zaèíná v~bodì $O$ a konèí v~protìj¹ím bodì
rovnobì¾níka, prohlásíme za souèet úseèek $\vec u$ a $\vec v$, tedy
$\vec u + \vec v$. Dále definujme násobení skalárem $\cdot: \R\times
U_O \to U_O$ takto: Úseèkou $\vec u$ prolo¾íme pøímku, na kterou
nekreslíme èíselnou osu s nulou v bodì $O$ a jednièkou v~koncovém bodì
úseèky $\vec u$. Na ose najdeme bod (èíslo) $\alpha$. Úseèka, která konèí 
v tomto bodì je vektor $\alpha\cdot\vec u$. Je-li $\vec u$ degenerovaná
úseèka konèící v~bodì~$O$, pak $\alpha\cdot\vec u$ definujeme jako stejnou
degenerovanou úseèku konèící v~bodì~$O$.

Mno¾ina $U_O$ s~takto konstruktivnì definovaným sèítáním a násobením
reálným èíslem tvoøí lineární prostor. Je zøejmé, ¾e souèet
orientovaných úseèek je orientovaná úseèka a $\alpha$ násobek
orientované úseèky je orientovaná úseèka. Je¹tì ovìøíme
vlastnosti (1) a¾ (7) z~definice\cite[dlp].  (1)~$\vec
u+\vec v = \vec v+\vec u$, proto¾e v~obou pøípadech doplòujeme na
stejný rovnobì¾ník.  (2)~$(\vec u+\vec v) + \vec w = \vec u + (\vec v +
\vec w)$, proto¾e postupné doplnìní úhlopøíèky rovnobì¾níku $\vec u,
\vec v$ a úseèky $\vec w$ na rovnobì¾ník vede ke stejnému výsledku,
jako kdy¾ nejprve sestavíme úhlopøíèku rovnobì¾níku $\vec v, \vec w$ a
tu doplníme na rovnobì¾ník s~úseèkou $\vec u$ (udìlejte si náètrek).
Výsledný souèet je tìlesová úhlopøíèka rovnobì¾nostìnu, který je
vymezen úseèkami $\vec u$, $\vec v$ a $\vec w$.
(3)~$\alpha\cdot(\beta \vec u) = (\alpha\,\beta)\cdot \vec u$, proto¾e
na levé stranì rovnosti se pracuje s mìøítkem, které je $\beta$krát
vìt¹í ne¾ pùvodní mìøítko. Na pùvodním mìøítku se hledá bod
$\alpha\beta$ a na $\beta$krát vìt¹ím mìøítku se hledá bod $\alpha$. 
(4)~$\alpha\cdot(\vec u+\vec v) = \alpha\cdot\vec u + \alpha\cdot\vec v$, 
proto¾e pøíslu¹né rovnobì¾níky pro sèítání jsou podobné a druhý je
$\alpha$~krát vìt¹í ne¾ první. Proto té¾ jeho úhlopøíèka bude
$\alpha$~krát vìt¹í. 
(5)~$(\alpha+\beta)\cdot\vec u = \alpha\cdot\vec u + \beta\cdot\vec u$,
proto¾e seètení vektorù $\alpha\cdot\vec u + \beta\cdot\vec u$ probíhá
v~\uv{degenerovaném} rovnobì¾níku, který se celý vejde do pøímky. Na
ní se sèítají úseèky o velikostech $\alpha$ a $\beta$, tak¾e
dostáváme na mìøítku bod $\alpha+\beta$. 
(6)~$1\cdot\vec u = \vec u$, proto¾e jednièka na mìøítku le¾í 
v~koncovém bodì vektoru~$\vec u$.
(7)~$0\cdot\vec u$ je v¾dy úseèka koèící v~bodì~$O$, proto¾e tam je
nula pomyslného mìøítka. Degenerovaná úseèka zaèínající i konèící 
v~bodì~$O$ je tedy nulovým prvkem na¹eho lineárního prostoru.

Vidíme, ¾e orientované úseèky s~vý¹e definovaným geometrickým sèítáním
a násobením skalárem mù¾eme v~souladu s~definicí\cite[dlp] nazývat
vektory. Zatímco v pøíkladu\cite[LPRn] jsme definovali sèítání vektorù
a násobení konstantou numericky (v jednotlivých slo¾kách sèítáme
reálná èísla), v pøípadì lineárního prostoru $U_O$ jsou tyto operace
definovány zcela jinak: geometricky.


%V\kcite\ktere[analgeom] kapitole 
%jim budeme øíkat vázané vektory (vázané bodem~$O$).

\okraj Prostor\hb funkcí | Prostor funkci

\priklad [LPfunkci]
%%%%%%%%%%%%%%%%%%%
Uva¾ujme mno¾inu $F_D$ v¹ech reálných funkcí reálné promìnné
definovaných na nìjaké mno¾inì $D\subseteq\R$, 
tj.~$F_D = \{f;\, f: D\to \R\}$. Pro libovolné funkce 
$f\in F_D$, $g\in F_D$ a pro libovolné reálné èíslo $\alpha$ definujme
souèet $f+g$ a násobek skalárem $\alpha\cdot f$ takto:
$$\let\eqno=\relax\eqalignno{
      (f+ g) (x) &\df= f(x) + g(x) \qquad \forall x\in D & \rce(plusf) \cr
  (\alpha\cdot f) (x) &\df= \alpha\, f(x) \qquad \forall x\in D&\rce(kratf)\cr}
$$
(srovnejte s~definicí $\oplus$ a $\odot$ v~pøíkladu\cite[polynomy]). 
Uká¾eme, ¾e mno¾ina $F_D$ s~takto definovaným sèítáním a násobením
skalárem tvoøí lineární prostor.
\inl[prostor: funkcí]

Potøebujeme ovìøit, zda souèet funkcí z~mno¾iny $F_D$ je opìt funkce
z~mno¾iny $F_D$ a skalární násobek je také funkce z~$F_D$. To ale platí,
proto¾e sèítáním funkcí ani násobením funkce konstantou podle na¹í
definice se nemìní definièní obor a výsledkem operací je znovu reálná
funkce reálné promìnné. 

Dále potøebujeme ovìøit vlastnosti (1) a¾ (7) z~definice\cite[dlp].
Pro libovolné $\relpenalty=10000 f\in F_D, g\in  F_D, h\in F_D,\penalty0 \alpha\in\R, \beta\in\R$ a
pro v¹echna $x\in D$ platí:
$$\eqalign{
\bod (1)    (f+g) (x) = f(x) + g(x) = g(x) + f(x) = (g+f) (x), \cr
\bod (2)    \bigl((f+g) + h\bigr) (x) = (f+g)(x) + h(x) = 
            \bigl( f(x) + g(x)\bigr) + h(x) = 
            f(x) + \bigl( g(x) + h(x) \bigr) = \cr &\odsun =  
            f(x) + (g+h)(x) = \bigl(f + (g+h)\bigr) (x), \cr
\bod (3)   \bigl(\alpha\cdot(\beta\cdot f)\bigr)(x) =
           \alpha\,\bigl((\beta\cdot f)(x)\bigr) =
           \alpha\,\bigl(\beta\,f(x)\bigr) =
           (\alpha\,\beta) f(x) = \bigl((\alpha\,\beta)\cdot f) (x), \cr
\bod (4)   \bigl(\alpha\cdot(f+g)\bigr)(x) = 
           \alpha\,\bigl((f+g)(x)\bigr) =
           \alpha\,(f(x) + g(x)) =
           \alpha\,f(x) + \alpha\,g(x) = \cr &\odsun =
           (\alpha\cdot f)(x) + (\alpha\cdot g)(x) =
           (\alpha\cdot f + \alpha\cdot g) (x), \cr
\bod (5)   \bigl((\alpha+\beta)\cdot f\bigr)(x) = 
           (\alpha+\beta)\,f(x) = \alpha\,f(x) + \beta\,f(x) =
           (\alpha\cdot f)(x) + (\beta\cdot f)(x) = \cr &\odsun =
           (\alpha\cdot f + \beta\cdot f) (x), \cr
\bod (6)   (1\cdot f)(x) = 1\cdot f(x) = f(x), \cr
\bod (7)   (0\cdot f)(x) = 0\cdot f(x) = o(x), \hbox{ kde funkce $o$ má pro
           v¹echna $x\in D$ hodnotu 0.} \cr
}
$$
Aèkoli tyto vzorce vypadají na první pohled jen jako \uv{hraní se
závorkami}, musíme si uvìdomit, ¾e rovnost funkcí zde dokazujeme na
základì rovnosti jejich hodnot v~ka¾dém bodì $x\in D$ a ¾e pøi dùkazu
pou¾íváme nejprve rozepsání operací podle vzorcù\cite(plusf)
a\cite(kratf). Tím problém pøevádíme na sèítání a násobení reálných
èísel, kde jsou vlastnosti (1) a¾ (7) zaruèeny. Jako cvièení si zkuste
pøepsat tyto vzorce tak, ¾e odli¹íte operace sèítání funkcí a násobení
funkce skalárem od bì¾ných operací \uv{$+$} a \uv{$\cdot$} pro
reálná èísla. Pou¾ijte napøíklad symbolù $\oplus$ a $\odot$, jako
v~pøíkladu\cite[polynomy]. 

Vidíme, ¾e mno¾ina $F_D$ s~definicí sèítání a násobení skalárem 
podle vzorcù\cite(plusf) a\cite(kratf) je lineárním prostorem. Funkce z~$F_D$
jsme tedy podle definice\cite[dlp] oprávnìni nazývat vektory. Nulovým
vektorem je v~tomto pøípadì funkce, která má pro v¹echna~$x\in D$
nulovou hodnotu.

\okraj Prostor\hb polynomù | Prostor polynomu

\priklad [LPpolynomu]
%%%%%%%%%%%%%%%%%%%%%
Uká¾eme, ¾e mno¾ina $P$ v¹ech polynomù s~definicemi sèítání a násobení
skalárem podle pøíkladu\cite[polynomy] tvoøí lineární prostor. 
\inl[prostor: polynomù, polynom]

Pøedev¹ím souèet dvou polynomù je polynom a skalární násobek polynomu
je polynom, tak¾e platí, ¾e $+: P\times P \to P$ a $\cdot: \R\times P
\to P$. To je ale v¹e, co potøebujeme dokázat. Ovìøováním vlastností
(1) a¾ (7) se nemusíme zdr¾ovat, proto¾e jsme definice sèítání a
násobení polynomù pøevzali z~prostoru funkcí $F_D$, o~nìm¾ jsme
dokázali v~pøíkladu\cite[LPfunkci], ¾e se jedná o~lineární prostor
(volíme $D=\R$). Pøi ovìøování vlastností~(1) a¾ (7) bychom 
dìlali vlastnì to samé jako v~pøíkladu\cite[LPfunkci], 
jen na podmno¾inì $P\subseteq F_D$.

\priklad [NeLPpolynomu]
%%%%%%%%%%%%%%%%%%%%%%%
Nech» $n\in \N,\, n\geq0$ (symbolem $\N$ znaèíme mno¾inu pøirozených èísel).
Mno¾ina $P_n$ v¹ech polynomù právì $n$-tého stupnì s~definicemi
sèítání a násobení skalárem podle pøíkladu\cite[polynomy] {\it netvoøí}
lineární prostor. Pøipomeneme, ¾e {\em stupeò polynomu} se definuje
jako nejvìt¹í $k\in\N$ takové, ¾e $a_k$
je ve vzorci\cite(polynom) nenulové. Jsou-li v¹echna $a_k$ nulová,
definujeme stupeò takového polynomu jako $-1$.
\inl[stupeò: polynomu]

Proè není mno¾ina $P_n$ lineárním prostorem? Seèteme-li toti¾ dva
polynomy $n$-tého stupnì, napøíklad $x^n + 2$ a $-x^n - 2$, dostáváme
nulový polynom, co¾ je polynom stupnì $-1$. Tento
protipøíklad ukazuje, ¾e neplatí vlastnost $+:P_n\times P_n \to P_n$.
Dokonce neplatí ani $\cdot:\R\times P_n \to P_n$ (zkuste násobit
polynom $n$-tého stupnì nulou).

\okraj Lineární podprostor | Linearni podprostor

\pozn [vllpp]
%%%%%
Pøíklady\cite[LPpolynomu] a \cite[NeLPpolynomu] ukazují, ¾e mù¾eme
vymezit podmno¾inu $M\subseteq L$ lineárního prostoru $L$ a pøevzít
pro ni operace sèítání a násobení konstantou z~$L$. 
Za jistých okolností mno¾ina $M$ s~pøevzatými operacemi
mù¾e být lineárním prostorem, ale nemusí být v¾dy. 
Z~pøíkladu\cite[LPpolynomu] navíc vidíme, ¾e staèí ovìøit vlastnosti
$+: M\times M\to M$ a $\cdot: \R\times M\to M$, abychom mohli
prohlásit, ¾e $M$ je lineární prostor. Vlastnosti (1) a¾ (7) není
tøeba znovu ovìøovat, proto¾e operace nemìníme. 
Podmo¾inu lineárního prostoru, která je sama
lineárním prostorem pøi pou¾ití stejných operací, nazýváme lineárním
podprostorem. Pøesnìji viz následující definici.

\definice [dlpp]
%%%%%%%%%%%%%%%%
Nech» $L$ je lineární prostor s~operacemi \uv{$+$} a \uv{$\cdot$}.
Neprázdnou mno¾inu $M\subseteq L$ nazýváme 
{\em lineárním podprostorem prostoru $L$}, 
pokud pro v¹echna $\vec x\in M, \vec y\in M$ a $\alpha\in\R$ platí:
$$\eqalign{
\bod (1)  \vec x + \vec y \in M, \cr
\bod (2)  \alpha\cdot\vec x \in M. \cr }
$$
\par\inl[podprostor: lineární, lineární: podprostor]

\priklad
%%%%%%%%
Mno¾ina v¹ech polynomù $P$ z~pøíkladu\cite[LPpolynomu] je lineárním 
podprostorem mno¾iny v¹ech funkcí $F_D$ z~pøíkladu\cite[LPfunkci], kde
volíme $D=\R$. Mno¾ina $P_n$ v¹ech polynomù právì $n$-tého stupnì
z~pøíkladu\cite[NeLPpolynomu] není lineárním podprostorem lineárního
prostoru $F_D$ ani lineárního prostoru $P$.
\inl[prostor: polynomù, polynom, podprostor: prostoru funkcí]

\priklad [lpPnn]
%%%%%%%%
Mno¾ina $P_{\leq n}$ v¹ech polynomù nejvý¹e $n$-tého
stupnì je lineárním podprostorem lineárního prostoru v¹ech polynomù
$P$ i lineárního prostoru v¹ech reálných funkcí $F_D$. Je to dáno tím, ¾e
(1)~souètem polynomù nejvý¹e $n$-tého stupnì dostáváme polynom
nejvý¹e $n$-tého stupnì a (2)~vynásobením polynomu nejvý¹e $n$-tého stupnì
reálným èíslem dostaneme zase polynom nejvý¹e $n$-tého stupnì.
\inl[podprostor: polynomù, polynom]

\priklad [LPPRn]
%%%%%%%%%%%%%%%%
Uva¾ujme $M\subseteq\R^n$, $M=\{(a,a,\ldots,a);\,\,
a\in\R\}$. Pøedpokládáme tedy, ¾e mno¾ina $M$ 
obsahuje takové $n$-tice, ve kterých se v¹echny
slo¾ky vzájemnì rovnají. Uká¾eme, ¾e $M$ je lineární podprostor
lineárního prostoru $\R^n$.

Staèí pro mno¾inu $M$ dokázat vlastnosti (1) a (2) 
z~definice\cite[dlpp]. Platí (1)~souèet dvou uspoøádaných $n$-tic, ve
kterých se slo¾ky rovnají, je uspoøádaná $n$-tice, ve kterých se
slo¾ky rovnají. (2)~vynásobením uspoøádané $n$-tice, ve které se
slo¾ky rovnají, reálným èíslem, dostáváme zase uspoøádanou $n$-tici, ve
které se slo¾ky rovnají.
\inl[podprostor: R9n, R9n]

\priklad [LPPR3]
%%%%%%%%%%%%%%%%
Uva¾ujme mno¾iny $M\subseteq \R^3$, $N\subseteq \R^3$ a $S\subseteq
\R^3$, které jsou definovány takto:
$$\eqalign{
  M &= \{(x,y,z);\, x + 2y = 0, \, z \hbox{ libovolné}\,\}, \cr
  N &= \{(x,y,z);\, 2x + y - z = 0\}, \cr
  S &= \{(x,y,z);\, 2x + y - z = 3\}. \cr }
$$
Uká¾eme, ¾e $M$ a $N$ jsou lineárními podprostory lineárního prostoru
$\R^3$, zatímco $S$ není lineárním podprostorem lineárního prostoru~$\R^3$.
\inl[podprostor: R9n]

Ovìøíme vlastnost (1) z~definice\cite[dlpp]: Nech»
$(x_1,y_1,z_1)\in M$ a $(x_2,y_2,z_2)\in M$. Pak platí 
$x_1 + 2y_1 = 0$ a $x_2 + 2y_2 = 0$. Pro souèet 
$(x_1+x_2,y_1+y_2,z_1+z_2)$ platí $x_1 + 2y_1 + x_2 + 2y_2 = 0$
(seèetli jsme pøedchozí rovnice), tj. $(x_1 + x_2) + 2(y_1 + y_2) =
0$, tak¾e i souèet le¾í v~mno¾inì $M$. Nyní vlastnost (2):
Jestli¾e $(x,y,z)\in M$, $\alpha\in\R$, pak platí  $x + 2y =
0$. Vynásobením rovnice èíslem $\alpha$ dostáváme, ¾e té¾
$\alpha\,x + 2\alpha\,y = 0$, co¾ ale znamená, ¾e i trojice
$\alpha\cdot(x,y,z)$ le¾í v~mno¾inì $M$. Ovìøení, ¾e mno¾ina 
$N$ je lineárním podprostorem, lze provést podobnì.

Mno¾ina $S$ není lineárním podprostorem, proto¾e napøíklad 
$0\cdot(x,y,z) = (0,0,0)$, co¾ je ale prvek, který nele¾í v~$S$.
Neplatí toti¾ $2\cdot0 + 0 - 0 = 3$.

\okraj Prùnik\hb prostorù | Prunik prostoru

\veta* [pruniklpp]
%%%%%%%%%%%%%%%%%
Nech» $M\subseteq L$ a $N\subseteq L$ jsou lineární podprostory 
lineárního prostoru $L$. Pak platí:
$$\eqalign{
\bod (1) M\cap N \hbox{ je lineární podprostor lineárního prostoru $L$}.\cr
\bod (2)  M\cup N 
     \hbox{ nemusí být lineární podprostor lineárního prostoru $L$}.\cr}
$$
\par\inl[prùnik: prostorù, sjednocení: prostorù]

\dukaz
(1) Z~pøedpokladù vìty a definice\cite[dlpp] víme, ¾e pro 
$\vec x\in M$, $\vec y\in M$, $\alpha\in\R$ je $\vec x + \vec y \in M$
a $\alpha\cdot\vec x \in M$. Toté¾ platí pro mno¾inu $N$. Pokud nyní 
$\vec x\in M\cap N$, $\vec y\in M\cap N$, pak $\vec x$ i $\vec y$ le¾í
souèasnì v~$M$ i $N$, tak¾e platí, ¾e 
$\vec x + \vec y \in M$, $\alpha\cdot\vec x \in M$ a souèasnì
$\vec x + \vec y \in N$, $\alpha\cdot\vec x \in N$. 
Prvky $\vec x + \vec y$ a $\alpha\cdot\vec x$ le¾í v~obou mno¾inách
$M$ a $N$ souèasnì a to není jinak mo¾né, ne¾ ¾e le¾í v~prùniku tìchto
mno¾in. 

(2) Abychom ukázali, ¾e sjednocení $M\cup N$ nemusí být lineárním
podprostorem, staèí najít vhodný pøíklad. Nech»
$M=\{(a,0);\,a\in\R\}$, $N=\{(0,b);\,b\in\R\}$. Je zøejmé, ¾e
$M$ a $N$ jsou lineárními podprostory lineárního prostoru $\R^2$.
Sjednocením tìchto mno¾in je mno¾ina uspoøádaných dvojic, pro které je
první nebo druhá slo¾ka nulová. Vezmeme nyní $(1,0)\in M\cup N$ a 
$(0,1)\in M\cup N$.
Souèet $(1,0)+(0,1)=(1,1)$ je uspoøádaná dvojice, která nele¾í ve
sjednocení $M\cup N$.

\priklad
%%%%%%%%
Uva¾ujme podprostory $M$ a $N$ z~pøíkladu\cite[LPPR3]. Podle 
vìty\cite[pruniklpp] je také $M\cap N$ lineárním podprostorem
lineárního prostoru $\R^3$. 


\priklad
%%%%%%%%
Nech» $U_O$ je lineární prostor orientovaných úseèek zavedený v
pøíkladu\cite[lpvv] a dále nech» 
$M\subset U_O$ jsou jen takové úseèky, které le¾í ve stejné
rovinì, jako le¾í ná¹ papír, na který jsme v~pøíkladu\cite[lpvv]
nakreslili køí¾ek. Vidíme, ¾e $M\not=U_O$, proto¾e napøíklad úseèka
nenulové velikosti kolmá na ná¹ papír nele¾í v~$M$. Uká¾eme, ¾e
mno¾ina~$M$ je lineární podprostor lineárního prostoru~$U_O$. 
Skuteènì, souèet libovolných dvou úseèek le¾í ve stejné rovinì
(proto¾e tam le¾í celý rovnobì¾ník) a násobek úseèky le¾í dokonce na
stejné pøímce, jako pùvodní úseèka, tak¾e nutnì zùstává ve stejné
rovinì.
\inl[prostor: UO, prostor: orientovaných úseèek]

Ka¾dá rovina, která prochází bodem $O$,
obsahuje podmno¾inu úseèek z~$U_O$, které tvoøí lineární podprostor lineárního
prostoru $U_O$.

Uva¾ujme nyní dvì roviny, které mají spoleèný bod $O$, ale nejsou
toto¾né. Jejich prùnik je nìjaká pøímka, procházející bodem $O$.
V¹echny orientované úseèky z~$U_O$, které le¾í v~této pøímce, tvoøí
podle vìty\cite[pruniklpp] rovnì¾ lineární podprostor lineárního
prostoru $U_O$.

\okraj Prostor posloupností | Prostor posloupnosti

\priklad [LPposloupnosti]
%%%%%%%%
Nekoneèné posloupnosti reálných èísel lze sèítat tak, ¾e sèítáme
odpovídající prvky jednotlivých posloupností. A mù¾eme je násobit konstantou tak,
¾e v¹echny prvky posloupnosti jsou vynásobeny touto konstantou. Tedy:
$$
  \eqalign{
  (a_1,a_2,a_3,a_4,\ldots) + (b_1,b_2,b_3,b_4,\ldots) &=
  (a_1+b_1,a_2+b_2,a_3+b_3,a_4+b_4,\ldots), \cr
  \alpha\cdot (a_1,a_2,a_3,a_4,\ldots) &= 
  (\alpha a_1,\alpha a_2,\alpha a_3,\alpha a_4,\ldots).
}
$$
Mno¾ina nekoneèných posloupností $S$ s takto zavedenými operacemi sèítání
a násobení konstantou tvoøí lineární prostor. Argumentuje se stejnì, jako
v pøíkladu\cite[LPRn].
\inl[lineární: prostor: posloupností]

Podmno¾ina $C\subseteq S$ nekoneèných posloupností, které jsou konvergentní, tvoøí
lineární podprostor lineárního prostoru $S$, nebo» souèet 
konvergentních posloupností je konvergentní posloupnost a 
násobek konvergentní posloupnosti je konvergentní posloupnost. 

Podmno¾ina $N\subseteq S$ nekoneèných posloupností, které mají limitu nula, tvoøí
lineární podprostor lienárního prostoru $S$, nebo» souèet 
posloupností majících limitu nula je
posloupnost mající limitu nula a násobek posloupnosti s limitou nula
je posloupnost s limitou nula. Dokonce $N$ je lineárním podprostorem lineárního
prostoru $C$.

Nekoneèné posloupnosti, které mají jen koneènì mnoho nenulových prvkù, se nazývají
{\em posloupnosti s~koneèným nosièem}. 
Podmno¾ina $K\subseteq S$ posloupností s koneèným nosièem
tvoøí lineární podprostor, nebo» souèet posloupností
s koneèným nosièem je posloupnost s koneèným nosièem a 
násobek posloupnosti s koneèným nosièem je posloupnost s koneèným
nosièem. Dokonce $K$ je lineárním podprostorem lineárního prostoru~$N$. 

Struènì: $K$ je podprostorem $N$ je podprostorem $C$ je podprostorem $S$.


\okraj Triviální prostor | Trivialni prostor

\pozn [trivprostor]
%%%%%
Zamysleme se, jak mù¾e vypadat lineární prostor s~nejmen¹ím poètem
prvkù. Podle definice\cite[dlp] je lineární prostor v¾dy neprázdná
mno¾ina, tak¾e musí obsahovat aspoò jeden prvek. Ukazuje se,
¾e jednobodová mno¾ina $L=\{\vec o\}$ je skuteènì nejmen¹í mo¾ný
lineární prostor.  Pøitom $\vec o$ je nulový prvek z~vlastnosti
(7). Sèítání je definováno pøedpisem $\vec o + \vec o = \vec o$ a
násobení skalárem $\alpha$ pøedpisem $\alpha\cdot\vec o = \vec o$.
Takový lineární prostor nazýváme {\em triviální}.
\inl[prostor: triviální, triviální: prostor]

\pozn [dvoubodovy]
%%%%%%%%%%%%%%%%%%
Uká¾eme, ¾e koneèná mno¾ina obsahující aspoò dva prvky nemù¾e 
být lineárním prostorem. Znamená to, ¾e se nám pro takovou
mno¾inu $L$ nepovede najít operace $+:L\times L\to L$ a 
$\cdot:\R\times L\to L$ takové, aby souèasnì
splòovaly vlastnosti (1) a¾ (7) z~definice\cite[dlp]. 

Jeden z~prvkù mno¾iny $L$
musí být nulový prvek (oznaème jej~$\vec o$) a jiný prvek oznaème
tøeba $\vec x$. Dal¹í prvky oznaèovat nemusíme.
Uva¾ujme mno¾inu $K=\{\alpha\cdot\vec x;\, \alpha\in\R\}$.
Proto¾e $K\subseteq L$, je i $K$ koneèná mno¾ina.
Proto¾e reálných èísel je nekoneènì mnoho, a pøitom $K$ je koneèná, musejí 
existovat dvì rùzná reálná èísla
$\beta\ne\gamma$ taková, ¾e $\beta\cdot\vec x = \gamma\cdot\vec x$.
Z~definice lineárního prostoru\cite[dlp] dostáváme:

$$
  \vec o = 0\cdot\vec x = (\beta-\beta)\cdot \vec x =
  \beta\cdot\vec x  + (-\beta)\cdot\vec x =
  \gamma\cdot\vec x + (-\beta)\cdot\vec x =
  (\gamma-\beta)\cdot\vec x.
$$
Nyní máme splnìny pøedpoklady vlastnosti (3) vìty\cite[nulprvek]
(volíme $\alpha=\gamma-\beta$). Dostáváme tedy $\vec x=\vec o$.
To je ale spor s pøedpokladem, ¾e jsme vybrali prvek $\vec x$ jiný ne¾
nulový. Koneèná mno¾ina obsahující aspoò dva prvky tedy nemù¾e
být lineárním prostorem.

Existuje tedy jednobodový lineární prostor a pak dlouho nic
\dots~a v¹echny ostatní lineární prostory musejí mít nekoneèné
mno¾ství prvkù.

\priklad [ObskurniLP]
%%%%%%%%%%%%%%%%%%%%%%
Uká¾eme si jeden pøíklad ponìkud exotického
lineárního prostoru. Jedná se o~mno¾inu kladných reálných èísel $\R^+$,
na které je definováno \uv{sèítání} $\oplus: \R^+ \times \R^+ \to \R^+$  
a \uv{násobení} reálným èíslem $\odot: \R\times \R^+ \to \R^+$ takto:
pro $x\in\R^+$, $y\in\R^+$, $\alpha\in\R$ je
$$ x \oplus y \df= x\cdot y, \quad \alpha\odot x \df= x^\alpha, $$
kde znakem \uv{$\cdot$} je mínìno bì¾né násobení reálných èísel a 
$x^\alpha$ je reálná mocnina o~kladném základu.

V~tomto pøíkladì jsme se pokornì vrátili ke krou¾kování nových operací
sèítání a násobení skalárem, proto¾e bychom je velmi tì¾ko odli¹ovali
od bì¾ného sèítání a násobení reálných èísel. Nové sèítání vlastnì
definujeme jako bì¾né násobení a nové násobení jako bì¾nou mocninu.

Aby $\R^+$ s~operacemi $\oplus$ a $\odot$ byl lineárním protorem, musí
splòovat vlastnosti (1) a¾ (7) z~definice\cite[dlp]. Pro 
$x\in\R^+$, $y\in\R^+$, $z\in\R^+$, $\alpha\in\R$, $\beta\in\R$ je
$$\eqalign{
\bod (1)   x\oplus y = x\cdot y = y\cdot x = y\oplus x, \cr
\bod (2)   (x\oplus y) \oplus z = (x \cdot y)\cdot z =
           x \cdot (y \cdot z) = x \oplus (y \oplus z), \cr
\bod (3)   \alpha\odot(\beta\odot x) = (\beta\odot x)^\alpha =
           (x^\beta)^\alpha = x^{\alpha\cdot\beta} = 
           (\alpha\,\beta)\odot x, \cr
\bod (4)   \alpha\odot(x\oplus y) = (x\oplus y)^\alpha =
           (x\cdot y)^\alpha = x^\alpha \cdot y^\alpha =
           (\alpha\odot x) \cdot (\alpha\odot y) =
           (\alpha\odot x) \oplus (\alpha\odot y), \cr
\bod (5)   (\alpha+\beta)\odot x = x^{\alpha+\beta} = 
           x^\alpha \cdot x^\beta = 
           (\alpha \odot x) \cdot (\beta\odot x) =
           (\alpha \odot x) \oplus (\beta\odot x), \cr
\bod (6)   1\odot x = x^1 = x, \cr
\bod (7)   0\odot x = x^0 = 1 \in \R^+. \cr }
$$
Z~poslední vlastnosti vyplývá, ¾e nulový prvek tohoto lineárního
prostoru je èíslo 1. To je pøekvapení.

\okraj Lineární prostor\hb nad~{\C} | Linearni prostor nad C

\poznamka [dlpnadC]
%%%%%%%%%
V definici\cite[dlp] jsme za skaláry pova¾ovali reálná èísla.
Nyní zkusíme nahradit v této definici v¹echny výskyty mno¾iny 
$\R$ mno¾inou komplexních èísel $\C$. Dostáváme pozmìnìnou definici:

{\em Lineárním prostorem} nazýváme ka¾dou neprázdnou mno¾inu $L$, 
na které je definováno sèítání  $+: L\times\nobreak L \to L$ a násobení
komplexním èíslem $\cdot: \C\times L \to L$ a tyto operace splòují pro ka¾dé 
$\vec x\in L$, $\vec y\in L$, $\vec z\in L$, $\alpha\in\C$, $\beta\in\C$
axiomy linearity~(1) a¾~(7) (viz definici\cite[dlp]).
Prvky lineárního prostoru nazýváme {\em vektory}. Komplexnímu èíslu
v~kontextu násobení $\cdot: \C\times L \to L$ øíkáme {\em skalár}.
Prvku $\vec o\in L$ z~vlastnosti (7) øíkáme {\em nulový prvek} nebo 
{\em nulový vektor}. 
\inl[prostor: lineární: nad C, lineární: prostor: nad C]

Takto definovanému lineárnímu prostoru øíkáme {\em lineární prostor
nad komplexními èísly}. Na druhé stranì pùvodní
definice\cite[dlp] vymezila {\em lineární prostor nad reálnými èísly}.

\poznamka
%%%%%%%%%
Kdy¾ si peèlivý ètenáø projde celý text této kapitoly znovu a nahradí
v¹echny zmínky o reálných èíslech zmínkami o komplexních èíslech
(s~výjimkou pøíkladu\cite[lpvv]), 
v¹echna tvrzení budou platit i v takovém pøípadì. V na¹em textu si ale vìt¹inou 
vystaèíme s lineárními prostory nad reálnými èísly. Nebude-li zde 
výslovì øeèeno, o jaký lineární prostor se jedná, máme na mysli
lineární prostor nad reálnými èísly. Pøitom vesmìs v¹echny úvahy platí i pro
lineární prostory nad komplexními èísly, pokud ve¹keré zmínky o
reálných èíslech nahradíme v textu zmínkami o èíslech komplexních.
 
\poznamka
%%%%%%%%%
V kapitole\kcite\ktere[grupy] se setkáme s dal¹ím zobecnìním lineárního prostoru.
Lineární prostor nad reálnými nebo nad komplexními èísly nahradíme 
lineárním prostorem nad obecným {\em tìlesem}. Vesmìs v¹echny
vlastnosti, které doká¾eme pro lineární prostory nad~$\R$, zùstanou 
v~platnosti i pro lineární prostory nad obecným tìlesem.
\inl[tìleso]

\shrnuti
%%%%%%%%
%Na konci ka¾dé kapitoly zopakujeme hlavní sdìlení dané kapitoly. 
%Nejpodstatnìj¹í my¹lenky jsou v takovém shrnutí tedy øeèeny znovu, 
%èasto jen struèným a lapidárním jazykem s odkazy na pøedchozí pøesné 
%definice a vìty.
%
V lineární algebøe se pracuje s lineárními prostory\lcite[dlp], co¾
jsou mno¾iny abstraktních \uv{vektorù}, o nich¾ pouze víme, ¾e je lze
sèítat a násobit konstantou, pøièem¾ tyto operace splòují axiomy
linearity vyjmenované v~definici\cite[dlp] pod èísly~(1) a¾~(7).

V pøíkladech jsme si ukázali, ¾e existují rùzné lineární prostory:
prostor uspoøádaných $n$-tic reálných èísel\lcite[LPRn], 
prostor funkcí\lcite[LPfunkci], prostor
polynomù\lcite[LPpolynomu], 
prostor nekoneèných posloupností\lcite[LPposloupnosti], 
prostor orientovaných úseèek\lcite[lpvv]. 
Tento výèet zdaleka není úplný. Dají se sestrojit i lineární
prostory s neobvyklými operacemi, které pøesto splòují axiomy 
linearity\lcite[ObskurniLP].

Nejdùle¾itìj¹ím pøíkladem je lineární prostor uspoøádaných $n$-tic
reálných èísel\lcite[LPRn]. Vektory tohoto lineárního prostoru 
sèítáme po slo¾kách a násobíme reálným èíslem tak, 
¾e násobíme tímto èíslem ka¾dou slo¾ku.
V následujích kapitolách se s tímto lineárním prostorem je¹tì
mnohokrát setkáme.

Podmo¾iny lineárních prostorù mohou se stejnými operacemi být samy
lineárními prostory. V takovém pøípadì jim øíkáme 
podprostory\lcite[dlpp]. Prùnik podprostorù je podprostor ale sjednocení
podprostorù nemusí být podprostor\lcite[pruniklpp].


\icviceni 1



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\kapitola Lineární závislost a nezávislost, lineární obal |
          Linearni zavislost a nezavislost, linearni obal
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\pozn
%%%%%
Aèkoli jsme v~pøedchozí kapitole uvedli mnoho pøíkladù, které mìly
ilustrovat definici lineárního prostoru, je mo¾né, ¾e smysl
této definice se tím nepodaøilo objasnit. Mù¾ete se ptát, proè jsme
nuceni ovìøovat u~rùzných mno¾in, zda jsou èi nejsou pøi definování
urèitých operací sèítání a násobení reálným èíslem lineárními
prostory. Neuvedli jsme toti¾, ¾e pokud nìjaká mno¾ina je lineárním
prostorem, lze na ni zkoumat mnoho dal¹ích vlastností a zavést plno
u¾iteèných pojmù, které jsou spoleèné v¹em lineárním prostorùm.

Tyto vlastnosti a pojmy pøedpokládají pouze to, ¾e vektory (tj.~prvky
nìjaké blí¾e neurèené mno¾iny) umíme sèítat a násobit reálným èíslem,
a pøitom tyto operace splòují axiomy (1) a¾ (7)
z~definice\cite[dlp].  Kdybychom tuto jednotící definici nemìli,
museli bychom napøíklad zvlá¹» zavádìt pojmy lineární závislost, báze
a dimenze pro mno¾inu orientovaných úseèek, zvlá¹» pro mno¾inu
uspoøádaných $n$-tic a zvlá¹» pro mno¾inu reálných funkcí. A¾ bychom
tøeba pozdìji zjistili, ¾e mù¾eme kupøíkladu matice stejné velikosti 
sèítat a násobit skalárem, znovu bychom pro tuto
mno¾inu byli nuceni definovat pojmy lineární závislost, báze a
dimenze. Pøitom k~zavedení tìchto pojmù je zapotøebí dokázat nìkolik
tvrzení, která bychom tak museli dokazovat pro ka¾dou konkrétní
mno¾inu zvlá¹» a znova. Snad ka¾dý uzná, ¾e to je docela zbyteèná práce. Je
pøeci jen jednodu¹¹í ovìøit, ¾e nìjaká mno¾ina tvoøí lineární
prostor a okam¾itì pro ni pou¾ívat v¹echny dal¹í vlastnosti a pojmy,
které se dozvíme v~této kapitole.

\pozn % Zbytecne zavorky nepiseme, misto (-1) x piseme -x
%%%%%%%%%%%%
Sèítání má podle definice\cite[dlp] dva operandy. Kdy¾ bychom
chtìli seèíst tøeba tøi vektory $\vec x + \vec y + \vec z$, mìli
bychom uvést, v~jakém poøadí budeme operace provádìt, tj. zda provedeme
$(\vec x + \vec y) + \vec z$ nebo $\vec x + (\vec y + \vec z)$. 
Vlastnost (2) definice\cite[dlp] nás ale od této povinnosti osvobozuje,
proto¾e zaruèuje, ¾e oba pøípady povedou ke stejnému výsledku.
Proto nebudeme v~takovém pøípadì nadále závorky uvádìt a napøíklad
pro vektory $\vecc x_n$ budeme jejich
souèet zapisovat jednodu¹e: \hbox{$\vec x_1+ \vec x_2+ \cdots+ \vec x_n$}.

Dále budeme místo $\vec x + (-1)\cdot \vec y$ zapisovat struènì 
$\vec x-\vec y$. Tím vlastnì máme zavedenu operaci odèítání vektorù,
aèkoli tato operace není v~definici\cite[dlp] vùbec zmínìna.

Abychom v~textu odli¹ili vektory (tj.~prvky nìjakého lineárního
prostoru) od reálných èísel, budeme vektory oznaèovat malými písmeny 
anglické abecedy a v¾dy je zvýrazníme tuènì, tedy takto: $\vec x, \vec
y, \vec a, \vec x_1$ atd. V~ruènì psaném textu se èasto vektory zvýrazòují
zápisem ¹ipky nad písmeno, podtr¾ením písmene nebo i~jinak.

\okraj Lineární kombinace | Linearni kombinace

\definice [lk]
%%%%%%%%%%%%%%
Nech» $\vecc x_n$ jsou vektory (tj.~prvky nìjakého
lineárního prostoru). {\em Lineární kombinací\/} vektorù
$\vecc x_n$ rozumíme vektor
$$
  \alpha_1\cdot\vec x_1+ \alpha_2\cdot\vec x_2+ \cdots+\alpha_n\cdot\vec x_n,
$$
kde $\alpha_1, \alpha_2, \ldots, \alpha_n$ jsou nìjaká reálná èísla.
Tìmto èíslùm øíkáme {\em koeficienty\/} lineární kombinace.
\inl[kombinace: lineární, lineární: kombinace]
\inl[koeficienty: lineární: kombinace]

\priklad
%%%%%%%%
Lineární kombinací vektorù $\vec x, \vec y, \vec z$ mù¾e být tøeba
vektor $\vec x + \vec y + \vec z$ (v¹echny tøi koeficienty jsou rovny
jedné), nebo vektor $\teckacarka 2\vec x - \vec y + 3.18\vec z$ 
(koeficienty jsou èísla $\teckacarka 2;\, -1;\, 3.18$), nebo také vektor 
$\alpha\,\vec x +\beta\,\vec y + \gamma\,\vec z$ 
(koeficienty $\alpha,\beta,\gamma\in\R$ jsme blí¾e neurèili).
\inl[kombinace: lineární, lineární: kombinace]

\okraj Triviální\hb lineární\hb kombinace | Trivialni linearni kombinace

\definice [trivlk]
%%%%%%%%%%%%%%%%%%
{\em Triviální\/} lineární kombinace vektorù $\vecc x_n$
je taková lineární kombinace, která má v¹echny koeficienty nulové, 
tj.~$0 \vec x_1 + 0 \vec x_2 + \cdots + 0 \vec x_n$. {\em Netriviální\/}
lineární kombinace je taková lineární kombinace, která není triviální,
tj.~aspoò jeden její koeficient je nenulový.
\inl[kombinace: lineární: triviální, triviální: lineární: kombinace]
\inl[kombinace: lineární: netriviální, netriviální: lineární: kombinace]

\veta
%%%%%
Triviální lineární kombinace je v¾dy rovna nulovému vektoru.
\inl[vektor: nulový, nulový: vektor]
\inl[kombinace: lineární: triviální, triviální: lineární: kombinace]

\dukaz
Podle vlastnosti (7) v~definici\cite[dlp] je ka¾dý sèítanec v~triviální
lineární kombinaci roven nulovému vektoru a podle vlastnosti (1) 
vìty\cite[nulprvek] je i souèet nulových vektorù roven nulovému vektoru.

\okraj Lineární\hb závislost\hb skupiny | Linearni zavislost skupiny

\definice* [LZskupiny]
%%%%%%%%%%%%%%%%%%%%%
Skupinu vektorù $\vecc x_n$ nazýváme
{\em lineárnì závislou}, pokud existuje netriviální lineární kombinace
vektorù $\vecc x_n$, která je rovna
nulovému vektoru. Struènì øíkáme, ¾e vektory  
$\vecc x_n$ jsou {\em lineárnì závislé}.
\inl[lineární: závislost, lineární: závislost: skupiny vektorù]

\pozn [poznlz]
%%%%%%%%%%%%%%
Pokud bychom rozvedli pojem netriviální lineární kombinace podle
definic\cite[trivlk] a\cite[lk], mù¾eme øíci, ¾e  vektory  
$\vecc x_n$ jsou {\em lineárnì závislé},
pokud existují reálná èísla $\alpha_1 ,\alpha_2, \ldots, \alpha_n$
tak, ¾e aspoò jedno z~nich je nenulové, a pøitom platí
$$
  \alpha_1\cdot\vec x_1+ \alpha_2\cdot\vec x_2+ 
  \cdots+\alpha_n\cdot\vec x_n = \vec o.
$$

\okraj Lineární\hb nezávislost skupiny | Linearni nezavislost skupiny

\definice [LNskupiny]
%%%%%%%%%%%%%%%%%%%%%
Skupinu vektorù $\vecc x_n$ nazýváme
{\em lineárnì nezávislou}, pokud není lineárnì závislá. Struènì
øíkáme, ¾e vektory  
$\vecc x_n$ jsou {\em lineárnì nezávislé}.
\inl[lineární: nezávislost, lineární: nezávislost: skupiny vektorù]

\pozn* [poznln]
%%%%%%%%%%%%%%
Vektory jsou lineárnì nezávislé, pokud (podle definic\cite[LZskupiny]
a\cite[LNskupiny]) neexistuje netriviální lineární kombinace tìchto
vektorù, která je rovna nulovému vektoru. Jinak øeèeno, jedinì
triviální lineární kombinace je rovna nulovému vektoru.
Pøi pou¾ití definice\cite[trivlk] mù¾eme øíci, ¾e vektory 
$\vecc x_n$
jsou lineárnì nezávislé, pokud z~pøedpokladu
$
  \alpha_1\cdot\vec x_1+ \alpha_2\cdot\vec x_2+ 
  \cdots+\alpha_n\cdot\vec x_n = \vec o
$
nutnì plyne, ¾e $\alpha_1 = \alpha_2 = \cdots = \alpha_n = 0$. 

\pozn
%%%%%
Aèkoli se vesmìs pou¾ívá struèná formulace: \uv{vektory $\vecc x_n$ 
jsou lineárnì závislé/nezávislé} místo
pøesnìj¹ího: \uv{skupina
vektorù $\vecc x_n$ je lineárnì
závislá/nezávislá}, je potøeba si uvìdomit, ¾e struèná formulace mù¾e
vést k~nepochopení. Rozhodnì se tím nechce øíci, ¾e jednotlivé vektory
jsou lineárnì závislé/nezávislé (tj. $\vec x_1$ je lineárnì
závislý/nezávislý, $\vec x_2$ je lineárnì závislý/nezávislý atd.), ale
jedná se v¾dy o~vlastnost celé skupiny vektorù jako celku.

Pojem lineární závislosti a nezávislosti vektorù
má v lineární algebøe zásadní dùle¾itost. Závislost vektorù je mo¾ná
názornìj¹í z pohledu následující vìty\cite[xr], ov¹em pøi ovìøování
lineární závislosti abstraktních vektorù je èasto definice\cite[LZskupiny] 
pou¾itelnìj¹í. Má proto smysl definicím\cite[LZskupiny] 
a\cite[LNskupiny] vìnovat nále¾itou pozornost.

\priklad
%%%%%%%%
Uva¾ujme lineární prostor $\R^3$ (viz pøíklad\cite[LPRn], $n=3$).
Jsou dány tøi vektory z~$\R^3$: 
$$
  \vec x=(1,2,3), \quad \vec y =(1,0,2), \quad \vec z =(-1,4,0).
$$
Zjistíme z~definice, zda jsou vektory $\vec x,\vec y,\vec z$ lineárnì
závislé èi nezávislé. Podle poznámek\cite[poznlz] a\cite[poznln]
staèí zjistit, jaké mohou být koeficienty $\alpha,\beta,\gamma$, pokud
polo¾íme 
$$
  \alpha\,\vec x + \beta\,\vec y + \gamma\,\vec z = \vec o.
$$
Dosazením do této rovnice dostáváme
$$
  \alpha\,(1,2,3) + \beta\,(1,0,2) + \gamma\,(-1,4,0) = (0,0,0).
$$
Zde jsme vyu¾ili toho, ¾e nulový vektor v~$\R^3$ je roven trojici
$(0,0,0)$. Dále podle definice sèítání a násobení skalárem na $\R^3$
dostáváme
$$
  (\alpha+\beta-\gamma, 2\,\alpha+4\,\gamma, 3\,\alpha+2\,\beta)= (0,0,0).
$$
Dvì uspoøádané trojice se rovnají, pokud se rovnají jejich
odpovídající slo¾ky. Musí tedy platit tyto rovnice:
$$\soustava{
  \1\,\alpha&+\1\,\beta&-\1\,\gamma &= 0, \cr
   2\,\alpha&          &+ 4\,\gamma &= 0, \cr
   3\,\alpha&+ 2\,\beta&            &= 0.\, \cr}
$$
Tato soustava má nekoneènì mnoho øe¹ení (zkuste si to ovìøit 
tøeba Gaussovou eliminaèní metodou). Mezi tìmito øe¹eními je jediné
triviální, v¹echna ostatní jsou netriviální. Pøíkladem takového
netriviálního øe¹ení mù¾e být tøeba $\alpha=2$, $\beta=-3$,
$\gamma=-1$, tak¾e
$$
  2\,(1,2,3) - 3\,(1,0,2) - 1\,(-1,4,0) = (0,0,0).
$$
Existuje tedy  netriviální lineární kombinace vektorù
$\vec x,\vec y,\vec z$, která je rovna nulovému vektoru, co¾ podle
definice\cite[LZskupiny] znamená, ¾e
vektory $\vec x,\vec y,\vec z$ jsou lineárnì závislé.


\priklad [lntrojka]
%%%%%%%%
V~lineárním prostoru $\R^3$ jsou dány tøi vektory z~$\R^3$: 
$$
  \vec x=(1,2,3), \quad \vec y =(1,0,2), \quad \vec z =(-2,1,0).
$$
Zjistíme z~definice, zda jsou vektory $\vec x,\vec y,\vec z$ lineárnì
závislé èi nezávislé. Podle poznámek\cite[poznlz] a\cite[poznln]
staèí zjistit, jaké mohou být koeficienty $\alpha,\beta,\gamma$, pokud
polo¾íme 
$
  \alpha\,\vec x + \beta\,\vec y + \gamma\,\vec z = \vec o.
$
Dosazením do této rovnice dostáváme
$$\eqalign{
  \alpha\,(1,2,3) + \beta\,(1,0,2) + \gamma\,(-2,1,0) &= (0,0,0),\cr
  (\alpha+\beta-2\,\gamma, 2\,\alpha+\gamma, 3\,\alpha+2\,\beta)&= (0,0,0).\cr}
$$
Dvì uspoøádané trojice se rovnají, pokud se rovnají jejich
odpovídající slo¾ky. Musí tedy platit tyto rovnice:
$$\soustava{
  \1\,\alpha&+\1\,\beta&- 2\,\gamma &= 0, \cr
   2\,\alpha&          &+\1\,\gamma &= 0, \cr
   3\,\alpha&+2\,\beta &            &= 0.\, \cr}
$$
Tato soustava má jediné øe¹ení $\alpha=0,\, \beta=0,\, \gamma=0$
(zkuste si to ovìøit tøeba Gaussovou eliminaèní metodou). Vidíme tedy,
¾e jedinì triviální lineární kombinace vektorù
$\vec x,\vec y,\vec z$ je rovna nulovému vektoru, co¾ podle
definice\cite[LNskupiny] znamená, ¾e
vektory $\vec x,\vec y,\vec z$ jsou lineárnì nezávislé.

\priklad [sincos4]
%%%%%%%%
Uva¾ujme lineární prostor v¹ech reálných funkcí definovaných na $\R$ a
v~nìm tøi funkce $f,g,h$, které jsou zadané tìmito vzorci:
$$
  f(x) = \sin(x), \quad  g(x) = \cos(x), \quad h(x) = 4 \quad \forall x\in\R.
$$
Ovìøíme, zda jsou tyto tøi funkce lineárnì nezávislé èi závislé. Polo¾íme
jejich lineární kombinaci rovnu nulové funkci:
$$
  \alpha\cdot\sin(x) + \beta\cdot\cos(x) + \gamma\cdot 4 = 0 
  \quad \forall x\in\R \rce (sincos4)
$$
a zjistíme, jakých hodnot mohou nabývat koeficienty $\alpha, \beta, \gamma$.
Tato rovnost má být splnìna pro v¹echna $x\in\R$. Je mo¾né, ¾e pøi
volbì tøí hodnot $x\in\R$ u¾ vynutíme trivialitu lineární kombinace 
v\cite(sincos4). Zkusme ¹tìstí napøíklad pro 
$x\in\left\{0,{\pi\over2},\pi\right\}$.
V rovnici\cite(sincos4) se tedy omezíme na
$$
  \alpha\cdot\sin(x) + \beta\cdot\cos(x) + \gamma\cdot 4 = 0 \quad 
  \hbox{pro } x\in\left\{0,{\pi\over2},\pi\right\}. \rce (sincos4a)
$$
%Je jedno, jaký jsme zvolili \uv{vzorek} tøí hodnot $x$. Pro závìreènou
%argumentaci nám staèí, ¾e z~výroku\cite(sincos4) plyne výrok\cite(sincos4a).
Po dosazení hodnot $x$ dostáváme tøi rovnice:
$$\soustava{
   0\,\alpha + \1\,\beta + 4\,\gamma &= 0, \cr
  \1\,\alpha +  0\,\beta + 4\,\gamma &= 0, \cr
   0\,\alpha - \1\,\beta + 4\,\gamma &= 0.\, \cr}
$$
Tato soustava má jediné øe¹ení $\alpha=0,\, \beta=0,\, \gamma=0$
(zkuste si to ovìøit tøeba Gaussovou eliminaèní metodou). 
Tak¾e pokus se zdaøil.
Z~rovnice\cite(sincos4) plyne\cite(sincos4a) 
a z ní pak $\alpha=0,\, \beta=0,\, \gamma=0$. To
podle definice znamená, ¾e vektory $f, g, h$ jsou lineárnì nezávislé.
\inl[lineární: nezávislost: funkcí]

\priklad [sincos42]
%%%%%%%%
Uva¾ujme lineární prostor v¹ech reálných funkcí definovaných na $\R$ a
v~nìm tøi funkce $f,g,h$, které jsou zadané tìmito vzorci:
$$
  f(x) = \sin^2(x), \quad  g(x) = 3\,\cos^2(x), \quad h(x) = 4 \quad \forall x\in\R.
$$
Ovìøíme, zda jsou tyto tøi funkce lineárnì nezávislé èi závislé. Polo¾íme
jejich lineární kombinaci rovnu nulové funkci:
$$
  \alpha\cdot\sin^2(x) + \beta\cdot3\,\cos^2(x) + \gamma\cdot 4 = 0 
  \quad \forall x\in\R \rce(sincos42)
$$
a zjistíme, jakých hodnot mohou nabývat koeficienty $\alpha, \beta, \gamma$.
Jako v~pøíkladu\cite[sincos4] zkusíme volit nìjaké tøi hodnoty $x$.
Po dosazení $x=0$, $x=\pi/2$ a $x=\pi$ dostáváme soustavu
$$\soustava{
            & 3\,\beta &+ 4\,\gamma &= 0, \cr
  \alpha \; &          &+ 4\,\gamma &= 0, \cr
            & 3\,\beta &+ 4\,\gamma &= 0.\, }
$$
Vidíme, ¾e jedna rovnice je zde napsaná dvakrát, tak¾e zbývají dvì
rovnice o~tøech neznámých. Taková soustava rovnic má
nekoneènì mnoho øe¹ení, jedním z~nich je napøíklad  
$\alpha=12,\, \beta=4,\, \gamma=-3$. To nám ale k~závìru o~lineární 
závislosti funkcí nestaèí, proto¾e my musíme najít
netriviální kombinaci rovnou nule pro v¹echna $x\in\R$, nikoli jen pro
tøi vyvolené hodnoty. Výsledek ale napovídá, jaké by mohly být 
koeficienty hledané netriviální lineární kombinace:
$$
  12\cdot\sin^2(x) + 4\cdot3\,\cos^2(x) - 3\cdot4 =
  12\,(\sin^2(x) + \cos^2(x)) - 12 = 0 \quad \forall\,x\in\R.
$$
Zde jsme vyu¾ili vzorce $\sin^2(x) + \cos^2(x) = 1$ pro v¹echa $x\in\R$.
Na¹li jsme tedy netriviální lineární kombinaci, která je rovna nulové
funkci na celém definièním oboru, a proto jsou funkce 
$f, g, h$ lineárnì závislé.
\inl[lineární: závislost: funkcí]

\poznamka
%%%%%%%%
Pøi vy¹etøování lineární nezávislosti funkcí mù¾eme té¾ vyu¾ít
derivací. Tøeba rovnost\cite(sincos4) má platit pro v¹echna $x\in\R$ a
tím pádem pro v¹echny derivace v libovolném bodì. Tøeba v~nule.
Pro $x=0$ je $\beta+4\gamma=0$, po zderivování máme 
$\alpha\cos(x)-\beta\sin(x)=0$ a dosazením $x=0$ dostaneme druhou
rovnost $\alpha=0$. Je¹tì jednou zderivjeme a dosadíme $x=0$, máme
$\beta=0$. Z první rovnosti plyne, ¾e tedy musí $\alpha=0$. V¹echny
koeficienty musejí být nulové, tak¾e vektory $f,g,h$ 
z~pøíkladu\cite[sincos4] jsou lineárnì nezávislé. 

Na druhé stranì postupným derivováním rovnosti\cite(sincos42) 
z~pøíkladu\cite[sincos42] a dosazením $x=0$ dostáváme 
rovnice: $3\beta+4\gamma=0$, $0=0$, $\alpha-3\beta=0$, $0=0$, $0=0$,
atd. (zkuste si sami zderivovat). Tak¾e máme jen dvì nenulové rovnice 
o~tøech neznámých, tedy $\alpha$, $\beta$, $\gamma$ mohou být
nenulové. Tento postup nám tedy nedává záruku nezávislosti 
funkcí~$f,g,h$ z pøíkladu\cite[sincos42].

\priklad
%%%%%%%%
Nech» $\vec u, \vec v, \vec w$ jsou prvky nìjakého (blí¾e
nespecifikovaného) lineárního prostoru. Pøedpokládejme, ¾e jsou
lineárnì nezávislé. Úkolem je zjistit, pro které $a\in\R$ jsou 
vektory 
$$
  \vec x = 2\,\vec u - \vec v, \quad
  \vec y = \vec u + 3\,\vec v - 2\,\vec w, \quad
  \vec z = \vec v + a\,\vec w
$$
lineárnì závislé.

Polo¾íme tedy lineární kombinaci vektorù $\vec x, \vec y, \vec z$
rovnu nulovému vektoru a budeme zji¹»ovat, jaké musí být koeficienty
$\alpha, \beta, \gamma$:
$$
  \alpha\,\vec x + \beta\,\vec y + \gamma\,\vec z = \vec o.
$$
Dosadíme: 
$$
  \alpha\,(2\,\vec u - \vec v) + 
  \beta\,(\vec u + 3\,\vec v - 2\,\vec w) +
  \gamma\,(\vec v + a\,\vec w) = \vec o
$$
a po úpravách dostáváme
$$
  (2\,\alpha + \beta)\,\vec u +
  (-\alpha + 3\,\beta + \gamma)\,\vec v + 
  (-2\,\beta + a\,\gamma)\,\vec w = \vec o.
$$
Proto¾e podle pøedpokladù jsou vektory $\vec u, \vec v, \vec w$
lineárnì nezávislé, musí být tato lineární kombinace jedinì triviální,
tj. v¹echny koeficienty jsou nulové:
$$\soustava{
  2\,\alpha &+ \1\,\beta &             &= 0, \cr
  {}-\alpha &+  3\,\beta &+ \1\,\gamma &= 0, \cr
            &-  2\,\beta &+  a\,\gamma &= 0.\, \cr}
$$  
Napøíklad pomocí Gaussovy eliminaèní metody se mù¾eme pøesvìdèit, ¾e
soustava má jediné øe¹ení $\alpha=0,\, \beta=0,\, \gamma=0$ pro
$7a+4\not=0$. V~takovém pøípadì budou vektory 
$\vec x, \vec y, \vec z$ lineárnì nezávislé.  
Jestli¾e naopak $7a+4=0$, má soustava nekoneènì mnoho øe¹ení, mezi kterými
se jistì najde i netriviální øe¹ení. Vektory $\vec x, \vec y, \vec z$
jsou tedy lineárnì závislé pro $a=-4/7$.

\okraj Jeden vektor je lineární kombinací ostatních |
       Jeden vektor je linearni kombinaci ostatnich

\veta* [xr]
%%%%%
Nech» $n\geq2$.
Vektory $\vecc x_n$ jsou lineárnì závislé
právì tehdy, kdy¾ existuje index $r\in\{1,\ldots,n\}$ takový, ¾e 
vektor $\vec x_r$ je roven lineární kombinaci ostatních vektorù.
\inl[lineární: závislost]

\dukaz
%%%%%%
Vìty formulované ve tvaru ekvivalence (výrok $A$ platí právì tehdy,
kdy¾ platí výrok $B$) se obvykle dokazují ve dvou krocích. Nejprve
doká¾eme, ¾e z~$A$ plyne $B$ a pak doká¾eme, ¾e z~$B$ plyne $A$.

Dokazujme tedy nejprve, ¾e z~lineární závislosti vektorù 
$\vecc x_n$ plyne existence indexu $r$
vý¹e uvedené vlastnosti. Z~definice lineární závislosti víme, ¾e
existuje netriviální lineární kombinace rovna nulovému vektoru, tj.
$$
  \lkvecc\alpha.x_n =
  \sum_{i=1}^n \alpha_i\,\vec x_i = \vec o,
  \rce (lknul)
$$
a pøitom aspoò jeden koeficient lineární kombinace je nenulový. 
Existuje tedy $r\in\{1,\ldots,n\}$ takové, ¾e $\alpha_r\not=0$.
Pøièteme nyní vektor $-\alpha_r\,\vec x_r$ k~obìma stranám 
rovnice\cite(lknul)
$$
  \sum_{\textstyle{i=1\atop i\not=r}}^n \alpha_i\,\vec x_i 
  = -\alpha_r\,\vec x_r.
$$
Po vynásobení obou stran rovnice koeficientem
$-1/\alpha_r$ dostáváme 
$$
  \sum_{\textstyle{i=1\atop i\not=r}}^n {\alpha_i\over-\alpha_r}\,\vec x_i 
  = \vec x_r.
$$
Vektor $\vec x_r$ je tedy roven lineární kombinaci ostatních vektorù.

V~druhé èásti dùkazu pøedpokládáme existenci koeficientu $r$ takového,
¾e vektor $\vec x_r$ je roven lineární kombinaci ostatních vektorù.
Doká¾eme lineární závislost vektorù $\vecc x_n$.
Pro nìjaké $r\in\{1,\ldots,n\}$ tedy platí
$$
  \vec x_r =
  \sum_{\textstyle{i=1\atop i\not=r}}^n \beta_i\,\vec x_i .
$$ 
Pøièteme-li k~obìma stranám této rovnice vektor $-\vec x_r$, dostáváme
$$
  \sum_{\textstyle{i=1\atop i\not=r}}^n \beta_i\,\vec x_i +
  (-1)\cdot\vec x_r = \vec o,
$$
co¾ je netriviální lineární kombinace vektorù $\vecc x_n$
(její $r$-tý koeficient je jistì
nenulový), která je rovna nulovému vektoru.

\pozn
%%%%%
Vìta\cite[xr] se dá pøeformulovat té¾ takto: vektory 
$\vecc x_n$ jsou lineárnì nezávislé právì
tehdy, kdy¾ ¾ádný z~vektorù $\vec x_i$, $i\in\{1,\ldots,n\}$, není
lineární kombinací ostatních vektorù.
\inl[lineární: závislost]


\okraj Základní vlastnosti lineární (ne)závislosti |
       Zakladni vlastnosti linearni (ne)zavislosti

\veta[lnlz]
%%%%%
Nech» $\vecc x_n$ jsou prvky nìjakého
lineárního prostoru~$L$. Pak platí:

\noindent
(1) Lineární závislost èi nezávislost vektorù 
$\vecc x_n$ se nezmìní pøi zmìnì poøadí 
tìchto vektorù.

\noindent
(2) Jestli¾e se mezi $\vecc x_n$ vyskytuje
nulový vektor, pak jsou tyto vektory lineárnì závislé.

\noindent
(3) Jestli¾e se ve skupinì vektorù $\vecc x_n$
nìkterý vektor vyskytuje aspoò dvakrát, je tato skupina vektorù
lineárnì závislá.

\noindent
(4) Jestli¾e jsou vektory $\vecc x_n$
lineárnì závislé a $\vec x_{n+1}\in L$, pak jsou i vektory
$\vecc x_n, \vec x_{n+1}$ lineárnì
závislé. 

\noindent
(5) Jestli¾e jsou vektory $\vecc x_n$
lineárnì nezávislé, pak jsou i vektory 
$\vecc x_{n-1}$ lineárnì nezávislé.

\noindent
(6) Samotný vektor $\vec x_1$ (chápaný ov¹em jako skupina vektorù 
o~jednom prvku) je lineárnì nezávislý právì tehdy, kdy¾ je nenulový.

\noindent
(7) Dva vektory jsou lineárnì závislé právì tehdy, kdy¾ jeden je
násobkem druhého.

\dukaz
%%%%%%
(1) Lineární kombinace vektorù $\vecc x_n$
nezávisí na jejich poøadí, proto¾e sèítání vektorù je 
podle definice\cite[dlp] komutativní.

(2) Vzhledem k~vlastnosti (1) staèí bez újmy na obecnosti
pøedpokládat, ¾e $\vec o=\vec x_1$. Pak platí:
$$
  1\cdot\vec o + 0\cdot\vec x_2 + 0\cdot\vec x_3 + \cdots
  + 0\cdot\vec x_n = \vec o,
$$
co¾ je netriviální lineární kombinace rovna nulovému vektoru.	

(3) Vzhledem k~vlastnosti (1) staèí bez újmy na obecnosti
pøedpokládat, ¾e $\vec x_1 = \vec x_2$. Pak platí:
$$
  1\cdot\vec x_1 + (-1)\cdot\vec x_2 + 0\cdot\vec x_3 + \cdots
  + 0\cdot\vec x_n = (1-1)\cdot\vec x_1 = \vec o,
$$
co¾ je netriviální lineární kombinace rovna nulovému vektoru.

(4) Podle pøedpokladu existuje netriviální lineární kombinace
$\lkvecc \alpha.x_n$ rovna nulovému vektoru.
Potom platí 
$$
 \alpha_1\,\vec x_1 + \cdots + \alpha_n\,\vec x_n + 0\cdot\vec x_{n+1} =
 \vec o,
$$
co¾ je netriviální lineární kombinace vektorù 
$\vecc x_n, \vec x_{n+1}$ rovna nulovému vektoru.

(5) Doká¾eme to sporem. Budeme pøedpokládat negaci tvrzení vìty (tj. ¾e 
vektory $\vecc x_{n-1}$ jsou lineárnì
závislé). Pak ale podle vlastnosti (4) musejí být lineárnì závislé i
vektory $\vecc x_n$, co¾ je spor s~pøedpokladem, ¾e tyto vektory 
jsou lineárnì nezávislé. 

(6) Je-li $\vec x_1 = \vec o$, pak je $\vec x_1$ 
podle vlastnosti (2) lineárnì závislý.
Pøedpokládejme nyní $\vec x_1 \not=\vec o$ a polo¾me 
$$
  \alpha\,\vec x_1 = \vec o.
$$
Kdyby bylo $\alpha\not=0$, pak dostáváme spor s vlastností (3)
vìty\cite[nulprvek]. Musí tedy být $\alpha=0$. To znamená, ¾e pouze
triviální lineární kombinace je rovna nulovému vektoru, 
tak¾e vektor $\vec x_1$ je lineárnì nezávislý. 

(7) Tvrzení je shodné s vìtou\cite[xr] pro $n=2$.


\pozn
%%%%%
Vlastnost (4) pøedchozí vìty nelze \uv{obrátit}. 
Pøesnìji: z~lineární závislosti
vektorù $\vecc x_n$ neplyne nic o~lineární
závislosti èi nezávislosti vektorù 
$\vecc x_{n-1}$. Mù¾e se tøeba stát, ¾e
vektory $\vecc x_{n-1}$ jsou lineárnì
nezávislé a lineární závislost vektorù $\vecc x_n$
je zpùsobena tím, ¾e vektor $\vec x_n$ je nulový. 
Mù¾e se ale také stát, ¾e vektory $\vecc x_{n-1}$ 
zùstávají lineárnì závislé.

Vlastnost (5) pøedchozí vìty nelze \uv{obrátit}.
Pøesnìji: z~lineární nezávislosti vektorù 
$\vecc x_n$ neplyne nic o~lineární
závislosti èi nezávislosti vektorù 
$\vecc x_{n+1}$. Vektor $\vec x_{n+1}$ toti¾ mù¾e být
nulový, ale také mù¾e být takový, ¾e vektory 
$\vecc x_{n+1}$ zùstávají lineárnì nezávislé.


\priklad [lzRn]
%%%%%%%%
Nech» $\vecc x_m$ jsou vektory z~lineárního prostoru $\R^n$. Uká¾eme,
¾e pokud $m>n$, jsou nutnì tyto vektory lineárnì závislé.

Podle definice lineární závislosti hledejme netriviální lineární
kombinaci, pro kterou
$$
  \lkvecc \alpha.x_m = \vec o.
$$
Rozepsáním tohoto po¾adavku do slo¾ek dostáváme $n$ rovnic o~$m$
neznámých. Proto¾e pravé strany rovnic jsou nulové, soustava má
urèitì aspoò triviální øe¹ení. Proto¾e je v~soustavì více neznámých 
ne¾ rovnic existuje nekoneènì mnoho øe¹ení této soustavy. Mezi 
tìmito øe¹eními je jen jediné triviální a v¹echna ostatní 
jsou netriviální. 

Poznamenejme, ¾e pøíklad ukazuje dùle¾itou vlastnost lineárních
prostorù $\R^n$: v¹echny lineárnì nezávislé skupiny vektorù mají 
poèet vektorù men¹í nebo roven $n$. Podobné tvrzení pro libovolné
lineární prostory vyslovíme ve vìtì\cite[123]. 

\okraj Závislost\hb oriento\-vaných\hb úseèek | Zavislost orientovanych usecek 

\priklad [UOlnlz]
%%%%%%%%
Uva¾ujme lineární prostor $U_O$ v¹ech orientovaných úseèek 
z~pøíkladu\cite[lpvv]. 
\inl[prostor: UO, prostor: orientovaných úseèek]

(1) Le¾í-li dvì úseèky $\vec u, \vec v\in U_O$ 
ve stejné pøímce, pak jsou lineárnì závislé, proto¾e 
jedna je násobkem druhé. Nele¾í-li úseèky $\vec u, \vec v$ 
ve spoleèné pøímce, pak jsou lineárnì nezávislé. 

(2) Nech» $\vec u, \vec v\in U_O$ jsou lineárnì nezávislé. Pak mno¾ina v¹ech
lineárních kombinací $\alpha\,\vec u + \beta\,\vec v$ vyplòuje mno¾inu
v¹ech úseèek, které mají koncový bod v~rovinì urèené úseèkami 
$\vec u, \vec v$.

Abychom to dokázali, potøebujeme urèitou pøedstavivost a
zku¹enosti s~euklidovskou geometrií. Pøipomeòme, ¾e $O$ znaèí
spoleèný poèátek v¹ech orientovaných úseèek na¹eho lineárního prostoru.
Zvolme nyní libovolnou orientovanou úseèku $\vec x$ s~poèátkem v~$O$, 
která le¾í v~rovinì urèené úseèkami $\vec u, \vec v$.
Uká¾eme, ¾e existují $\alpha,\beta\in\R$ tak, 
¾e $\vec x = \alpha\,\vec u + \beta\,\vec v$.
Le¾í-li $\vec x$ na spoleèné pøímce s~úseèkou $\vec u$ nebo na pøímce
spoleèné s~úseèkou $\vec v$, pak je $\vec x$ násobkem této úseèky
a druhý koeficient hledané lineární kombinace je nulový.
Nech» tedy $\vec x$ nele¾í na ¾ádné z~tìchto pøímek.
Nakreslíme na tyto pøímky mìøítka, jako v pøíkladu\cite[lpvv].
Koncový bod úseèky $\vec x$ oznaème~$X$.
Veïme bodem $X$ rovnobì¾ky s~obìma mìøítky.
Hodnota na mìøítku podél vektoru $\vec u$ v místì prùseèíku rovnobì¾ky 
s mìøítkem je èíslo $\alpha$. Èíslo $\beta$ je pak v místì prùseèíku
druhé rovnobì¾ky na druhém mìøítku.
Z~definice sèítání orientovaných úseèek pomocí
rovnobì¾níka vidíme, ¾e $\vec x = \alpha\,\vec u + \beta\,\vec v$.
Udìlejte si náèrtek.
\inl[geometrie: euklidovská, euklidovská: geometrie]

(3) Le¾í-li tøi useèky $\vec u, \vec v, \vec w\in U_O$ ve spoleèné rovinì, pak
jsou lineárnì závislé, proto¾e z~(2) plyne,
¾e jedna z~nich je lineární kombinací ostatních. Dále pou¾ijeme
vìtu\cite[xr]. 

(4) Pokud $\vec u$ a $\vec v\in U_O$ jsou lineárnì nezávislé a 
$\vec w$ le¾í mimo rovinu danou úseèkami $\vec u, \vec v$, pak
jsou $\vec u, \vec v, \vec w$ lineárnì nezávislé.

(5) Nech» $\vec u, \vec v, \vec w\in U_O$ jsou lineárnì nezávislé. 
Pak mno¾ina v¹ech lineárních kombinací 
$$
  \alpha\,\vec u + \beta\,\vec v + \gamma\,\vec w
$$ 
vyplòuje celý lineární prostor $U_O$. 

Abychom to dokázali, potøebujeme opìt urèitou pøedstavivost. 
%a zku¹enosti s~Eukleidovskou geometrií. 
Nech» $\varrho$ je rovina urèená
úseèkami $\vec u$ a $\vec v$. Uká¾eme, ¾e pro libovolnou orientovanou
úseèku $\vec x$ s~poèátkem v~$O$ existují reálná èísla
$\alpha,\beta,\gamma$ taková, ¾e 
$\vec x = \alpha\,\vec u + \beta\,\vec v + \gamma\,\vec w$.
Le¾í-li $\vec x$ v~rovinì $\varrho$, polo¾íme $\gamma=0$ a dále
vyu¾ijeme výsledku z~(2). Nech» tedy $\vec x$ nele¾í v~rovinì
$\varrho$. Oznaème $X$ koncový bod úseèky $\vec x$. Veïme bodem $X$
rovnobì¾ku s~úseèkou $\vec w$. Ta nutnì protne rovinu $\varrho$ 
v~nìjakém bodì $P$. Podle (2) existují $\alpha,\beta\in\R$ takové, ¾e
$\vector{OP}=\alpha\,\vec u + \beta\,\vec v$. V~rovinì urèené vektory
$\vec x$ a $\vec w$ veïme rovnobì¾ku s~vektorem $\vector{OP}$. Ta
protne mìøítko procházející vektorem $\vec w$ v~místì s~hodnotou $\gamma$.
Je $\vec x=\vector{OP}+\gamma\,\vec w = 
\alpha\,\vec u + \beta\,\vec v + \gamma\,\vec w$.


\okraj Lineární (ne)závislost nekoneèných mno¾in |
       Linearni (ne)zavislost nekonecnych mnozin

\pozn
%%%%%
A¾ dosud jsme pracovali s~pojmem lineární závislost èi nezávislost
koneèných {\em skupin\/} vektorù. Skupina, na rozdíl od mno¾iny, mù¾e
obsahovat stejné prvky a je v¾dy koneèná. V~následující definici roz¹íøíme pojem 
lineární závislost èi nezávislost na koneèné i nekoneèné
{\em mno¾iny\/} vektorù. Definice lineární závislosti se
mù¾e jevit ponìkud nepøímoèará. Je to tím, ¾e mno¾iny vektorù mohou
být nekoneèné, a pøitom nelze sestavovat nekoneèné lineární 
kombinace vektorù.

\definice* [neklz]
%%%%%%%%%
Nech» $L$ je lineární prostor a nech» $M\subseteq L$ je
neprázdná mno¾ina vektorù.
Mno¾ina $M$ je {\em lineárnì závislá}, pokud existuje koneènì mnoho
rùzných vektorù z $M$, které jsou lineárnì závislé. Mno¾ina $M$ je 
{\em lineárnì nezávislá}, pokud není lineárnì závislá. Tedy pokud 
neexistuje ¾ádná její koneèná lineárnì závislá podmno¾ina.

Prázdnou mno¾inu pova¾ujeme v¾dy za lineárnì nezávislou.

\pozn* [lzmnozin]
%%%%%
Uvìdomíme si podrobnìji základní vlastnost lineárnì závislých mno¾in.
Mno¾ina vektorù $M$ je lineárnì závislá, právì kdy¾ existuje koneènì mnoho
vektorù z této mno¾iny, které jsou lineárnì závislé. Podle
vìty\cite[xr] to znamená, ¾e existuje jeden vektor $\vec z\in M$, který je roven
lineární kombinaci koneènì mnoha jiných vektorù z~této mno¾iny.

\pozn [lnnekmnozin]
Uvìdomíme si podrobnìji základní vlastnost lineárnì nezávislých mno¾in.

Neprázdná koneèná mno¾ina vektorù 
$\{\vecc x_n\}$
je lineárnì nezávislá, právì kdy¾ jsou vektory 
$\vecc x_n$ lineárnì nezávislé (odkazujeme na definici\cite[LNskupiny]).

Z opakovaného pou¾ití vlastnosti~(5) vìty\cite[lnlz] 
(nebo z~vìty\cite[xr]) toti¾ plyne, ¾e je-li koneèná
mno¾ina vektorù $K$ lineárnì nezávislá, pak v¹echny
její podmno¾iny $K'\subseteq K$ jsou lineárnì nezávislé.

Nekoneèná mno¾ina vektorù $M\subseteq L$ je podle definice\cite[neklz]
lineárnì nezávislá, pokud v¹echny její koneèné podmno¾iny $K\subseteq M$
jsou lineárnì nezávislé. 

Nech» nekoneèná mno¾ina $M\subseteq L$ je lineárnì nezávislá a $M'\subseteq M$
je její nekoneèná podmno¾ina. Pak $M'$ musí být také lineárnì nezávislá,
proto¾e v¹echny její koneèné podmno¾iny jsou té¾ koneènými
podmno¾inami mno¾iny $M$. Tak¾e dostáváme následující vìtu, ve které u¾
nerozli¹ujeme mezi koneènými a nekoneènými (pod)mno¾inami:

\veta* [lnmnoz]
%%%%%
Je-li mno¾ina vektorù $M$ v lineárním prostoru $L$ je lineárnì nezávislá,
pak ka¾dá její podmno¾ina je lineárnì nezávislá.
 
\dukaz
Viz poznámku\cite[lnnekmnozin].

\poznamka
%%%%%%%%%
Vìtu\cite[lnmnoz] nelze obrátit ve smyslu, ¾e pokud ka¾dá
mno¾ina $N\subset M$, $N\not=M$, 
je lineárnì nezávislá, pak je $M$ lineárnì
nezávislá. Toto neplatí. Pøedstavme si tøi orientované úseèky
lineárního prostoru $U_O$ (viz pøíklad\cite[lpvv]) le¾ící
ve spoleèné rovinì, ale ¾ádné dva nele¾í na spoleèné pøímce. Mno¾inu
tìchto tøí vektorù oznaème~$M$. Pak ka¾dá
podmno¾ina $N$ mno¾iny $M$, $N\not=M$, je lineárnì nezávislá, ale $M$ je
lineárnì závislá.

\priklad [lnpolynomy]
%%%%%%%%
Nech» $M=\{1,x,x^2,x^3, \ldots\}$ je nekoneèná podmno¾ina lineárního
prostoru v¹ech polynomù $P$. Uká¾eme, ¾e $M$ je lineárnì nezávislá.

Podle definice\cite[neklz] a poznámky\cite[lnnekmnozin]
staèí ukázat, ¾e ka¾dá koneèná podmno¾ina
polynomù
$$
  K=\{x^{k_1}, x^{k_2}, \ldots, x^{k_n}\}, \quad 
  n\in\N, \quad k_i\in\N\cup\{0\} \hbox { pro } i\in\{1,2,\ldots,n\}, 
  \quad k_1<k_2<\cdots<k_n 
$$
je lineárnì nezávislá. Polo¾me tedy lineární kombinaci prvkù mno¾iny 
$K$ rovnu nulovému polynomu:
$$
  \alpha_1\,x^{k_1} + \alpha_2\,x^{k_2} + \cdots + 
  \alpha_n\,x^{k_n} = 0 \quad \forall\,x\in\R
$$
a ptejme se, co z~toho plyne pro koeficienty $\alpha_1, \ldots, \alpha_n$.
Proto¾e $k_1<k_2<\cdots<k_n$, odpovídají
èísla $\alpha_1, \ldots, \alpha_n$ vybraným koeficientùm polynomu.
Nulový polynom je ov¹em pouze takový polynom, který má v¹echny
koeficienty nulové 
\ifbook (doká¾eme to podrobnì ve vìtì\cite[pnulovy])\fi. 
Tak¾e v¹echna èísla $\alpha_1, \ldots, \alpha_n$
musejí být rovna nule. Nulovému polynomu se tedy rovná pouze triviální
lineární kombinace, tak¾e mno¾ina $K$ je lineárnì nezávislá.
\inl[polynom]


\okraj Lineární\hb obal | Linearni obal 

\definice* [linobal]
%%%%%%%%%
Nech» $L$ je lineární prostor. 
{\em Lineární obal}
skupiny vektorù $\vecc x_n$ znaèíme $\lob<\vecc x_n>$ a je to mno¾ina v¹ech
lineárních kombinací vektorù $\vecc x_n$. 

Nech» dále $M\subseteq L$
je neprázdná mno¾ina vektorù. 
{\em Lineární obal\/} mno¾iny vektorù $M$
je mno¾ina v¹ech koneèných lineárních kombinací
vektorù z~$M$. 
Lineární obal mno¾iny $M$ znaèíme symbolem $\lob<M>$.

Lineární obal prázdné mno¾iny definujeme jako jednoprvkovou mno¾inu
obsahující nulový vektor.


\poznamka [poznkonlob]
%%%%%%%%
Podle definice\cite[linobal] je
$$
  \lob<\vecc x_n> = \{\lkvecc\alpha.x_n;\,
                    \alpha_1\in\R,\alpha_2\in\R,\ldots,\alpha_n\in\R\}.
$$
Je zøejmé, ¾e $\lob<\vecc x_n> = \lob<\{\vecc x_n\}>$.
Na pravé stranì této rovnosti sice jsou pøidány i lineární kombinace
v¹ech koneèných podmno¾in mno¾iny $\{\vecc x_n\}$, ale ty se dají
zapsat jako lineární kombinace v¹ech vektorù $\vecc x_n$. Staèí toti¾
vektory mimo koneèný výbìr násobit nulou.

\poznamka
%%%%%%%%%
V lineární algebøe se nikdy nepracuje s nekoneèným souètem násobkù vektorù,
v¹echny lineární kombinace musejí být v¾dy tvoøeny koneèným souètem.
Definice\cite[linobal] pøipou¹tí, ¾e mno¾ina vektorù $M$ mù¾e být
nekoneèná, ale i v takovém pøípadì lineární obal sestavujeme z
{\em koneèných\/} souètù, tj. vybíráme koneèné podmno¾iny vektorù z~$M$, ze
kterých sestavujeme lineární kombinace. Samozøejmì, ¾e takových výbìrù
mù¾e být nekoneènì mnoho a z ka¾dého koneèného výbìru vektorù mù¾eme sestavit
nekoneènì mnoho lineárních kombinací. Tak¾e lineární obal je nekoneèná
mno¾ina (s~jedinou výjimkou: lineární obal nulového vektoru nebo
prázdné mno¾iny). 

\priklad
%%%%%%%%
Uva¾ujme lineární prostor $\R^3$.
Najdeme lineární obal vektorù $x=(1,2,3)$, $y=(2,-1,0)$.
Podle poznámky\cite[poznkonlob] je
$$
  \lob<(1,2,3), (2,-1,0)> = \{\alpha\,(1,2,3) + \beta\,(2,-1,0);\,
                            \alpha\in\R, \beta\in\R\} =
                            \{(\alpha+2\beta, 2\alpha-\beta, 3\alpha);\,
                            \alpha\in\R, \beta\in\R\}.
$$

\priklad [obaltrojky]
%%%%%%%%
Jsou dány $\vec x=(1,2,3)$, $\vec y=(1,0,2)$, $\vec z=(-2,1,0)$.
Uká¾eme, ¾e $\lob<\vec x, \vec y, \vec z> = \R^3$.

Mno¾ina lineárních kombinací prvkù nìjakého lineárního prostoru $L$
je v¾dy podmno¾inou $L$. Jde tedy pouze o~to ukázat, ¾e
$\R^3\subseteq\lob<\vec x, \vec y, \vec z>$.
Volme libovolný vektor $(a,b,c)\in\R^3$. Uká¾eme, ¾e 
$(a,b,c)$ le¾í v~$\lob<\vec x, \vec y, \vec z>$. K~tomu je potøeba najít
lineární kombinaci vektorù $\vec x, \vec y, \vec z$, která je
rovna vektoru $(a,b,c)$.  Hledejme tedy koeficienty $\alpha,\beta,\gamma$,
pro které platí
$$
  (a,b,c) = \alpha\,(1,2,3) + \beta\,(1,0,2) + \gamma\,(-2,1,0).
$$
Po úpravì a porovnání jednotlivých slo¾ek dostáváme soustavu
$$\soustava{
 \1\alpha &+ \1\beta &-  2\gamma &=& a, \cr
  2\alpha &          &+ \1\gamma &=& b, \cr
  3\alpha &+  2\beta &           &=& c.\,  }
$$
Napøíklad Gaussovou eliminaèní metodou zjistíme, ¾e soustava má øe¹ení pro
v¹echna $a,b,c\in\R$. Proto $(a,b,c)\in\lob<\vec x, \vec y, \vec z>$.

\okraj Prvek lineárního obalu | Prvek linearniho obalu 

\poznamka [poznlob]
%%%%%%%%%
Zamysleme se nad tím, co to znamená, ¾e $\vec z\in\lob<M>$. 
Vektor $\vec z$ je lineární kombinací nìjakého koneèného výbìru vektorù z
mno¾iny $M$.

Vidíme tedy, ¾e $\vec z\in\lob<M>$ právì tehdy, kdy¾ existuje koneènì
mnoho vektorù $\vecc x_n \in M$ a existují
reálná èísla $\alpha_1, \alpha_2, \ldots, \alpha_n$ taková, ¾e
$$
  \vec z = \lkvecc\alpha.x_n.
  \rce (zinlob)
$$

\okraj Vlastnosti lineárního obalu | Vlastnosti linearniho obalu

\veta* [loblob]
%%%%%
Nech» $L$ je lineární prostor a $M\subseteq L$. Pak platí:
$$\eqalign{
\bod (1) M\subseteq \lob<M>. \cr
\bod (2) \hbox{Je-li $N\subseteq M$, pak $\lob<N>\subseteq\lob<M>$}. \cr
\bod (3) \lob<M> = \lob<{\lob<M>}>. \cr
\bod (4) \hbox{Je-li } \vec z\in\lob<M>, \hbox{ pak }
         \lob<M>=\lob<M\cup\{\vec z\}>.
}
$$
\par\inl[lineární: obal]

\dukaz
%%%%%%
(1) Staèí ukázat, ¾e pokud $\vec z\in M$ pak $\vec z\in\lob<M>$.
Platí $\vec z = 1\cdot\vec z$, tak¾e pro $\vec z$ existuje koneènì
mnoho prvkù z~$M$ (jmenovitì prvek $\vec z$ samotný)
tak, ¾e $\vec z$ je lineární kombinací tìchto prvkù. To podle 
poznámky\cite[poznlob] znamená, ¾e $\vec z\in\lob<M>$.

(2) Nech» $\vec z\in\lob<N>$, tj. pøedpokládáme, ¾e 
$\vec z$ lze zapsat jako lineární
kombinaci koneènì mnoha prvkù z~$N$. Proto¾e tyto prvky le¾í i v~$M$,
mù¾eme øíci, ¾e $\vec z$ lze zapsat jako lineární kombinaci 
koneènì mnoha prvkù z~$M$. 
To podle poznámky\cite[poznlob] znamená, ¾e $\vec z\in\lob<M>$.

(3) Vzhledem k~(1) a (2)
je $\lob<M>\subseteq\lob<{\lob<M>}>$. 
Staèí tedy ukázat, ¾e $\lob<{\lob<M>}>\subseteq\lob<M>$.
Nech» $\vec z\in\lob<{\lob<M>}>$, uká¾eme ¾e $\vec z\in\lob<M>$.
Proto¾e $\vec z\in\lob<{\lob<M>}>$, existují vektory
$\vecc x_n \in\lob<M>$ takové, ¾e
platí\cite(zinlob). Pro ka¾dé $i\in\{1,\ldots,n\}$ je
$\vec x_i\in\lob<M>$, tj. existuje koneènì mnoho vektorù
$\vec y_{i,1}, \ldots, \vec y_{i,k_i} \in M$ takových, ¾e 
$$
  \vec x_i = \beta_{i,1}\,\vec y_{i,1} + \cdots +
             \beta_{i,k_i}\,\vec y_{i,k_i}.
$$
Dosazením tìchto rovnic do\cite(zinlob) a roznásobením dostáváme
výsledek, ¾e $\vec z$ je lineární kombinací koneènì mnoha vektorù 
$\vec y_{i,j}\in M$, $i\in\{1,\ldots,n\}, j\in\{1,\ldots,k_i\}$.
To znamená, ¾e $\vec z\in\lob<M>$.

(4) Proto¾e $M\subseteq M\cup\{\vec z\}$, je podle (2)
$\lob<M>\subseteq \lob<M\cup\{\vec z\}>$.
Proto¾e $\vec z\in\lob<M>$, je $M\cup\{\vec z\} \subseteq\lob<M>$
a podle (2) a (3) dostáváme $\lob<M\cup\{\vec z\}>\subseteq\lob<{\lob<M>}>=\lob<M>$.
Máme tedy $\lob<M>\subseteq \lob<M\cup\{\vec z\}>\subseteq\lob<M>$,
tak¾e v~místì inkluzí musí být rovnost.

\pozn
%%%%%
Vlastnost (1) vìty\cite[loblob] lidovì øeèeno znamená, ¾e \uv{lineární
obalení} mno¾iny mù¾e pøidat do této mno¾iny dal¹í prvky, ale pokud
tento proces zopakujeme, dal¹í prvky u¾ podle vlastnosti~(3) nezískáme.

Takové mno¾iny, které pøi \uv{lineárním obalení} ji¾ nepøidávají ¾ádné
dal¹í prvky, jsou v¾dy lineárními podprostory. To ukazuje následující vìta.

\okraj Lineární\hb obal je\hb podprostor | Linearni obal je podprostor

\veta* [lob=lpp]
%%%%%
Nech» $L$ je lineární prostor, $M\subseteq L$. Mno¾ina $M$ je
lineárním podprostorem lineárního prostoru $L$ právì tehdy, kdy¾
$\lob<M>=M$.
\inl[lineární: obal, lineární: podprostor, podprostor: lineární]

\dukaz
%%%%%%
Doká¾eme nejprve \uv{je-li $M$ lineární podprostor, pak $\lob<M>=M$}.
Vezmeme $\vec z\in\lob<M>$ a doká¾eme, ¾e $\vec z\in M$.
Proto¾e $\vec z\in\lob<M>$, existuje koneènì mnoho vektorù
$\vecc x_n\in M$ takových, ¾e lze psát $\vec z=\lkvecc\alpha.x_n$.
Ka¾dý sèítanec le¾í podle vlastnosti (2) definice\cite[dlpp]
v~mno¾inì $M$. Podle vlastnosti (1) definice\cite[dlpp]
v~mno¾inì $M$ le¾í i souèet tìchto vektorù, tedy $\vec z\in M$.

Zbývá dokázat \uv{je-li $\lob<M>=M$, pak $M$ je lineární podprostor}.
Uva¾ujme $\vec x\in M,\, \vec y\in M$.
Abychom dokázali, ¾e $M$ je lineární podprostor, staèí ovìøit, ¾e 
lineární kombinace $1\cdot\vec x + 1\cdot\vec y$ le¾í v~$M$ a dále
$\alpha\cdot\vec x + 0\cdot\vec y$ le¾í v~$M$.
Proto¾e $\vec x\in M$, $\vec y\in M$, je podle definice lineárního
obalu ka¾dá jejich lineární kombinace prvkem $\lob<M>$ a podle
pøedpokladu je $\lob<M>=M$. V~mno¾inì $M$ tedy le¾í 
i uvedené dvì lineární kombinace vektorù $\vec x,\vec y$.

\veta* [lobjemin]
%%%%%
Nech» $L$ je lineární prostor a $M\subseteq L$ je libovolná neprázdná mno¾ina.
Pak $P=\lob<M>$ je nejmen¹í lineární podprostor, pro který platí
$M\subseteq P$.
\inl[lineární: obal, lineární: podprostor, podprostor: lineární]

\dukaz
%%%%%%
Proto¾e $\lob<P>=\lob<{\lob<M>}> = \lob<M> = P$, je podle vìty\cite[lob=lpp]
zøejmé, ¾e $P$ je lineární podprostor. 
Staèí ukázat, ¾e $P$ je nejmen¹í podprostor s vlastností $M\subseteq P$.

Nech» $Q$ je nìjaký podprostor, pro který také platí $M\subseteq Q$.
Podle vìty\cite[lob=lpp] je $\lob<Q>=Q$. Dále pou¾ijeme 
(2)~vìty\cite[loblob] na inkluzi $M\subseteq Q$ a dostáváme
$P=\lob<M>\subseteq\lob<Q>=Q$.

\definice
%%%%%%%%%
Nech» $P$ je lineární podprostor lineárního prostoru $L$.
Mno¾ina vektorù $M$, pro kterou platí $\lob<M>=P$, se nazývá
{\em mno¾ina generátorù\/} lineárního podprostoru $P$. Je-li
$\lob<\vecc x_n>=P$, pak také øíkáme, ¾e {\em vektory $\vecc x_n$ generují\/}
lineární podprostor $P$. Skuteènost, ¾e vektory generují lineární
podprostor $P$ není nic jiného, ne¾ ¾e mno¾ina v¹ech jejich lineárních
kombinací \uv{vyplní} celý podprostor $P$.
\inl[mno¾ina: generátorù, vektory: generující podprostor]

\okraj Roz¹íøení\hb LN mno¾iny |
       Rozsireni LN mnoziny 

\veta* [pridanivektoru]
%%%%%
Nech» $L$ je lineární prostor, $M\subseteq L$ je lineárnì nezávislá
mno¾ina a $\vec z\not\in \lob<M>$. Pak té¾ $M\cup\{\vec z\}$ je lineárnì
nezávislá mno¾ina.
\inl[lineární: obal, lineární: nezávislost]

\dukaz
%%%%%%
Dùkaz povedeme sporem. Pøedpokládejme, ¾e 
$M\cup\{\vec z\}$ je lineárnì závislá. Pak existuje
koneènì mnoho prvkù $\vecc x_n \in M$ takových, ¾e
$\lkvecc \alpha.x_n + \alpha_{n+1}\,\vec z $
je netriviální lineární kombinace rovna nulovému vektoru. 
Pro $\alpha_{n+1}=0$ zùstává netriviální lineární kombinace 
vektorù $\vecc x_n$ rovna nulovému vektoru, neboli koneèná 
podmno¾ina $M$ je lineárnì závislá. To je ve sporu s~tím, 
¾e $M$ je lineárnì nezávislá.

Pro $\alpha_{n+1}\not=0$ je vektor $\vec z$ lineární kombinací vektorù
$\vecc x_n$ (pøevedeme násobek vektoru $\vec z$ na druhou stranu
rovnosti a podìlíme $-\alpha_{n+1}$, jako v~dùkazu vìty\cite[xr]). 
To je ve sporu s~tím, ¾e $\vec z\not\in\lob<M>$. Pro oba 
pøípady hodnot $\alpha_{n+1}$ dostáváme spor, tak¾e 
$M\cup\{\vec z\}$ nemù¾e být lineárnì závislá.


\veta [lnMcupN]
%%%%%
Nech» $M$ a $N$ jsou lineárnì nezávislé mno¾iny v lineárním prostoru
$L$ a pøedpokládejme, ¾e $\lob<M>\cap\lob<N>=\{\vec o\}$. Pak mno¾ina
$M\cup N$ je lineárnì nezávislá.

\dukaz
Lineární nezávislost mno¾iny $M\cup N$ vyplyne z toho, 
¾e ka¾dá koneèná lineární kombinace
vektorù $\vecc x_m$ z~$M$ a vektorù $\vecc y_n$ z~$N$
(dohromady), která je rovna nulovému vektoru, je triviální.
Polo¾me tedy
$$
  (\alpha_1\vec x_1 + \alpha_2\vec x_2 + \cdots + \alpha_m\vec x_m) +
  (\beta_1\vec y_1 + \beta_2\vec y_2 + \cdots + \beta_m\vec y_m) = \vec o
$$ 
a oznaème první závorku $\vec a$ a druhou $\vec b$. Zøejmì je
$\vec a\in\lob<M>$ a $\vec b\in\lob<N>$. Proto¾e je 
$\vec a=-\vec b$ (jinak by souèet nemohl být roven nulovému vektoru), je také
$\vec a\in\lob<N>$. Tak¾e $\vec a\in\lob<M>\cap\lob<N>$ a podle
pøedpokladu je $\vec a=\vec o$. Proto¾e je $M$ lineárnì nezávislá,
musí být lineární kombinace v první závorce pouze triviální. Je toti¾
rovna nulovému vektoru $\vec a$. Proto¾e je $N$ lienárnì nezávislá,
musí být lineární kombinace v druhé závorce pouze triviální. Je toti¾
rovna nulovému vektoru $-\vec a$. Tak¾e zkoumaná lineární kombinace
v¹ech vektorù $\vecc x_m, \vecc y_n$ je triviální.

\poznamka
%%%%%%%%%
Pøedpoklad $\lob<M>\cap\lob<N>=\{\vec o\}$ 
ve vìtì\cite[lnMcupN] je nutný. Pøíklad
$M=\{(1,0,0), (0,1,0)\}$, $N=\nobreak\{(1,0,1), (0,1,1)\}$ ilustruje situaci,
kdy obì mno¾iny jsou lineárnì nezávislé, mno¾ina $M$ le¾í mimo
$\lob<N>$ a mno¾ina $N$ le¾í mimo $\lob<M>$, a pøesto je mno¾ina
$M\cup N$ lineárnì závislá.


\okraj Charakte\-ristiky\hb LN mno¾iny |
       Charakteristiky LN mnoziny 

\veta [N=N1cupN2]
%%%%%
Nech» $N$ je lineárnì nezávislá mno¾ina v linerním prostoru $L$ a
nech» $N_1$ a $N_2$ jsou její disjunktní podmno¾iny 
(tj. $N_1\cap N_2=\emptyset$). Pak $\lob<N_1>\cap\lob<N_2>=\{\vec o\}$.

\exdukaz
%%%%%%
Pøedpokládejme $\vec x\in\lob<N_1>\cap\lob<N_2>$.
Uká¾eme, ¾e musí $\vec x=\vec o$. 
Vektor $\vec x$ je koneènou lineární kombinací vektorù
$\vecc x_m$ z $N_1$ a je také koneènou lineární kombinací vektorù 
$\vecc y_k$ z $N_2$, tedy
$$
  \eqalign{
  \vec x &= \lkvecc \alpha.x_m, \quad 
  \vec x = \lkvecc \beta.y_k,\cr\hbox{tak¾e:}\quad
  \vec x-\vec x=\vec o &= \lkvecc \alpha.x_m 
   - \beta_1\vec y_1 - \beta_2\vec y_2 - \cdots - \beta_k\vec y_k
}
$$
Lineární kombinace 
$\lkvecc \alpha.x_m - \beta_1\vec y_1 - \beta_2\vec y_2 - \cdots - \beta_k\vec y_k$ 
je kombinací koneènì mnoha rùzných
vektorù z mno¾iny $N$ a tato mno¾ina je podle pøedpokladu linárnì
nezávislá. Proto¾e je tato
lineární kombinace rovna nulovému vektoru, musí být triviální.
Tak¾e také $\lkvecc \alpha.x_m$ je triviální lineární kombinace a to
znamená, ¾e $\vec x = 0\,\vec x_1 + 0\,\vec x_2 + \cdots + 0\,\vec x_m = \vec o$.

\veta [lnlob]
%%%%%
Nech» $L$ je lineární prostor. Mno¾ina $N\subseteq L$ je lineárnì nezávislá
právì tehdy, kdy¾ pro v¹echny vlastní podmno¾iny $M\subset N$,
$M\not=N$ platí $\lob<M>\subset\lob<N>$, $\lob<M>\not=\lob<N>$.
\inl[lineární: obal, lineární: nezávislost]

\exdukaz
%%%%%%
Pøedpokládejme nejprve, ¾e $N$ je lineárnì nezávislá. Nech» 
$M\subset N$, $M\not=N$.
Zvolme vektor $\vec z\in N$ takový, ¾e $\vec z\not\in M$. 
Vektor $\vec z$ nelze vyjádøit jako lineární
kombinaci ¾ádné koneèné podmno¾iny prvkù mno¾iny $M$. Kdyby to bylo mo¾né,
byla by mno¾ina $N$ lineárnì závislá a ona není.
Platí tedy, ¾e $\vec z\not\in\lob<M>$, a pøitom $\vec z\in\lob<N>$. 

Pøedpokládejme nyní, ¾e $N$ je lineárnì závislá. 
Pak podle poznámky\cite[lzmnozin] existuje vektor $\vec z\in N$, který
je roven lineární kombinaci koneènì mnoha ostatních vektorù z $N$, 
tak¾e $\vec z\in\lob<M>$, kde $M=N\setminus\{\vec z\}$.
Podle vlastnosti (4) vìty\cite[loblob] je $\lob<M>=\lob<M\cup\{\vec z\}>$,
jinými slovy $\lob<M>=\lob<N>$.
 
\shrnuti
%%%%%%%%
V této kapitole jsme definovali lineární závislost a nezávislost 
vektorù~/\ncite[LZskupiny], \ncite[poznlz], \ncite[LNskupiny], 
\ncite[neklz]/. Vektory jsou lineárnì závislé, pokud exituje
netriviální lineární kombinace tìchto vektorù rovnající se nulovému
vektoru. To je ekvivalentní s tím, ¾e existuje jeden vektor, který je
lineární kombinací ostatních\lcite[xr]. Vektory jsou lineárnì
nezávislé, pokud jen jejich triviální lineární kombinace je rovna
nulovému vektoru. Tedy pokud neexistuje ¾ádný takový vektor, který by
byl lineární kombinací ostatních.

Nekoneèná mno¾ina vektorù je lineárnì závislá, pokud existuje její koneèná 
lineárnì závislá podmno¾ina. Nekoneèná mno¾ina je lineárnì nezávislá,
pokud ka¾dá její koneèná mno¾ina je lineárnì nezávislá.
Ka¾dá podmno¾ina (koneèná i nekoneèná) lineárnì nezávislé mno¾iny je
lineárnì nezávislá\lcite[lnmnoz].

Lineární obaly vektorù obsahují v¹echny jejich koneèné lineární
kombinace~/\ncite[linobal], \ncite[poznkonlob], \ncite[poznlob]/. 
Lineární obal lineárního obalu u¾ nepøiná¹í nové lineární 
kombinace\lcite[loblob]. Ka¾dý lineární podprostor $P$ lze zapsat jako lineární
obal nìjaké mno¾iny (napøíklad mno¾iny $P$ samotné, ale to není
nejúèelnìj¹í) a naopak lineární obal jakékoli mno¾iny $M$ 
je podprostorem. Je to nejmen¹í podprostor, který
obsahuje mno¾inu $M$\lcite[lobjemin].

Z lineárnì závislé mno¾iny lze odebrat vektor tak, aby zùstal zachován
její lineární obal~/\ncite[xr],\cite[loblob]/,
zatímco z lineárnì nezávislé mno¾iny nelze odebrat vektor bez zmìny
jejího lineárního obalu\lcite[lnlob].


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\kapitola [base] Báze, dimenze, souøadnice | Base, dimense, souradnice
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\pozn
%%%%%
Mezi mno¾inami generátorù nìjakého lineárního (pod)prostoru bude
zøejmì nejúspornìj¹í taková mno¾ina, která je lineárnì nezávislá.
Vìta\cite[lnlob] nám ukázala, ¾e to je skuteènì
\uv{nejúspornìj¹í opatøení}, proto¾e odebráním jakéhokoli prvku z~takové
mno¾iny zpùsobí, ¾e lineární obal u¾ nebude pokrývat celý (pod)prostor.
®ádné prvky lineárnì nezávislé mno¾iny tedy nejsou pøi popisu (pod)prostoru pomocí
lineárního obalu zbyteèné. To nás vede (kromì jiných dùle¾itých
dùvodù) k~definici báze lineárního (pod)prostoru.

\okraj Báze | Base

\definice* [dbase]
%%%%%%%%%
{\em Báze} lineárního (pod)prostoru $L$ je taková podmno¾ina $B\subseteq L$, 
pro kterou platí
$$\eqalign{
\bod (1) B \hbox{ je lineárnì nezávislá},\cr
\bod (2) \lob<B> = L. \cr}
$$
Struènì øeèeno: báze lineárního (pod)prostoru $L$ je lineárnì nezávislá
mno¾ina jeho generátorù.
\par\inl[báze]

%\pozn
%%%%%
%V~definici\cite[dbase] se mluví o~$L$ jako o~lineárním prostoru. Není
%ale vylouèeno, ¾e $L$ je lineární podprostor nìjakého jiného
%(vìt¹ího) lineárního prostoru $L'$, proto¾e lineární podprostor je podle 
%poznámky\cite[vllpp] sám o~sobì lineárním prostorem. 

\priklad [baseR3]
%%%%%%%%
Mno¾ina vektorù $B=\{(1,2,3),(1,0,2),(-2,1,0)\}$ 
je bází lineárního prostoru $\R^3$, proto¾e je podle 
pøíkladu\cite[lntrojka] lineárnì nezávislá a podle 
pøíkladu\cite[obaltrojky] generuje $\R^3$.

\priklad [gbaseR3]
%%%%%%%%
Mno¾ina vektorù $B=\{(1,0,0),(0,1,0),(0,0,1)\}$ je bází lineárního
prostoru $\R^3$. Snadno zjistíme, ¾e je lineárnì nezávislá a navíc pro
vektor $(a,b,c)\in\R^3$ je
$$
  (a,b,c) = a\,(1,0,0) + b\,(0,1,0) + c\,(0,0,1).
$$
Ka¾dý vektor $(a,b,c)$ lze tedy zapsat jako lineární kombinaci
vektorù z~$B$, neboli $\lob<B>=\R^3$.

V¹imnìme si, ¾e jsme u¾ na¹li dvì báze lineárního prostoru $\R^3$
(v~pøíkladu\cite[baseR3] a v~tomto pøíkladu). Vidíme tedy, ¾e báze
není urèena lineárním prostorem jednoznaènì. Napøíklad pro
$\alpha\not=0$ jsou
mno¾iny $B_\alpha = \{(\alpha,0,0),(0,1,0),(0,0,1)\}$ 
rùzné báze lineárního prostoru $\R^3$. Bází je tedy
nekoneènì mnoho.
\inl[báze: standardní, báze, báze: standardní: v R3]

\priklad [gbaseRn]
%%%%%%%%
Mno¾ina uspoøádaných $n$-tic
$S_n=\{(1,0,0,\ldots,0), (0,1,0,\ldots,0), \ldots, (0,0,0,\ldots,0,1)\}$
tvoøí bázi lineárního prostoru $\R^n$. Je lineárnì nezávislá a generuje
$\R^n$ z~analogických dùvodù, jako v~pøíkladu\cite[gbaseR3].
Takovou bázi lineárního prostoru $\R^n$ nazýváme {\em standardní bází}.
\inl[báze: standardní, báze, báze: standardní: v Rn]

\priklad [basepolynomy]
%%%%%%%%
Mno¾ina $B=\{1,x,x^2,x^3,\ldots\}$ tvoøí bázi lineárního prostoru $P$
v¹ech polynomù. Podle pøíkladu\cite[lnpolynomy] je lineárnì nezávislá.
Zbývá tedy ovìøit, ¾e $\lob<B>=P$. Zvolme nìjaký polynom
$p\in P$. Uká¾eme, ¾e $p\in\lob<B>$. Pro ka¾dý polynom $p\in P$
existuje $n\in\N$ a reálná èísla $a_0, a_1, \ldots, a_n$ taková, ¾e
hodnota polynomu $p$ v~bodì $x$ je dána vzorcem
$$
  p(x) = a_n\,x^n + \cdots + a_1\,x + a_0 \quad\forall x\in\R.
$$
Existuje tedy koneèná podmno¾ina $K\subseteq B$, 
$K=\{1,x,x^2,\ldots,x^n\}$ taková, ¾e $p$ je lineární kombinací
prvkù z~$K$ (koeficienty této lineární kombinace jsou èísla
$a_0, a_1, \ldots, a_n$). Z~toho plyne, ¾e $p\in\lob<B>$.
\inl[polynom, báze: polynomù, prostor: polynomù]

\priklad [basePnn]
%%%%%%%%
Uva¾ujme lineární prostor $P_{\leq n}$ v¹ech polynomù nejvý¹e
$n$-tého stupnì z~pøíkladu\cite[lpPnn]. Uká¾eme, ¾e mno¾ina
$B_n=\{1,x,x^2,\ldots,x^n\}$ tvoøí bázi lineárního prostoru $P_{\leq n}$.

Pøednì, $B_n$ je lineárnì nezávislá, proto¾e je podmno¾inou
lineárnì nezávislé mno¾iny $B$ z~pøíkladu\cite[basepolynomy]
(ka¾dá podmno¾ina lineárnì nezávislé mno¾iny je podle 
vìty\cite[lnmnoz] lineárnì nezávislá). Analogicky jako
v~pøíkladu\cite[basepolynomy] lze ukázat, ¾e $\lob<B_n>=P_{\leq n}$.

\priklad [dimUO]
%%%%%%%%
Vra»me se k~lineárnímu prostoru $U_O$ v¹ech orientovaných úseèek
se spoleèným poèátkem. Podle (5) z~pøíkladu\cite[UOlnlz]
je ka¾dá lineárnì nezávislá mno¾ina vektorù 
$\{\vec u, \vec v, \vec w\}$ bází lineárního prostoru~$U_O$.
\inl[prostor: UO, prostor: orientovaných úseèek]

\okraj Existenece a jednoznaènost báze | Existenece a jednoznacnost base

\pozn* [jednoznacnostbase]
%%%%%%%%%%%%%%%%%%%%%%%%%
{\it O~existenci a jednoznaènosti báze}.
Pøíklad\cite[gbaseR3] ilustroval skuteènost, ¾e báze lineárního 
(pod)prostoru není urèena jednoznaènì. Lineární 
(pod)prostor mù¾e mít dokonce nekoneènì mnoho bází.

Následující vìta dokládá, ¾e ka¾dý lineární prostor má bázi.
Výjimkou je pouze triviální lineární prostor $L=\{\vec o\}$, který
jediný nemá bázi (nìkteøí autoøi uvádìjí prázdnou mno¾inu jako bázi
triviálního lineárního prostoru).
%Polo¾me si otázku, zda ka¾dý lineární prostor musí mít bázi. 
%S~výjimkou triviálního lineárního prostoru 
%(tj.~$L=\{\vec o\}$, viz pøíklad\cite[trivprostor])
%má skuteènì ka¾dý lineární prostor bázi. To dokládá následující vìta.
Následující vìta dokonce tvrdí, ¾e ka¾dou lineárnì nezávislou 
mno¾inu lze doplnit pøidáním pøípadnì dal¹ích
prvkù na bázi a naopak, z~ka¾dé mno¾iny $M$, která generuje $L$,
lze pøípadnì odebrat nìjaké prvky tak, aby zbylá mno¾ina tvoøila
bázi. 
%Vìtu bohu¾el nebudeme dokazovat, proto¾e vy¾aduje pou¾ití
%hlub¹ích poznatkù z~teorie mno¾in (tzv.~Zornovo lemma), které 
%v~tuto chvíli nemáme k~dispozici.

%Poznamenejme je¹tì, ¾e báze triviálního lineárního prostoru 
%(tj.~$L=\{\vec o\}$, viz pøíklad\cite[trivprostor]) je prázdná
%mno¾ina. Abychom to mohli prohlásit, musíme 
%dodefinovat lineární obal prázdné mno¾iny
%jako mno¾inu~$\{\vec o\}$, co¾ je v~souladu s~vlastností 
%vìty\cite[lobjemin].

\veta [existencebase]
%%%%%%%%%%%%%%%%%%%%%
Nech» $L$ je netriviální lineární prostor. Pak $L$ má bázi. Podrobnìji: 

\noindent
(1) Pro ka¾dou lineárnì
nezávislou mno¾inu $N\subseteq L$ existuje báze $B$ 
prostoru $L$ taková, ¾e $N\subseteq B$. 

\noindent
(2) Pro ka¾dou mno¾inu 
$M$ generátorù prostoru $L$ existuje 
báze $B$ prostoru $L$ taková, ¾e $B\subseteq M$.

\exdukaz
Tímto dùkazem se ètenáø opravdu nemusí zabývat, pokud k~tomu nemá pádný dùvod. 
Je zde uveden zejména proto, aby ka¾dá zde vyslovená a pou¾itá 
vìta mìla svùj dùkaz. Ov¹em pro argumenty dùkazu je tøeba sáhnout 
do jiné teorie, v tomto pøípadì axiomatické teorie mno¾in 
(axiom výbìru, princip maximality). Nemá-li ètenáø
z této oblasti odpovídající znalosti, udìlá dobøe, kdy¾ dùkaz
pøeskoèí. Algebraická idea dùkazu ve srozumitelné podobì je vylo¾ena 
v~následujících pøíkladech\cite[N-base],\cite[M-base],\cite[odebirani].
To je pro studium lineární algebry dostaèující. Následující dùkaz je
tedy spí¹e cvièením z teorie mno¾in.
\inl[princip: maximality, axiom: výbìru]

Dùkaz existence báze se opírá o princip maximality, o kterém je
známo, ¾e je ekvivalentní s axiomem výbìru. Tento axiom v teorii
mno¾in je sice bezesporný s ostatními axiomy, ale diskutabilní.
Nicménì v~mnoha teoriích ho potøebujeme. Tøeba právì nyní.

Princip maximality øíká, ¾e máme-li mno¾inu ${\cal S}$ 
uspoøádanou relací $\le_S$ a platí-li, ¾e ka¾dá podmno¾ina 
${\cal R}$ mno¾iny ${\cal S}$, ve které jsou si v relaci v¹echny prvky 
vzájemnì, má horní mez $U\in{\cal S}$ (tj. $\forall R\in{\cal R}$ je
$R\le_S U$), pak pro ka¾dý prvek $N\in{\cal S}$ existuje maximální prvek 
$B\in{\cal S}$ tak, ¾e $N\le_S B$. Maximální prvek $B\in{\cal S}$
ja takový, ¾e v ${\cal S}$ neexistuje prvek vìt¹í, tj. neexistuje prvek
$B'\in{\cal S}$, $B'\not=B$ tak, ¾e $B\le_S B'$.

Pro dùkaz první èásti vìty nech» ${\cal S}$ je systém v¹ech lineárnì nezávislých
mno¾in lineárního prostoru $L$ uspoøádaný relací \uv{být podmno¾inou},
tj. relací $\subseteq$. Pro ka¾dý podsystém $\cal R$, kde lze relací
$\subseteq$ porovnat ka¾dou mno¾inu s ka¾dou (jedná se tedy o systém
vzájemnì do sebe vnoøených mno¾in $R_I$) sestrojíme $U=\cup R_I$. To
je horní mez, proto¾e $R_J\subseteq \cup R_I$ pro libovolnou mno¾inu
$R_J\in{\cal R}$ a navíc $U\in{\cal S}$, nebo» je lineárnì nezávislá.
Proè je nezávislá? Pro spor pøedpokládejme, ¾e $U$ je lineárnì
závislá. Pak existuje koneèná lineárnì
závislá mno¾ina $K=\{\vecc x_k\}\subseteq U$. Ka¾dý jednotlivý vektor
$\vec x_i$ le¾í v nìjaké mno¾inì $R_i\in{\cal R}$. Tento koneèný poèet
mno¾in z $\cal R$ uspoøádáme podle velikosti: 
$R_1\subseteq R_2\subseteq\cdots\subseteq R_k$, tak¾e $K\subseteq R_k$.
O mno¾inì $R_k$ se ale ví, ¾e je lineárnì nezávislá, tak¾e nemù¾e
obsahovat lineárnì závislou podmno¾inu $K$. To je spor, tak¾e $U$ je
lineárnì nezávislá, tedy $U\in{\cal S}$. Nyní pro ka¾dou lineárnì nezávislou
mno¾inu $N$ sestrojíme podle principu maximality maximální prvek
$B\in{\cal S}$. Mno¾ina $B$ je báze, proto¾e je lineárnì nezávislá a
pøidáním libovolného prvku k $B$ u¾ získáme mno¾inu mimo $\cal S$,
tedy mno¾inu lineárnì závislou. Tak¾e podle vìty\cite[pridanivektoru]
musí $\lob<B>=L$.

K dùkazu druhé èáti vìty zvolíme $\cal S$ systém v¹ech lineárnì nezávislých
podmno¾in mno¾iny $M$ uspoøádaných relací $\subseteq$. Z principu
maximality (podmínky se ovìøí stejnì jako pøed chvílí) existuje 
ke mno¾inì $N=\emptyset$ maximální mno¾ina $B\in {\cal S}$
taková, ¾e $\emptyset\subseteq B$. 
Platí $M\subseteq \lob<B>$. Kdyby toti¾ $\vec x\in M$ a souèasnì 
$\vec x\not\in\lob<B>$, pak $B\cup\{\vec x\}$ by byla podle 
vìty\cite[pridanivektoru] lineárnì nezávislá podmno¾ina $M$. To ale 
není mo¾né, proto¾e $B$ je maximální. Na nerovnost
$M\subseteq\lob<B>$ nyní uplatníme vìtu\cite[loblob]:
$\lob<M>\subseteq \lob<{\lob<B>}>=\lob<B>$. Proto¾e $\lob<M>=L$, je
$\lob<B>=L$..


\priklad [N-base]
%%%%%%%%
Je-li $N=\{\vecc x_k\}$ lineárnì nezávislá mno¾ina lineárního prostoru
$\R^n$, pak podle pøedchozí vìty existuje mno¾ina 
$B=\{\vecc x_m\}$, $m\geq k$ taková, ¾e $B$ je báze. 
Uká¾eme v~tomto pøíkladì, jak bychom takovou bázi nalezli.

Pokud u¾ $\lob<N>=\R^n$, pak $N$ samotná je báze a polo¾íme $B=N$.
Pokud ale $\lob<N>\not=\R^n$, pak existuje prvek $\vec x\in\R^n$, pro
který $\vec x\not\in\lob<N>$ Ptáme se, zda u¾ $N\cup\{\vec x\}$ je báze.
Podle vìty\cite[pridanivektoru] tato mno¾ina zùstává lineárnì
nezávislá. Pokud $\lob<N\cup\{\vec x\}>=\R^n$, pak jsme na¹li
bázi. Jestli¾e tato vlastnost neplatí, opakujme postup 
s~pøidáním dal¹ího prvku
$\vec y\not\in \lob<N\cup\{\vec x\}>$ znovu. Tento postup budeme
opakovat tak dlouho, dokud budou existovat vektory mimo lineární obal
na¹í postupnì roz¹iøované mno¾iny. Podle pøíkladu\cite[lzRn] 
dospìjeme k~výsledku po koneènì mnoha krocích, proto¾e v~$\R^n$ 
nelze vytvoøit lineárnì nezávislou mno¾inu, která by mìla 
více ne¾ $n$ prvkù.

Poznamenejme, ¾e tento postup vedl k~cíli, proto¾e jsme mìli zaruèeno,
¾e báze bude mít koneènì mnoho prvkù. Pro nekoneèné báze bychom se
tímto postupem mohli \uv{utopit v~nekoneènu}. Na druhé stranì postup
lze aplikovat na libovolný lineární prostor, který má koneèné báze,
nemusíme se nutnì omezovat na $\R^n$.

\priklad [M-base]
%%%%%%%%
Tvrzení druhé èásti vìty\cite[existencebase] si ilustrujeme na pøíkladu koneèné
mno¾iny $M$. Je $\lob<M>=L$ a máme dokázat, ¾e existuje $B\subseteq M$ 
taková, ¾e $\lob<B>=L$ a navíc $B$ je lineárnì nezávislá.

Uva¾ujme v¹echny podmno¾iny $A_i\subseteq M$, pro které $\lob<A_i>=L$.
Vidíme, ¾e existuje aspoò jedna taková podmno¾ina, sice mno¾ina $M$
samotná. Ze v¹ech takových podmno¾in $A_i$ vyberme tu, která má nejmen¹í
poèet prvkù (v¹echny tyto podmno¾iny jsou koneèné, tak¾e pro ka¾dou
mù¾eme spoèítat její poèet prvkù). Je mo¾né, ¾e takových mno¾in
s~nejmen¹ím poètem prvkù bude existovat více, pak je jedno, kterou 
z~nich zvolíme. Oznaème ji $B$. Víme, ¾e $\lob<B>=L$ (tuto vlastnost
mají v¹echny podmno¾iny $A_i$, tak¾e jmenovitì té¾ mno¾ina $B$). 
Dále víme, ¾e odebráním jakéhokoli prvku z~mno¾iny $B$ 
u¾ nebude pro novou $B_1$
platit $\lob<B_1>=L$. Kdyby to platilo, tak nebyla vybrána $B$ 
s~nejmen¹ím poètem prvkù. Nyní pou¾ijeme vìtu\cite[lnlob]. Mno¾ina
$B$ je tedy lineárnì nezávislá.

\priklad* [odebirani]
%%%%%%%%
Z koneèné mno¾iny $M$, která splòuje $\lob<M>=L$, lze vytvoøit
postupným odebíráním prvkù z $M$ bázi $L$, tedy najít mno¾inu $B$ 
z pøedchozího pøíkladu. Existuje k tomu tento názorný postup:
Je-li $M$ lineárnì nezávislá, je $B=M$ a jsme hotovi. Je-li lineárnì
závislá, podle vìty\cite[xr] existuje jeden prvek $M$, který je
lineární kombinací ostatních. Odebráním tohoto prvku vzniká mno¾ina
$M'$ se stejným lineárním obalem, jako $\lob<M>$, proto¾e platí (4) 
vìty\cite[loblob]. Je-li $M'$ lineárnì nezávislá, je $B=M'$ a jsme
hotovi. Jinak postup opakujeme, tj. odebereme z $M'$ vektor tak, ¾e se
nezmìní lineární obal a znovu se ptáme na lineární nezávislost zbylé
mno¾iny. Proces konèí, a¾ se podaøí odebrat tolik prvkù, ¾e zbytek je
mno¾ina lineárnì nezávislá. Proces urèitì skonèí po koneènì mnoha
krocích, nebo» $M$ je koneèná. Pokud $M$ obsahuje nenulové vektory,
výsledná mno¾ina $B$ je jistì neprázdná, lineárnì nezávislá a
$\lob<B>=L$, tedy $B$ je báze. 
%Je-li $M=\{\vec o\}$, pak je té¾
%$L=\{\vec o\}$, co¾ je vyjímeèný pøípad prostoru, který nemá bázi. 

\poznamka
%%%%%%%%%
Pøíklad báze prostoru $F_D$ v¹ech funkcí definovaných na mno¾inì
$D\subset\R$ nebudeme uvádìt, proto¾e nemáme prostøedky, 
jak takovou bázi zapsat. Báze je v~tomto pøípadì
nekoneènou mno¾inou, která má 
vìt¹í mohutnost, ne¾ je mohutnost mno¾iny pøirozených èísel.
Není tedy mo¾né bázové prvky oèíslovat a seøadit za sebe.
\inl[prostor: funkcí, báze, báze: prostoru: funkcí]

\okraj Báze jsou stejnì velké | Base jsou stejne velke

\poznamka
%%%%%%%%%
Uká¾eme, ¾e dvì (obecnì rùzné) báze stejného lineárního (pod)prostoru mají
stejný poèet prvkù. Tento dùkaz se tradiènì opírá o~Steinitzovu vìtu 
o~výmìnì. Ètenáø si mù¾e pro vìt¹í názornost vytvoøit mno¾inu $M$
èerných kamínkù a lineárnì nezávislou mno¾inu $N$ bílých kamínkù,
které v¹echny le¾í v lineárním obalu èerných. Mù¾e zaèít
{\it vymìòovat\/} postupnì èerné kamínky za bílé kus za kus. Pøi pou¾ití 
následující Steinitzovy vìty o~výmìnì ètenáø shledá, ¾e výmìnu lze 
udìlat tak, aby lineární obal pùvodní mno¾iny $M$ zùstal zachován i
pøesto, ¾e v ní jsou nahrazeny nìkteré èerné kameny v¹emi bílými.

\veta (Steinitzova o výmìnì) [steinitz]
%%%%%
Nech» $L$ je lineární prostor, $M\subseteq L$ je libovolná mno¾ina
a $N\subseteq \lob<M>$ je lineárnì nezávislá mno¾ina, obsahující $k$ vektorù.
Pak lze odebrat z~mno¾iny $M$ jejích $k$~vektorù a vytvoøit tak mno¾inu
$M_1$, pro kterou platí:
$$
  \lob <M> = \lob<M_1\cup N>.
$$
Jinými slovy, odebráním vhodných $k$ vektorù z $M$ a nahrazením tìchto vektorù
v¹emi lineárnì nezávislými vektory z~$N$ se lineární obal $\lob<M>$ nezmìní.
\inl[vìta: Steinitzova o výmìnì, Steinitzova: vìta o výmìnì]
\inl[lineární: obal]

\exdukaz
%%%%%%
Pou¾ijeme matematickou indukci podle~$k$ (o indukci viz
\ifbook poznámku\cite[mat-indukce] a \fi dùkaz vìty\cite[pocetperm]).
Pro $k=0$ vìta platí, proto¾e
mno¾inu $M$ vùbec nemìníme.

Nech» nyní vìta platí pro ka¾dou lineárnì nezávislou mno¾inu 
s~$k$ prvky a doká¾eme, ¾e platí i pro mno¾inu s~$k+1$ prvky. 
Nech» $N=\{\vecc v_k, \vec v_{k+1}\}\subseteq\lob<M>$. 
Oznaème $N_1=\{\vecc v_k\}$.
Z~mno¾iny $M$ lze odebrat $k$ vektorù tak, ¾e vznikne mno¾ina $M_1$,
pro kterou je 
$$
 \lob<M>=\lob<M_1\cup N_1>=\lob<M_1\cup N>. 
$$
První
rovnost je indukèní pøedpoklad a druhá rovnost plyne z toho, ¾e
$\vec v_{k+1}\in\lob<M>=\lob<M_1\cup N_1>$ a ze~ètvrté vlastnosti
vìty\cite[loblob]. Staèí tedy najít v $M_1$ vektor $\vec w_1$ tak, 
aby jej ¹lo odebrat a obal se nezmìnil, tedy
$\lob<M_1\cup N>=\lob<M_1\setminus\{\vec w_1\}\cup N>$.
Proto¾e
$\vec v_{k+1}\in\lob<M>=\lob<M_1\cup N_1>$,
existuje koneènì mnoho vektorù $\vecc w_n\in M_1$ tak, ¾e
$$
  \vec v_{k+1} = \alpha_1\vec w_1 + \alpha_2\vec w_2 +\cdots + \alpha_n\vec w_n +
                 \beta_1\vec v_1 + \cdots + \beta_k\vec v_k.
$$
Proto¾e $N$ je lineárnì nezávislá, tak 
(A)~pøi $k=0$ musí být $\vec v_{k+1}$ nenulový a (B)~pøi $k>0$ nesmí 
$\vec v_{k+1}$ být lineární kombinací vektorù $\vecc v_k$ (vìta\cite[xr]).
Z toho plyne, ¾e $n>0$ a nemohou být v¹echny koeficienty $\alpha_i$ nulové.
Uspoøádáme nyní
$\vecc w_n$ tak, aby $\alpha_1\not=0$. Z~pøedchozí rovnosti plyne
$$
  \vec w_1 = {1\over\alpha_1}\,\vec v_{k+1} - 
                 {\alpha_2\over\alpha_1}\,\vec w_2 -\cdots - 
                 {\alpha_n\over\alpha_1}\,\vec w_n -
                 {\beta_1\over\alpha_1}\,\vec v_1 - \cdots - 
                 {\beta_k\over\alpha_1}\,\vec v_k,
$$
tak¾e
$\vec w_1\in\lob<M_1\setminus\{\vec w_1\}\cup N_1\cup\{\vec v_{k+1}\}>$.
Podle (4)~z~vìty\cite[loblob] se pøidáním vektoru $\vec w_1$ do mno¾iny
$M_1\setminus\{\vec w_1\}\cup N$ lineární obal mno¾iny nezmìní, tak¾e je
$\lob<M_1\setminus\{\vec w_1\}\cup N>=\lob<M_1\cup N>=\lob<M>$.
Uvedený postup pøitom zaruèil $\vec w_1\in M_1$, tak¾e z mno¾iny $M$
jsme celkem odebrali $k+1$ vektorù.

\veta [steinitz2]
%%%%%
Nech» $L$ je lineární prostor, $M\subseteq L$ je libovolná koneèná mno¾ina
a $N\subseteq \lob<M>$ je lineárnì nezávislá mno¾ina. Pak poèet prvkù
mno¾iny $N$ je men¹í nebo roven poètu prvkù mno¾iny $M$.

\dukaz
%%%%%%
Vìta\cite[steinitz] tvrdí, ¾e z mno¾iny $M$ lze odebrat tolik vektorù,
kolik jich má mno¾ina $N$. Kdyby mìla mno¾ina $N$ více vektorù ne¾
mno¾ina $M$, pak by tento úkon ne¹el provést, tj. dostali bychom se do
sporu se Steinitzovou vìtou.

\veta* [stejnebase]
%%%%%
Dvì báze stejného lineárního prostoru jsou obì nekoneèné nebo 
mají stejný poèet prvkù.
\inl[báze]

\dukaz
%%%%%%
Uva¾ujme dvì koneèné báze $B_1$ a $B_2$ lineárního prostoru $L$.
Proto¾e $B_1\subseteq \lob<B_2>$ a $B_1$ je lineárnì nezávislá, musí
podle vìty\cite[steinitz2] mít $B_2$ aspoò tolik prvkù, jako má $B_1$. 
Proto¾e $B_2\subseteq \lob<B_1>$ a $B_2$ je lineárnì nezávislá, musí
podle stejné vìty mít $B_1$ aspoò tolik prvkù, jako má $B_2$.
Tak¾e poèet prvkù tìchto mno¾in musí být stejný. 

Co se stane, kdy¾ $B_1$ je koneèná a $B_2$ nekoneèná? Pak ka¾dá
koneèná podmno¾ina $K\subseteq B_2$ je lineárnì nezávislá. Vezmu
takovou koneènou podmno¾inu $K$, která má více prvkù, ne¾ $B_1$. Proto¾e
$K\subseteq \lob<B_1>$ a $K$ je lineárnì nezávislá, musí mít $B_1$
aspoò tolik prvkù, jako $K$. To ale nemá. Dostáváme tedy spor, tak¾e situace
\uv{jedna báze koneèná a druhá nekoneèná} nemù¾e nastat.

\okraj Dimenze prostoru | Dimense prostoru

\definice* [ddimense]
%%%%%%%%%
{\em Dimenze} lineárního (pod)prostoru $L$ je poèet prvkù báze 
tohoto (pod)prostoru~$L$. Dimenzi (pod)prostoru~$L$
oznaèujeme symbolem $\dim L$. Dimenzi jednobodového lineárního
(pod)prostoru $L=\{\vec o\}$ pokládáme rovnu nule.
\inl[dimenze, dimL]

\poznamka
%%%%%%%%%
Vìta\cite[stejnebase] nám zaruèuje smysluplnost definice
dimenze. Aèkoli lineární prostor mù¾e mít více bází, v¹echny tyto báze
mají podle této vìty stejný poèet prvkù, nebo jsou nekoneèné. V tomto
druhém pøípadì klademe $\dim L=\infty$.

\priklad
%%%%%%%%
$\dim\R^n=n$, viz pøíklad\cite[gbaseRn]. 
$\dim P_{\leq n}=n+1$, viz pøíklad\cite[basePnn]. 
$\dim P=\infty$, viz pøíklad\cite[basepolynomy]. 
Koneènì $\dim U_O=3$ podle pøíkladu\cite[dimUO]. Va¾me si toho, ¾e nás
Stvoøitel obklopil lineárním prostorem dimenze 3 nejen proto, ¾e trojka je
¹»astné èíslo.
\inl[Stvoøitel, dimenze]
\inl[prostor: UO, prostor: orientovaných úseèek]
\inl[prostor: polynomù, prostor: R9n, R9n]
\inl[dimenze: prostoru: UO, dimenze: prostoru: polynomù, dimenze: prostoru: R9n]

\okraj Dimenze podprostoru | Dimense podprostoru

\veta [dimpodprostoru]
%%%%%
Nech» $L$ je lineární prostor a $P\subseteq L$ je lineární podprostor
lineárního prostoru $L$. Pak $\dim P \leq \dim L$.
\inl[podprostor]

\dukaz
%%%%%%
Oznaème $B_L$ nìjakou bázi lineárního prostoru~$L$.
Báze $B_P$ podprostoru $P$ je lineárnì nezávislá mno¾ina, pro kterou je
$B_P\subseteq \lob<B_L>$. Podle vìty\cite[steinitz2] má $B_P$ nejvý¹e
tolik prvkù, jako $B_L$.

\veta [P=L]
Nech» $L$ je lineární prostor a $P\subseteq L$ je lineární podprostor
lineárního prostoru $L$.
Nech» dále $\dim P = \dim L$ a tato dimenze je koneèná. Potom $P=L$.

\dukaz
$B_P$ je báze podprostoru $P$ a $B_L$ báze prostoru $L$ jako 
v~pøedchozím dùkazu, tj. $B_P\subseteq\lob<B_L>$.
Proto¾e jsou $B_P$ a $B_L$ stejnì poèetné, pak podle Steinitzovy vìty
lze vymìnit v¹echny vektory z $B_L$ za v¹echny vektory z $B_P$ beze
zmìny lineárního obalu, tak¾e $\lob<B_P>=\lob<B_L>$. Jinými slovy $P=L$.

\poznamka
%%%%%%%%%
Podmínku koneènosti dimenze v pøedchozí vìtì nelze vynechat.
Steinitzova vìta toti¾ pøedpokládá koneènou mno¾inu~$N$.
Nezbytnost podmínky koneèné dimenze ilustruje tøeba tento
pøíklad. Nech» $L$ je lineární prostor v¹ech polynomù a 
$P=\lob<1,x^2,x^4,\ldots>$ je podprostor polynomù jen se sudými
mocninami. Pak $\dim L=\dim P=\infty$, ale $P\not=L$.

\poznamka
%%%%%%%%%
Vìta\cite[P=L] má dùsledky shrnuté v následujících dvou vìtách. 
Ty se nám budou hodit, a¾ budeme lineární podprostory zapisovat jako 
lineární obaly mno¾in vektorù a budeme se potýkat s tím, ¾e tento 
zápis podprostoru není jednoznaèný.

\veta [rovnostobalu]
%%%%%
Nech» $\vecc u_k, \vecc v_m$ jsou vektory lineárního prostoru $L$.
Rovnost lineárních obalù $\lob<\vecc u_k>$ a $\lob<\vecc v_m>$ je
ekvivalentní podmínce:
$$\dim\lob<\vecc u_k> = \dim\lob<\vecc v_m> = \dim\lob<\vecc u_k,\vecc v_m>.$$

\dukaz
Pøepokládejme nejprve rovnost obalù a doká¾eme podmínku.
Oznaèíme $U=\{\vecc u_k\}$ a $V=\{\vecc v_m\}$. Jestli¾e $\lob<U>=\lob<V>$, pak
$U\subseteq\lob<U>=\lob<V>$, $V\subseteq\lob<U>=\lob<V>$, tedy
$U\cup V\subseteq\lob<U>=\lob<V>$. Pøechodem k lineárnímu obalu obou
stran mno¾inové nerovnosti a vyu¾itím vìty\cite[loblob]~(3) dostáváme
$\lob<U\cup V>\subseteq\lob<{\lob<U>}> =\lob<U>$.
Proto¾e $U\cup V\supseteq U$, platí také $\lob<U\cup
V>\supseteq \lob<U>$, tak¾e
$\lob<U\cup V> = \lob<U>=\lob<V>$. Kdy¾ se rovnají obaly, rovnají se i
jejich dimenze.

Pøedpokládejme nyní platnost podmínky a doká¾eme $\lob<U>=\lob<V>$.
Proto¾e $\lob<U>\subseteq\lob<U\cup V>$ a dimenze se rovnají, musí
se podle vìty\cite[P=L] (volte $\lob<U>=P, \lob<U\cup V>=L$) rovnat
obaly samotné, tj.  $\lob<U>=\lob<U\cup V>$. To samé platí pro
$\lob<V>$, tak¾e $\lob<U>=\lob<U\cup V>=\lob<V>$.

\veta [pribaleni]
%%%%%
Nech» $\vec v,\vecc u_k$ jsou vektory lineárního prostoru $L$.
Pak $\vec v\in\lob<\vecc u_k>$ právì tehdy, kdy¾ 
$\dim\lob<\vecc u_k> = \dim\lob<\vecc u_k, \vec v>$.

\dukaz
Z pøedpokladu, ¾e $\vec v\in\lob<\vecc u_k>$ a z vìty\cite[loblob]~(4)
plyne, ¾e obaly $\lob<\vecc u_k>$ a $\lob<\vecc u_k, \vec v>$ se
rovnají. Proto se rovnají i jejich dimenze.

Nech» nyní se dimenze rovnají. Obal $\lob<\vecc u_k>$ je
podprostorem obalu $\lob<\vecc u_k, \vec v>$, tak¾e podle 
vìty\cite[P=L] se tyto obaly rovnají. Vlastnost
$\vec v\in\lob<\vecc u_k>$ pak plyne z následující inkluze:
$\{\vecc u_k, \vec v\}\subseteq \lob<\vecc u_k, \vec v>=\lob<\vecc u_k>$.

\okraj Poèet prvkù v~LN mno¾inì | Pocet prvku v~LN mnozine

\veta [123]
%%%%%
Nech» $L$ je lineární prostor, $\dim L = n$ a 
$M=\{\vecc x_m\}$. Pak platí:

\noindent
(1) Je-li $M$ lineárnì nezávislá, pak $m \leq n$.

\noindent
(2) Je-li $m>n$, pak $M$ je lineárnì závislá.

\noindent
(3) Je-li $m=n$ a $M$ je lineárnì nezávislá, pak $\lob<M>=L$.

\noindent
(4) Je-li $m=n$ a $\lob<M>=L$, pak je $M$ lineárnì nezávislá.

\noindent
(5) Je-li $M$ lineárnì nezávislá a $\lob<M>=L$, pak $m=n$.

\dukaz
%%%%%%
(1) Nech» $B$ je báze $L$, tedy $\lob<B>=L$. Podle
vìty\cite[steinitz2] lze nahradit $m$ prvkù z~$B$ v¹emi prvky z~$M$
tak, ¾e se lineární obal nezmìní. Aby to bylo mo¾né provést, nutnì
musí být $m\leq n$.

(2) Toto tvrzení je ekvivalentní s~tvrzením (1).

(3) Kdyby $\lob<M>\not=L$,
pak lze pøidat do mno¾iny $M$ vektor $\vec x\not\in\lob<M>$, a pøitom
podle vìty\cite[pridanivektoru] zùstane roz¹íøená mno¾ina lineárnì
nezávislá. To ale podle (1) není mo¾né. Musí tedy $\lob<M>=L$.

(4) Z mno¾iny $M$ lze odebrat prvky tak,
aby vzniklá podmno¾ina $B\subseteq M$ mìla stejný obal, ale byla 
lineárnì nezávislá. $B$ je tedy bází prostoru $L$. 
Kdyby byla $M$ lineárnì závislá, pak musí $B$ mít ménì prvkù 
ne¾ $m=n$, co¾ je ve sporu s vìtou\cite[stejnebase]. 
Tak¾e musí $M$ být lineárnì nezávislá.

(5) Mno¾ina $M$ je podle definice bází $L$. Podle
vìty\cite[stejnebase] tedy musí mít $n$ prvkù.

\poznamka [dusl123]
%%%%%%%%%
Uvìdomíme si význam této vìty. Báze lineárního prostoru koneèné
dimenze je podle (1) nejpoèetnìj¹í lineárnì nezávislá mno¾ina.  
Dále podle (3) ka¾dá lineárnì nezávislá
mno¾ina, která má poèet prvkù rovný koneèné dimenzi, je bází.

\priklad
%%%%%%%%
Mno¾ina $\{(1,1,1),(0,1,1),(0,0,2)\}$ je bází lineárního prostoru $\R^3$,
proto¾e je lineárnì nezávislá a její poèet prvkù 
je roven $\dim\R^3$. Staèí pou¾ít vìtu\cite[123], vlastnost (3) a
nemusíme pracnì ovìøovat z~definice, ¾e mno¾ina generuje~$\R^3$.


\okraj Souøadnice vektoru | Souradnice vektoru

\poznamka
%%%%%%%%%
Je-li $\dim L$ koneèná, je mo¾né zvolit a uspoøádat bázi prostoru $L$
a ka¾dý vektor $\vec x$ pak zapsat jako lineární kombinaci této
báze. Koeficienty této lineární kombinace nazýváme {\em souøadnice vektoru\/}
$\vec x$. Tímto zpùsobem mù¾eme vektory lineárního prostoru $L$ 
podchytit pomocí reálných èísel. Pøechod od abstraktního vektoru 
k~souøadnicím (uspoøádané $n$-tici èísel) nyní popí¹eme podrobnìji.
\inl[souøadnice: vektoru]

\definice [ubase]
%%%%%%%%%
Nech» $B=\{\vecc b_n\}$ je báze lineárního prostoru~$L$. Zále¾í-li nám
na poøadí prvkù báze $\vecc b_n$ (tj.~po¾adujeme, aby $\vec b_1$ byl
první prvek báze, $\vec b_2$ druhý prvek atd.), pak mluvíme 
o~{\em uspoøádané bázi}. Uspoøádaná báze je tedy uspoøádaná $n$-tice
prvkù báze, tj.~$(\vecc b_n)$. Skuteènost, ¾e báze~$B$ je uspoøádaná,
budeme vyznaèovat symbolem $(B)$.
\inl[báze: uspoøádaná, uspoøádaná: báze]

\poznamka
%%%%%%%%%
Uspoøádanou bázi jsme definovali jen pro lineární prostory koneèné
dimenze. Aèkoli tedy v dal¹ím textu nebude tato skuteènost výslovnì
uvedena, v¹ude tam, kde se mluví o~uspoøádaných bázích, máme na mysli
lineární prostor koneèné dimenze.

\definice* [souradnice]
%%%%%%%%%
Nech» $(B)=(\vecc b_n)$ je uspoøádaná báze lineárního prostoru~$L$
a $\vec x\in L$ je libovolný vektor. Uspoøádanou $n$-tici reálných 
èísel $(\alpha_1,\alpha_2,\ldots,\alpha_n)\in\R^n$ nazýváme {\em souøadnicemi
vektoru~$\vec x$ vzhledem k~uspoøádané bázi~$(B)$}, pokud platí
$$
  \vec x = \lkvecc \alpha.b_n .
$$
Skuteènost, ¾e $(\alpha_1,\alpha_2,\ldots,\alpha_n)$ jsou souøadnice
vektoru $\vec x$ vzhledem k~uspoøádané bázi~$(B)$ budeme zapisovat takto:
$$
  \c_B(\vec x) = (\alpha_1,\alpha_2,\ldots,\alpha_n).
$$
\par\inl[souøadnice: vektoru]

\okraj Existence a jednoznaènost sou\-øadnic | 
       Existence a jednoznacnost souradnic

\veta*  [jednsouradnice]
%%%%%
Nech» $(B)$ je uspoøádaná báze lineárního prostoru~$L$. Pak ka¾dý
vektor $\vec x\in L$ má jednoznaènì urèeny své souøadnice vzhledem 
k uspoøádané bázi $(B)$

\dukaz
%%%%%%
Existence: proto¾e $\lob<B>=L$, lze ka¾dý vektor $\vec x\in L$
zapsat jako lineární kombinaci prvkù z $B$.

Jednoznaènost: Dùkaz se opírá o lineární nezávislost mno¾iny $B$.
Oznaème $(B)=(\vecc b_n)$. 
Nech» $\vec x$ má sou¾adnice $(\alpha_1,\alpha_2,\ldots,\alpha_n)$ a 
souèasnì má souøadnice $(\beta_1,\beta_2,\ldots,\beta_n)$. 
V obou pøípadech se jedná o souøadnice vzhledem ke stejné bázi $(B)$.
Uká¾eme, ¾e pak je
$\alpha_i = \beta_i$, $\forall i\in\{1,\ldots,n\}$.
Podle definice\cite[souradnice] je
$$
  \vec x = \lkvecc \alpha.b_n, \qquad \vec x = \lkvecc \beta.b_n.
$$
Odeètením tìchto rovností dostáváme
$$
  \vec x - \vec x = \vec o = (\alpha_1 - \beta_1)\,\vec b_1 +
           (\alpha_2 - \beta_2)\,\vec b_2 + \cdots +
           (\alpha_n - \beta_n)\,\vec b_n.
$$
Proto¾e vektory báze $\vecc b_n$ jsou lineárnì nezávislé, pouze
triviální lineární kombinace mù¾e být rovna nulovému vektoru.
V¹echny koeficienty uvedené lineární kombinace musejí tedy být rovny nule.
Tím dostáváme $\alpha_i = \beta_i$, $\forall i\in\{1,\ldots,n\}$.

\priklad [sourpolynomu]
%%%%%%%%
Nech» $L$ je lineární prostor polynomù nejvý¹e tøetího stupnì.
Najdeme souøadnice polynomu $p\in L$, $p(x)=2x^3 + x^2 - 3x$ vzhledem
k uspoøádané bázi $(B)=\bigl(x+1, x-1, (x+1)^2, (x+1)^3\bigr)$.

Nevìøící Tomá¹ové by nejprve mìli ovìøit, zda je $B$ skuteènì bází
lineárního prostoru~$L$,
tj. zda platí vlastnosti~(1) a~(2) z~definice\cite[dbase]. Polo¾ili by
následující lineární kombinaci rovnu nulovému polynomu:
$$
  \alpha\,(x+1) + \beta\,(x-1) + \gamma\,(x+1)^2 + \delta\,(x+1)^3 = 
 \delta\,x^3 + (\gamma+3\delta)\,x^2 + (\alpha+\beta+2\gamma+3\delta)\,x
 + \alpha - \beta + \gamma + \delta = 0
$$
a zkoumali by, za jakých okolností lze rovnost splnit. Polynom je
nulový jen tehdy, kdy¾ jsou nulové v¹echny jeho koeficienty, co¾ vede
na homogenní soustavu ètyø rovnic o neznámých $\alpha, \beta, \gamma, \delta$.
Tu by Tomá¹ové vyøe¹ili, zjistili by, ¾e má pouze nulové øe¹ení,
a proto jsou dané polynomy z mno¾iny $B$ lineárnì
nezávislé. Dále by Tomá¹ové pou¾ili vlastnost~(3) vìty\cite[123] a
prohlásili, ¾e kdy¾ mno¾ina $B$ je lineárnì nezávislá a obsahuje stejný
poèet vektorù, jako je dimenze prostoru
(podle pøíkladu\cite[basePnn] je $\dim L=4$),
pak musí $\lob<B>=L$. Tím by zjistili, ¾e $B$ je báze lineárního prostoru~$L$.
\inl[Tomá¹: nevìøící]

Nyní najdeme souøadnice polynomu $p$ vzhledem k~bázi $(B)$. Podle 
definice\cite[souradnice] má pro souøadnice $(\alpha, \beta, \gamma, \delta)$
platit
$$
  \eqalign{
  2x^3 + x^2 - 3x &=
  \alpha\,(x+1) + \beta\,(x-1) + \gamma\,(x+1)^2 + \delta\,(x+1)^3, \cr
  \hbox{po úpravì:} \quad
  2x^3 + x^2 - 3x &=
  \delta\,x^3 + (\gamma+3\delta)\,x^2 + (\alpha+\beta+2\gamma+3\delta)\,x
  + \alpha - \beta + \gamma + \delta .}
$$    
Dva polynomy se rovnají, kdy¾ se rovnají odpovídající jejich koeficienty.
Po porovnání jednotlivých koeficientù u polynomù na levé a pravé
stranì rovnosti dostáváme soustavu rovnic
$$
  \soustava{\alpha - \beta +\1\gamma +\1\delta =& 0 \cr
            \alpha + \beta + 2\gamma + 3\delta =& \!\! -3 \cr
                              \gamma + 3\delta =& 1 \cr
                                        \delta =& 2 }
$$
Soustava má jediné øe¹ení $\alpha=2, \beta=-1, \gamma=-5, \delta=2$.
Zapí¹eme výsledek: $\c_B(p)=(2,-1,-5,2)$.

\priklad [sourpolynomu2]
%%%%%%%%
Uva¾ujme stejný lineární prostor $L$ jako v pøedchozím pøíkladì a v nìm
stejný polynom $p\in L$, $p(x) = 2x^3 + x^2 - 3x$. Vzhledem 
k~uspoøádané bázi $B_0=(1,x,x^2,x^3)$ má polynom souøadnice shodné se
svými koeficienty, tedy 
$$
  \c_{B_0}(p) = (0, -3, 1, 2).
$$
Platí toti¾ $p(x) = 0\cdot1 + (-3)\cdot x + 1\cdot x^2 + 2\cdot x^3$.

\dolu3mm
\obrazek .4+.08 7 obr1 
{
\p 44 -3 O
\p 10 60 \vec b_1
\p 5 0 \vec b_2
\p 33 120 \vec x
}
%
\priklad [sourUO]
%%%%%%%%
Uva¾ujme podprostor $P$ prostoru orientovaných úseèek $U_O$, ve kterém
jsou jen vektory le¾ící v rovinì dané stránkou této uèebnice a mající 
poèáteèní bod v~bodì~$O$ na obrázku. Zjevnì je $\dim P=2$.
Na uvedeném obrázku jsou vyznaèeny vektory $\vec b_1$ a $\vec b_2\in P$, 
které jsou lineárnì nezávislé, tak¾e tvoøí bázi podprostoru $P$.
Najdeme souøadnice vektoru $\vec x$ vzhledem k uspoøádané bázi 
$(B)=(\vec b_1,\vec b_2)$.

Je tøeba narýsovat dvì mìøítka, jedno procházející vektorem $\vec b_1$
a mající jednièku v koncovém bodì tohoto vektoru. Druhé mìøítko prochází
vektorem $\vec b_2$ a má jednièku v koncovém bodì $\vec b_2$. 
Obì mìøítka mají nulu v~bodì~$O$. Dále
narýsujeme rovnobì¾ky s tìmito mìøítky, které procházejí koncovým
bodem vektoru $\vec x$. V prùseèících tìchto pøímek pak pøeèteme souøadnice
vektoru $\vec x$. Laskavý ètenáø si jistì sám do obrázku dorýsuje uvedená
mìøítka a rovnobì¾ky a shledá, ¾e je $\c_B(\vec x) = (2{,}6;\,-1{,}3)$.
Pøesnost výsledku závisí na pøesnosti rýsování.

Pamatujme: ideální geometrii nikdy nenarýsujeme, ta existuje pouze v
myslích ka¾dého z nás. Tak¾e ve skuteènosti jsou vektory z lineárního
prostoru $U_O$  velmi obtí¾nì uchopitelné. Je tedy u¾iteèné
pøejít od tìchto abstraktních vektorù k uspoøádaným $n$-ticím reálných
èísel, k jejich souøadnicím. S~tìmi se poèítá daleko pohodlnìji.
Viz té¾ pøíklad\cite[U0isoR2]

\priklad [sourRn]
%%%%%%%%
V lineárním prostoru $\R^n$ se pracuje pøímo s reálnámi èísly, tak¾e hledat 
k~uspoøádaným $n$-ticím jejich souøadnice, tedy zase uspoøádané
$n$-tice, mù¾e pùsobit jako no¹ení døíví do lesa. Nicménì se o to
pokusíme. Abychom se do toho nezamotali, rozli¹ujme dùslednì pojem
{\it slo¾ky vektoru} od pojmu {\it souøadnice vektoru} vzhledem ke
zvolené bázi. Zvolíme dvì uspoøádané báze v $\R^3$:
$$
  (B) = \bigl( (1,3,1), (3,0,2), (2,1,1)\bigr), \qquad
  (S_3) = \bigl( (1,0,0), (0,1,0), (0,0,1)\bigr).
$$
je dán vektor $(1,2,3)$. Èísla 1, 2, 3 jsou jeho slo¾ky a báze na
pøedchozím øádku jsou také dány svými slo¾kami.
Najdeme souøadnice daného vektoru jednak vzhledem k bázi~$(B)$ a
také vzhledem k bázi~$(S_3)$.

Pøedev¹ím je zøejmé, ¾e $B$ je báze (nevìøící Tomá¹ové si to ovìøí).
Mno¾ina $S_3$ je také bází, je to dokonce standardní báze 
lineárního prostoru $\R^3$.

Souøadnice vektoru $(1,2,3)$ vzhledem k~$(B)$ tvoøí trojici èísel
$(\alpha,\beta,\gamma)$, pro které platí
$$
   (1,2,3) = \alpha(1,3,1) + \beta(3,0,2) + \gamma(2,1,1)
$$
Po vynásobení vektorù a jejich seètení podle definice z~pøíkladu\cite[LPRn]
dostáváme rovnost uspoøádaných trojic 
$(1,2,3) = (\alpha+3\beta+2\gamma,3\alpha+\gamma,\alpha+2\beta+\gamma)$.
Z této rovnosti plynou tøi rovnice pro neznámé $\alpha,\beta,\gamma$.
Ètenáø si sám spoèítá, ¾e soustava tìchto tøí rovnic má jediné øe¹ení
$\alpha=9/4$, $\beta=11/4$, $\gamma=-19/4$. Tak¾e
$\c_B\bigl((1,2,3)\bigr) = (9/4,11/4,-19/4)$.

Proto¾e je $(1,2,3) = 1\cdot(1,0,0) + 2\cdot(0,1,0) + 3\cdot(0,0,1)$, je okam¾itì
patrné, ¾e $\c_{S_3}\bigl((1,2,3)\bigr) = (1,2,3)$. Poslední výsledek zobecníme
v následujícím tvrzení:

\veta [snsour]
%%%%%
Souøadnice ka¾dého vektoru $\vec x\in\R^n$ vzhledem ke standardní bázi $S_n$
jsou rovny slo¾kám vektoru~$\vec x$. Jinými slovy:
$\c_{S_n}\bigl((x_1,x_2,\ldots,x_n)\bigr) = (x_1,x_2,\ldots,x_n)$.

\dukaz
Zøejmì je 
$(x_1,x_2,\ldots,x_n) = x_1(1,0,0,\ldots,0)+ x_2(0,1,0,\ldots,0)+ \ldots +
x_n(0,0,0,\ldots,0,1)$.

\poznamka*
%%%%%%%%%
Vý¹e uvedené pøíklady ilustrují platnost sloganu \uv{na volbì báze zále¾í}.
Pøedev¹ím vidíme, ¾e souøadnice stejného vektoru vzhledem
k rùzným bázím jsou rozdílné.

V pøíkladì\cite[sourpolynomu2] se nám podaøilo najít
souøadnice stejného polynomu mnohem pohodlnìji, ne¾ 
v~pøíkladì\cite[sourpolynomu]. Stejnì tak by se nám lépe hledaly
souøadnice orientované úseèky v pøíkladì\cite[sourUO], pokud by 
byly bázové vektory voleny tak, ¾e jsou na sebe kolmé a mají stejnou
velikost. Mohli bychom pak pou¾ít pravítko s ryskou. 
Koneènì standardní báze $(B_0)$ v $\R^3$ v
pøíkladu\cite[sourRn] nám nekladla (na rozdíl od náhodnì zvolené báze $B$)
¾ádné pøeká¾ky pøi hledání souøadnic.
Mezi v¹emi bázemi lineárního prostoru tedy existují báze, vzhledem ke
kterým je mo¾né hledat souøadnice výraznì pohodlnìji.


\okraj Spojení a prùnik lineárních podprostorù | 
       Spojeni a prunik linearnich podprostoru

\definice [dspoj]
%%%%%%%%%
Nech» $L$ je lineární prostor, $M$ a $N$ jsou jeho podprostory.
Mno¾inu $\lob<M\cup N>$ nazýváme {\em spojením podprostorù $M$ a $N$} 
a znaèíme $M\vee N$.
\inl[spojení: podprostorù, 0MveeN]

\poznamka
%%%%%%%%%
Podle vìty\cite[lobjemin] je $M\vee N$ nejmen¹í podprostor, který
obsahuje v¹echny prvky z~$M$ i $N$ dohromady. 

\veta [spojeni=soucet]
%%%%%
Nech» $L$ je lineární prostor, $M$ a $N$ jsou jeho podprostory.
Pro podprostor $M\vee N$ platí:
$$
  M\vee N = \{\vec y+\vec z;\; \vec y\in M,\, \vec z\in N\}.
$$

\dukaz
%%%%%%
Je-li $\vec x\in \{\vec y+\vec z;\; \vec y\in M, \vec z\in N\}$, 
tj. $\vec x$ se dá rozepsat na
souèet prvku z~$M$ a prvku z~$N$, 
pak podle definice lineárního obalu
je $\vec x\in\lob<M\cup N>=M\vee N$. To dokazuje inkluzi
$\{\vec y+\vec z;\; \vec y\in M, \vec z\in N\} \subseteq M\vee N$.

Je-li $\vec x\in M\vee N = \lob<M\cup N>$, pak podle definice lineárního
obalu existuje koneènì mnoho prvkù z~$M$ a koneènì mnoho prvkù z~$N$
takových, ¾e $\vec x$ je lineární kombinací tìchto prvkù. Tuto lineární
kombinaci rozdìlíme na souèet násobkù prvkù z~$M$ a souèet násobkù
ostatních prvkù (tedy prvkù z~$N$). První souèet oznaèíme~$\vec y$ a 
druhý~$\vec z$. Proto¾e $M$ a $N$ jsou podprostory, 
je podle vìty\cite[lob=lpp]
$\lob<M>=M$, $\lob<N>=N$, tak¾e lineární kombinace prvkù z $M$ le¾í
v~$M$ a podobnì pro $N$. Máme tedy $\vec y\in M$, $\vec z\in N$. Proto¾e 
$\vec x=\vec y+\vec z$, je 
$\vec x\in\{\vec y+\vec z;\;\vec y\in M,\vec z\in N\}$. 
To dokazuje obrácenou inkluzi.

\veta* [dimspojeni]
%%%%%
Nech» $L$ je lineární prostor koneèné dimenze, $M$ a $N$ jsou 
jeho podprostory. Pak
$$
  \dim M + \dim N = \dim (M\cap N) + \dim (M\vee N).
$$

\exdukaz
%%%%%%
Nech» $\dim M = m$, $\dim N = n$, $\dim (M\cap N) = k$.
Nech» $\vecc b_k$ je báze podprostoru $M\cap N$.
Vzhledem k tomu, ¾e $M\cap N \subseteq M$, lze lineárnì nezávislé vektory
$\vecc b_k$ doplnit o dal¹í prvky,
aby dohromady tvoøily bázi v~$M$. Viz vìtu\cite[existencebase].
Podobnì lze doplnit 
$\vecc b_k$ o~dal¹í prvky, aby tvoøily bázi v $N$. Máme tedy
$$
  \tabskip=0pt plus1fil
  \halign to\hsize{$#\qquad$\hfil\tabskip=0pt&$#$\hfil\tabskip=0pt plus1fil\cr
  \hbox{báze $M\cap N$: }& \{\vecc b_k \}, \cr
  \hbox{báze $M$: }& \{\vecc b_k, \vec c_{k+1}, \ldots, \vec c_m \}, \cr
  \hbox{báze $N$: }& \{\vecc b_k, \vec d_{k+1}, \ldots, \vec d_n \}. \cr}
$$
Za této situace je mno¾ina 
$B=\{\vecc b_k, \vec c_{k+1}, \ldots, \vec c_m, \vec d_{k+1},\ldots, \vec d_n \}$ 
bází podprostoru $M \vee N$. Zdùvodníme proè.

Uká¾eme nejdøíve, ¾e $\lob<B>=M\vee N$. Proto¾e
$B\subseteq M\cup N$, je $\lob<B>\subseteq\lob<M\cup N>=M\vee N$. Nyní
uká¾eme obrácenou inkluzi. Je-li $\vec x\in M\vee N$, pak podle 
vìty\cite[spojeni=soucet] existují vektory $\vec y\in M$ a $\vec z\in
N$ takové, ¾e $\vec x = \vec y+\vec z$. Vektor~$\vec y$ lze zapsat
jako lineární kombinaci prvkù báze~$M$ a vektor~$\vec z$ jako lineární
kombinaci prvkù báze~$N$. Proto je vektor~$\vec x$ lineární kombinací
prvkù mno¾iny~$B$ a máme dokázánu obrácenou inkluzi
$M\vee N \subseteq\lob<B>$.

Nyní uká¾eme, ¾e $B$ je lineárnì nezávislá mno¾ina. Polo¾me
$$
  (\lkvecc \alpha.b_k) + 
  (\gamma_{k+1}\vec c_{k+1}+ \cdots+\gamma_m\vec c_m) +
  (\delta_{k+1}\vec d_{k+1}+ \cdots+\delta_m\vec d_m) = \vec o.
$$
Doká¾eme, ¾e tato lineární kombinace musí být triviální.
Oznaème první závorku $\vec b$, druhou $\vec c$ a tøetí $\vec d$.
Je $\vec d=-\vec b-\vec c$, tak¾e $\vec d\in M$ (je lineární kombinací
prvkù~z~$M$) a také $\vec d\in N$ (je lineární kombinací prvkù s $N$),
tak¾e $\vec d\in M\cap N$. Je tedy mo¾né zapsat $\vec d$ jako lineární
kombinaci prvkù báze $M\cap N$, tedy $\vec d=\lkvecc\beta.b_k$.
Jinak napsáno: 
$\lkvecc\beta.b_k-\delta_{k+1}\vec d_{k+1}- \cdots-\delta_m\vec
d_m=\vec o$.
Tady vidíme lineární kombinaci prvkù báze podprostoru~$N$ rovnu
nulovému vektoru, tak¾e musí být triviální. Tak¾e $\vec d=\vec o$.
Dosadíme tento poznatek do pùvodní rovnosti $\vec b+\vec c+\vec d=\vec o$
a máme $\vec b+\vec c=\vec o$, jinak napsáno:
$\lkvecc \alpha.b_k+\gamma_{k+1}\vec c_{k+1}+ 
\cdots+\gamma_m\vec c_m=\vec o$.
Zde je lineární kombinace prvkù báze
podprostoru~$M$, která je rovna nulovému vektoru. Tak¾e musí být
triviální.

Proto¾e $B$ je bází $M\vee N$ a je vidìt, ¾e $B$ má $m+n-k$ prvkù, je
$\dim (M\vee N) = m+n-k$. Dokazovaná rovnost nyní plyne z~toho, ¾e
platí~$m+n = k + (m+n-k)$.


\shrnuti
%%%%%%%%
Lineárnì nezávislou mno¾inu vektorù, která generuje
lineární (pod)prostor, nazýváme bází tohoto 
(pod)prostoru\lcite[dbase]. Bází stejného (pod)prostoru je více, ale v¹echny mají
stejný poèet prvkù~/\ncite[steinitz],\cite[stejnebase]/. Tento poèet
prvkù se nazývá dimenze (pod)prostoru\lcite[dimpodprostoru].

Koneèná lineárnì nezávislá mno¾ina je bází (pod)prostoru $L$, pokud má stejný
poèet prvkù, jako je dimenze $L$\lcite[123]. Více prvkù lineárnì
nezávislá mno¾ina nemù¾e mít~/rovnì¾\cite[123]/, tak¾e
dimenze $L$ je maximální poèet prvkù, jaký mù¾e v~$L$ mít lineárnì 
nezávislá mno¾ina. 

Ka¾dý vektor $\vec x$ lineárního prostoru koneèné dimenze má vzhledem k pevnì
zvolené uspoøádané bázi jednoznaènì urèeny své souøadnice. Staèí
vektor $\vec x$ zapsat jako lineární kombinaci prvkù této báze a
koeficienty této kombinace nazýváme jeho 
souøadnice~/\ncite[souradnice],\cite[jednsouradnice]/. Existence souøadnic je
dána tím, báze generuje prostor a jednoznaènost
plyne z lineární nezávislosti báze.

Vzhledem k rùzným bázím má stejný vektor samozøejmì rùzné souøadnice.
Existují báze, vzhledem ke kterým se souøadnice pohodlnì 
hledají~/\ncite[sourpolynomu2],\cite[snsour]/, zatímco najít souøadnice vektoru
vzhledem k~jiným bázím dá ponìkud práci~/\ncite[sourpolynomu],
\ncite[sourUO], \ncite[sourRn]/. Pomocí souøadnic mù¾eme numericky
podchytit vektory z~rozlièných lineárních prostorù. Pøesná formulace
této velmi dùle¾ité vlastnosti bude pøedmìtem a¾ dal¹í kapitoly.  

V závìru kapitoly jsme zavedli pojem spojení podprostorù\lcite[dspoj]
a dokázali dùle¾itou vìtu o dimenzi spojení a
prùniku dvou lineárních podprostorù\lcite[dimspojeni].

\icviceni 2


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\kapitola Lineární zobrazení, izomorfismus | Linearni zobrazeni, isomorfismus
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\poznamka
%%%%%%%%%
Zobrazení je zobecnìním pojmu funkce. Zatímco funkce pøiøazuje èíslùm
èísla, zobrazení pøiøazuje prvkùm libovolné mno¾iny prvky libovolné mno¾iny.

Ne¾ se pustíme do definice pojmu {\em lineární} zobrazení, bude u¾iteèné si
pøipomenout, co to je vùbec zobrazení, a uvést jeho základní vlastnosti.

\okraj Definice\hb zobrazení | Definice zobrazeni

\definice [zobr]
%%%%%%%%%
Nech» $L_1$ a $L_2$ jsou libovolné mno¾iny. {\em Zobrazením
$\a$ z mno¾iny $L_1$ do mno¾iny $L_2$} rozumíme jakýkoli pøedpis,
který ka¾dému prvku z mno¾iny $L_1$ pøiøadí jednoznaèným zpùsobem
nìjaký prvek z mno¾iny $L_2$. Skuteènost, ¾e $\a$ je zobrazení
z~mno¾iny $L_1$ do mno¾iny $L_2$, zapisujeme 
$\a: L_1\to L_2$.
\inl[zobrazení, 1a]

Je-li $\vec x\in L_1$, pak zobrazení $\a: L_1\to L_2$ pøiøadí
prvku $\vec x$ jednoznaènì nìjaký prvek z~mno¾iny~$L_2$. 
Tento prvek oznaèujeme symbolem $\a(\vec x)$ a nazýváme jej
{\em hodnotou zobrazení $\a$ v~$\vec x$} nebo také
{\em obrazem prvku~$\vec x$}. V tomto kontextu se prvku $\vec x$ 
øíká {\em vzor}.
Je-li $M\subseteq L_1$, 
pak definujeme
$$
  \a(M) = \bigl\{\vec y\in L_2;\; \exists \vec x\in M
                \hbox{ tak, ¾e }
                \a(\vec x) = \vec y \bigr\}.
$$
\par\inl[hodnota: zobrazení]
\inl[obraz, vzor]

\priklad [pZ]
%%%%%%%%
Pro ilustraci uvedeme pøíklady nìkterých zobrazení:
\item {(1)} Funkce $f:\R\to\R$, která ka¾dému $x\in\R$ pøiøadí $\sin(x)\in\R$
          je speciální pøípad zobrazení.
\item {(2)} Zobrazení $\a_2$ z mno¾iny diferencovatelných funkcí do mno¾iny funkcí,
          které ka¾dé funkci pøiøadí její derivaci. Tj. $\a_2(f) = f'$.
\item {(3)} Zobrazení $\a_3$ z mno¾iny orientovaných úseèek do mno¾iny
          orientovaných
          úseèek, které ka¾dému vektoru pøiøadí jeho \uv{stín} na pevnì zvolené
          rovinì procházející poèátkem.
\item {(4)} Zobrazení $\a_4$ z mno¾iny spojitých funkcí do mno¾iny reálných èísel,
          které ka¾dé spojité funkci pøiøadí hodnotu
          urèitého integrálu této funkce od nuly do jedné. Tedy
          $\a_4(f) = \int_0^1 f(x)\d x$.
\item {(5)} Zobrazení $\a_5$ z mno¾iny funkcí do mno¾iny nekoneèných posloupností,
          které ka¾dé funkci $f$ pøiøadí nekoneènou posloupnost
          $f(1), f(2), f(3), \ldots$
\item {(6)} Zobrazení $\a_6$ z mno¾iny posloupností do mno¾iny funkcí, které
          ka¾dé posloupnosti $c_1, c_2, c_3, \ldots$ pøiøadí po èástech
          konstantní funkci, která je nulová na $(-\infty,1)$ a
          $f(x)=c_i$ pro $x\in\langle i,i+1)$.
\item {(7)} Zobrazení $\c_B$ z mno¾iny orientovaných úseèek $U_O$ do mno¾iny
          uspoøádaných trojic $\R^3$, které ka¾dé úseèce pøidìlí její
          souøadnice vzhledem k pevnì zvolené uspoøádané bázi $(B)$.

\okraj Zobrazení \uv{na} | Zobrazeni "na"

\definice [defna]
%%%%%%%%%
Nech» $L_1$ a $L_2$ jsou libovolné mno¾iny a uva¾ujme
$\a: L_1\to L_2$. Pokud platí $\a(L_1) = L_2$, øíkáme, ¾e 
$\a$ je zobrazení z mno¾iny $L_1$ {\em na mno¾inu $L_2$}
(nebo øíkáme, ¾e zobrazení je {\em surjektivní}). 
\inl[zobrazení: na]
\inl[zobrazení: surjektivní, surjektivní zobrazení]

\poznamka
%%%%%%%%%
Zobrazení $\a$ z mno¾iny $L_1$ na mno¾inu $L_2$ je speciální 
pøípad zobrazení z mno¾iny $L_1$ do mno¾iny $L_2$ (v¹imneme si
rozdílnosti slùvek \uv{do} a \uv{na}). Mù¾e se stát, ¾e existují prvky
$\vec y\in L_2$, pro které neexistuje ¾ádný prvek $\vec x\in L_1$,
který by splòoval $\a(\vec x) = \vec y$. V takovém pøípadì
zobrazení $\a$ není \uv{na} mno¾inu $L_2$, je jenom \uv{do} mno¾iny
$L_2$. Lidovì øeèeno, mno¾ina $L_2$ je
v takovém pøípadì \uv{vìt¹í}, ne¾ mno¾ina v¹ech obrazù
zobrazení $\a$.

\okraj Prosté\hb zobrazení | Proste zobrazeni

\definice [proste]
%%%%%%%%%
Nech» $L_1$ a $L_2$ jsou libovolné mno¾iny a uva¾ujme
$\a: L_1\to L_2$. Zobrazení $\a$ je {\em prosté} 
({\em injektivní\/}), pokud
pro ka¾dé dva prvky $\vec x_1\in L_1$, $\vec x_2\in L_1$,
$\vec x_1\not=\vec x_2$ platí $\a(\vec x_1)\not=\a(\vec x_2)$.
Je-li zobrazení prosté i \uv{na} mno¾inu, øíkáme mu {\em bijektivní} zobrazení.
\inl[zobrazení: prosté, prosté zobrazení]
\inl[zobrazení: injektivní, injektivní zobrazení]
\inl[zobrazení: bijektivní, bijektivní zobrazení]

\priklad
%%%%%%%%
Zobrazení (4), (5) a (7) z pøíkladu\cite[pZ] jsou \uv{na} mno¾inu
(surjektivní). Ostatní zobrazení v~tomto pøíkladu nejsou \uv{na}
mno¾inu. Zobrazení (6) a (7) jsou zobrazení prostá (injektivní). Ostatní zobrazení 
v~pøíkladu\cite[pZ] nejsou prostá. Zobrazení (7) je prosté i \uv{na},
tedy je to bijektivní zobrazení.


\okraj Definice\hb lineárního zobrazení | Definice linearniho zobrazeni

\definice* [linzob]
%%%%%%%%%
Nech» $L_1$ a $L_2$ jsou lineární prostory, $\a: L_1\to L_2$ je
zobrazení z $L_1$ do $L_2$. Zobrazení~$\a$ nazýváme 
{\em lineárním zobrazením}, pokud pro v¹echna $\vec x\in L_1$,
$\vec y\in L_1$, $\alpha\in\R$ platí
$$
  \eqalign{
   \bod(1)  \a(\vec x + \vec y) = \a(\vec x) + \a(\vec y), \cr
   \bod(2)  \a(\alpha\cdot\vec x) = \alpha\cdot \a(\vec x). }
$$
\par\inl[lineární: zobrazení, zobrazení: lineární]

\poznamka*
%%%%%%%%%
Lineární zobrazení \uv{zachovává} operace sèítání a násobení konstantou.
Seèteme-li dva prvky z~$L_1$ a výsledek pøevedeme prostøednictvím
lineárního zobrazení do $L_2$, výjde toté¾, jako kdybychom nejprve 
jednotlivé prvky pøevedli prostøednictvím zobrazení do $L_2$ a tam je
seèetli. V¹imneme si, ¾e první operace~\uv{$+$} ve vlastnosti~(1)
je sèítáním definovaným na lineárním prostoru $L_1$, zatímco 
druhá operace~\uv{$+$} v~této vlastnosti je sèítáním 
definovaným na lineárním prostoru $L_2$. Tato dvì sèítání mohou být
definována zcela rozdílným zpùsobem na zcela rozdílných lineárních
prostorech. Podobnì ve vlastnosti~(2) je první operace~\uv{$\cdot$}
násobkem definovaným na~$L_1$, zatímco druhá operace~\uv{$\cdot$} 
je násobek definovaný na~$L_2$.

\veta [zobnuly]
%%%%%
Pro lineární zobrazení $\a: L_1\to L_2$ platí 
$\a(\vec o_1) = \vec o_2$, kde $\vec o_1$ je nulový vektor lineárního
prostoru~$L_1$ a $\vec o_2$ je nulový vektor lineárního
prostoru~$L_2$.

\dukaz
%%%%%%
Podle vlastnosti~(7) definice\cite[dlp] je $\vec o_1=0\,\vec x$, kde
$\vec x\in L_1$. Podle vlastnosti~(2) definice\cite[linzob]
je $\a(\vec o_1) = \a(0\,\vec x) = 0\,\a(\vec x) = \vec o_2$.

\priklad
%%%%%%%%
Prozkoumáme linearitu zobrazení z pøíkladu\cite[pZ].

Zobrazení (1) není lineární, proto¾e 
$\sin(\pi/2+\pi/2)=\sin(\pi)=0\not=\sin(\pi/2)+\sin(\pi/2)=2$.
%
Zobrazení~$\a_2$ je lineární, proto¾e $(f+g)'=f'+g'$ a $(\alpha f)'=\alpha f$.
%
Zobrazení~$\a_3$ je lineární za pøedpokladu, ¾e svìtlo dopadá na rovinu z
nekoneènì vzdáleného zdroje, tj. paprsky jsou rovnobì¾né. Dále musí
mít svùj stín (ze svìtla z protismìru) i vektory, které jsou \uv{schovány
za rovinou}. Sèítání a násobení konstantou provádíme v tomto pøíkladì 
geometricky v~souladu s~pøíkladem\cite[lpvv]. Skuteènì platí, ¾e stín
souètu je souèet stínù a alfa násobek stínu je stín alfa násobku.
Naèrtnìte si obrázek a najdìte v nìm odpovídající podobné trojúhelníky.

Zobrazení~$\a_4$ je lineární: 
$\int (f(x)+g(x))\d x = \int f(x)\d x+\int g(x)\d x$ a
$\int (\alpha f(x))\d x = \alpha \int f(x)\d x$. 
%
Zobrazení~$\a_5$ je lineární, proto¾e $(f+g)(i)=f(i)+g(i)$ a 
$(\alpha f)(i)=\alpha(f(i))$ pro v¹echna
pøirozená~$i$. Na prostoru $L_1$ v tomto pøípadì sèítáme funkce, na
prostoru $L_2$ sèítáme nekoneèné posloupnosti.
%
Zobrazení~$\a_6$ je lineární, proto¾e $(c_1,c_2\ldots) +
(d_1,d_2\ldots) = (c_1+d_1,c_2+d_2\ldots{})$ a obraz této posloupnosti
je roven souètu obrazù jednotlivých posloupností $(c_1,c_2\ldots)$ a $(d_1,d_2\ldots)$. 
Na $L_2$ sèítáme funkce. Také platí $\alpha(c_1,c_2\ldots)=(\alpha c_1,\alpha c_2,\ldots)$
a obraz této posloupnosti je $\alpha$-násobkem obrazu posloupnosti $(c_1,c_2\ldots)$.
%
Linearitu zobrazení $\c_B$, které ka¾dému vektoru pøiøadí souøadnice, doká¾eme
v~tomto textu pozdìji. 

\priklad [R2toR3]
%%%%%%%%
Ovìøíme, zda je zobrazení $\a: \R^2\to\R^3$, definované vzorcem
$$
  \a(x_1,x_2) = (x_1+2x_2,\; -x_2,\; 2x_1-3x_2),
$$ 
lineární. Poznamenejme, ¾e jsme v uvedeném vzorci vynechali jednu
kulatou závorku, jako se to obvykle u~zobrazení definovaných na $\R^n$
dìlá, tj.~místo abychom psali
$\a\bigl((x_1,x_2)\bigr)$, pí¹eme struènì $\a(x_1,x_2)$.

Ovìøíme vlastnosti (1) a (2) z definice\cite[linzob]:
$$
  \eqalign{
   \bod(1) \a\bigl((x_1,x_2) + (y_1, y_2)\bigr) 
           = \a(x_1+y_1, x_2+y_2) = \cr
   &\qquad = 
     \bigl(x_1+y_1+2(x_2+y_2), -(x_2+y_2), 2(x_1+y_1)-3(x_2+y_2)\bigr)
     = \cr
   &\qquad = (x_1+2x_2, -x_2, 2x_1-3x_2) +
             (y_1+2y_2, -y_2, 2y_1-3y_2) 
           = \a(x_1, x_2) + \a(y_1, y_2), \cr
   \bod(2) \a\bigl(\alpha\,(x_1, x_2)\bigr) =
           \a(\alpha\,x_1, \alpha\,x_2) =
           (\alpha\,x_1+2\alpha\,x_2, 
             -\alpha\,x_2, 2\alpha\,x_1-3\alpha\,x_2) = \cr
   &\qquad = \alpha\,(x_1+2x_2, -x_2, 2x_1-3x_2) =
           \alpha\,\a(x_1, x_2).
  }
$$

\priklad
%%%%%%%%
Zobrazení $\a:\R^4\to\R^3$ definované pøedpisem
$\a(x_1,x_2,x_3,x_4) = (x_2+x_3, x_3+3, 2x_1)$
není lineární, proto¾e $\a(0,0,0,0) = (0,3,0)$ a to není nulový
vektor v~$\R^3$. Podle vìty\cite[zobnuly] musí ka¾dé lineární
zobrazení zobrazit nulový vektor na nulový vektor.

Pilnìj¹í ètenáøi si zkusí ovìøit, ¾e $\a$ není lineární, pøímo
z~definice\cite[linzob]. % nebo z~principu superpozice\cite[principsupozice].

\poznamka
%%%%%%%%%
Podmínka vìty\cite[zobnuly], ¾e $\a(\vec o_1) = \vec o_2$, je nutná
podmínka linearity zobrazení, ale není to podmínka
postaèující. Napøíklad $\sin(0)=0$, ale zobrazení $\sin:\R\to\R$ 
není lineární.

\priklad
%%%%%%%%
Nech» $\R$ je lineární prostor z pøíkladu\cite[LPR] a $\R^+$ je
lineární prostor z pøíkladu\cite[ObskurniLP]. Uva¾ujme zobrazení
$\exp: \R\to\R^+$, které ka¾dému reálnému èíslu $x$ pøiøadí hodnotu
$e^x$. Toto zobrazení je lineární. Skuteènì:
$$
  \exp(x+y) = \exp x\cdot \exp y = (\exp x)\oplus (\exp y), \qquad
  \exp(\alpha x) = (\exp x)^\alpha = \alpha\odot(\exp x).
$$
Vidíme, ¾e linearita zobrazení závisí nejen na zpùsobu pøiøazení
hodnoty zobrazením, ale také na operacích $+$ a $\cdot$, které jsou definovány na
jednotlivých lineárních prostorech $L_1$ a $L_2$. Zjevnì zobrazení
$\exp: \R\to\R$ lineární není, proto¾e $\exp(0)=1$, tj. nulový prvek 
se nezobrazí na nulový prvek.


\okraj Princip\hb superpozice | Princip superposice

\veta (princip superpozice) [principsupozice]
%%%%%
Nech» $L_1$ a $L_2$ jsou lineární prostory. Zobrazení
$\a: L_1\to L_2$ je lineární právì tehdy, kdy¾
pro v¹echna $\vec x\in L_1$, $\vec y\in L_1$, $\alpha\in\R$,
$\beta\in\R$ platí
$$
  \a(\alpha\,\vec x + \beta\,\vec y) =
  \alpha\,\a(\vec x) + \beta\,\a(\vec y).
  \rce(superpozice)
$$
\par\inl[princip: superpozice]

\dukaz
%%%%%%
Nejprve pøedpokládejme, ¾e pro zobrazení $\a: L_1\to L_2$ 
platí\cite(superpozice) pro v¹echna $\vec x, \vec y\in L_1$
a $\alpha, \beta \in \R$. Doká¾eme, ¾e $\a$ je lineární, tj.~¾e 
platí~(1) a~(2) z~definice\cite[linzob]. Pokud zvolíme
$\alpha=\beta=1$, plyne z\cite(superpozice) vlastnost~(1) a pokud
volíme $\beta=0$, plyne z\cite(superpozice) vlastnost~(2).

Nech» nyní $\a: L_1\to L_2$ je lineární. Platí
$$
  \a(\alpha\,\vec x + \beta\,\vec y) \buildrel (1)\over =
  \a(\alpha\,\vec x) + \a(\beta\,\vec y) \buildrel (2)\over =
  \alpha\,\a(\vec x) + \beta\,\a(\vec y).
$$
Nad rovnítky jsme uvedli, kterou vlastnost jsme zrovna pou¾ili.

\poznamka
%%%%%%%%%
Opakovaným pou¾itím principu superpozice (nebo formálnì matematickou
indukcí) lze snadno dokázat, ¾e
$\a:L_1\to L_2$ je lineární právì tehdy, kdy¾ pro v¹echna $n\in\N$,
$\vecc x_n\in L_1$, $\alpha_1, \alpha_2, \ldots, \alpha_n\in \R$ platí
$$
  \a(\lkvecc \alpha.x_n) = \alpha_1\,\a(\vec x_1) + 
   \alpha_2\,\a(\vec x_2) + \cdots + \alpha_n\,\a(\vec x_n).
  \rce(superpozice2)
$$

\okraj Zachování obalù | Zachovani obalu

\veta [alob]
%%%%%
Nech» $\a:L_1\to L_2$ je lineární zobrazení, $M\subseteq L_1$.
Pak $\a\bigl(\lob<M>\bigr) = \bigl<\a(M)\bigr>$.

\dukaz
%%%%%%
Nech» $\vec y\in\a\bigl(\lob<M>\bigr)$. Pak existuje vektor
$\vec x\in\lob<M>$ takový, ¾e $\a(\vec x) = \vec y$.
Proto¾e $\vec x\in\lob<M>$, existuje podle definice lineárního obalu
koneènì mnoho $\vecc x_i\in M$ takových, ¾e 
$\vec x$ je lineární kombinací
tìchto vektorù. Proto¾e $\a$ je lineární, 
máme podle\cite(superpozice2)
$$
  \vec y = \a(\vec x) = \a(\lkvecc \alpha.x_n) =
  \alpha_1\,\a(\vec x_1) + \alpha_2\,\a(\vec x_2) + \cdots
  + \alpha_n\,\a(\vec x_n).
$$
Z tohoto zápisu je patrné, ¾e $\vec y\in\bigl<\a(M)\bigr>$.

Nech» nyní obrácenì $\vec y\in\bigl<\a(M)\bigr>$. Z definice
lineárního obalu plyne, ¾e existuje koneènì mnoho
$\vec y_i\in\a(M)$ takových, ¾e $\vec y$ je lineární kombinací
tìchto vektorù. Pro ka¾dý vektor $\vec y_i$ existuje vektor
$\vec x_i\in M$ takový, ¾e $\a(\vec x_i) = \vec y_i$. Máme tedy
$$
  \vec y = \lkvecc\beta.y_m =  
  \beta_1\,\a(\vec x_1) + \cdots
  + \beta_m\,\a(\vec x_m) = \a(\lkvecc \beta.x_m) = \a(\vec x).
$$
Je tedy $\vec x \in \lob<M>$ a proto¾e $\vec y = \a(\vec x)$, je té¾
$\vec y\in \a\bigl(\lob<M>\bigr)$.

\poznamka [poznalob]
%%%%%%%%%
Vìta\cite[alob] má tento dùsledek: Je-li $M\subseteq L_1$ lineární podprostor 
v $L_1$, pak $\a(M)$ je lineární podprostor v $L_2$. Staèí si uvìdomit
platnost vìty\cite[lob=lpp]. Lineární zobrazení nám tedy pøevádí 
podprostory na podprostory. Speciálnì $\a(L_1)$ je podprostor v $L_2$,
který nazýváme {\em prostor obrazù}.
\inl [prostor: obrazù]

\okraj Jádro\hb zobrazení | Jadro zobrazeni


\definice* [jadro]
%%%%%%%%%
Nech» $L_1$, $L_2$ jsou lineární prostory, $\vec o_2$ je nulový vektor
v~lineárním prostoru $L_2$ a $\a: L_1\to L_2$ je
lineární zobrazení. Mno¾inu
$$
   \ker\a = \{\vec x\in L_1;\; \a(\vec x) = \vec o_2\}.
$$
nazýváme % {\em nulovým prostorem lineárního zobrazení $\a$} nebo také
{\em jádrem lineárního zobrazení $\a$}.
\inl[jádro: zobrazení, KerA]

\veta [jadroprst]
%%%%%
Jádro lineárního zobrazení $\a: L_1\to L_2$ tvoøí lineární podprostor
lineárního prostoru $L_1$

\dukaz
Pro $\vec x, \vec y\in \ker\a$ a $\alpha\in\R$ platí:
$$
  \eqalign{
  \a(\vec x) = \vec o_2, \quad \a(\vec x)=\vec o_2, &\hbox{ tak¾e }
  \a(\vec x+\vec y) = \a(\vec x)+\a(\vec x) = \vec o_2+ \vec o_2 = \vec o_2,
  \hbox{ neboli } \vec x+\vec y\in\ker\a, \cr
  &\hbox{ dále } \a(\alpha\vec x) = \alpha\a(\vec x) = \alpha \vec o_2
  = \vec o_2, \hbox{ tak¾e také } \alpha\vec x \in \ker\a.}
$$


\priklad [kerR2toR3]
%%%%%%%%
Najdeme jádro zobrazení $\a$ z pøíkladu\cite[R2toR3]. Podle 
definice\cite[jadro] je
$$
  \ker\a = \bigl\{(x_1,x_2);\;\a(x_1,x_2) = (0,0,0)\bigr\} =
   \bigl\{(x_1,x_2);\;(x_1+2x_2, -x_2, 2x_1-3x_2) = (0,0,0)\bigr\}.
$$
Proto¾e uspoøádané trojice se rovnají, kdy¾ se rovnají odpovídající
slo¾ky, musí èísla $x_1$, $x_2$ splòovat soustavu lineárních rovnic
$$
\eqalign {
  x_1+2x_2 &= 0\cr -x_2  &= 0\cr 2x_1-3x_2 &=0 
}
$$
ze které plyne, ¾e $x_1=0$ a $x_2=0$. Tak¾e
$
  \ker\a = \bigl\{(0,0)\bigr\}.
$

\priklad
%%%%%%%%
Uvedeme si jádra lineárních zobrazení z pøíkladu\cite[pZ].

$\ker\a_2$ je roven mno¾inì v¹ech funkcí, které jsou
konstantní. Právì tyto funkce se toti¾ zobrazí pomocí derivace na
nulovou funkci.

$\ker\a_3$ je roven mno¾inì v¹ech orientovaných úseèek,
které le¾í na pøímce procházející poèátkem, která je rovnobì¾ná s
paprsky svìtla. Skuteènì, tyto vektory mají nulový stín.

$\ker\a_4$ obsahuje v¹echny funkce $f$, pro které je
$\int_0^1 f(x)\d x =0$.

$\ker\a_5$ obsahuje v¹echny funkce $f$, které mají nulovou
hodnotu ve v¹ech pøirozených èíslech. Hodnoty v ostatních reálných
èíslech mohou mít libovolné.

$\ker\a_6=\{(0,0,0,\ldots)\}$. Tento prostor obsahuje jen nulový vektor
lineárního prostoru nekoneèných posloupností.

Jediný vektor, který má nulové souøadnice, je nulový vektor (úseèka,
která zaèíná i konèí v bodì~$O$). Proto
i zobrazení (7) má ve svém jádru jen nulový vektor.

\okraj Defekt a hodnost\hb zobrazení | Defekt a hodnost zobrazeni

\dolu4mm
\obrazek .4+.05 7 obr3
{
  \p 25 80 {\a}
  \p 74 25 \vec o_1
  \p 73 140 \vec o_2
  \p 103 10  {\ker\a}
  \p 117 125  \a(L_1)
  \p 140 14  L_1
  \p 142 128 L_2
}
%
\definice* [defhod]
%%%%%%%%%
{\em Defekt lineárního zobrazení} $\a: L_1\to L_2$ je 
definován, jako $\dim\ker\a$ a {\em hodnost lineárního zobrazení}~$\a$
je definována jako $\dim\a(L_1)$. Defekt $\a$ znaèíme $\defekt\a$
a hodnost~$\a$ znaèíme $\hod\a$. Je tedy
\inl[defekt: zobrazení, hodnost: zobrazení, defA, hoda, hodnost]
$$
  \eqalign{
  \defekt\a &= \dim\ker\a, \cr
  \hod \a   &= \dim\a(L_1). }
$$ 

\poznamka
%%%%%%%%%
Pozdìji uká¾eme, ¾e defekt zobrazení udává
zhruba øeèeno \uv{vzdálenost} zobrazení od ideálního prostého
zobrazení. Jak moc je zobrazení $\a$ \uv{defektní} souvisí také s tím, kolik
informace, které dovedeme v~prostoru $L_1$ rozli¹it, 
se stává po aplikaci zobrazení $\a$ v prostoru $L_2$ nerozli¹itelné.
\ha 5

\priklad
%%%%%%%%
Podíváme se na defekty a hodnosti lineárních zobrazení z pøíkladu\cite[pZ].

$\defekt\a_2=\dim\ker\a_2= \dim\{c\cdot 1;\, c\in\R\} = \dim\lob<1>= 1$. 
Proto¾e $\a_2(L_1)$ obsahuje jistì (kromì dal¹ích funkcí) v¹echny
polynomy, má tento prostor nekoneènou dimenzi, tedy $\hod\a_2=\infty$.

$\defekt\a_3=\dim\ker\a_3= \dim\{\vec u;\,\vec u \hbox{ le¾í na
spoleèné pøímce}\} = 1$. Proto¾e $\a_3(U_O)$ obsahuje mno¾inu v¹ech
vektorù, které le¾í v~rovinì, kam se promítají stíny, je dimenze
tohoto prostoru~2, neboli $\hod\a_3=2$. Zobrazení $\a_3$
se napøíklad pou¾ívá v~poèítaèové grafice, kdy¾ je tøeba
3D scénu zobrazit na stínítko monitoru. Rovnost $\defekt\a_3=1$ øíká, ¾e
tímto zobrazením ztrácíme informace z~jedné dimenze.

$\defekt\a_4=\infty$, proto¾e $\ker\a_4$ obsahuje napøíklad funkce
$(x-1/2), (x-1/2)^3, (x-1/2)^5, \ldots$ a tìch je nekoneènì mnoho a
jsou lineárnì nezávislé. Proto¾e dále $\a_4(L_1) = \R$, je
$\hod\a_4=1$.

$\defekt\a_5=\infty$, proto¾e $\ker\a_5$ obsahuje také funkce, které
jsou rovny polynomùm a¾ na to, ¾e na pøirozených èíslech
jsou rovny nule. Tyto funkce jsou sice nespojité, ale $L_1$
obsahuje v¹echny funkce, tedy i nespojité funkce. $\hod\a_5=\infty$,
proto¾e mno¾ina $\a(L_1)$ obsahuje v¹echny nekoneèné posloupnosti,
jmenovitì tedy $(1,0,0,\ldots), (0,1,0,\dots), \ldots$ a ty jsou
lineárnì nezávislé a je jich nekoneènì mnoho.

$\defekt\a_6=0$, proto¾e $\ker\a_6=\{\vec o_1\}$. 
$\hod\a_6=\infty$, proto¾e napøíklad obrazy následujících posloupností
$(1,0,0,\ldots), (0,1,0,\dots), \ldots$ jsou lineárnì nezávislé.

$\defekt\c_B=\dim\{\vec o_1\}=0$, $\hod\c_B=\dim\R^3=3$.

\priklad
%%%%%%%%
Zobrazení $\a:\R^2\to\R^3$, $\a(x_1,x_2) = (x_1+2x_2, -x_2, 2x_1-3x_2)$
z pøíkladu\cite[R2toR3] má defekt roven nule. 
V~pøíkladu\cite[kerR2toR3] jsme toti¾ ukázali, ¾e $\ker\a=\{\vec o_1\}$.
Spoèítáme je¹tì $\hod\a$:
$$
  \hod\a = \dim\a(L_1) = \dim\a(\lob<(1,0),(0,1)>) =
  \dim\lob<\a(1,0),\a(0,1)> = \dim\lob<(1,0,2),(2,-1,-3)> = 2.
$$

\veta* [def+hod]
%%%%%
Nech» $\a:L_1\to L_2$ je lineární zobrazení. Pak
$\defekt\a+\hod\a=\dim L_1$

\exdukaz
Nech» nejprve jsou $\defekt\a$ i $\hod\a$ koneèné.
Oznaème $\vecc b_k$ bázi lineárního podprostoru $\ker\a$
a $\vecc c_m$ bázi lineárního podprostoru $\a(L_1)$. Ke ka¾dému vektoru
$\vec c_i$ existuje vektor $\vec c'_i\in L_1$ takový, ¾e $\a(\vec c'_i)=\vec c_i$.
K~jednomu vektoru $\vec c_i$ mù¾e existovat více vektorù $\vec c'_i$
uvedené vlastnosti, v takovém pøípadì je jedno, který vybereme.
Doká¾eme, ¾e $\{\vecc b_k, \vecc c'_m\}$ tvoøí bázi lineárního
prostoru~$L_1$. Dokazovaný vzorec pak plyne z toho, ¾e 
$\dim L_1$ je rovna poètu prvkù báze, tedy $\dim L_1=k+m$,
pøitom $\defekt\a=k$ a $\hod\a=m$.

Proè je mno¾ina $\{\vecc b_k, \vecc c'_m\}$ lineárnì nezávislá?
$$
  \eqalign{
  \vec o_1 =& \lkvecc \alpha.b_k + \lkvecc \beta.c'_k, \cr
  \hbox{tak¾e:}\quad 
  \vec o_2 =& \a(\vec o_1) = \a(\lkvecc \alpha.b_k
  + \lkvecc \beta.c'_k,) =\cr
  {}=& \a(\lkvecc \alpha.b_k) + \beta_1\a(\vec c'_1) +  
  \beta_2\a(\vec c'_2) + \cdots \beta_m\a(\vec c'_m) =\cr
  {}=& \beta_1\a(\vec c'_1) +  
  \beta_2\a(\vec c'_2) + \cdots \beta_m\a(\vec c'_m) =
  \lkvecc \beta.c_m.
}
$$
Vyu¾ili jsme vztahu $\a(\lkvecc \alpha.b_k)=\vec o_2$, 
který je dùsledkem faktu, ¾e tato lineární kombinace le¾í
v~$\ker\a$. Proto¾e $\{\vecc c_m\}$ je báze, je lineárnì nezávislá,
tak¾e $\beta_i=0$ pro v¹echny $i\in\{1,2,\ldots,m\}$ (pouze triviální
lineární kombinace báze je rovna nulovému vektoru). Dosazením tohoto
poznatku do pùvodního vztahu máme
$\vec o_1= \lkvecc \alpha.b_k$.
Proto¾e $\{\vecc b_k\}$ je báze, musí $\alpha_i=0$ pro v¹echny 
$i\in\{1,2,\ldots,k\}$. Tak¾e pouze triviální lineární kombinace
mno¾iny vektorù  $\{\vecc b_k, \vecc c'_m\}$ je rovna nulovému
vektoru, je tedy tato mno¾ina lineárnì nezávislá.

Proè je $\lob<\vecc b_k, \vecc c'_m>=L_1$? 
Je tøeba ukázat, ¾e ka¾dý vektor $\vec x$ lze zapsat jako
lineární kombinaci vektorù z $\{\vecc b_k, \vecc c'_m\}$.
Existují koeficienty $\beta_i$ tak, ¾e
$$
  \a(\vec x) = \lkvecc \beta.c_m,
$$
proto¾e $\{\vecc c_m\}$ je báze $\a(L_2)$. Dále platí
$$
  \a(\vec x-\lkvecc\beta.c'_m) = \a(\vec x) - (\lkvecc \beta.c_m) =
  \a(\vec x) - \a(\vec x) = \vec o_2,
$$ 
tak¾e vektor $\vec x-\lkvecc\beta.c'_m$ le¾í v $\ker\a$ a lze jej
vyjádøit jako lineární kombinaci báze lineárního podprostoru
$\ker\a$. Je tedy
$$
  \vec x-\lkvecc\beta.c'_m = \lkvecc\alpha.b_k
$$
a po pøiètení $\lkvecc\beta.c'_m$ k obìma stranám rovnosti
máme $\vec x$ vyjádøený jako
lineární kombinaci vektorù $\vecc b_k, \vecc c'_m$.

Je-li $\defekt\a=\infty$, musí být té¾ $\dim\L_1=\infty$, proto¾e
$\ker\a$ má nekoneènou dimezi a je podprostorem~lineárního prostoru~$L_1$. 
%
Nech» koneènì $\hod\a=\infty$. Pro spor pøedpokládejme, ¾e $\dim L_1$
je koneèná. Nech» $\{\vecc b_k\}$ je báze $L_1$. Platí 
$\a(L_1)=\a(\lob<\vecc b_k>)=\lob<\a(\vec b_1), \a(\vec b_2), \ldots \a(\vec b_k)>$.
Podle vìty\cite[steinitz2] tento obal nemù¾e obsahovat lineárnì
nezávislou mno¾inu s vìt¹ím poètem prvkù ne¾~$k$, co¾ je spor s tím,
¾e $\hod\a=\infty$.

\priklad
%%%%%%%%
Pov¹imneme si, ¾e vìta $\defekt\a+\hod\a=\dim L_1$ \uv{funguje} ve
v¹ech pøíkladech lineárních zobrazení uvedených v~pøíkladu\cite[pZ].
(2):~$1+\infty=\infty$, (3):~$1+2=3$, (4):~$\infty+1=\infty$, 
(5):~$\infty+\infty=\infty$, (6):~$0+\infty=\infty$, (7)~$0+3=3$.
%
Zobrazení z pøíkladu\cite[R2toR3] rovnì¾ splòuje $0+2=2$.

\veta [defA=proste]
%%%%%
Nech» $\a:L_1\to L_2$ je lineární zobrazení. Pak
$\defekt\a=0$ právì tehdy, kdy¾ $\a$ je prosté.

\dukaz
Nech» $\defekt\a=0$ a $\vec x,\vec y\in L_1$, $\vec x\not=\vec y$.
Pro spor pøedpokládejme, ¾e $\a(\vec x)=\a(\vec y)$, tak¾e 
$\a(\vec x)-\a(\vec y)=\vec o_2$, tak¾e $\a(\vec x-\vec y)=\vec o_2$.
To znamená, ¾e $\vec x-\vec y\in\ker\a$, ale podle pøedpokladu víme, ¾e
$\vec x-\vec y\not=\vec o_1$ a souèasnì $\ker\a=\{\vec o_1\}$. Spor.

Nech» nyní $\a$ je prosté. Víme, $\a(\vec o_1)=\a(\vec o_2)$. Proto¾e
je $\a$ prosté, je $\vec o_1$ jediný vektor, který se zobrazí na $\vec
o_2$, tak¾e $\ker\a=\{\vec o_1\}$.

\okraj Zobrazení lineárnì (ne)závislých vektorù | 
       Zobrazeni linearne (ne)zavislych vektoru

\veta
%%%%%
Nech» $\a:L_1\to L_2$ je lineární zobrazení, $M\subseteq L_1$ je
lineárnì závislá mno¾ina v $L_1$. Pak je $\a(M)$ lineárnì závislá
mno¾ina v $L_2$.

\dukaz
%%%%%%
Je-li $M$ lineárnì závislá, pak koneèná pomno¾ina $\{\vecc x_k\}\subseteq M$
je lineárnì závislá. Tak¾e platí
$$
\alpha_1\vec x_1 + \alpha_2\vec x_2 + \cdots + \alpha_n\vec x_n = \vec o_1,
$$
pøièem¾ aspoò jedno $\alpha_i$ je nenulové. Zobrazením obou stran
rovnice a z principu superpozice dostáváme:
$$
\a(\alpha_1\vec x_1 + \alpha_2\vec x_2 + \cdots + \alpha_n\vec x_n) =
\alpha_1\a(\vec x_1) + \alpha_2\a(\vec x_2) + \cdots + \alpha_n\a(\vec x_n)
= \vec o_2,
$$
pøitom stále jedno $\alpha_i$ je nenulové. Tak¾e vektory
$\{\a(\vec x_1), \a(\vec x_2), \ldots, \a(\vec x_n)\}\subseteq \a(M)$ 
jsou lineárnì závislé, tak¾e i $\a(M)$ je lineárnì závislá mno¾ina.


\poznamka
%%%%%%%%%
Lineární zobrazení nemusí lineárnì nezávislou mno¾inu $N$ zobrazit na
mno¾inu lineárnì nezávislou. Napøíklad nenulová konstantní funkce
se zobrazí pøi pou¾ití zobrazení $\a_2$ z pøíkladu\cite[pZ] (derivace) 
na nulovou funkci, tedy na nulový vektor v $L_2$, který je lineárnì
závislý. Vzorem byla ale nenulová funkce, tedy lineárnì nezávislý
vektor.

V pøedchozím textu jsme ukázali, ¾e v¹echny ostatní \uv{vlastnosti
linearity} (lineární podprostor, lineární obal, lineární závislost) se
pøi lineárním zobrazení nemìní. V jakém pøípadì se nemìní lineární
nezávislost ukazuje následující vìta.

\veta [zobN]
%%%%%
Lineární zobrazení $\a$ zobrazuje lineárnì nezávislé mno¾iny vzorù 
na lineárnì nezávislé mno¾iny obrazù
právì tehdy,
kdy¾ $\a$ je prosté zobrazení.

\dukaz
Nech» nejprve $\a(N)$ je lineárnì nezávislá pro v¹echny lineárnì nezávislé
mno¾iny $N$. Doká¾eme, ¾e $\a$ je prosté zobrazení.
Volme vektory $\vec x,\vec y\in L_1$, $\vec x\not=\vec y$. 
Potøebujeme dokázat $\a(\vec x)\not=\a(\vec y)$.
Zvolme $N=\{\vec x-\vec y\}$, tj. $N$ je nezávislá.
Pak $\a(N)=\{\a(\vec x-\vec y)\}$ je podle pøedpokladu lineárnì nezávislá, tedy
$\a(\vec x-\vec y)\not=\vec o_2$. Z linearity zobrazení je 
$\vec o_2\not=\a(\vec x-\vec y)=\a(\vec x)-\a(\vec y)$, neboli
$\a(\vec x)\not=\a(\vec y)$.

Obrácenì, pøedpokládejme, ¾e $\a$ je prosté a $N$ je lineárnì
nezávislá mno¾ina. Pro spor budeme pøedpokládat, ¾e $\a(N)$ je
lineárnì závislá. Pak musí
existovat koneènì mnoho $\{\vecc x_k\}\subseteq N$,
pro které lze najít nenulové $\alpha_i$ tak, ¾e
$$
  \alpha_1\a(\vec x_1) + \alpha_2\a(\vec x_2) + \ldots + 
  \alpha_n\a(\vec x_n) = \vec o_2
$$
Podle principu superpozice je
$$
  \alpha_1\a(\vec x_1) + \alpha_2\a(\vec x_2) + \ldots + 
  \alpha_n\a(\vec x_n) = \a(\alpha_1\vec x_1 + \alpha_2\vec x_2 + \ldots + 
  \alpha_n\vec x_n) = \vec o_2
$$
tak¾e $\alpha_1\vec x_1 + \alpha_2\vec x_2 + \ldots + \alpha_n\vec
x_n\in \ker\a$. Proto¾e je $\a$ prosté, je podle vìty\cite[defA=proste]
$\ker\a=\{\vec o_1\}$. Tak¾e
$\alpha_1\vec x_1 + \alpha_2\vec x_2 + \ldots + \alpha_n\vec
x_n=\vec o_1$. Pøipomeòme, ¾e $\{\vecc x_k\}$ je podmno¾inou $N$,
tak¾e tyto vektory jsou podle vìty\cite[lnmnoz] lineárnì nezávislé. 
Dále pøipomeòme, ¾e
ve vztahu $\alpha_1\vec x_1 + \alpha_2\vec x_2 + \ldots + \alpha_n\vec
x_n=\vec o_1$ existuje nenulové~$\alpha_i$. Dostáváme spor.

\okraj Souøadnice jako lineární zobrazení | Souradnice jako linearni zobrazeni

\poznamka*
%%%%%%%%%
Pøedchozí vìty nám zaruèují, ¾e zobrazení, které je lineární a prosté,
zobrazí ve¹ekré \uv{lineární skuteènosti}, které mù¾eme zkoumat 
v lineárním prostoru $L_1$ (závislost, nezávislost, podprostory,
lineární obaly, báze, dimenze), bez ztráty informace do lineárního
prostoru $L_2$. Pokud je lineární prostor $L_2$ volen tak, ¾e se tam
tyto skuteènosti pohodlnìji zkoumají, stojí za to pøevést pomocí 
\uv{vhodného lineárního zobrazení} problém z $L_1$ do $L_2$ a tam jej 
podrobit zkoumání. Takovým vhodným lineárním zobrazením je zobrazení,
které vektorùm pøiøazuje souøadnice. To øíká následující vìta.

\veta* [sour-lin]
%%%%%
Nech» $L$ je lineární prostor, $\dim L=n$ a nech» $(B)$ je uspoøádaná
báze prostoru $L$. Pak je zobrazení $\c_B: L\to \R^n$, které ka¾dému
vektoru $\vec x\in L$ pøiøadí jeho souøadnice vzhledem k uspoøádané
bázi $(B)$, zobrazením lineárním, prostým a na $\R^n$.

\dukaz Vìta\cite[jednsouradnice] øíká, ¾e ka¾dému vektoru $\vec x$ lze
jednoznaènì pøiøadit uspoøádanou $n$-tici souøadnic vzhledem k
uspoøádané bázi $(B)$, tak¾e $\c_B$ je zobrazení z $L$ do $\R^n$.

Proè je linární?
Nech» $\c_B(\vec x) = (\alpha_1,\alpha_2,\ldots,\alpha_n)$,
$\c_B(\vec y) = (\beta_1,\beta_2,\ldots,\beta_n)$. Pro 
vìt¹í názornost operace v $L$ budeme znaèit $\oplus$, $\odot$, zatímco
operace v $\R^n$ definované v pøíkladu\cite[LPRn] stejnì jako bì¾né
operace v $\R$ oznaèíme $+$ a~$\cdot$.
Nech» $(B)=(\vecc b_n)$.
Pro vektory vektory $\vec x$ a $\vec y$ platí
$$
  \vec x = \alpha_1\odot \vec b_1 \oplus \alpha_2\odot \vec b_2 
  \oplus \cdots \oplus \alpha_n\odot \vec b_n, \qquad 
  \vec y = \beta_1\odot \vec b_1 \oplus \beta_2\odot \vec b_2 
  \oplus \cdots \oplus \beta_n\odot \vec b_n. 
$$
Po seètení tìchto rovností a po vynásobení první rovnosti èíslem
$\gamma\in\R$ dostáváme
$$
  \eqalign{
  \vec x\oplus \vec y &= (\alpha_1+\beta_1)\odot\vec b_1 \oplus 
      (\alpha_2+\beta_2)\odot\vec b_2 \oplus \cdots \oplus 
      (\alpha_n+\beta_n)\odot\vec b_n, \cr
  \gamma\odot\vec x &= (\gamma\cdot\alpha_1)\odot\vec b_1 \oplus
      (\gamma\cdot\alpha_2)\odot\vec b_2 \oplus \cdots \oplus 
      (\gamma\cdot\alpha_n)\odot\vec b_n. } 
$$
Proto¾e souøadnice vektoru vzhledem k bázi jsou urèeny jednoznaènì,
z~uvedených rovností plyne, ¾e 
$\c_B(\vec x \oplus \vec y) = \c_B(\vec x) + \c_B(\vec y)$,
$\c_B(\gamma\odot\vec x) = \gamma\cdot\c_B(\vec x)$. Zobrazení $\c_B$ 
je tedy lineární.

Hledejme nyní $\ker\c_B$. Proto¾e $\vec o=0\cdot\vec b_1\oplus
0\cdot\vec b_2\oplus\cdots\oplus 0\cdot\vec b_n$ a nenulovému vektoru
se triviální lineární kombinace rovnat nemù¾e, je $\ker\c_B=\{\vec o\}$,
neboli $\defekt\c_B=0$. Z vìty\cite[defA=proste] plyne, ¾e $\c_B$ je
prosté zobrazení.

Proto¾e ke ka¾dému prvku $\vec a\in\R^n$, 
$\vec a = (\alpha_1,\alpha_2,\ldots,\alpha_n)$ existuje $\vec x\in L$,
pro který $\c_B(\vec x) = \vec a$ (staèí volit
$\vec x = \alpha_1\odot \vec b_1 \oplus \alpha_2\odot \vec b_2 
\oplus \cdots \oplus \alpha_n\odot \vec b_n$), je $\c_B(L)=\R^n$. 
Zobrazení $\c_B$
je tedy zobrazením z~$L$ \uv{na}~$\R^n$. Je $\hod\c_B = \dim\R^n = n$.

\okraj Izomorfismus | Isomorfismus

\definice* [defiso]
%%%%%%%%%
Lineární zobrazení $\a: L_1\to L_2$, které je prosté a na $L_2$ se
nazývá {\em izomorfismus}. Existuje-li izomorfismus $\a: L_1\to L_2$,
øíkáme, ¾e prostory $L_1$, $L_2$ {\em jsou izomorfní}, nebo ¾e $L_1$
{\em je izomorfní} s~$L_2$, resp. $L_2$ {\em je izomorfní} s~$L_1$.

\poznamka
%%%%%%%%%
Je zøejmé, ¾e zobrazení $\a:L_1\to L_2$, které je prosté a na $L_2$, 
má tu vlastnost, ¾e ka¾dému $\vec y\in L_2$ lze jednoznaènì 
najít $\vec x\in L_1$ tak, ¾e $\a(\vec x) = \vec y$. Skuteènì, pro
daný obraz $\vec y\in L_2$ lze vzor $\vec x\in L_1$ najít, proto¾e
$\a$ je \uv{na} $L_2$. Pøiøazení je jednoznaèné, proto¾e $\a$ je prosté.
Toto \uv{zpìtné zobrazení} z $L_2$ do $L_1$ se nazývá 
{\em zobrazení inverzní} k zobrazení $\a$ a znaèíme je $\a^{-1}$.
Pozdìji v této kapitole tento pojem zavedeme pøesnìji a uká¾eme, ¾e inverzní
zobrazení k lineárnímu zobrazení je rovnì¾ zobrazení lineární. Tak¾e
inverzní zobrazení k izomorfismu existuje a je rovnì¾ izomorfizmus.
To je dùvod, proè v~definici\cite[defiso] izomorfních 
prostorù se nerozli¹uje mezi tvrzeními \uv{$L_1$ je izomorfní s $L_2$} a
\uv{$L_2$ je izomorfní s~$L_1$}.

\veta* [isoRn]
%%%%%
Ka¾dý lineární prostor $L$, pro který je $\dim L=n$, je izomorfní
s~lineárním prostorem~$\R^n$.

\dukaz
Hledaným izomorfismem jsou napøíklad 
souøadnice vzhledem k bázi, viz vìtu\cite[sour-lin].

\poznamka
%%%%%%%%%
Pøedchozí vìta má v lineární algebøe zásadní význam. Potøebujeme-li
zkoumat \uv{vlastnosti linearity} na libovolném lineárním prostoru
koneèné dimenze, staèí nám pomocí izomorfizmu souøadnic zkoumat tyto
vlastnosti v lineárním prostoru $\R^n$. V tomto lineárním prostoru
sèítáme a násobíme konstantou po slo¾kách, tedy pracujeme 
s~reálnými èísly. Algoritmy, které øe¹í \uv{otázky linearity} v $\R^n$
jsou tedy zalo¾eny na numerických výpoètech. Slo¾ky vektorù z $\R^n$
budeme v rámci tìchto algorimù èasto zapisovat 
do øádkù pod sebe, èím¾ vznikají tabulky èísel, kterým øíkáme {\em matice}.
V následujících kapitolách zamìøíme tedy pozornost na lineární prostor
$\R^n$ a nauèíme se pracovat s maticemi.


\dolu 3mm
\obrazek .5+.07 12 obr2
{
\p 120 -5 O
\p 95 -10 \vec b_2
\p 78 -6 1
\p 45 -6 2
\p 10 -6 3
\p 120 18 \vec b_1
\p 120 34 1
\p 120 68 2
\p 120 102 3
\p 120 136 4
\p 120 170 5
\p 120 204 6
\p 60 18 \vec u
\p 88 100 \vec v
\p 37 120 \vec u+\vec v
}
%
\priklad [U0isoR2]
%%%%%%%%
Nech» $P$ je lineární podprostor lineárního prostoru $U_O$
orientovaných úseèek, které v¹echny
le¾í v rovinì papíru tohoto textu (nebo v rovinì stínítka obrazovky,
pokud to nìjaký ne¹»astník ète z obrazovky poèítaèe) a v¹echny
zaèínají v bodì $O$ na obrázku. 
V~$P$ jsou dány dva vektory $\vec u$ a $\vec v$ 
(viz stejný obrázek). Kdybychom chtìli tyto vektory
napøíklad seèíst v lineárním podprostoru $P$, musíme pou¾ít pravítko a
kru¾ítko, nebo» sèítání je v tomto linárním prostoru definováno
geometricky (viz pøíklad\cite[lpvv]). Mù¾eme ale problém \uv{seètení
tìchto dvou vektorù} pøenést pomocí izomorfismu souøadnic do
lineárního prostoru~$\R^2$. Volbu báze a nalezení souøadnic vidíme
na obrázku.  Souøadnice vektoru $\vec u$ vzhledem
k~bázi $(\vec b_1,\vec b_2)$ jsou rovny $(1,2)$ a souøadnice vektoru $\vec v$ 
vzhledem ke stejné bázi jsou $(5,1)$. V lineárním prostoru $\R^2$
mù¾eme provést souèet:
$(1,2)+(5,1)=(6,3)$. Tento výpoèet jsme provedli {\it numericky}. 
Koneènì je mo¾né výsledek v $\R^2$ pøevést zpìt do
pùvodního lineárního podprostoru $P$ pomocí inverzního izomorfismu. 
V lineárním podprostoru $P$ pak výsledek narýsujeme.
{\hbadness=2000\emergencystretch=2em\par}

Nebo se mù¾eme ptát, zda vektory $\vec u$ a $\vec v$ jsou lineárnì
nezávislé v $U_O$. To zjistíme \uv{pohledem na nì}, ¾e toti¾ nele¾í ve
spoleèné pøímce. Vektory $\vec u$ a $\vec v$ jsou lineárnì nezávislé
právì tehdy, kdy¾ jsou lineárnì nezávislé jejich souøadnice v
$\R^2$. To zaruèuje izomorfismus souøadnic. Souøadnice tìchto vektorù
mù¾eme zapsat do øádkù matice:
$$
  \A=\pmatrix{2&1\cr1&5}
$$
Uká¾eme v následujících kapitolách, ¾e lineární nezávislost øádkù
takové matice lze ovìøit výpoètem determinantu matice $\A$ a ovìøením, ¾e je
tento determinant nenulový. V $\R^n$ tedy jsme schopni otázky linearity zkoumat
numericky (pomocí algorimtù zalo¾ených na poèítání s èísly). 
Tento {\it numerický výpoèet\/} pak odpoví díky izomorfismu
souøadnic i na {\it geometrickou otázku}, zda tøeba vektory le¾í èi
nele¾í v~jedné pøímce. 

\poznamka
%%%%%%%%%
Isomorfizmus souøadnic nám umo¾òuje si ka¾dý vektor lineárního prostoru
koneèné dimenze pøedstavit jako uspoøádanou $n$-tici, tøeba¾e ten
vektor ve skuteènosti je popsán jinak. Tøeba v~pøípadì 
geometrického prostoru dimenze~3 orientovaných úseèek mù¾eme 
pøi pøedstavì vektoru my¹lenkovì \uv{pøepínat} 
mezi orientovanou úseèkou a uspoøádanou trojicí podle
potøeby. Nebo zkoumání lineární závislosti a nezávislosti polynomù
nejvý¹e $n$-tého stupnì mù¾eme pøevést na zkoumání závislosti èi
nezávislosti uspoøádaných $(n+1)$-tic jeho koeficientù. Zobrazení,
které polynomu pøiøadí souøadnice vzhledem k uspoøádané bázi 
$(1,x,x^2,\ldots,x^n)$, je toti¾ izomorfismus.


\okraj Slo¾ené\hb zobrazení | Slozene zobrazeni

\poznamka
%%%%%%%%%
V závìru této kapitoly zavedeme slo¾ené zobrazení, inverzní zobrazení
a uvedeme jejich vlastnosti. K lineárním zobrazením se pak vrátíme
je¹tì v kapitole\kcite\ktere[linzob2], kde odhalíme mnoho dal¹ích vlastností 
zejména v souvislosti s tím, ¾e mezi zobrazeními lineárních prostorù koneèné
dimenze a maticemi èísel je úzká souvislost.

\definice [slozzob]
%%%%%%%%%
Nech» $\a:L_1\to L_2$ a $\b:L_2\to L_3$ jsou zobrazení. Symbolem
$\b\circ\a:L_1\to L_3$ oznaèujeme {\em slo¾ené zobrazení}, které je
definováno pøedpisem $(\b\circ\a)(\vec x) = \b\bigl(\a(\vec x)\bigr)$,
$\forall \vec x\in L_1$.
\inl[slo¾ené: zobrazení, skládání: zobrazení, 0circ]

\dolu 5mm
\obrazek .4+.04 8 obr4
{
  \p 33 48 {\a}
  \p 35 124 {\b}
  \p -4 90 {\b\circ\a}
  \p 50 14  L_1
  \p 50 84 L_2
  \p 50 157 L_3
}
%
\poznamka
%%%%%%%%%
Symbol $\circ$ pro skládání zobrazení èteme \uv{zprava doleva}. To
znamená, ¾e ve slo¾eném zobrazení $\b\circ\a$ zpracuje vstupní hodnotu $\vec x$
nejprve zobrazení $\a$ a vytvoøí \uv{mezivýsledek} $\a(x)$, který je
dále zpracován zobrazením $\b$. Dùvod tohoto \uv{arabského ètení} vyplývá 
ze skuteènosti, ¾e vstupní hodnotu~$\vec x$ klademe do závorky {\it vpravo\/} od
symbolu zobrazení, tak¾e $(\b\circ\a)(\vec x) = \b\bigl(\a(\vec x)\bigr)$. 
Je tøeba také upozornit na to, ¾e literatura v tomto znaèení není jednotná.

\veta [slozlin]
%%%%%
Nech» $\a:L_1\to L_2$ a $\b:L_2\to L_3$ jsou lineární zobrazení.
Pak je lineární té¾ slo¾ené zobrazení $(\b\circ\a):L_1\to L_3$.

\dukaz
%%%%%%
Nech» $\vec x\in L_1$, $\vec y\in L_1$, $\alpha\in\R$.
$$\eqalign{
 (\b\circ\a)(\vec x+\vec y) &= \b\bigl(\a(\vec x+\vec y)\bigr) =
 \b\bigl(\a(\vec x)+\a(\vec y)\bigr) =
 \b\bigl(\a(\vec x)\bigr) + \b\bigl(\a(\vec y)\bigr) =
 (\b\circ\a)(\vec x) + (\b\circ\a)(\vec y) \cr
 (\b\circ\a)(\alpha\,\vec x) &= \b\bigl(\a(\alpha\,\vec x)\bigr) =
 \b\bigl(\alpha\,\a(\vec x)\bigr) = 
 \alpha\,\b\bigl(\a(\vec x)\bigr) = \alpha\,(\b\circ\a)(\vec x).
 }
$$ 

\okraj Inverzní\hb zobrazení | Inversni zobrazeni

\definice [Izob]
%%%%%%%%%
{\em Identické zobrazení} je zobrazení 
$\i:L\to L$, které je definováno pøedpisem $\i(\vec x) = \vec x$.
Struènì nazýváme zobrazení $\i$ {\em identitou}. 
Nech» $\a:L_1\to L_2$ je prosté zobrazení. Pak definujeme 
{\em inverzní zobrazení} $\a^{-1}:\a(L_1)\to L_1$ jako takové zobrazení,
které splòuje $\a^{-1}\circ\a=\i$, kde $\i:L_1\to L_1$ je identita.
\inl[zobrazení: identické, identické: zobrazení, identita]
\inl[zobrazení: inverzní, inverzní: zobrazení]

\veta [exIzob]
%%%%%
Je-li $\a:L_1\to L_2$ prosté, pak existuje právì jedno inverzní
zobrazení $\a^{-1}:\a(L_1)\to L_1$.

\dukaz
%%%%%%
Pro ka¾dý prvek $\vec y\in\a(L_1)$ existuje právì jeden prvek
$\vec x\in L_1$ takový, ¾e $\a(\vec x) = \vec y$. To plyne pøímo 
z~definice\cite[proste] prostého zobrazení. Definujeme
$\a^{-1}(\vec y) = \vec x$. Vidíme, ¾e $\a^{-1}\circ\a$ je identita.

\veta [invjelin]
%%%%%
Je-li $L$ lineární prostor, pak identita $\i:L\to L$ je lineární.
Je-li $\a:L_1\to L_2$ lineární a prosté zobrazení, pak té¾ 
$\a^{-1}:\a(L_1)\to L_1$ je lineární.  

\dukaz
%%%%%%
Identita je zcela zøejmì lineární. Ovìøíme linearitu zobrazení
$\a^{-1}$. Poèítejme $\a^{-1}(\vec x+\vec y)$ pro 
$\vec x\in\a(L_1)$, $\vec y\in\a(L_1)$. Podle poznámky\cite[poznalob]
je $\a(L_1)$ lineární podprostor, tak¾e $\vec x + \vec y\in \a(L_1)$.
Proto¾e $\a$ je prosté, existuje právì jeden vektor $\vec a\in L_1$ a
právì jeden vektor $\vec b\in L_1$ tak, ¾e $\a(\vec a) = \vec x$,
$\a(\vec b) = \vec y$. Platí tedy 
$\a^{-1}(\vec x) = \vec a$, $\a^{-1}(\vec y) = \vec b$.
Proto¾e $\a$ je lineární, je
$\a(\vec a + \vec b) = \vec x + \vec y$, neboli 
$$
  \a^{-1}(\vec x + \vec y) = \vec a + \vec b = 
  \a^{-1}(\vec x) + \a^{-1}(\vec y).
$$
Proto¾e $\a$ je lineární, platí pro $\alpha\in\R$, ¾e 
$\a(\alpha\,\vec a) = \alpha\,\vec x$, neboli
$
  \a^{-1}(\alpha\,\vec x) = \alpha\,\vec a = \alpha\,\a^{-1}(\vec x).
$ 

\veta [inversena]
%%%%%
Nech» $\a:L_1\to L_2$ je izomorfismus. Pak je
inverzní zobrazení $\a^{-1}:L_2\to L_1$ rovnì¾ izomorfismus.

\dukaz
Izomorfismus je zobrazení, které je lineární, prosté a \uv{na}.

®e je $\a^{-1}$ definováno na celém $L_2$ plyne z toho, ¾e $\a$ je
\uv{na}~$L_2$, neboli $\a(L_1)=L_2$.

®e je $\a^{-1}$ lineární plyne z vìty\cite[invjelin].

®e je $\a^{-1}$ prosté plyne z toho, ¾e je $\a$ zobrazení.
Dvìma rùzným prvkùm $\vec x\in L_2$, $\vec y\in L_2$ musejí odpovídat
rùzné prvky $\vec a\in L_1$ a $\vec b\in L_1$ takové, ¾e
$\a(\vec a) = \vec x$, $\a(\vec b) = \vec y$. Kdyby mìlo platit
$\vec a = \vec b$, okam¾itì vidíme, ¾e zobrazení $\a$ nemù¾e
splòovat $\a(\vec a) = \vec x\not=\vec y = \a(\vec b) = \a(\vec a)$.

Uká¾eme, ¾e $\a^{-1}$ je~\uv{na}~$L_1$. Ka¾dý prvek $\vec a\in L_1$ je
zobrazením $\a$ pøeveden na nìjaký prvek 
$\a(\vec a) = \vec x\in L_2$. Jinými slovy
neexistuje prvek $\vec a\in L_1$, který by nemìl svùj protìj¹ek
$\a(\vec a) = \vec x\in L_2$. 

\veta* [sloziso]
%%%%%
Slo¾ení dvou izomorfismù je izomorfismus.

\dukaz
Uva¾ujme izomorfismy $\a: L_1\to L_2$, $\b: L_2\to L_3$. Doká¾eme, ¾e
$\b\circ\a$ je izomorfismus. 

$\b\circ\a$ je lineární díky vìtì\cite[slozlin]. $\b\circ\a$ je
prosté, proto¾e $\a$ je prosté i $\b$ je prosté. Koneènì $\b\circ\a$
je \uv{na}~$L_3$, proto¾e $\b\bigl(\a(L_1)\bigr)=\b(L_2)=L_3$.

\veta* [isoLL]
%%%%%
Ka¾dé dva lineární prostory stejné koneèné dimenze jsou vzájemnì
izomorfní.

\dukaz
Nech» $L_1, L_2$ jsou lineární prostory, $\dim L_1=\dim L_2=n$.
Pak existují podle vìty\cite[isoRn] izomorfismy $\a: L_1\to \R^n$
a $\b: L_2\to \R^n$. Podle vìty\cite[inversena] je $\b^{-1}: \R^n\to
L_2$ izomorfismus. Nakonec vìta\cite[sloziso] øíká, ¾e
$\b^{-1}\circ\a: L_1 \to L_2$ je izomorfismus.

\poznamka
%%%%%%%%%
Poslední vìta zhruba øíká, ¾e je zbyteèné pøi studiu vlastností lineárních
prostorù koneèné dimenze mezi nimi rozli¹ovat. Napøíklad polynomy
nejvý¹e druhého stupnì se chovají z hlediska \uv{vlastností linearity}
stejnì jako orientovné úseèky se spoleèným poèátkem a ty se chovají
stejnì jako uspoøádané trojice reálných èísel.
%
Pro lineární prostory nekoneèné dimenze analogická vìta neplatí.

\shrnuti
%%%%%%%%
Zobrazení je lineární, pokud zobrazí souèet vzorù na souèet obrazù a alfanásobek
vzoru na alfanásobek obrazu\lcite[linzob], tedy pokud zobrazení \uv{respektuje}
souèet a násobek. Tato vlastnost je ekvivalentní s principem
superpozice, tj. lineární kombinace vzorù se zobrazí na lineární
kombinaci obrazù se stejnými koeficienty\lcite[principsupozice].
Z té okam¾itì plyne, ¾e lineární obaly (neboli podprostory) vzorù se
pøenesou na lineární obaly (neboli podprostory) obrazù\lcite[alob].

Mno¾inu v¹ech vzorù, které se zobrazí na nulový vektor ve výstupním
lineárním prostoru, oznaèujeme symbolem
$\ker$ a jedná se o~podprostor vstupního lineárního 
prostoru\lcite[jadro]. Dimenzi tohoto
podprostoru øíkáme defekt\lcite[defhod]. Hodnost zobrazení je
dimenze podprostoru v¹ech obrazù. Souèet defektu a hodnosti je roven
dimezi vstupního lineárního prostoru\lcite[def+hod].

Lineární zobrazení je prosté\lcite[proste] právì tehdy, kdy¾ má
nulový defekt\lcite[defA=proste] co¾ platí právì tehdy, kdy¾
jsou v¹echny lineárnì nezávislé mno¾iny zobrazeny na lineárnì
nezávislé mno¾iny\lcite[zobN]. Lineární zobrazení které je prosté,
tedy zachová v¹echny lineární vztahy mezi vzory i v postoru obrazù
(závislost, nezávislost, báze, dimenze, podprostory, obaly).
Je-li takové zobrazení navíc \uv{na} prostor $L_2$, øíkáme mu
izomorfismus\lcite[defiso].

Souøadnice vzhledem ke koneèné uspoøádané bázi zobrazují libovolný
vektor na uspoøádanou $n$-tici v~$\R^n$ a je to 
izomorfismus\lcite[sour-lin]. Díky tomu jsou v¹echny lineární prostory dimenze
$n$ izomorfní s~$\R^n$\lcite[isoRn] a jsou izomorfní i sobì
navzájem\lcite[isoLL]. Pøi studiu linárních skuteèností, které jsou
dùsledky axiomù linearity v~definici\cite[dlp], není tedy tøeba
rozli¹ovat mezi jednotlivými lineárními prostory stejné dimenze. Èasto
se pomocí izomofismu souøadnic \uv{pøepneme} do $\R^n$ a tam lineární
problém øe¹íme numericky. K~tomu budeme potøebovat umìt dobøe poèítat
s maticemi, a proto se této problematice vìnují následující kapitoly. 



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\kapitola Matice | Matice
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

S~pojmem matice jsme se u¾ seznámili v~úvodu do
Gaussovy eliminaèní metody. Nyní si definujeme pojem matice pøesnìji.

\okraj Definice\hb matice | Definice matice

\definice [defmatice]
%%%%%%%%%
{\em Matice typu $(m,n)$} je tabulka reálných (nebo komplexních) 
èísel s~$m$ øádky a $n$ sloupci. Èíslo $a_{i,j}$ z $i$-tého øádku
a $j$-tého sloupce této tabulky nazýváme {\em $(i,j)$-tý prvek} matice.
Mno¾inu v¹ech matic typu $(m,n)$ znaèíme $\R^{m,n}$, pokud má reálné
prvky, a $\C^{m,n}$, pokud má komplexní prvky. 

Matici $\A\in\R^{m,n}$ (nebo $\A\in\C^{m,n}$) zapisujeme takto:
$$
  \A = \pmatrix{a_{1,1}, & a_{1,2}, &\ldots, & a_{1,n} \cr
               a_{2,1}, & a_{2,2}, &\ldots, & a_{2,n} \cr
                        &          &\vdots  &  \cr
               a_{m,1}, & a_{m,2}, &\ldots, & a_{m,n} \cr}
$$
nebo zapí¹eme jen struènì prvky matice $\A$:
$$
\A=(a_{i,j}), \quad i\in\{1,2,\ldots,m\},\, j\in\{1,2,\ldots,n\}.
$$
\inl[matice, øádek: matice, sloupec: matice, prvek: matice]%
Matici, která má v¹echny prvky nulové, nazýváme {\em nulovou maticí}.
\inl[matice: nulová, nulová: matice]
Matici typu $(m,n)$ nazýváme {\em ètvercovou maticí}, pokud $m=n$.
\inl[matice: ètvercová, ètvercová: matice]

V následujícím textu budeme pracovat vìt¹inou s reálnými maticemi
(tj. s maticemi z~$\R^{m,n}$). Skoro
v¹echny vlastnosti lze analogicky odvodit i pro matice komplexní.
\eng
matice = matrix; matice typu $(m,n)$ = $m$ by $n$ matrix; 
prvek matice = an entry of the matrix; 
ètvercová matice = square matrix.
\inl[matrix, entry of matrix, square matrix]

\poznamka [rovnostmatic]
%%%%%%%%%
Dvì matice {\em se rovnají}, pokud jsou stejného typu a v¹echny prvky
jedné matice se rovnají odpovídajícím prvkùm matice druhé. Pøesnìji,
$\A=(a_{i,j})\in\R^{m,n}$ se rovná matici $\B=(b_{i,j})\in\R^{p,q}$,
pokud $m=p$, $n=q$ a $a_{i,j}=b_{i,j}$ pro v¹echna
$i\in\{1,2,\ldots,m\},\, j\in\{1,2,\ldots,n\}$.
\inl[rovnost: matic]

\okraj Lineární\hb prostor\hb matic | Linearni prostor matic

\definice [deflpmatic]
%%%%%%%%%
Nech» $\A=(a_{i,j})\in\R^{m,n},\,\B=(b_{i,j})\in\R^{m,n}$.
Matici $\C\in\R^{m,n}$ nazýváme 
{\em souètem matic} $\A,\B$ (znaèíme $\C=\A+\B$), pokud
pro prvky matice $\C=(c_{i,j})$ platí 
$c_{i,j} = a_{i,j} + b_{i,j}$, $i\in\nobreak\{1,2,\ldots,m\}, j\in\nobreak\{1,2,\ldots,n\}$.
Nech» $\alpha\in\R$. {\em $\alpha$-násobek} matice $\A$ je matice
$\alpha\cdot\A=(\alpha\,a_{i,j})$. Názornì:
$$
  \def\quad{\hskip.4em }
  \A+\B = 
  \pmatrix{a_{1,1}+b_{1,1}, & a_{1,2}+b_{1,2}, &\ldots, & a_{1,n}+b_{1,n} \cr
           a_{2,1}+b_{2,1}, & a_{2,2}+b_{2,2}, &\ldots, & a_{2,n}+b_{2,n} \cr
                                    &          &\vdots  &  \cr
           a_{m,1}+b_{m,1}, & a_{m,2}+b_{m,2}, &\ldots, & a_{m,n}+b_{m,n} \cr},
  \quad\ \alpha\cdot\A =
  \pmatrix{\alpha\,a_{1,1}, & \alpha\,a_{1,2}, &\ldots, & \alpha\,a_{1,n} \cr
           \alpha\,a_{2,1}, & \alpha\,a_{2,2}, &\ldots, & \alpha\,a_{2,n} \cr
                                    &          &\vdots  &  \cr
           \alpha\,a_{m,1}, & \alpha\,a_{m,2}, &\ldots, & \alpha\,a_{m,n} \cr}.
$$
\par\inl[prostor: matic]
\inl[matice: souèet, matice: násobek]
\inl[souèet:matic, násobek: matic]

\veta [maticeLP]
%%%%%
Mno¾ina $\R^{m,n}$ tvoøí se sèítáním matic a
násobením matice reálným èíslem podle definice\cite[deflpmatic] lineární
prostor. Nulový vektor tohoto prostoru je nulová matice.
\inl[prostor: matic]

\dukaz
%%%%%%
Dùkaz si ètenáø provede sám jako cvièení. Srovnejte 
s~pøíklady\cite[LPdvojice] a\cite[LPRn].

\priklad [matice32]
%%%%%%%%
Mno¾ina 
$$
B = \left\{
\pmatrix{1&0\cr0&0\cr0&0}, \pmatrix{0&1\cr0&0\cr0&0},
\pmatrix{0&0\cr1&0\cr0&0}, \pmatrix{0&0\cr0&1\cr0&0},
\pmatrix{0&0\cr0&0\cr1&0}, \pmatrix{0&0\cr0&0\cr0&1}
\right\}
$$
tvoøí bázi lineárního prostoru $\R^{3,2}$.

Abychom to ukázali, ovìøíme lineární nezávislost $B$ a dále vlastnost
$\lob<B>=\R^{3,2}$.
Nejprve ovìøíme lineární nezávislost. Polo¾me lineární kombinaci prvkù z~$B$
rovnu nulové matici:
$$
\alpha\,\pmatrix{1&0\cr0&0\cr0&0} + \beta\,\pmatrix{0&1\cr0&0\cr0&0} +
\gamma\,\pmatrix{0&0\cr1&0\cr0&0} + \delta\,\pmatrix{0&0\cr0&1\cr0&0} +
\varepsilon\,\pmatrix{0&0\cr0&0\cr1&0} + \zeta\,\pmatrix{0&0\cr0&0\cr0&1} =
\pmatrix{0&0\cr0&0\cr0&0}
$$
Odpovídající slo¾ky se musejí rovnat, co¾ vede k~¹esti rovnicím:
$\alpha=0$,  $\beta=0$, $\gamma=0$, $\delta=0$, $\varepsilon=0$, $\zeta=0$.
Jedinì triviální lineární kombinace je rovna nulovému vektoru.

Ovìøíme nyní vlastnost (2) z~definice\cite[dbase]. Nech»
$$
  \pmatrix{a&b\cr c&d\cr e&f}
$$
je nìjaká matice z~lineárního prostoru $\R^{3,2}$. Snadno zjistíme, ¾e
existuje lineární kombinace matic z~mno¾iny $B$, která je rovna této
matici (staèí volit 
$\alpha=a$,  $\beta=b$, $\gamma=c$, $\delta=d$, $\mu=e$, $\nu=f$).
Tím jsme dokázali, ¾e $\lob<B>=\R^{3,2}$ a $B$ je tedy báze lineárního
prostoru matic $\R^{3,2}$. Nazýváme ji {\em standardní bází}.

Dimenze lineárního prostoru $\R^{3,2}$ je poèet prvkù báze, je
tedy rovna ¹esti.
\inl[báze: prostoru: matic, dimenze: prostoru: matic]

\priklad
%%%%%%%%
Platí
$\dim \R^{m,n} = m\cdot n$. Analogicky jako v~pøíkladu\cite[matice32]
lze toti¾ sestrojit bázi lineárního prostoru $\R^{m,n}$, která 
má $m\cdot n$ prvkù. 
\inl[báze: prostoru: matic, dimenze: prostoru: matic]


\okraj Sloupcové a øádkové vektory | Sloupcove a radkove vektory

\veta
%%%%%
Lineární prostor jednosloupcových matic $\R^{n,1}$ je izomorfní 
s lineárním prostorem $\R^n$. Lineární prostor jednoøádkových 
matic $\R^{1,n}$ je rovnì¾ izomorfní s lineárním prostorem $\R^n$.

\dukaz
Vìta je dùsledkem vìty\cite[isoLL].

\poznamka [radkovevektory]
%%%%%%%%%
Mezi lineárním prostorem $\R^n$ a lineárním prostorem $\R^{n,1}$
budeme pou¾ívat následující izomorfismus: slo¾ky vektoru z $\R^n$
napí¹eme po øadì (místo do øádku) do sloupce. Vzhledem k tomuto izomorfismu 
èasto ztoto¾òujeme vektory z $\R^{n,1}$ s vektory z $\R^n$ a mluvíme
o~{\em sloupcových vektorech}. Analogicky vektory z $\R^{1,n}$
nazýváme {\em øádkové vektory} a také je ztoto¾òujeme s vektory z~$\R^n$.
\inl[vektor: sloupcový, sloupcový vektor, vektor: øádkový, øádkový vektor]


\okraj Vlastnosti GEM | Vlastnosti GEM

\poznamka
%%%%%%%%%
V následujícím textu si uká¾eme, jaké vlastnosti má modifikace matice
Gaussovou eliminaèní metodou. Na matici v tomto kontextu budeme
pohlí¾et jako na matici øádkových vektorù kladených pod sebe.
Pøesnìji, matice $\R^{m,n}$ obsahuje $m$ øádkových vektorù (øádkù
matice), ka¾dý z~nich je z lineárního prostoru $\R^{1,n}$. Tento
lineární prostor podle poznámky\cite[radkovevektory] ztoto¾òujeme s
lineárním prostorem $\R^n$.

\definice [sim]
%%%%%%%%%
Symbolem $\A\sim\B$ oznaèujeme skuteènost, ¾e matice $\B$ vznikla
z~matice $\A$ koneèným poètem krokù podle Gaussovy eliminaèní metody.
Za krok Gaussovy eliminaèní metody je pova¾ováno prohození øádkù,
pronásobení øádku nenulovou konstantou, pøiètení násobku øádku 
k~jinému, odstranìní nulového øádku nebo pøidání nulového øádku.
\inl[GEM, Gaussova: eliminaèní metoda, eliminaèní metoda: Gaussova]
\inl[relace: 0sim, 0sim]

\okraj Symetrie relace~\uv{$\sim$} | Symetrie relace \noexpand~

\veta [symetriesim]
%%%%%
Relace \uv{$\sim$} je symetrická, tj. $\A\sim\B$ právì tehdy, 
kdy¾ $\B\sim\A$.
\inl[relace: 0sim, 0sim]

\dukaz
%%%%%%
Staèí ukázat, ¾e po provedení jednoho kroku podle Gaussovy eliminaèní
metody se lze pomocí dal¹ích krokù podle Gaussovy eliminaèní metody
vrátit k~pùvodní matici. 
%Pøipomeòme pøi té pøíle¾itosti v¹echny kroky,
%které se v~Gaussovì eliminaèní metodì pou¾ívají:

(1) Prohození dvou libovolných øádkù mezi sebou. Staèí prohodit tyté¾
øádky mezi sebou je¹tì jednou a máme pùvodní matici.

(2) Vynásobení jednoho øádku nenulovým reálným èíslem $\alpha$. Staèí
vynásobit tento øádek èíslem $1/\alpha$ a dostáváme pùvodní matici.

(3) Pøiètení $\alpha$-násobku nìjakého øádku $\vec a$ k~øádku $\vec b$
(øádek $\vec a$ se v~tomto kroku opisuje). K~pùvodní matici se pak
vrátíme tak, ¾e k~právì zmìnìnému øádku pøièteme $(-\alpha)$-násobek
øádku $\vec a$.

(4) Vynechání nebo pøidání nulového øádku. Jestli¾e nulový øádek pøi
pøechodu k~matici $\B$ vynecháme, tak jej zas pøi návratu k~matici
$\A$ pøidáme. Pokud jej pøi pøechodu k~matici $\B$ pøidáme, pak jej
pøi návratu k~matici $\A$ odebereme.

\poznamka
%%%%%%%%%
V~nìkteré literatuøe se místo kroku (3) uvádí pøiètení lineární
kombinace ostatních øádkù ke zvolenému øádku $\vec b$. Tento krok lze
samozøejmì nahradit koneèným opakováním kroku (3).

V~jiné literaruøe se nìkdy neuvádí prohození øádkù jako samotný 
krok Gaussovy eliminaèní metody, proto¾e tento krok lze 
(ponìkud tì¾kopádnì) provést opakovaným
pou¾itím kroku (3) a v~závìru aplikací kroku (2):
$$
  \pmatrix{\vec a\cr\vec b} \sim \pmatrix{\vec a\cr \vec a+\vec b} \sim
  \pmatrix{\vec a - (\vec a+\vec b)\cr \vec a + \vec b} =
  \pmatrix{-\vec b\cr\vec a + \vec b} \sim
  \pmatrix{-\vec b\cr\vec a} \sim \pmatrix{\vec b\cr\vec a}.
$$

\definice [lobradku]
%%%%%%%%%
Mno¾inu v¹ech øádkù matice $\A$ znaèíme $\hbox{r:}\,\A$. 
Lineární obal mno¾iny v¹ech øádkù matice~$\A$ je tedy oznaèen 
symbolem $\lobr<\A>$.
\inl[rA, rA0lobrA]

\okraj Gaussova eliminace zachovává obal | Gaussova eliminace zachovava obal

\veta* [lobalymatic]
%%%%%
Je-li $\A\sim\B$, pak $\lobr<\A>=\lobr<\B>$.
Jinými slovy: Gaussova eliminaèní metoda zachovává lineární obal øádkù
matice.
\inl[0sim, lineární: obal: øádkù matice]

\dukaz
%%%%%%
Doká¾eme nejdøíve pomocné tvrzení: jestli¾e $\A_1$ je matice,
která vznikne z~matice $\A$ \hbox{jedním} krokem podle Gaussovy eliminaèní
metody, pak $\lobr<\A_1>\subseteq\lobr<\A>$. 

V¹echny øádky matice $\A_1$ 
lze zapsat jako lineární kombinaci øádkù matice $\A$.
Je pøitom jedno, zda matice $\A_1$ vznikla prohozením øádkù, pronásobením
jednoho øádku nenulovým reálným èíslem, pøiètením násobku jednoho 
øádku k~jinému, odebráním nebo pøidáním nulového øádku.
Platí tedy, ¾e $\hbox{r:}\,\A_1\subseteq\lobr<\A>$. Podle vìty\cite[loblob]
je $\lobr<\A_1>\subseteq \lob<{\lobr<\A>}>=\lobr<\A>$, tak¾e 
$\lobr<\A_1>\subseteq \lobr<\A>$.

Pomocné tvrzení máme dokázáno. Pokud toto tvrzení uplatníme opakovanì
(matice $\B$ vznikla z~matice $\A$ po koneènì mnoha krocích podle
Gaussovy eliminaèní metody), máme výsledek 
$\lobr<\B>\subseteq\lobr<\A>$. Tvrzení dokazované vìty nyní plyne ze
symetrie relace \uv{$\sim$}, tj. z~vìty\cite[symetriesim].

Obrácené tvrzení k této vìtì \uv{jestli¾e $\lobr<\A>=\lobr<\B>$, pak $\A\sim\B$}
doká¾eme v odstavci\cite[AsimBequiv].

\priklad [AsimB]
%%%%%%%%
Øádky matice $\A$ i matice $\B$ uvedené ní¾e mají podle 
vìty\cite[lobalymatic] stejné lineární obaly. Tyto obaly tvoøí
podle vìty\cite[lob=lpp] nìjaký
lineární podprostor lineárního prostoru $\R^5$.
$$
  \A=
  \pmatrix{1&2&3&4&5\cr 2&3&4&4&7\cr 1&1&1&3&4\cr 3&5&7&8&12} \sim
  \pmatrix{1&2&3&4&5\cr 0&1&2&4&3\cr 0&1&2&1&1\cr 0&1&2&4&3} \sim
  \pmatrix{1&2&3&4&5\cr 0&1&2&4&3\cr 0&0&0&3&2} = \B
$$
Snadno ovìøíme, ¾e øádky matice $\B$ jsou lineárnì nezávislé. Tak¾e tyto øádky
tvoøí bázi lineárního podprostoru $\lobr<\B>=\lobr<\A>$.
Vidíme tedy, ¾e $\dim\lobr<\A>=3$.

\okraj Hodnost\hb matice | Hodnost matice

\definice* [dhodnost]
%%%%%%%%%
{\em Hodnost matice $\A$} znaèíme $\hod(\A)$ a
definujeme $\hod(\A)=\dim\lobr<\A>$. 
\inl[hodnost, rank, hodnost: matice, hodA]
\eng hodnost = rank.

\veta* [hodAB]
%%%%%
Je-li $\A\sim\B$, pak $\hod(\A)=\hod(\B)$. Jinými slovy, Gaussova eliminaèní
metoda nemìní hodnost matice.

\dukaz
%%%%%%
Vìta je jednoduchým dùsledkem vìty\cite[lobalymatic] a 
definice\cite[dhodnost].

\priklad
%%%%%%%%
Matice $\B$ z~pøíkladu\cite[AsimB] má zøejmì hodnost 3.  
Vìta\cite[hodAB] nám zaruèí, ¾e i matice $\A$ z~tohoto pøíkladu má
hodnost~3.

\poznamka
%%%%%%%%%
Pozorný ètenáø si jistì v¹iml, ¾e v definici\cite[defhod] jsme
pou¾ili pojem \uv{hodnost} v~kontextu lineárního zobrazení. 
Nyní jsme definovali hodnost
matice. Zatím je rozumné toto vnímat jako dva rùzné pojmy, ka¾dý má svou
definici. Také budeme definovat zvlá¹» inverzi matice, tøeba¾e
definice inverzního zobrazení u¾ zaznìla. V tuto chvíli se zamìøíme
pouze na vlastnosti matic, budeme hledat napøíklad algoritmy pro
výpoèet hodnosti matice a teoretické dùsledky tohoto pojmu. Pozdìji
budeme schopni sestavit izomorfismus mezi lineárním prostorem matic a
lineárním prostorem lineárních zobrazení. Pak uká¾eme, ¾e uvedené pojmy se
ve smyslu tohoto izomorfismu shodují. 

\veta [hod=maxradku]
%%%%%
Hodnost matice je maximální poèet lineárnì nezávislých øádkù matice.
Pøesnìji øeèeno, hodnost je poèet prvkù nejvìt¹í lineárnì nezávislé 
podmno¾iny z mno¾iny øádkù matice.

\dukaz
%%%%%%
Zkoumanou matici oznaèím symbolem $\A$.
Jsou-li øádky matice $\A$ lineárnì nezávislé, polo¾ím $\A=\A'$, jinak
odeberu postupnì z~$\A$ øádky, které jsou lineární kombinací ostatních, jako 
v~pøíkladu\cite[odebirani]. Po koneènì mnoha odebráních vznikne matice $\A'$,
která má lineárnì nezávislé øádky a $\lobr<\A>=\lobr<\A'>$.
Proces vzniku matice $\A'$ samozøejmì nemusí být jednoznaèný. Ov¹em
øádky matice $\A'$ jsou v ka¾dém pøípadì podmno¾inou øádkù matice $\A$,
která je nejpoèetnìj¹í z tìch podmno¾in, které jsou lineárnì
nezávislé. 
Øádky matice $\A'$ jsou toti¾ bází podprostoru $\lobr<\A>$
a kdyby existovala poèetnìj¹í lineárnì nezávislá mno¾ina se stejným
lineárním obalem, byla by také bází tého¾ podprostoru. To ale není
mo¾né, nebo» dvì báze stejného lineárního (pod)prostoru mají podle 
vìty\cite[stejnebase] stejný poèet prvkù. Poèet øádkù matice $\A'$
je podle definice\cite[dhodnost] roven hodnosti matice $\A$.

\poznamka
%%%%%%%%%
Èasto je hodnost matice definována jako
maximální poèet lineárnì nezávislých øádkù matice. 
Je ov¹em potøeba si velmi peèlivì uvìdomit, co slovo \uv{maximální}
v této formulaci znamená, a je potøeba z takové definice 
umìt dokázat vìtu\cite[hodAB]. 

\okraj Schodovité\hb matice | Schodovite matice

\poznamka
%%%%%%%%%
Matice $\B$ v~pøíkladu\cite[AsimB] je typickou ukázkou matice, která
vznikne po ukonèení pøímého chodu Gaussovy eliminaèní metody. Jedná se
o~matici, ve které ka¾dý následující øádek má aspoò o~jednu nulu
v~souvislé øadì nul (psané z~leva) více, ne¾ øádek pøedchozí.
Pøitom matice neobsahuje nulové øádky. Takovým maticím øíkáme
schodovité (rozhraní mezi nulovými a nenulovými prvky tvoøí schody).

\definice [hornitroj]
%%%%%%%%%
Nech» matice $\A$ má øádky $\vecc a_n$ a nech» ¾ádný z~nich není nulový. 
Nech» pro ka¾dé dva po sobì jdoucí øádky $\vec a_i$, $\vec a_{i+1}$ platí:
má-li øádek $\vec a_i$ prvních $k$ slo¾ek nulových, musí mít øádek
$\vec a_{i+1}$ aspoò prvních $k+1$ slo¾ek nulových.
Pak matici $\A$ nazýváme {\em schodovitou maticí}
\inl[matice: schodovitá, schodovitá matice]
\eng schodovitá matice = matrix in echelon form

\veta [trojnezavis]
%%%%%
Schodovitá matice má lineárnì nezávislé øádky.
\inl[lineární: nezávislost: øádkù matice]

\dukaz
%%%%%%
Lineární nezávislost ovìøíme z~definice. Nech» matice $\A$
má øádky $\vecc a_n$ a polo¾me
$$
  \lkvecc \alpha.a_n = \vec o.
$$
Po pøevedení této rovnosti do soustavy rovnic odpovídají koeficienty
jednotlivých rovnic sloupcùm matice~$\A$. Pøitom tato soustava má
v¾dy pouze triviální øe¹ení. Z~první nenulové rovnice toti¾ okam¾itì plyne, 
¾e $\alpha_1 = 0$. Dosazením tohoto výsledku do
ostatních rovnic dostaneme z~nìkteré z~následujících rovnic 
výsledek $\alpha_2=0$. Znovu dosadíme. Tento postup opakujeme tak
dlouho, dokud nedostaneme $\alpha_i=0$ $\forall i\in\{1,\ldots,n\}$.

\veta* [simhornitroj]
%%%%%
Ka¾dou matici lze pøevést koneèným poètem krokù Gaussovy eliminaèní
metody na schodovitou matici.

\dukaz
%%%%%%
Plyne z~popisu pøímého chodu Gaussovy eliminaèní metody, který je
podrobnì popsán v úvodní kapitole této uèebnice.

\algoritmus [metodahodnosti]
%%%%%%%%%%%
Pøedchozí vìta nám spoleènì s~vìtou\cite[hodAB] 
dává záruky, ¾e hodnost libovolné matice mù¾eme spoèítat
postupem, jaký jsme zvolili v~pøíkladu\cite[AsimB].
Tedy pøi výpoètu hodnosti matice $\A$ ji pøevedeme Gaussovou
eliminaèní metodou na schodovitou matici $\B$ a v ní spoèítáme
poèet nenulových øádkù. Tento poèet je roven hodnosti matice 
$\B$, proto¾e její øádky jsou podle vìty\cite[trojnezavis] lineárnì nezávislé
a tvoøí tedy bázi svého lineárního obalu. Koneènì $\hod\A=\hod\B$ díky
vìtì\cite[hodAB].
\inl[hodnost: matice]

\poznamka [sofprimychod]
%%%%%%%%%
Je zøejmé, ¾e matice, která vznikne ze~schodovité matice
pøehozením nìkterých sloupcù, má také lineárnì nezávislé øádky.
Nemusíme tedy nutnì pøi hledání hodnosti matice vytváøet
v~jednotlivých etapách Gaussovy eliminaèní metody nulové prvky 
v~tìsnì následujících sloupcích. Je-li to
z~nìjakých dùvodù výhodné, mù¾eme nejprve tøeba vytvoøit nuly pod
prvním øádkem v~osmém sloupci, pak opí¹eme první a druhý øádek a
vytváøíme nuly ve tøetím sloupci atd. Tento sofistikovanìj¹í postup
doporuèujeme ale pou¾ít jen tehdy, kdy¾ jste dùkladnì seznámeni
s~klasickým postupem pøímého chodu Gaussovy eliminaèní metody.
Jinak mù¾e velmi snadno dojít k~omylùm.
\inl[lineární: nezávislost: øádkù matice]

\poznamka
%%%%%%%%%
Postup pøímého chodu Gassovy eliminaèní metody podle 
poznámky\cite[sofprimychod] se mù¾e hodit ve dvou pøípadech. 

(1) Poèítáme modelové pøíklady a sna¾íme se dr¾et malých celých èísel.
Pøitom v~prvním sloupci jsou nesoudìlná èísla, co¾ vede po eliminaci 
ke zbyteènì velkým celým èíslùm. Poznamenejme ale, ¾e modelové
pøíklady ze skript se v~praxi vìt¹inou nevyskytují, tak¾e podstatnìj¹í
pro nás bude druhý pøípad vyu¾ití.
\inl[pøíklad: modelový, modelový pøíklad]

(2) Pøi implementaci Gaussovy eliminaèí metody do poèítaèe je vhodné
se sna¾it minimalizovat zaokrouhlovací chyby. Ty mohou ne¾ádoucím
zpùsobem ovlivnit výsledek, pokud se napøíklad sna¾íme dìlit èíslem
blízkým nule. Algoritmus by mìl vyhledat optimální cestu pøi øe¹ení
Gaussovou eliminaèní metodou, aby se pokud mo¾no vyhnul dìlením takovými
èísly.

\okraj Numericky nestabilní matice | Numericky nestabilni matice 

\poznamka
%%%%%%%%%
Numerické vyhodnocování hodnosti matice v~poèítaèi má svá úskalí,
která vyplývají z~mo¾ných zaokrouhlovacích chyb. Hodnost je definována
jednoznaènì jako pøirozené èíslo (nebo nula), ale v~praktických 
situacích se mù¾e stát, ¾e toto èíslo nelze zjistit zcela pøesnì. 
Podívejme se kupøíkladu na tuto matici:
$$\teckacarka
  \C = \pmatrix{28.33333 & 11.33333 \cr 56.66667 & 22.66667}.
$$
Kdybychom èísla v~této matici pova¾ovali za zcela pøesná, museli
bychom øíci, ¾e $\hod(\C)=2$. Pokud ale pøipustíme, ¾e na posledním
desetinném místì mohou být zaokrouhlovací chyby, pak nemáme jistotu,
zda hodnost této matice není náhodou rovna jedné. Dobøe implementovaný
algoritmus Gaussovy eliminaèní metody v~poèítaèi by nás mìl upozornit,
je-li výsledek skuteènì zaruèen, nebo zda mù¾e dojít k~záva¾ným
chybám, jako v~této matici. Takovým maticím, jako matice $\C$ v~tomto
pøíkladì, øíkáme {\em numericky nestabilní matice}. 
\inl[matice: numericky nestabilní, numericky: nestabilní matice]

Problematiku numerických metod v~tuto chvíli opustíme,
proto¾e se vìnujeme algebøe.

\okraj GEM zachovává závislost a nezávislost øádkù |
       GEM zachovava zavislost a nezavislost rádku

\poznamka 
%%%%%%%%%
Ve vìtì\cite[lobalymatic] jsme ukázali, ¾e Gaussova
eliminaèní metoda zachovává lineární obaly øádkù matice a dále
vìta\cite[hodAB] ukazuje, ¾e Gaussova eliminaèní metoda zachovává 
hodnost matice. Z toho plyne, ¾e Gaussova eliminaèní metoda zachovává
lineární závislost resp. nezávislost øádkù. Pøesnìji to zformulujeme 
v~následující vìtì\cite[GEMzav]. Nejprve ale potøebujeme dokázat
následující vìtu.

\veta* [nezav=hod]
%%%%%
Matice $\A$ má lineárnì nezávislé øádky právì tehdy, kdy¾ její hodnost
je rovna poètu jejích øádkù.

\dukaz
Nech» má $\A$ lineárnì nezávislé øádky. Pak tyto øádky tvoøí bázi
podprostoru $\lobr<\A>$, tak¾e jejich poèet je roven dimenzi tohoto
podprostoru, neboli hodnosti matice $\A$. Nech» naopak má matice $\A$
lineárnì závislé øádky. Pak je potøeba odebrat aspoò jeden øádek
procesem popsaným v pøíkladu\cite[odebirani] tak, abychom dospìli 
k~lineárnì nezávislým øádkùm, jejich¾ lineární obal je stejný jako
$\lobr<\A>$. Tato lineárnì nezávislá mno¾ina je bází podprostoru
$\lobr<\A>$ a má ménì prvkù ne¾ je poèet øádkù matice $\A$.
Hodnost matice $\A$ je tedy men¹í ne¾ poèet jejích øádkù.

\veta* [GEMzav]
%%%%%
Nech» $\A\sim\B$ oznaèuje, ¾e matice $\B$ vznikla z $\A$ koneènì mnoha
kroky Gaussovy eliminaèní metody, pøièem¾ krok odebrání nebo pøidání
nulového øádku není povolen. Pak øádky matice $\A$ jsou lineárnì
nezávislé právì tehdy, kdy¾ jsou lineárnì nezávislé øádky matice $\B$.

\dukaz
Proto¾e jsme zakázali odebírání a pøidávání øádkù, má matice $\A$
stejný poèet øádkù jako matice~$\B$. Podle vìty\cite[hodAB] Gaussova
eliminaèní metoda zachovává hodnost a je tedy v obou pøípadech tato
hodnost rovna poètu øádkù nebo men¹í ne¾ poèet øádkù. Podle
vìty\cite[nezav=hod] to znamená, ¾e v obou pøípadech jsou øádky
linárnì nezávislé nebo jsou v obou pøípadech lineárnì závislé.

\algoritmus [algollnlz]
%%%%%%%%%%%
Vìta\cite[nezav=hod] nám dává návod, jak vyhodnotit lineární
závislost èi nezávislost vektorù z $\R^n$. Vy¹etøované vektory staèí
zapsat do øádkù matice a spoèítat eliminaèní metodou hodnost této
matice (viz algoritmus\cite[metodahodnosti]). 
Je-li hodnost men¹í, ne¾ poèet øádkù, jsou tyto øádky lineárnì
závislé. Jinak jsou lineárnì nezávislé.

\priklad
%%%%%%%%
Vektory $(1,2,3,4,5), (2,3,4,4,7), (1,1,1,3,4), (3,5,7,8,12)$ jsou
lineárnì závislé, proto¾e odpovídající matice má hodnost 3, jak jsme
ji¾ spoèítali v pøíkladu\cite[AsimB].

\algoritmus [algolrovnost]
%%%%%%%%%%%
Vìta\cite[rovnostobalu] spoleènì s definicí hodnosti matice jako dimenzi
lineárního obalu øádkù matice\cite[dhodnost] nám dává návod, jak
vyhodnotit, zda dva lineární obaly jsou stejné. Nech» $\vecc u_k$ a
$\vecc v_m$ jsou vektory z $\R^n$ a cílem je ovìøit, zda
$\lob<\vecc u_k>=\lob<\vecc v_m>$, Do øádkù matice $\A$ zapí¹eme
vektory $\vecc u_k$, do øádkù matice $\B$ zapí¹eme vektory $\vecc v_m$
a koneènì do øádkù matice $\C$ zapí¹eme øádky obou matic spoleènì. Pak
uvedené lineární obaly se rovnají, pokud
$\hod\A=\hod\B=\hod\C$. Pøitom na výpoèet hodnosti máme 
algoritmus\cite[metodahodnosti].

\priklad
%%%%%%%%
Ovìøíme, ¾e $\lob<(1,2,4,2),(2,5,0,3),(4,9,8,7)>=\lob<(1,3,-4,1),(3,7,-4,4)>$.
$$
%\eqalign{
\vcenter{
  \hbox{$\A=\pmatrix{1&2&4&2\cr2&5&0&3\cr4&9&8&7}\sim
        \pmatrix{1&2&4&2\cr0&1&-8&-1},$}\medskip
  \hbox{$\B=\pmatrix{1&3&-4&1\cr3&7&-4&4}\sim
         \pmatrix{1&3&-4&1\cr0&1&-8&-1},$}
}\qquad
\C=\pmatrix{1&2&4&2\cr2&5&0&3\cr4&9&8&7\cr1&3&-4&1\cr3&7&-4&4}\sim
        \pmatrix{1&2&4&2\cr0&1&-8&-1},
%}
$$
Proto¾e $\hod\A=\hod\B=\hod\C=2$, uvedené lineární obaly se rovnají.

\algoritmus [algoljeprvkem]
%%%%%%%%%%%
Vìta\cite[pribaleni] spoleènì s definicí hodnosti matice\cite[dhodnost]
nám dává návod, jak poznat, ¾e nìjaký vektor $\vec v\in\R^n$ je prvkem
lineárního obalu $\lob<\vecc u_k>$, kde vektory $\vecc u_k$ jsou také prvky
z~$\R^n$. Staèí do matice $\A$ zapsat po øádcích vektory $\vecc u_k$ a
do øádkù matice $\B$ napsat toté¾, ale navíc tam pøidat øádek $\vec v$.  
Pak $\vec v$ le¾í v uvedeném lineárním obalu, právì kdy¾
$\hod\A=\hod\B$. Pøitom na výpoèet hodnosti máme 
algoritmus\cite[metodahodnosti].

\priklad
%%%%%%%%
Ovìøíme, zda $(1,1,12,3)\in\lob<(1,2,4,2),(2,5,0,3),(4,9,8,7)>$.
$$
\A=\pmatrix{1&2&4&2\cr2&5&0&3\cr4&9&8&7}\sim
        \pmatrix{1&2&4&2\cr0&1&-8&-1},\qquad
\B=\pmatrix{1&2&4&2\cr2&5&0&3\cr4&9&8&7\cr1&1&12&3}\sim
        \pmatrix{1&2&4&2\cr0&1&-8&-1}.
$$
Proto¾e $\hod\A=\hod\B=2$, le¾í vektor $(1,1,12,3)$ v uvedeném
lineárním obalu.

\okraj Transpono\-vaná matice | Transponovana matice

\definice [defAT]
%%%%%%%%%
Nech» $\A=(a_{i,j})\in\R^{m,n}$. Matici $\A^T=(a_{j,i})\in\R^{n,m}$
nazýváme {\em transponovanou maticí} k~matici $\A$. 
Matice $\A^T$ tedy vznikne z~matice $\A$ pøepsáním øádkù matice 
$\A$ do sloupcù matice $\A^T$, respektive pøepsáním sloupcù 
matice $\A$ do øádkù matice $\A^T$.
\inl[matice: transponovaná, transponovaná: matice, 1AT]

\priklad
%%%%%%%%
\vskip-\bigskipamount
$$
  \hbox{Je-li tøeba } \A   = \pmatrix{1&2&3\cr4&5&6}, \quad
  \hbox{pak je }          \A^T = \pmatrix{1&4\cr2&5\cr3&6}.
$$

\veta [ATT=A]
%%%%%%%%%%%%%
Pro ka¾dou matici $\A$ platí: $(\A^T)^T = \A$.

\dukaz
%%%%%%
Vìta plyne pøímo z~definice\cite[defAT].

\veta* [hA=hAT]
%%%%%%%%%%%%%%
Pro ka¾dou matici $\A\in\R^{m,n}$ platí: $\hod(\A^T) = \hod(\A)$.

\exdukaz
%%%%%%%%
Uká¾eme nejprve, ¾e $\hod(\A^T)\ge\hod(\A)$.
Nech» $\A\in\R^{m,n}$ a oznaème $k=\hod(\A)$. 
Podle vìty\cite[hod=maxradku] existuje $k$ lineárnì nezávislých 
øádkù matice $\A$. Oznaème je $\vecc b_k$.
Zapi¹me si, co to znamená, ¾e tyto øádky jsou lineárnì nezávislé.
Pro
$$
  \lkvecc \alpha.b_k = \vec o
$$
musí být $\alpha_i=0$ $\forall i\in\{1,\ldots,k\}$.
Tento po¾adavek vede na soustavu rovnic, která
musí mít jedinì triviální øe¹ení:
$$
  \def\quad{\kern.3em }
  \matrix{
  \alpha_1\,b_{1,1} + \alpha_2\,b_{2,1} + \cdots + \alpha_k\,b_{k,1} &=& 0, \cr
  \alpha_1\,b_{1,2} + \alpha_2\,b_{2,2} + \cdots + \alpha_k\,b_{k,2} &=& 0, \cr 
  \hphantom{ \alpha_1\,b_{1,1} + \alpha_2\,b_{2,1} +{}}         
  \cdots\hphantom{{}+\alpha_k\,b_{k,1}}  \cr
  \alpha_1\,b_{1,n} + \alpha_2\,b_{2,n} + \cdots + \alpha_k\,b_{k,n} &=& 0. \cr
  }\rce(AT)
$$
Koeficienty jednotlivých rovnic soustavy\cite(AT) odpovídají
èástem sloupcù matice $\A$. Èástmi sloupcù v~tomto dùkazu budeme
oznaèovat uspoøádané $k$-tice obsahující jen ty prvky z~daného
sloupce, které le¾í ve vybraných øádcích $\vecc b_k$. Aby bylo zaruèeno 
pouze triviální øe¹ení soustavy\cite(AT), musíme po pøímém chodu 
Gaussovy eliminaèní metody dostat schodovitou matici 
o~$k$-øádcích (ménì øádkù by vedlo na nekoneènì
mnoho øe¹ení). To podle vìt\cite[hod=maxradku] 
a\cite[lobalymatic] znamená, ¾e existuje
$k$ lineárnì nezávislých èástí sloupcù matice $\A$. Tyté¾
celé sloupce matice $\A$ jsou lineárnì nezávislé
(kdyby byly závislé, pak by stejná netriviální lineární
kombinace celých sloupcù dávala nulový vektor i 
na èástech sloupcù, ale my víme, ¾e èásti sloupcù jsou 
lineárnì nezávislé). Máme 
tedy zaruèeno, ¾e v~matici $\A$ je aspoò $k$ lineárnì 
nezávislých sloupcù (zatím není vylouèeno, ¾e jich mù¾e být více). 
Podle vìty\cite[hod=maxradku] tedy je $\hod(\A^T)\geq k=\hod(\A)$.

Máme $\hod\bigl((\A^T)^T\bigr)\geq \hod(\A^T)\geq \hod(\A)$, a pøitom podle
vìty\cite[ATT=A] je $(\A^T)^T=\A$, tak¾e v¹echny uvedené hodnosti se
rovnají. 

\poznamka
%%%%%%%%%
Ukázali jsme, ¾e hodnosti matice $\A$ a $\A^T$ se rovnají. To
vysvìtluje, proè jsme nedefinovali zvlá¹» \uv{øádkovou} hodnost
matice jako dimenzi lineárního obalu øádkù a zvlá¹» 
\uv{sloupcovou} hodnost jako dimezi lineárního obalu sloupcù.
Tato èísla jsou podle vìty\cite[hA=hAT] stejná.

\veta [hodminimum]
%%%%%
Nech» $\A\in\R^{m,n}$. Pak $\hod(\A) \leq \min(m,n)$.
\inl[hodnost: matice]

\dukaz
%%%%%%
Hodnost matice je men¹í nebo rovna poètu øádkù z~vìty\cite[hod=maxradku] 
a je men¹í nebo rovna poètu sloupcù z~vìty\cite[hA=hAT].


\okraj Pøíklad na spojení podprostorù | Priklad na spojeni podprostoru

\poznamka
%%%%%%%%%
Na konci kapitoly\kcite\ktere[base] jsme uvedli \uv{pøílepek} o spojení a
prùniku podprostorù. Nyní máme k dispozici
vìtu\cite[lobalymatic], tedy aparát, pomocí
kterého si mù¾eme tuto problematiku ilustrovat na pøíkladech.


\priklad [pr-prunikspojeni]
%%%%%%%%
Jsou dány lineární podprostory $M$ a $N$ lineárního prostoru $\R^5$
pomocí lineárních obalù:
$$
  \eqalign{
  M &= \bigl< (1,2,0,1,1), (1,3,1,3,4), (3,5,2,4,5) \bigr>, \cr
  N &= \bigl< (1,1,3,4,3), (1,0,2,2,0), (2,1,3,2,3), (0,1,2,4,3) \bigr>. }
$$
Najdeme bázi a dimenzi prostorù $M$, $N$, $M\cap N$ a $M\vee N$.

Podle vìty\cite[lobalymatic] zachovává Gaussova eliminaèní metoda
lineární obal øádkù matice, tak¾e budeme eliminovat následující
matice:
$$
  \jot=0pt
\eqalign{
  M: &\quad
  \matice{1&2&0&1&1\cr 1&3&1&3&4\cr 3&5&2&4&5} \sim
  \matice{1&2&0&1&1\cr 0&1&1&2&3\cr 0&\!-1&2&1&2} \sim
  \matice{1&2&0&1&1\cr 0&1&1&2&3\cr 0&0&3&3&5} ,
\cr \noalign{\medskip}
  N: &\quad 
  \matice{1&1&3&4&3\cr 1&0&2&2&0\cr 2&1&3&2&3\cr 0&1&2&4&3} \sim
  \matice{1&1&3&4&3\cr 0&-1&-1&-2&-3\cr 0&-1&-3&-6&-3\cr 0&1&2&4&3} \sim
  \matice{1&1&3&4&3\cr 0&1&1&2&3\cr 0&0&2&4&0\cr 0&0&1&2&0} \sim
  \matice{1&1&3&4&3\cr 0&1&1&2&3\cr 0&0&1&2&0}.
}
$$
Podle vìty\cite[trojnezavis] jsou øádky matic zapsaných nejvíce vpravo
lineárnì nezávislé. Lineární obal tìchto øádkù zùstal zachován a je
roven $M$, respektive $N$. Máme tedy:
$$
  \eqalign{
  \hbox{báze $M$}: &\quad 
  \bigl\{(1,2,0,1,1), (0,1,1,2,3), (0,0,3,3,5)\bigr\}, \quad
  \dim M = 3, \cr
  \hbox{báze $N$}: &\quad 
  \bigl\{(1,1,3,4,3), (0,1,1,2,3), (0,0,1,2,0)\bigr\}, \quad
  \dim N = 3. }
$$
Vzhledem k tomu, ¾e tøi vektory, kterými je zadán podprostor~$M$, jsou
lineárnì nezávislé, mù¾eme zapsat i jinou bázi~$M$:
$\{(1,2,0,1,1), (1,3,1,3,4), (3,5,2,4,5)\}$. Vektory, kterými je zadán
podprostor~$N$ jsou lineárnì závislé, tak¾e netvoøí bázi.

Platí $M\vee N =\lob<M\cup N> = \lob<\hbox{báze}\;M\,\cup\,{}\hbox{báze}\;N>$, 
tak¾e bázi tohoto podprostoru najdeme eliminací následující matice:
$$
  \displaylines{
  M\vee N: \enspace
  \matice{1&2&0&1&1\cr 0&1&1&2&3\cr 0&0&3&3&5\cr
          1&1&3&4&3\cr 0&1&1&2&3\cr 0&0&1&2&0} \sim
  \matice{1&2&0&1&1\cr 0&1&1&2&3\cr 0&0&3&3&5\cr
          0&\!-1&3&3&2\cr 0&0&1&2&0} \sim
  \matice{1&2&0&1&1\cr 0&1&1&2&3\cr 0&0&3&3&5\cr
          0&0&4&5&5\cr 0&0&1&2&0} \sim
  \matice{1&2&0&1&1\cr 0&1&1&2&3\cr 0&0&3&3&5\cr
          0&0&0&\!-3&5\cr 0&0&0&\!-3&5} \sim
  \matice{1&2&0&1&1\cr 0&1&1&2&3\cr 0&0&3&3&5\cr
          0&0&0&\!-3&5}, \cr
  \hbox{báze}\; M\vee N: \quad
  \bigl\{(1,2,0,1,1), (0,1,1,2,3), (0,0,3,3,5), (0,0,0,-3,5) \bigr\}, \quad
  \dim (M\vee N) = 4. }
$$
Podle vìty\cite[dimspojeni] máme okam¾itì dimenzi prùniku:
$$
  \dim(M\cap N) = \dim M + \dim N - \dim (M\vee N) = 3 + 3 - 4 = 2,
$$
bohu¾el nalezení báze prùniku dá je¹tì trochu práce. 
Vektory spoleèné obìma podprostorùm musí jít zapsat jako 
lineární kombinace báze~$M$ i lineární kombinace báze~$N$:
$$
  \alpha\,(1,2,0,1,1)+ \beta\,(0,1,1,2,3) + \gamma\,(0,0,3,3,5) = 
  a\,(1,1,3,4,3) + b\,(0,1,1,2,3) + c\,(0,0,1,2,0).
  \rce(hledamprunik)
$$
Z tohoto po¾adavku nám vychází soustava pìti rovnic o ¹esti neznámých
$\alpha, \beta, \gamma, a, b, c$. 
Eliminujeme matici této homogenní soustavy.
$$
  \matice{1&\kern4pt0&\kern4pt0&-1&0&0\cr2&1&0&-1&-1&0\cr0&1&3&-3&-1&-1\cr
          1&2&3&-4&-2&-2\cr1&3&5&-3&-3&0}\sim
  \matice{1&\kern4pt0&\kern4pt0&-1&0&0\cr0&1&0& 1&-1&0\cr0&1&3&-3&-1&-1\cr
          0&2&3&-3&-2&-2\cr0&3&5&-2&-3&0}\sim \cdots \sim
  \matice{1&\kern4pt0&\kern4pt0&-1&0&0\cr0&1&0& 1&-1&0\cr0&0&3&-4&0&-1\cr
          0&0&0&1&0&1}.
$$
Volíme $b=t$, $c=u$, pak vychází $a=-u$. Ostatní hodnoty promìnných
nemusíme poèítat a vrátíme se k pravé stranì rovnosti\cite(hledamprunik).
Vektory, které jsou spoleèné obìma prostorùm, musejí tedy splòovat:
$$
   -u\,(1,1,3,4,3) + t\,(0,1,1,2,3) + u\,(0,0,1,2,0) =
  t\,(0,1,1,2,3) + u\,(-1,-1,-2,-2,-3).
$$
Je tedy $M\cap N = \bigl<(0,1,1,2,3), (1,1,2,2,3)\bigr>$ a tyto
dva vektory tvoøí jednu z mo¾ných bází lineárního prostoru $M\cap N$.
®e prùnik obsahuje vektor $(0,1,1,2,3)$ nás nepøekvapí, proto¾e tento
vektor byl souèástí obou bází podprostorù $M$ i $N$. Soustavu jsme
poèítali jen kvùli tomu, abychom na¹li ten druhý vektor.


\shrnuti
%%%%%%%%
Mno¾ina matic $\R^{m,n}$ tvoøí lineární prostor. Vektory z $\R^n$
mù¾eme ztoto¾nit s maticemi z~$\R^{1,n}$ (øádkové vektory) nebo 
s~maticemi z~$\R^{n,1}$ (sloupcové vektory). Øádkové vektory mù¾eme
klást pod sebe a tvoøit matice, nebo mù¾eme sloupcové vektory klást
vedle sebe a rovnì¾ dostáváme matice.

Hodnost matice je dimenze lineárního obalu øádkù\lcite[dhodnost],
co¾ je toté¾ jako dimenze lineárního obalu sloupcù\lcite[hA=hAT].
Na výpoèet hodnosti matice se pou¾ívá algoritmus\cite[metodahodnosti].

V této kapitole jsme si ukázali algoritmy vycházející z toho, ¾e
dané øádkové vektory zapí¹eme pod sebe a vytvoøíme matici, její¾
hodnost vypoèítáme.
Algoritmus\cite[algollnlz] umo¾ní rozhodnout, zda jsou vektory
lineárnì závislé èi nezávislé. Algoritmus\cite[algolrovnost]
umo¾ní ovìøit rovnost obalù a algoritmus\cite[algoljeprvkem] odpoví na
otázku, zda vektor le¾í v lineárním obalu daných vektorù.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\kapitola Násobení matic | Nasobeni matic
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\okraj Definice násobení matic | Definice nasobeni matic

\definice* [soucinAB]
%%%%%%%%%
Nech» $\A=(a_{i,j})\in\R^{m,n}$ a $\B=(b_{j,k})\in\R^{n,p}$.
Pak je definován {\em souèin matic $\A\cdot\B$} 
(v~tomto poøadí) jako matice typu $(m,p)$ takto: 
ka¾dý prvek $c_{i,k}$ matice $\A\cdot\B$ je dán vzorcem
$$
  c_{i,k} = a_{i,1}\,b_{1,k} + a_{i,2}\,b_{2,k} + \cdots + a_{i,n}\,b_{n,k} 
  = \sum_{j=1}^n a_{i,j}\,b_{j,k}, \quad 
  i\in\{1,\ldots,m\},\quad k\in\{1,\ldots,p\}.
  \rce(cik)
$$
\par\inl[násobení: matic, matice: násobení]
\inl[souèin: matic, matice: souèin]

\poznamka
%%%%%%%%%
V¹imneme si, ¾e násobení je definováno jen tehdy, pokud poèet sloupcù
první matice je roven poètu øádkù druhé matice. Výsledná matice má
stejný poèet øádkù, jako první matice a stejný poèet sloupcù, jako
druhá matice. Názornì:
$$
\setbox0=\hbox{$\underbrace{\matrix {\circ&\circ&\cdots&\circ\cr
            \circ&\circ&\cdots&\circ\cr
                      &&\cdots&\cr
            \circ&\circ&\cdots&\circ\cr}}$}
\dimen0=\wd0
\setbox0=\vtop{\hbox{\box0}\kern2pt\hbox to\dimen0{\hfil$n$\hfil}}\dp0=0pt
\setbox1=\hbox{$\underbrace{\matrix {\circ&\cdots&\circ\cr
            \circ&\cdots&\circ\cr
            \circ&\cdots&\circ\cr
                 &\cdots&\cr
            \circ&\cdots&\circ\cr}}$}
\dimen0=\wd1
\setbox1=\vtop{\hbox{\box1}\kern2pt\hbox to\dimen0{\hfil$p$\hfil}}\dp1=0pt
\setbox2=\hbox{$\underbrace{\matrix {\circ&\cdots&\circ\cr
            \circ&\cdots&\circ\cr
                 &\cdots&\cr
            \circ&\cdots&\circ\cr}}$}
\dimen0=\wd2
\setbox2=\vtop{\hbox{\box2}\kern2pt\hbox to\dimen0{\hfil$p$\hfil}}\dp2=0pt
%
m\left\{\left(\box0\right)\right. \quad\cdot\quad 
n\left\{\left(\box1\right)\right. 
\quad=\quad \left.\left(\box2\right)\right\}m
%
\advance\belowdisplayskip by1.5\baselineskip
\belowdisplayshortskip=\belowdisplayskip
$$
Ka¾dý prvek matice $\A\cdot\B$ pøitom musíme poèítat podle 
vzorce\cite(cik) jako souèet
souèinù odpovídajících prvkù øádku první matice a sloupce druhé
matice. Zaèáteèníci mohou pou¾ít tzv.~\uv{dvouprstovou vizuální
metodu}: pøi výpoètu èísla $c_{i,k}$ pøilo¾te ukazováèek levé ruky na
zaèátek $i$-tého øádku první matice a ukazováèek pravé ruky na zaèátek
$k$-tého sloupce druhé matice. Pak pronásobte mezi sebou èísla, na
která ukazují prsty, a výsledek ulo¾te do sèítací pamìti. Posuòte levý
prst na dal¹í prvek v~øádku a pravý prst na dal¹í prvek
v~sloupci. Znovu vynásobte a pøiètìte výsledek ke sèítací
pamìti. Posunujte dále levý prst v~øádku a pravý prst ve sloupci, 
násobte a sèítejte ve sèítací pamìti tak dlouho, dokud nevyèerpáte 
celý øádek první matice. To se stane podle
definice v~okam¾iku, kdy té¾ vyèerpáte celý sloupec druhé
matice. Výsledek sèítací pamìti pak napi¹te jako prvek $c_{i,k}$
do postupnì budované výsledné matice $\A\cdot\B$.

\priklad [prikladnasobeni]
%%%%%%%%
$$
  \catcode`.=13 \def.{\cdot}
  \pmatrix{1&2&3&4\cr5&6&7&8\cr0&2&1&0} \cdot
  \pmatrix{1&2\cr3&4\cr5&6\cr2&7} =
  \pmatrix{1.1+2.3+3.5+4.2 \enskip & 1.2+2.4+3.6+4.7 \cr
           5.1+6.3+7.5+8.2 \enskip & 5.2+6.4+7.6+8.7 \cr
           0.1+2.3+1.5+0.2 \enskip & 0.2+2.4+1.6+0.7 \cr} =
  \pmatrix{30 & 56 \cr 74 & 132 \cr 11 & 14}.
$$

\priklad* [nekomutuje]
%%%%%%%%
$$
  \pmatrix{1&1\cr1&1} \cdot \pmatrix{\hfill1&\hfill1\cr-1&-1} 
   = \pmatrix{0&0\cr0&0}, \qquad
  \pmatrix{\hfill1&\hfill1\cr-1&-1} \cdot \pmatrix{1&1\cr1&1} 
   = \pmatrix{\hfill2&\hfill2\cr-2&-2}.
$$
Tento pøíklad ilustruje, ¾e násobení matic obecnì nesplòuje
komutativní zákon ani pro
ètvercové matice, tj. existují matice $\A$, $\B$, pro které neplatí
$\A\cdot\B = \B\cdot\A$.
Pokud nìkterá z~matic $\A$, $\B$ není ètvercová, pak souèin
$\B\cdot\A$ nemusí být vùbec definován, pøesto¾e souèin $\A\cdot\B$
definován je. 
\inl[zákon: komutativní, komutativní: zákon]

Pøíklad dále ukazuje, ¾e není splnìna ani vlastnost nuly,
na kterou jsme zvyklí pøi násobení reálných èísel: je-li $a\not=0$, 
$b\not= 0$, pak $a\,b\not=0$. V~pøíkladu násobíme dvì nenulové matice,
a pøitom dostáváme matici nulovou.

Musíme si z~toho odnést ponauèení, ¾e násobení matic nesplòuje v¹echny
vlastnosti, na které jsme zvyklí, a proto pøi úpravách vzorcù
obsahujících násobení matic si musíme dát pozor, co mù¾eme v~dané
situaci udìlat.
\inl[násobení: matic, matice: násobení]
\inl[souèin: matic, matice: souèin]

Nabízí se pøirozená otázka, zda násobení matic splòuje aspoò nìjaké
zákony, na které jsme zvyklí (jinak by bylo skoro zbyteèné tuto
operaci nazývat násobením). Následující vìta ukazuje, ¾e násobení
matic je asociativní a také distributivní vzhledem ke sèítání matic.

\veta* [soucinAB-vlastnosti]
%%%%%
Nech» $\alpha\in\R$ a matice $\A$, $\B$, $\C$ jsou odpovídajících 
typù tak, aby ní¾e uvedené souèiny a souèty byly definovány. Pak platí
$$
\abovedisplayskip=2pt
\eqalign{ 
  \bod (1) (\A\cdot\B)\cdot\C = \A\cdot(\B\cdot\C)
            \quad \hbox{(asociativní zákon)}, \cr
  \bod (2) (\A+\B)\cdot\C = \A\cdot\C + \B\cdot\C
            \quad \hbox{(distributivní zákon)},\cr
  \bod (3) \C\cdot(\A+\B) = \C\cdot\A + \C\cdot\B
            \quad \hbox{(distributivní zákon)},\cr
  \bod (4) \alpha(\A\cdot\B) = (\alpha\,\A)\cdot\B =
            \A\cdot(\alpha\,\B), \cr
  \bod (5) (\A\cdot\B)^T=\B^T\cdot\A^T. \cr}
$$
\par\inl[násobení: matic, matice: násobení]
\inl[souèin: matic, matice: souèin]
\inl[asociativní: zákon, zákon: asociativní]
\inl[distributivní: zákon, zákon: distributivní]

\dukaz
%%%%%%
Jako cvièení doplòte ke ka¾dému vzorci vìty pøedpoklady o~typech 
matic. Tyto pøedpoklady se budou pro rùzné vzorce li¹it.
V~tomto dùkazu pøedpokládáme typy matic $(m,n)$, $(n,p)$ a $(p,q)$.

(1) Oznaème $\A=(a_{i,j})$, $\B=(b_{j,k})$, $\C=(c_{k,l})$, 
$\A\cdot\B=(d_{i,k})$, $\B\cdot\C=(f_{j,l})$, 
$(\A\cdot\B)\cdot\C=(g_{i,l})$, $\A\cdot(\B\cdot\C)=(h_{i,l})$
pro $i\in\{1,\ldots,m\}$, $j\in\{1,\ldots,n\}$, 
$k\in\{1,\ldots,p\}$, $l\in\{1,\ldots,q\}$. Jde o~to ukázat, ¾e
$g_{i,l} = h_{i,l}$ pro v¹echna $i\in\{1,\ldots,m\}$ a $l\in\{1,\ldots,q\}$.
Podle definice\cite[soucinAB] je
$$
  d_{i,k} = \sum_{j=1}^n a_{i,j}\,b_{j,k}, \quad 
  f_{j,l} = \sum_{k=1}^p b_{j,k}\,c_{k,l},
$$
tak¾e platí
$$
\def\j{\vbox to0pt{\vss\hbox{$\scriptstyle j$}}}
\displaylines{
  g_{i,l} = \sum_{k=1}^p d_{i,k}\,c_{k,l} =
  \sum_{k=1}^p \left( \sum_{\j=1}^n a_{i,j}\,b_{j,k}\right)c_{k,l}\, =
  \sum_{k=1}^p \left( \sum_{\j=1}^n a_{i,j}\,b_{j,k}\,c_{k,l}\right) = X, \cr
  h_{i,l} =  \sum_{j=1}^n a_{i,j}\,f_{j,l} =
  \sum_{j=1}^n a_{i,j}\,\left( \sum_{k=1}^p b_{j,k}\,c_{k,l}\right) =
  \sum_{j=1}^n \left( \sum_{k=1}^p a_{i,j}\,b_{j,k}\,c_{k,l}\right) = Y.
}
$$    
Vysvìtlíme si, proè platí $X=Y$. Volme $i$, $l$ pevná. 
Souèiny $a_{i,j}\cdot b_{j,k}\cdot c_{k,l}$ mù¾eme zapsat do tabulky, 
ve které index $j$ odpovídá øádku tabulky a
index $k$ sloupci. Hodnota $X$ pak znamená souèet sloupcových
mezisouètù v~tabulce a hodnota $Y$ souèet øádkových mezisouètù.
Ka¾dá úèetní ví, ¾e obì hodnoty musí 
dát stejný výsledek. My ostatní to snadno nahlédneme.

(2)  Oznaème $\A=(a_{i,j})$, $\B=(b_{i,j})$, $\C=(c_{j,k})$,
$(\A+\B)\cdot\C=(d_{i,k})$ pro
$i\in\{1,\ldots,m\}$, $j\in\{1,\ldots,n\}$, 
$k\in\{1,\ldots,p\}$. Pak podle definic\cite[soucinAB] a\cite[deflpmatic]
platí
$$
  d_{i,k} = \sum_{j=1}^n (a_{i,j} + b_{i,j})\, c_{j,k} =
   \sum_{j=1}^n (a_{i,j}\,c_{j,k} +  b_{i,j}\,c_{j,k}) =
   \sum_{j=1}^n a_{i,j}\,c_{j,k} +  \sum_{j=1}^n b_{i,j}\,c_{j,k},
$$
co¾ odpovídá prvkùm matice $\A\cdot\C + \B\cdot\C$.

(3) Dùkaz bychom provedli obdobnì, jako v~pøípadì (2).

(4) Oznaème $\A=(a_{i,j})$, $\B=(b_{j,k})$ pro $i\in\{1,\ldots,m\}$,
$j\in\{1,\ldots,n\}$, $k\in\{1,\ldots,p\}$. Platí
$$
  \alpha\,\sum_{j=1}^n a_{i,j}\,b_{j,k} = 
  \sum_{j=1}^n \alpha\, a_{i,j}\,b_{j,k} =
  \sum_{j=1}^n (\alpha\, a_{i,j})\,b_{j,k} =
  \sum_{j=1}^n a_{i,j}\,(\alpha\,b_{j,k}),
$$
co¾ dokazuje vzorec:~(4).

(5) Oznaèíme $\A=(a_{i,j})$, $\B=(b_{j,k})$, $\C=\A\cdot\B=(c_{i,k})$,
$i\in\{1,\ldots,m\}$, $j\in\{1,\ldots,n\}$, \hbox{$k\in\{1,\ldots,p\}$}.
Je tedy $\A^T=(\alpha_{j,i})$, $\B^T=(\beta_{k,j})$, kde 
$\alpha_{j,i}=a_{i,j}$, $\beta_{k,j}=b_{j,k}$.
Oznaème je¹tì souèin $\D=\B^T\cdot\A^T=(d_{k,i})$. 
Podle definice násobení je
$$
  c_{i,k} = \sum_{j=1}^n a_{i,j}\,b_{j,k} =
            \sum_{j=1}^n \beta_{k,j}\,\alpha_{j,i} = 
  d_{k,i}, 
$$
tak¾e $\D^T=\C$, co¾ dokazuje vzorec~(5).

\priklad
%%%%%%%%
Nech» $\A$, $\B$, $\C$ jsou ètvercové matice. Spoèítáme
$(\A+\B)\cdot(\B+\C)$. Podle~(3) ve vìtì\cite[soucinAB-vlastnosti]
je $(\A+\B)\cdot(\B+\C) = (\A+\B)\cdot \B + (\A+\B)\cdot \C =
\A\cdot\B + \B\cdot\B + \A\cdot\C + \B\cdot\C$. Místo zápisu
$\B\cdot\B$ budeme u¾ívat zkratku $\B^2$. Koneèný výsledek je
$\A\cdot\B + \B^2 + \A\cdot\C + \B\cdot\C$.

Jiný pøíklad: $(\A+\B)^2 = (\A+\B) \cdot (\A+\B) = 
(\A+\B)\cdot\A + (\A+\B)\cdot\B =
\A^2 + \B^2 + \A\cdot\B + \B\cdot\A$. Tento výsledek obecnì nelze
zjednodu¹it, proto¾e násobení matic není komutativní. Pouze tehdy,
kdy¾ pro tyto matice platí $\A\cdot\B = \B\cdot\A$, mù¾eme psát 
výsledek ve tvaru $\A^2 + 2\,\A\cdot\B + \B^2$.

\okraj Blokové\hb násobení | Blokove nasobeni

\poznamka
%%%%%%%%%
Matice mù¾e vzniknout sestavením men¹ích matic vedle sebe anebo pod
sebe. Napøíklad:
$$
\A_1 = \pmatrix{1&2\cr 3&4}, \quad
\A_2 = \pmatrix{6\cr 7}, \quad
\A_3 = \pmatrix{8&9}, \quad
\A_4 = \pmatrix{0}, \quad
\B = \pmatrix {\A_1&\A_2\cr \A_3&\A_4} = 
     \pmatrix {1&2&6\cr3&4&7\cr8&9&0}
$$
Zde na matici $\B$ mù¾eme pohlí¾et jako na matici sestavenou napøíklad
z blokù $\A_1$, $\A_2$, $\A_3$, $\A_4$. Bloky kladené vedle sebe
musejí mít samozøejmì stejný poèet øádkù a bloky kladené pod sebe
musejí mít stejný poèet sloupcù. 


\veta [ctyribloky]
%%%%%
Nech» $\A$ a $\B$ jsou matice sestavené po blocích takto:
$$
  \A = \pmatrix {\A_{1,1}& \A_{1,2} \cr \A_{2,1} & \A_{2,2}}, \quad
  \B = \pmatrix {\B_{1,1}& \B_{1,2} \cr \B_{2,1} & \B_{2,2}}
$$
Nech» uvedené bloky jsou matice takového typu, ¾e násobení matic $\A_{i,j}\cdot\B_{j,k}$
je definováno pro v¹echny pøípady, které se vyskytují v následujícím
vzorci. Pak
$$
  \A\cdot \B = \pmatrix {\A_{1,1}\cdot\B_{1,1}+ \A_{1,2}\cdot\B_{2,1}&\
                         \A_{1,1}\cdot\B_{1,2}+ \A_{1,2}\cdot\B_{2,2}\cr
                         \A_{2,1}\cdot\B_{1,1}+ \A_{2,2}\cdot\B_{2,1}&\
                         \A_{2,1}\cdot\B_{1,2}+ \A_{2,2}\cdot\B_{2,2}}
$$
\vskip-2\baselineskip\null

\dolu 12mm
\obrazek .5+.06 11 obr5
{
  \p 7 15 {\hbox{1. úsek}}
  \p 7 65 {\hbox{2. úsek}}
  \p 14 -14 i
  \p 30 30 \A_{1,1}
  \p 30 70 \A_{1,2}
  \p 70 30 \A_{2,1}
  \p 70 70 \A_{2,2}
  \p 50 -10 {\left(\vrule height55pt width0pt \right.}
  \p 50 95 {\left.\vrule height55pt width0pt \right)}
  \p 50 107 {\cdot}
  \p -3 163 k
  \p 50 115 {\left(\vrule height50pt width0pt \right.}
  \p 50 215 {\left.\vrule height50pt width0pt \right)}
  \p 30 130 {\hbox{1. úsek}}
  \p 77 130 {\hbox{2. úsek}}
  \p 35 170 \B_{1,1}
  \p 35 195 \B_{1,2}
  \p 77 170 \B_{2,1}
  \p 77 195 \B_{2,2}
}
\dukaz
%%%%%%
Prvek $c_{i,k}$
souèinu $\A\cdot\B$ se poèítá z~prvkù $i$-tého øádku matice $\A$ a
$k$-tého sloup\-ce matice $\B$. Prochází-li $i$-tý øádek bloky
$\A_{1,1}$ a $\A_{1,2}$ a $k$-tý sloupec bloky $\B_{1,1}$ a
$\B_{2,1}$, pak zøejmì souèin $\A_{1,1}\cdot\B_{1,1}$ pracuje s prvky
prvního úseku $i$-tého øádku matice $\A$ a prvního úseku $k$-tého sloupce matice
$\B$ a dal¹í souèin $\A_{1,2}\cdot\B_{2,1}$ bere prvky z druhého úseku 
$i$-tého øádku matice $\A$ a druého úseku $k$-tého sloupce matice $\B$.
Prvek $c_{i,k}$ je podle definice maticového souèinu\cite[soucinAB] 
souètem odpovídajících prvkù na $i$-tém øádku
a $k$-tém sloupci v maticích $\A_{1,1}\cdot\B_{1,1}$ a $\A_{1,2}\cdot\B_{2,1}$.
Analogicky je mo¾no argumentovat v pøípadì, ¾e $i$-tý øádek nebo
$k$-tý sloupec procházejí jinými bloky. Obtí¾nì se o tom mluví, lep¹í
je si toto maticové násobení \uv{nakreslit} (viz obrázek).
$$
\eqalign{
  c'_{i,k} &= \hbox{prvek}_{i,k}\hbox{ matice }\A_{1,1}\cdot\B_{1,1} =
             (\hbox{1. úsek $i$-tého øádku }\A)\cdot
             (\hbox{1. úsek $k$-tého sloupce }\B) \cr
  c''_{i,k} &= \hbox{prvek}_{i,k}\hbox{ matice }\A_{1,2}\cdot\B_{2,1} =
              (\hbox{2. úsek $i$-tého øádku }\A)\cdot
              (\hbox{2. úsek $k$-tého sloupce }\B) \cr
  c_{i,k} &= \hbox{prvek}_{i,k}\hbox{ matice }\A\cdot\B =
             (\hbox{celý $i$-tý øádek }\A)\cdot(\hbox{celý $k$-tý sloupec }\B)
           = c'_{i,k} + c''_{i,k}. 
}
$$

\veta [soucinbloku]
%%%%%
Nech» $\A$ a $\B$ jsou matice sestavené po blocích takto:
$$
  \A = \pmatrix {\A_{1,1}& \A_{1,2}& \ldots& \A_{1,n} \cr 
                 \A_{2,1}& \A_{2,2}& \ldots& \A_{2,n} \cr
                        &         & \ldots&        \cr
                 \A_{m,1}& \A_{m,2}& \ldots& \A_{m,n}}, \quad
  \B = \pmatrix {\B_{1,1}& \B_{1,2}& \ldots& \B_{1,p} \cr 
                 \B_{2,1}& \B_{2,2}& \ldots& \B_{2,p} \cr
                        &         & \ldots&        \cr
                 \B_{n,1}& \B_{n,2}& \ldots& \B_{n,p}}
$$
Nech» uvedené bloky jsou matice takového typu, ¾e násobení matic $\A_{i,j}\cdot\B_{j,k}$
je definováno pro v¹echna $i\in\{1,\ldots,m\}$, $j\in\{1,\ldots,n\}$, 
$k\in\{1,\ldots,p\}$. Tedy poèet sloupcù bloku $\A_{i,j}$ je roven poètu
øádkù bloku~$\B_{j,k}$. Pak
$$
  \C= \A\cdot \B = \pmatrix {\C_{1,1}& \C_{1,2}& \ldots& \C_{1,p} \cr 
                 \C_{2,1}& \C_{2,2}& \ldots& \C_{2,p} \cr
                        &         & \ldots&        \cr
                 \C_{m,1}& \C_{m,2}& \ldots& \C_{m,p}}, \quad
\hbox{kde}\quad \C_{i,k} = \sum_{j=1}^n \A_{i,j}\cdot \B_{j,k}.
$$

\dukaz
Je zøejmé, ¾e $\C_{i,k}$ je blok typu $(u_i,v_k)$, kde $u_i$ je poèet
øádkù bloku $\A_{i,1}$ a $v_k$ je poèet sloupcù bloku $\B_{1,k}$ a
tento typ mají v¹echny souèiny $\A_{i,j}\cdot \B_{j,k}$ pro v¹echna
$j\in\{1,\ldots,n\}$, tak¾e souèet souèinù ve vzorci pro $\C_{i,k}$ je definován.
Vìtu lze dále dokázat analogicky, jako vìtu pøedchozí. Ka¾dý øádek matice
$\A$ a sloupec matice $\B$ se nyní rozdìlí na $n$~úsekù.

\poznamka
%%%%%%%%%
Pov¹imneme si, ¾e pokud volíme ve vìtì\cite[soucinbloku] za bloky
\uv{matice s jediným èíslem} (matice z $\R^{1,1})$, pak vìta
rozepisuje definici maticového násobení. Zajímavé jsou pro nás
je¹tì pøípady, kdy matice $\A$ je rozepsána do øádkových blokù nebo matice
$\B$ je rozepsána do sloupcových blokù. To je formulováno v
následujících vìtì.

\veta [soucinsloupcu]
%%%%%
Nech» $\A\in\R^{m,n}$, $\B\in\R^{n,p}$. Nech» matice $\B$ je zapsána
po sloupcích: $\B=(\vec b_1\ \vec b_2\ \ldots\ \vec b_p)$, 
tj. $\vec b_k$ jsou sloupcové vektory z~$\R^{n,1}$. Pak
$$
  \A\cdot\B = (\A\cdot\vec b_1\ \ \ \A\cdot\vec b_2\ \ \ldots \ \ \A\cdot\vec b_p)
$$

\goodbreak
\dukaz
%%%%%%
Staèí v pøedchozí vìtì\cite[soucinbloku] volit matici $\A$ obsahující jediný blok a
matici $\B$ obsahující jako bloky své sloupce. V terminologii
pøedchozí vìty tedy $m=n=1$ a $p=$~poèet sloupcù matice $\B$.

\poznamka
%%%%%%%%%
Vìta\cite[soucinsloupcu] se dá lapidárnì formulovat takto:
sloupce maticového souèinu $\A\cdot\B$ obsahují souèiny celé 
matice $\A$ s odpovídajícími sloupci matice $\B$.
Analogicky lze dokázat, ¾e øádky maticového souèinu $\A\cdot\B$ 
obsahují souèiny odpovídajících øádkù matice $\A$ s celou maticí $\B$.
Tuto vìtu si pøesnì zforuluje ji¾ laskavý ètenáø sám.

\poznamka
%%%%%%%%%
Rozdìlme v maticovém souèinu $\A\cdot\B$ matici $\A$ na øádky a
souèasnì matici $\B$ na sloupce. Pak vìta\cite[soucinbloku] nám øíká,
¾e ka¾dý prvek souèinu $c_{i,k}$ se poèítá jako maticový souèin
$i$-tého øádku matice $\A$ s~$k$-tým sloupcem matice $\B$.
Ka¾dý takový souèin je roven sumì ve vzorci\cite(cik).
Tak¾e tímto pohledem nezískáme nic jiného, ne¾ pøímo definici maticového 
násobení\cite[soucinAB]. 

Jiný pohled na maticový souèin dostaneme tím, ¾e matici $\A$ rozdìlíme na sloupce 
a matici $\B$ na øádky. Pak je $\A\cdot\B$ podle
vìty\cite[soucinbloku] souètem v¹ech souèinù $j$-tého
sloupce matice $\A$ s $j$-tým øádkem matice~$\B$ pro $j\in\{1,2,\ldots,n\}$. 
Ka¾dý takový souèin je tentokrát matice typu $(m,p)$.
Maticový souèin \uv{sloupec krát øádek} toti¾ vytvoøí matici typu
$(m,p)$, kde $m$ je poèet prvkù ve sloupci a $p$ je poèet prvkù v~øádku.
Na druhé stranì maticový souèin \uv{øádek krát sloupec} vytvoøí matici
typu $(1,1)$, tedy matici s~jediným prvkem.

\priklad
%%%%%%%%
Jiný pohled na maticový souèin z pøedchozí poznámky ilustrujeme na
pøíkladu\cite[prikladnasobeni]. Matice vynásobíme tak, ¾e první
matici rozdìlíme na sloupce a druhou na øádky. Dostáváme
$$
\displaylines{
  \pmatrix{1&2&3&4\cr5&6&7&8\cr0&2&1&0} \cdot
  \pmatrix{1&2\cr3&4\cr5&6\cr2&7} =
  \pmatrix{1\cr5\cr0} \cdot
  \pmatrix{1&2} +
  \pmatrix{2\cr6\cr2} \cdot
  \pmatrix{3&4} +
  \pmatrix{3\cr7\cr1} \cdot
  \pmatrix{5&6} +
  \pmatrix{4\cr8\cr0} \cdot
  \pmatrix{2&7} = \cr
  {} =
  \pmatrix{1&2\cr5&10\cr0&0} +
  \pmatrix{6&8\cr18&24\cr6&8} +
  \pmatrix{15&18\cr35&42\cr5&6} +
  \pmatrix{8&28\cr16&56\cr0&0} =
  \pmatrix{30 & 56 \cr 74 & 132 \cr 11 & 14}.
}
$$

\okraj Strassenùv algoritmus | Strassenùv algoritmus

\poznamka
%%%%%%%%%
Máme za úkol vynásobit dvì ètvercové matice z $\R^{n,n}$. Jak je to
výpoèetnì nároèné? Pøedpokládejme, ¾e násobení èísel je podstatnì 
\uv{dra¾¹í} operace ne¾ sèítání, tak¾e se zamìøíme na poèet potøebných
násobení dvou èísel a poèet sèítání budeme zanedbávat.

Pokud budeme postupovat pøi násobení èvercových matic podle
definice\cite[soucinAB], budeme potøebovat pro výpoèet ka¾dého prvku výsledku
$n$ operací a tìch prvkù je $n^2$, tak¾e dohoromady potøebujeme $n^3$
operací násobení. Lze na tom nìkde u¹etøit? V následujícím textu
uká¾eme, ¾e ano, pokud pou¾ijeme rekurzivní blokový pøístup k násobení
matic. Uvedeme nejprve klasickou rekurzi pro násobení a následnì 
tzv.~{\em Strassenùv algoritmus}, který roz¹iøuje klasickou rekurzi a
u¹etøí operace.
\inl[Strassenùv algoritmus, algoritmus: Strassenùv]

\algoritmus (klasická rekurze) [klasrek]
%%%%%%%%%%%
Pøedpokládejme, ¾e násobíme ètvercové matice $\A$ a $\B$ z $\R^n$ a ¾e navíc
existuje pøirozené $m$ tak, ¾e $n=2^m$. Jinými slovy, ka¾dou matici
lze rozkájet na ètyøi ètvercové bloky stejnì velké a tyto bloky lze
znovu takto rozkrájet a¾ na úroveò matic typu $(1,1)$.
Jak se zachovat, pokud tento pøedpoklad není splnìn, je zmínìno 
v~poznámce\cite[rekurzeruznych].

Proveïme vý¹e zmínìné rozdìlení matic $\A$ a $\B$ do blokù a pou¾ijme 
vìtu\cite[ctyribloky]:
$$
  \pmatrix{\A_1 &\A_2\cr \A_3&\A_4} \cdot
  \pmatrix{\B_1 &\B_2\cr \B_3&\B_4} =
  \pmatrix{\A_1\cdot\B_1+\A_2\cdot\B_3 & \A_1\cdot\B_2+\A_2\cdot\B_4\cr
           \A_3\cdot\B_1+\A_4\cdot\B_3 & \A_3\cdot\B_2+\A_4\cdot\B_4}
$$
Vidíme, ¾e algorimtus na násobení matic rekurzivnì volá 
sebe sama celkem osmkrát, ov¹em bloky, které se nyní násobí, jsou 
z~$\R^{n/2,n/2}$. Rekurzi mù¾eme nechat pokraèovat a¾ na úrovìò blokù
z~$\R^{1,1}$ a teprve v tom pøípadì násobíme odpovídající èísla mezi sebou.
 
\poznamka
%%%%%%%%%
Kolik potøebuje klasická rekurze operací násobení èísel? Je-li $F(n)$ poèet
potøebných operací pro výpoèet souèinu matic z~$\R^{n,n}$, kde $n=2^m$, pak platí:
$$
\eqalign{
  F(n) &= 8F(n/2) = 8(8F(n/4)) = 8(8(8F(n/2^3))) = \cdots = 
  8^m F(n/2^m) = 8^mF(1) =\cr &= 8^m = (2^3)^m =
  2^{3m} = (2^m)^3 = n^3.
}
$$
Potøebujeme tedy stejný poèet operací, jako kdybychom pou¾ili definici.

\algoritmus (Strassen) [strassen]
%%%%%%%%%%%
Nech» dvì ètvercové matice $\A$ a $\B$ z $\R^{n,n}$ splòují stejné
pøedpoklady, jako v pøedchozím algoritmu, tj. $n=2^m$ a rozdìlme
matice $\A$, $\B$ do blokù, jako pøed chvílí.
Vypoèteme pomocné matice:
\inl[Strassenùv algoritmus, algoritmus: Strassenùv]
$$
\eqalign{
  &\X_1 = (\A_1 + \A_4)\cdot(\B_1+\B_4), \quad
  \X_2 = (\A_3 + \A_4)\cdot\B_1, \quad
  \X_3 = \A_1\cdot(\B_2-\B_4), \quad
  \X_4 = \A_4\cdot(\B_3-\B_1), \cr
  &\X_5 = (\A_1+\A_2)\cdot\B_4, \quad
  \X_6 = (\A_3-\A_1)\cdot(\B_1+\B_2), \quad
  \X_7 = (\A_2-\A_4)\cdot(\B_3+\B_4)
}
$$
Ètenáø si jako cvièení ovìøí, ¾e platí:
$$
  \pmatrix{\A_1 &\A_2\cr \A_3&\A_4} \cdot
  \pmatrix{\B_1 &\B_2\cr \B_3&\B_4} =
  \pmatrix{\X_1+\X_4-\X_5+\X_7\ & \X_3+\X_5\cr \X_2+\X_4& \X_1-\X_2+\X_3+\X_6}.
$$
Pov¹imneme si, ¾e nyní jsme potøebovali pouze sedm maticových
násobení, tak¾e voláme rekurzivnì sebe sama jen sedmkrát.

\poznamka
%%%%%%%%%
Kolik potøebujeme ve Strassenovì algoritmu operací násobení jednotlivých
èísel? Pøedpokládejme matice z $\R^{n,n}$ a $n=2^m$, neboli $m=\log_2 n$.
Nech» $F(n)$ je poèet operací násobení pou¾itých ve Strassenovì algoritmu, který
sestavuje souèin matic z~$\R^{n,n}$. Pak
$$
  \eqalign{
  F(n) &= 7F(n/2) = 7(7F(n/4)) = 7(7(7F(n/2^3))) = \cdots = 
  7^m F(n/2^m) = 7^mF(1) =\cr &= 7^m = (2^{\log_2 7})^{\log_2 n} =
  2^{\log_2 7\,\cdot\,\log_2 n} = n^{\log_2 7} \doteq n^{2{,}807}.
}
$$
Èíslo $n^{2{,}807}$ je jistì men¹í ne¾ $n^3$, tak¾e Strassenùv algoritmus
¹etøí poèet násobení. Pro velká $n$ je úspora natolik výrazná, ¾e
pøestane být nevýhodou, ¾e potøebujeme ponìkud více sèítání. 
V~knihovnách pro násobení velkých matic se proto typicky pou¾ívá 
Strassenùv algoritmus.

\poznamka
%%%%%%%%%
V~èlánku\bcite[cw] Don Coppersmith a Shmuel Winograd uvádìjí
algoritmus, který má je¹tì lep¹í slo¾itost: $n^{2{,}376}$, ov¹em
pøidává tolik dodateèných re¾ijních operací a pamì»ových nárokù, ¾e by byl
u¾iteèný jen pro tak rozsáhlé matice, které se v souèasné dobì
nevejdou do poèítaèe. Pou¾ívá se tedy jen jako teoretická dosud známá
nejlep¹í mez slo¾itosti pro maticové násobení. Dosud pøitom není
dokázáno, jaká je skuteèná nejlep¹í mez, tj. zda by bylo mo¾né toto
èíslo je¹tì vylep¹it.

\poznamka [rekurzeruznych]
%%%%%%%%%
Pokud násobíme matice, které nejsou èvercové nebo nejsou typu
$(2^m,2^m)$, pak je potøeba roz¹íøit matice o nulové øádky nebo
sloupce nebo obojí tak, aby roz¹íøené matice byly typu $(2^m,2^m)$.
Pak je mo¾né pou¾ít vý¹e uvedené rekurzivní algoritmy. V nich mù¾eme
hlídat rozsah indexù jednotlivých blokù a pokud je celý blok v
prostoru, kde jsou jen nuly, nemusí algoritmus souèin poèítat a rovnou
vrátí jako výsledek nulový blok. Je to pouze technická vychytávka vý¹e
popsaných algoritmù, která neovlivní teoretické výsledky, o kterých
jsme se zmínili døíve. Ve výsledku je pak potøeba zpìtnì odebrat
roz¹íøující øádky a sloupce (které stejnì vyjdou nulové).



\okraj Komutující matice | Komutujici matice

\definice
%%%%%%%%%
Nech» je dána ètvercová matice $\A\in\R^{n,n}$. Pokud matice $\B$ splòuje
rovnost $\A\cdot\B=\B\cdot\A$, øíkáme, ¾e matice $\B$ {\em komutuje} 
s~maticí $\A$.

\priklad
%%%%%%%%
Zabývejme se vlastnostmi matic $\B$, které komutují s pevnì danou
ètvercovou maticí $\A\in\R^{n,n}$. Napøíklad matice $\A$ komutuje sama
se sebou, nebo» souèin $\A\cdot\A$ je pro ètvercovou matici definován
a prohození èinitelù vùbec nepoznáme. 

Matice $\B$ komutující s $\A$ musí mít stejný poèet øádkù jako matice $\A$
sloupcù (aby bylo definováno $\A\cdot\B$) a také musí mít stejný poèet
sloupcù jako matice $\A$ øádkù (aby bylo definováno $\B\cdot\A$). To
prakticky znamená, ¾e matice $\B$ musí být také ètvercová, typu $(n,n)$.

Z pøíkladu\cite[nekomutuje] víme, ¾e ne v¹echny matice z $\R^{n,n}$
komutují s~danou ètvercovou maticí. Tak¾e mno¾ina ètvercových matic
komutujících s danou maticí $\A$ bude tvoøit pomno¾inu v¹ech
ètvercových matic. Uká¾eme, ¾e tato podmno¾ina je lineárním
podprostorem v¹ech ètvercových matic. 

Podle definice\cite[dlpp] staèí ukázat, ¾e pokud jsou $\B$ a $\C$
komutující matice s~maticí $\A$ a $\alpha\in\R$, pak té¾ $\B+\C$ a
$\alpha\,\B$ jsou komutující matice. Pøedpokládejme tedy, ¾e platí
$\A\cdot\B=\B\cdot\A$, $\A\cdot\C=\C\cdot\A$. V~následujícím výpoètu
pou¾ijeme vìty\cite[soucinAB-vlastnosti], vzorce (2) a¾ (4) a na¹eho
pøedpokladu. 
$$\eqalign{
  &\A\cdot(\B+\C) = \A\cdot\B + \A\cdot\C = \B\cdot\A + \C\cdot\A =
  (\B+\C)\cdot\A, \cr
  &\A\cdot(\alpha\,\B) = \alpha\,(\A\cdot\B) = \alpha\,(\B\cdot\A) =
  (\alpha\,\B)\cdot\A. \cr}
$$
\par\inl[matice: komutující, komutující: matice]

\priklad [basekomut]
%%%%%%%%
Najdeme bázi a dimenzi lineárního podprostoru $M$ v¹ech matic komutujících
s~maticí
$$
  \A = \pmatrix{1&2\cr3&4}.
$$
Podle pøedchozího pøíkladu musejí být matice komutující s~maticí $\A$
rovnì¾ typu $(2,2)$. Pøedpokládejme, ¾e matice $\B$ lze zapsat ve
tvaru
$$
  \B = \pmatrix{a&b\cr c&d}.
$$
Jednotlivé souèiny pak vypadají následovnì
$$
   \pmatrix{a&b\cr c&d} \cdot \pmatrix{1&2\cr3&4} =
   \pmatrix{a+3b&2a+4b\cr c+3d&2c+4d}, \quad
   \pmatrix{1&2\cr3&4} \cdot \pmatrix{a&b\cr c&d} =
   \pmatrix{a+2c&b+2d\cr3a+4c&3b+4d}.
$$
Tyto souèiny se mají rovnat. Podle poznámky\cite[rovnostmatic] se dvì
matice rovnají, pokud se vzájemnì rovnají v¹echny jejich odpovídající
prvky. To nás vede ke ètyøem rovnicím o~ètyøech neznámých, které
upravíme Gaussovou elmininaèní metodou.
$$
  \let\thickmuskip=\thinmuskip \let\medmuskip=\thinmuskip
  \soustava{  & 3b &-2c &    &= 0\cr 
            2a&+3b &    &-2d &= 0\cr
           -3a&    &-3c &+3d &= 0\cr
              &-3b &+2c &    &= 0} 
  \quad
  \pmatrix{\hfill0&\hfill3&-2&\hfill0\cr \hfill2&\hfill3&\hfill0&-2\cr 
          -1&\hfill0&-1&\hfill1\cr\hfill0&-3&\hfill2&\hfill0} \sim
  \pmatrix{2&\hphantom{-}3&\hfill0&-2\cr 0&\hfill3&-2&\hfill0} 
  \quad
  \soustava{2a+3b&   &-2d&=0\cr
               3b&-2c&   &=0}
$$ 
Promìnné $c$ a $d$ mù¾eme volit libovolnì. Uvedené dvì rovnice nám
umo¾òují dopoèítat promìnné $b$ a $a$ takto: $b=2/3\,c$, $a=d-c$.
V¹echny matice, které komutují s~maticí $\A$ jsou tedy urèeny dvìma
parametry:
$$
  \B=\pmatrix{d-c&{2\over3}\,c\cr c& d} = 
   c \pmatrix{-1&{2\over3}\cr \hfill1&0} + d \pmatrix{1&0\cr0&1},
  \quad c\in\R,\quad d\in\R.
$$  
Lineární prostor v¹ech komutujících matic $M$ se nám podaøilo vyjádøit
jako mno¾inu v¹ech lineárních kombinací dvou konstantních matic. Tuto skuteènost
zapí¹eme pomocí lineárního obalu takto:
$$
  M =
   \left< \pmatrix{-1&{2\over3}\cr \hfill1&0}, \pmatrix{1&0\cr0&1} \right> =
   \left< \pmatrix{-3& 2\cr \hfill3&0}, \pmatrix{1&0\cr0&1} \right>.
$$
Poslední úpravu (pronásobení první matice tøemi) jsme nemuseli 
dìlat, pokud se spokojíme se zlomkem ve výsledku. V~modelových 
pøíkladech se dosti èasto sna¾íme dostat výsledek vyjádøitelný 
v~malých celých èíslech. Není to samozøejmì na¹í
povinností, pouze pak výsledek lépe vypadá a nás více potì¹í.
\inl[pøíklad: modelový,  modelový pøíklad]

Proto¾e poslední dvì uvedené matice jsou lineárnì nezávislé 
(to snadno zjistíme) a jejich lineární obal je celý podprostor $M$, 
máme výsledek:
$$
  \hbox{Báze } M = 
  \left\{\pmatrix{-3& 2\cr \hfill3&0}, \pmatrix{1&0\cr0&1} \right\}, 
  \quad \hbox{tj. } \dim M = 2.
$$

\okraj Matice\hb vektorù | Matice vektoru

\poznamka [matvektoru]
%%%%%%%%%
V~definici\cite[defmatice] jsme zavedli matice, její¾ prvky jsou
reálná nebo komplexní èísla. Obèas se mù¾eme setkat s~maticemi, 
její¾ prvky jsou vektory, tedy prvky libovolného lineárního prostoru.
Proto¾e lze prvky lineárního prostoru podle
definice\cite[dlp] násobit reálným èíslem, lze pøirozenì definovat
té¾ maticové násobení $\A\cdot\B$, kde $\A=(a_{i,j})\in\R^{m,n}$ je matice 
reálných èísel a $\B=(\vec b_{j,k})$ je matice
typu $(n,p)$ obsahující vektory lineárního prostoru~$L$,
tedy $\B\in L^{n,p}$.
Výsledná matice $\A\cdot\B$ je z~mno¾iny~$L^{m,p}$ 
a pro její prvky  $\vec c_{i,k}$ platí:
$$
  \vec c_{i,k} = a_{i,1}\,\vec b_{1,k} + a_{i,2}\,\vec b_{2,k} +
      \cdots + a_{i,n}\,\vec b_{n,k} =
      \sum_{j=1}^n a_{i,j}\,\vec b_{j,k}.
$$
\par\inl[matice: vektorù]

\priklad
%%%%%%%%
Nech» $\A\in\R^{1,n}$ je matice reálných èísel a $\B\in L^{n,1}$
Pak souèin $\A\cdot\B$ je
lineární kombinace vektorù z~$\B$, pøièem¾ prvky z~$\A$ jsou
koeficienty této lineární kombinace. Názornì:
$$
  \pmatrix{a_1,&a_2,&\cdots,&a_n} \cdot
  \pmatrix{\vec b_1\cr\vec b_2\cr\vdots\cr\vec b_n} = \lkvecc a.b_n.
$$

\poznamka* [ABlkB]
%%%%%%%%%
Pøedchozí pøíklad nám poskytuje dal¹í pohled na maticové násobení.
Pøedpokládejme matice $\A\in\R^{m,n}$, $\B\in\R^{n,p}$,
$\C=\A\cdot\B\in\R^{m,p}$. Na matici $\B$ se dívejme jako na
jednosloupcovou matici jejích øádkù. První øádek výsledné matice $\C$
obsahuje lineární kombinaci øádkù matice $\B$, pøièem¾ koeficienty
této lineární kombince jsou v prvním øádku matice $\A$. Také ka¾dý
$k$-tý øádek matice $\C$ obsahuje lineární kombinaci v¹ech øádkù
matice $\B$ a její koeficienty jsou v $k$-tém øádku matice $\A$.


\okraj Hodnost souèinu matic | Hodnost soucinu matic

\veta* [hodA.B]
%%%%%
Nech» $\A\in\R^{m,n}$, $\B\in\R^{n,p}$. Pak $\hod(\A\cdot\B)\le\hod\A$
a také $\hod(\A\cdot\B)\le\hod\B$. Jinými slovy: hodnost maticového
souèinu není vìt¹í ne¾ hodnosti jednotlivých èinitelù.

\dukaz
Podle poznámky\cite[ABlkB] víme, ¾e øádky matice $\A\B$ jsou
lineárními kombinacemi øádkù matice $\B$. Tak¾e 
$\hbox{r:}\,\A\B\subseteq\lobr<\B>$, tj.
$\lobr<\A\B>\subseteq\lob<{\lobr<\B>}>=\lobr<\B>$.
Podle vìty\cite[dimpodprostoru] tedy je
$\dim\lobr<\A\B>\le\dim\lobr<\B>$, neboli $\hod(\A\cdot\B)\le\hod\B$. 

Proto¾e platí vìty\cite[hA=hAT] a\cite[soucinAB-vlastnosti], mù¾eme psát
$\hod(\A\cdot\B) = \hod(\A\cdot\B)^T = \hod(\B^T\cdot\A^T)$
a z právì dokázané nerovnosti plyne, ¾e
$\hod(\B^T\cdot\A^T)\le\hod\A^T=\hod\A$.
Dokázali jsme $\hod(\A\cdot\B)\le\hod\A$.

%V~tuto chvíli máme prostøedky pro slíbený dùkaz vìty\cite[stejnebase].
%Vìtu na tomto místì zopakujeme a doká¾eme.
%
%\veta [stejnebase2]
%%%%%%
%Nech» $B_1$ a $B_2$ jsou dvì báze stejného lineárního prostoru $L$.
%Pak jsou buï obì nekoneèné, nebo mají obì stejný poèet prvkù.
%
%\dukaz
%%%%%%%
%Nech» jsou nejprve obì báze koneèné, $B_1=\{\vecc b_n\}$, 
%$B_2=\{\vecc c_m\}$. Rovnost poètu prvkù budeme dokazovat sporem, nech» tedy
%$m>n$. Ka¾dý z~vektorù $\vecc c_m$ je prvkem $L=\lobr<B_1>$, tak¾e ka¾dý
%z~tìchto vektorù se dá vyjádøit jako lineární kombinace vektorù
%$\vecc b_n$. Tuto skuteènost mù¾eme zapsat souhrnnì pomocí maticového násobení:
%$$
%  \pmatrix{\vec c_1\cr\vec c_2\cr\vdots\cr\vec c_m} =
%  \pmatrix{a_{1,1}, & a_{1,2}, &\ldots, & a_{1,n} \cr
%           a_{2,1}, & a_{2,2}, &\ldots, & a_{2,n} \cr
%                    &          &\vdots  &  \cr
%           a_{m,1}, & a_{m,2}, &\ldots, & a_{m,n} \cr} \cdot
%  \pmatrix{\vec b_1\cr\vec b_2\cr\vdots\cr\vec b_n}
%  \rce(c=Ab)
%$$
%Uvedená matice koeficientù lineárních kombinací je typu $(m,n)$. Podle
%pøíkladu\cite[lzRn] jsou øádky této matice lineárnì závislé. Podle 
%vìty\cite[xr] musí existovat øádek s~indexem $r\in\{1,2,\ldots,m\}$
%takový, ¾e tento øádek je lineární kombinací ostatních. Ze 
%vzorce\cite(c=Ab) pak okam¾itì plyne, ¾e vektor $\vec c_r$ je stejnou
%lineární kominací ostatních vektorù z~mno¾iny $B_2$. To je ale spor 
%s~pøedpokladem, ¾e $B_2$ je lineárnì nezávislá mno¾ina.
%
%Dále pøedpokládejme, ¾e $B_1$ je koneèná a $B_2$ nekoneèná. Podle
%poznámky\cite[lnnekmnozin] jsou v¹echny koneèné podmno¾iny
%$K\subseteq B_2$ lineárnì nezávislé. Volme $K$ takovou, aby mìla více
%prvkù, ne¾ mno¾ina $B_1$. Stejnì, jako v~pøedchozím pøípadì lze
%ukázat, ¾e vektor $\vec c_r\in K$ je lineární kombinací ostatních
%vektorù z~$K$, co¾ je spor s~pøedpokladem, ¾e $K$ je lineárnì
%nezávislá mno¾ina. Musí tedy být buï obì báze $B_1$ a $B_2$ nekoneèné
%nebo obì koneèné a se stejným poèem prvkù.
%
%\poznamka
%%%%%%%%%%
%Hloubavého ètenáøe mù¾e napadnout, proè jsme v~dùkazu vìty
%argumentovali pøíkladem\cite[lzRn] a nepou¾ili jsme pøímo tøeba
%vìtu\cite[hodminimum]. Je to tím, ¾e pojem hodnost se opírá o~platnost
%vìty, kterou dokazujeme. Tento pojem tedy nemù¾eme v~dùkazu 
%vìty pou¾ít, proto¾e by se dùkaz vìty opíral o~platnost té¾e vìty.
%Tím by se nám na¹e teorie zhroutila jako domeèek z~karet.

\okraj Jednotková matice | Jednotkova matice

\definice [defE]
%%%%%%%%%
Ètvercovou matici $\E\in\R^{n,n}$ nazýváme {\em jednotkovou maticí},
pokud pro její prvky~$e_{i,j}$ platí: $e_{i,j}=0$ pro 
$i\not=j$ a $e_{i,j}=1$ pro $i=j$. Názornì:
$$
  \E = 
  \pmatrix{1&0&0&\cdots&0\cr0&1&0&\cdots&0\cr&&&\cdots\cr0&0&0&\cdots&1\cr}.
$$
\par\inl[matice: jednotková, jednotková: matice]

\poznamka [poznE]
%%%%%%%%%
Z~definice maticového násobení okam¾itì plyne, ¾e pro ka¾dou ètvercovou
matici $\A\in\R^{n,n}$ je $\E\cdot\A = \A\cdot\E = \A$. Jednotková
matice má tedy stejnou vlastnost vzhledem k~násobení, jako jednièka
pøi násobení reálných èísel. Pro reálná èísla taky platí, ¾e 
$1\cdot a = a\cdot 1 = a$.

V¹imneme si také, ¾e jednotková matice je komutující s~ka¾dou
ètvercovou maticí.

\poznamka
%%%%%%%%%
Vra»me se k~pøíkladu\cite[basekomut]. Tam jsme na¹li bázi, ve které je
jednotková matice. To nás nepøekvapí, proto¾e jednotková matice je
komutující s~ka¾dou maticí. Dále s~maticí $\A$ komutuje
stejná matice $\A$. Pokud víme, ¾e $\dim M=2$ a matice $\A$ a $\E$
jsou lineárnì nezávislé, mù¾eme rovnou prohlásit, ¾e hledaná báze
lineárního podprostoru $M$ je $\{\A,\E\}$. Zdálo by se, ¾e jsme
výpoèty v~pøíkladu\cite[basekomut] dìlali zbyteènì. Není to tak docela
pravda, proto¾e dopøedu nevíme, zda dimenze hledaného prostoru bude
rovna dvìma.

\okraj Inverzní\hb matice | Inversni matice

\poznamka
%%%%%%%%%
V~definici\cite[defE] jsme zavedli jednotkovou matici s~podobnými
vlastnostmi, jako má reálné èíslo~1. Vra»me se znovu ke srovnání
s~reálnými èísly. Pro ka¾dé nenulové reálné èíslo $a$ existuje reálné
èíslo $b$ takové, ¾e $ab=1$. Takové reálné èíslo obvykle nazýváme
pøevrácenou hodnotou èísla $a$ a oznaèujeme $1/a$ nebo té¾ $a^{-1}$.
Analogicky definujeme \uv{pøevrácenou hodnotu matice}, tzv. inverzní
matici. 

\definice* [inverseA]
%%%%%%%%%
Nech» $\A\in\R^{n,n}$ je ètvercová matice a $\E\in\R^{n,n}$ je jednotková
matice. Matici $\B\in\R^{n,n}$, která
splòuje vlastnost 
$
  \A\cdot\B = \E = \B\cdot\A
$ 
nazýváme  {\em inverzní maticí} k~matici $\A$. Inverzní matici 
k~matici $\A$ oznaèujeme symbolem $\A^{-1}$.
\inl[matice: inverzní, inverzní: matice, 1A1]

\veta [jedinainv]
%%%%%
Pokud k~matici $\A$ existuje inverzní matice, pak je tato inverzní
matice jednoznaènì urèena.
\inl[matice: inverzní, inverzní: matice]

\dukaz
%%%%%%
Nech» má ètvercová matice $\A$ dvì inverzní matice $\B$ a $\C$.
Uká¾eme, ¾e pak $\B=\C$. Platí:
$$
  \B=\B\cdot\E = \B\cdot(\A\cdot\C) = (\B\cdot\A)\cdot\C = \E\cdot\C = \C.
  \rce(B=C)
$$
Zde jsme po øadì vyu¾ili: poznámku\cite[poznE], vlastnost, ¾e $\C$ je
inverzní matice k~$\A$, vlastnost~(1) z~vìty\cite[soucinAB-vlastnosti],
vlastnost, ¾e $\B$ je inverzní matice k~$\A$, a koneènì znovu poznámku\cite[poznE].

%\veta [existinverse]
%%%%%
%Ke ètvercové matici z $\R^{n,n}$ existuje inverzní matice právì tehdy,
%kdy¾ $\hod(\A)=n$.
%\inl[hodnost: matice, matice: inverzní, inverzní: matice]
%
%\dukaz
%%%%%%%
%Dùkaz této vìty pøesuneme a¾ do pøí¹tí kapitoly o~determinantech.
%Vìta ukazuje, ¾e matice, které mají hodnost rovnu poètu øádkù
%(tj. podle vìty\cite[hod=maxradku] jsou v¹echny øádky lineárnì
%nezávislé) mají inverzní matici. Pokud jsou øádky lineárnì závislé,
%inverzní matice neexistuje. Mù¾eme tedy øíci, ¾e pokud jsou øádky ve
%ètvercové matici lineárnì závislé, je matice z~hlediska maticového
%násobení \uv{skoro nulová} v~tom smyslu, ¾e k~ní neexistuje inverzní
%matice (podobnì jako k~reálnému èíslu nula neexistuje pøevrácená
%hodnota). To nás inspiruje k~následující definici.

\okraj Regulární, singulární matice | Regularni, singularni matice

\definice* [dregul]
%%%%%%%%%
Ètvercová matice $\A\in\R^{n,n}$ se nazývá {\em regulární}, pokud 
pro $\A$ existuje inverzní matice.
Ètvercová matice $\A\in\R^{n,n}$ se nazývá {\em singulární}, 
pokud není regulární.
\inl[matice: singulární, singulární: matice]
\inl[matice: regulární, regulární: matice]

\veta [hodreg]
%%%%%
Matice $\A$ je regulární právì kdy¾ $\hod\A=n$, kde $n$ je poèet øádkù
matice~$\A$.

\dukaz
Nech» $\A$ je regulární, tak¾e existuje $\A^{-1}$ tak, ¾e $\A\cdot\A^{-1}=\E$.
Podle vìty\cite[hodA.B] se hodnost matice souèinem nezvìt¹í. Tedy 
$\hod\E=\hod(\A\cdot\A^{-1})\le\hod\A$. Zjevnì je $\hod\E=n$, 
tak¾e musí $\hod\A=n$.

Nech» $\hod\A=n$. Tak¾e øádky matice $\A$ jsou lineárnì nezávislé a
tvoøí bázi $\R^n$. Oznaème ji $(B)$. Souøadnice $i$-tého øádku matice
$\E$ vzhledem k $(B)$ napi¹me do $i$-tého øádku matice $\B$. Zøejmì je
$\B\cdot\A=\E$ (viz poznamku\cite[ABlkB]). 
Proto¾e $\hod\A=\hod\A^T$, jsou i sloupce matice $\A$
lineárnì nezávislé a tvoøí bázi $(B')$ lineárního prostoru $\R^n$.
Souøadnice $i$-tého sloupce matice $\E$ vzhledem k $(B')$ napi¹me do
$i$-tého sloupce matice $\C$. Zøejmì je $\C^T\cdot\A^T=\E$, neboli
$\A\cdot\C=\E^T=\E$. Z rovností $\B\cdot\A=\E$ a $\A\cdot\C=\E$ plyne
$\B=\C$. Proè? Staèí zopakovat výpoèet\cite(B=C), který jsme provedli
v dùkazu vìty\cite[jedinainv].
Podle definice je $\B$ inverzní matice k matici~$\A$. 
Matice $\A$ je tedy regulární.

\veta [stacipul]
%%%%%
Nech» $\A\in\R^{n,n}$. Z existence matice $\B$ takové, ¾e $\B\cdot\A=\E$,
plyne, ¾e $\A$ je regulární a $\B$ je její inverzní matice.
Z existence matice $\C$ takové, ¾e $\A\cdot\C=\E$, plyne, ¾e $\A$ je
regulární a $\C$ je její inverzní matice.

\dukaz
Staèí trasovat dùkaz pøedchozí vìty.
Z existence $\B$ a z vìty\cite[hodA.B] plyne, ¾e 
$n=\hod(\B\cdot\A)\le\hod\A$, tak¾e $\hod\A=n$. Nyní sestavíme
matici $\C$ jako v pøedchozím dùkazu a uká¾eme, ¾e $\A\cdot\C=\E$
a navíc $\B=\C$, tak¾e je to inverzní matice k matici $\A$.
Vyjdeme-li z existence matice $\C$, postupujeme obdobnì.

\poznamka
%%%%%%%%%
Pøedchozí vìta øíká, ¾e v definici\cite[inverseA] je jedna z rovností
$\A\cdot\B=\E$, \ $\B\cdot\A=\E$ \uv{nadbyteèná}, proto¾e z jedné
rovnice plyne druhá a z druhé plyne první.


\veta [regulkratregul]
%%%%%
Nech» $\A\in\R^{n,n}$ a $\B\in\R^{n,n}$ jsou regulární ètvercové matice. Pak
matice $\A\cdot\B$ je rovnì¾ regulární matice typu $(n,n)$.

\dukaz
%%%%%%
Matice $\A\cdot\B$ je ètvercová typu $(n,n)$. To plyne pøímo z~definice
maticového souèinu. Staèí tedy dokázat, ¾e je regulární. Podle 
definice\cite[dregul] je matice regulární právì tehdy, kdy¾ k~ní
existuje inverzní matice. Podle pøedpokladu k~matici $\A$ existuje 
inverzní matice $\A^{-1}$ a k~matici $\B$ existuje inverzní matice
$\B^{-1}$. Staèí ukázat, ¾e existuje inverzní matice k~matici 
$\A\cdot\B$. Hledaná inverzní matice je tvaru $\B^{-1}\cdot\A^{-1}$,
proto¾e:
$$
  (\B^{-1}\cdot\A^{-1})\cdot(\A\cdot\B) =
  \B^{-1}\cdot(\A^{-1}\cdot\A)\cdot\B = \B^{-1}\cdot\E\cdot\B =
  \B^{-1}\cdot\B = \E.
$$

\okraj Výpoèet inverzní mati\-ce eliminací | Vypocet inversni matice eliminaci

\priklad* [metodainverse]
%%%%%%%%
Na jednoduchém pøíkladu uká¾eme obvyklý postup hledání
inverzní matice k~dané matici~$\A$. Teprve pak doká¾eme, ¾e tento
postup je oprávnìný a v¾dy vede k~inverzní matici.
\inl[metoda: poèítání: inverzní matice]

Na¹ím úkolem bude najít inverzní matici k~matici
$$
  \catcode`+=13 \def+{\hphantom{-}}
  \A = \pmatrix{+1&2&3\cr-1&0&1\cr+2&2&1}.
$$
Vedle prvkù matice $\A$ napí¹eme prvky jednotkové matice stejného typu
(oddìlíme od sebe pro pøehlednost svislou èarou) a dále pou¾ijeme
øádkové úpravy Gaussovy eliminaèní metody na matici $(\A|\E)$ 
jako celek. To znamená, ¾e pracujeme s~øádky délky $2n$, v~na¹em
konkrétním pøípadì s~øádky o~¹esti prvcích. Pøi~eliminaci se sna¾íme
vlevo od svislé èáry dostat postupnì jednotkovou matici.
$$
 \catcode`+=13 \def+{\hphantom{-}}
 \def\mmatrix#1{\left(\,\vcenter{\offinterlineskip
    \ialign{\hfil$##$&\quad\hfil$##$&\quad\hfil$##$&\hskip.7em
     \vrule\strut\hskip.7em\hfil$##$&&\quad\hfil$##$\cr#1\crcr}}\,\right)}
 %
\displaylines{
 \mmatrix{1&2&3&1&0&0\cr-1&0&1&0&1&0\cr2&2&1&0&0&1} \sim
 \mmatrix{1&+2&+3&+1&+0&+0\cr 0&2&4&1&1&0\cr0&-2&-5&-2&0&1} \sim
 \mmatrix{1&+2&+3&1&0&0\cr 0&2&4&1&1&0\cr0&0&1&1&-1&-1} \sim \cr
 \sim \mmatrix{1&+2&+0&-2&3&3\cr 0&2&0&-3&5&4\cr0&0&1&1&-1&-1} \sim
 \mmatrix{1&0&0&1&-2&-1\cr0&1&0&-{3\over2}&+{5\over2}&2\cr0&0&1&1&-1&-1}, \quad
 \A^{-1} = \pmatrix{+1&-2&-1\cr-{3\over2}&+{5\over2}&+2\cr+1&-1&-1}.}
$$ 
Pøi pøechodu z matice $\A$ na matici $\E$ v levém bloku 
jsme nejprve pøevedli matici
$\A$ na schodovitou matici stejnì, jako je popsáno v úvodní
kapitole o Gaussovì eliminaèní metodì (tzv.~{\em pøímý chod eliminaèní
metody\/}).  Jsou-li ve schodovité matici
na diagonále nenulové prvky, 
lze pokraèovat tzv.~{\em zpìtným chodem eliminaèní metody}.
V nìm nejprve násobíme poslední øádek vhodnými konstantami a pøièítáme
k øádkùm nad ním. Tím dostáváme nuly v posledním sloupci nad nenulovým
prvkem na pozici $(n,n)$. Pak pøièítáme násobky pøedposledního øádku k
pøedchozím a získáme nuly v pøedposledním sloupci. Takto postupnì
pokraèujeme a¾ dostaneme matici s nenulovými prvky na diagonále a s
nulovými prvky jinde. Ka¾dý øádek takové matice vynásobíme pøevrácenou
hodnotou jeho diagonálního prvku a dostáváme matici~$\E$.
\inl[zpìtný chod GEM, pøímý chod GEM]

Tvrdíme, ¾e hledaná inverzní matice k~matici $\A$ je zapsána vpravo od
svislé èáry v~poslední úpravì. Zformulujeme to jako algoritmus:

\algoritmus* [algolinverse]
%%%%%%%%%%%
Pokud $(\A\,|\,\E)\sim(\E\,|\,\B)$, kde~\uv{$\sim$} znamená koneènì mnoho 
øádkových úprav matice podle Gaussovy eliminaèní metody, pak $\B=\A^{-1}$.
\inl[matice: inverzní, inverzní: matice]

Zvídavý ètenáø se oprávnìnì ptá, proè tato metoda dává inverzní
matici. Sformulujeme tuto vlastnost jako vìtu\cite[inverse].
Nejprve si ale pov¹imneme dùle¾ité vlastnosti Gaussovy eliminace.

\veta* [emulaceGEM]
%%%%%
Nech» $\A\sim\B$ jsou dvì matice. 
Pak existuje matice $\P$ taková, ¾e $\B=\P\cdot\A$.

\dukaz
%%%%%%
Proto¾e podle vìty\cite[lobalymatic] je $\lobr<\A>=\lobr<\B>$, jsou
øádky matice $\B$ lineárními kombinacemi øádkù matice~$\A$.
Zapí¹eme-li koeficienty tìchto lineárních kombinací do øádkù matice
$\P$, dostáváme podle poznámky\cite[ABlkB] vztah~$\P\cdot\A=\B$.

\veta [inverse]
%%%%%
Nech» $\A\in\R^{n,n}$ a nech» lze provést $(\A\,|\,\E)\sim(\E\,|\,\B)$, kde 
\uv{$\sim$} oznaèuje koneèný poèet øádkových úprav podle eliminaèní 
metody a $\E$ znaèí jednotkovou matici z $\R^{n,n}$. Pak $\B=\A^{-1}$.

\dukaz
%%%%%%
Podle vìty\cite[emulaceGEM] existuje matice $\P$ taková, ¾e
$$\def\|{\,|\,}
  (\A\|\E) \sim (\E\|\B) = \P\cdot(\A \| \E) = (\P\A\|\P\E).  
$$
Proto¾e $\B=\P\E$, je $\P=\B$. Proto¾e $\E=\P\A$,
je $\E=\B\A$. Podle vìty\cite[stacipul] je $\B$ inverzní matice 
k~matici~$\A$.


\poznamka [emulacesloupcu]
%%%%%%%%%
Kdybychom napsali jednotkovou matici pod matici $\A$ a aplikovali na
sloupce této \uv{dvojmatice} sloupcové úpravy podle Gaussovy
eliminaèní metody a získali nakonec v~horní èásti matici~$\E$, pak je
ve spodní èásti matice inverzní. Pøi dùkazu tohoto tvrzení bychom
postupovali analogicky jako pøi øádkové metodì, jen maticemi 
$\P_i$, které \uv{emulují} sloupcové úpravy, bychom násobili 
matici~$\A$ zprava a nikoli zleva.

Rozmyslete si, ¾e není mo¾né pøi metodì hledání inverzní matice
kombinovat øádkové i sloupcové operace dohromady. Nará¾í to na
skuteènost, ¾e násobení matic není komutativní.


\okraj Podmínky regularity | Podminky regularity

\veta* [regulpodminky]
%%%%%
Nech» $\A\in\R^{n,n}$ je ètvercová matice. Pak následující
podmínky jsou ekvivalentní:

\noindent (1) $\A$ je regulární,

\noindent (2) $\A$ má inverzní matici $\A^{-1}$,

\noindent (3) $\hod\A=n$,

\noindent (4) Maticová rovnice $\A\X=\B$ s neznámou maticí
              $\X\in\R^{n,m}$ má øe¹ení pro ka¾dou $\B\in\R^{n,m}$.

\noindent (5) $\A\sim\E$, tj. existuje koneènì krokù Gaussovy
              eliminaèní metody, které pøevedou $\A$ na $\E$.


\dukaz
$(1) \equiv (2)$ pøímo z definice regulární matice. 
$(2) \equiv (3)$ z vìty\cite[hodreg].

Ekvivalence zbývajících podmínek vyplyne z~implikací
$(2)\impl(4)\impl(3)\impl(5)\impl(2)$. 

$(2)\impl(4)$: proto¾e $\A^{-1}\B$ uvedenou rovnici øe¹í. Skuteènì je
$\A(\A^{-1}\B)=(\A\A^{-1})\B=\E\B=\B$.

$(4)\impl(3)$: Je-li $\C$ øe¹ení rovnice $\A\X=\E$, pak musí
podle vìty\cite[hodA.B] být $\hod\E=\hod(\A\cdot\C)\le\hod\A$.
Proto¾e $\hod\E=n$, musí $\hod\A=n$.

$(3)\impl(5)$: Proto¾e eliminace nemìní hodnost, musí se po pøímém chodu
Gaussovy eliminace matice $\A$ promìnit ve schodovitou matici s nenulovými øádky,
tedy s nenulovými èísly na diagonále. Pak lze provést zpìtný chod
eliminace a pøevést pùvodní matici $\A$ na $\E$.

$(5)\impl(2)$: Je-li $\A\sim\E$, pak $(\A\,|\,\E)\sim(\E\,|\,\A^{-1})$ podle 
vìty\cite[inverse].  

\poznamka
%%%%%%%%%
Dal¹í ekvivalentní podmínkou regularity matice $\A$ je lineární
nezávislost jejích øádkù (podle vìty\cite[nezav=hod]) co¾ je ekvivalentní 
s~lineární nezávislosti sloupcù (podle vìty\cite[hA=hAT]) a to je
ekvivalentní s regularitou matice~$\A^T$.
V následující kapitole si je¹tì uká¾eme, ¾e $\A$ je regulární právì
tehdy, kdy¾ má nenulový determinant (vìta\cite[reguldet]).

Pro singulární matice lze zformulovat analogické podmínky:
$\A$ je singulární, právì kdy¾ neexistuje inverzní matice, právì kdy¾
$\A\X=\B$ nemá øe¹ení pro nìkteré matice $\B$, právì kdy¾
$\hod\A<n$, právì kdy¾ $\A$ má lineárnì závislé øádky/sloupce,
právì kdy¾ $\A^T$ je singulární, 
právì kdy¾ nelze $\A$ pøevést na $\E$ koneènì mnoha kroky Gaussovy
eliminaèní metody, právì kdy¾ má nulový determinant.

\poznamka
%%%%%%%%%
Proto¾e podle vìty\cite[regulpodminky] je matice $\A$ regulární právì
tehdy, kdy¾ $\A\sim\E$, máme zaruèeno, ¾e metoda výpoètu inverzní
matice nesel¾e pro ¾ádnou regulární matici. Jinými slovy, \hbox{má-li} matice
inverzní matici, pak pùjde provést eliminaci $(\A|\E)\sim(\E|\B)$, co¾
je podmínkou ke spu¹tìní algoritmu\cite[algolinverse].

\poznamka
%%%%%%%%%
Maticové rovnice z podmínky (4) lze øe¹it \uv{vynásobením obou stran
rovnice maticí $\A^{-1}$ zleva}. Tím se $\A\X=\B$ pøevede na
$\X=\A^{-1}\B$. Dále lze øe¹it maticové rovnice $\X\A=\B$ 
(pro matice $\X,\B\in\R^{m,n})$ \uv{vynásobením obou stran
rovnice maticí $\A^{-1}$ zprava}. Tím dostáváme
$\X=\B\A^{-1}$. Situace je tedy podobná jako s èíselnou linární rovnicí
$ax=b$ jen s tím rozdílem, ¾e musíme mít na pamìti, ¾e není splnìn
komuntativní zákon souèinu matic, tak¾e $\A^{-1}\B$ nemusí být toté¾
jako $\B\A^{-1}$.

Mnoho maticových rovnic lze na maticové rovnice $\A\X=\B$ nebo $\X\A=\B$
pøevést, jak ukazuje následující pøíklad.

\priklad [AX4A]
%%%%%%%%
Najdeme matici $\X$ takovou, aby byla splnìna rovnice 
$$
  \A\cdot\X-\X+4\,\A=\O,
$$
kde $\A\in\R^{3,3}$ je matice z~pøíkladu\cite[metodainverse]
a $\O$ je nulová matice stejného typu.

Hledaná matice musí být ètvercová typu $(3,3)$, jinak by nebylo definováno
sèítání.
Rovnici postupnì upravíme (dáváme si pozor na to, ¾e nemusí platit
komutativní zákon). 
$$
  \A\cdot\X-\X=-4\,\A\quad \hbox{tj.}\quad
  \A\cdot\X-\E\cdot\X=-4\,\A\quad \hbox{tj.}\quad (\A-\E)\cdot\X=-4\,\A.
$$
Pokud existuje matice $(\A-\E)^{-1}$, pak 
po pronásobení obou stran rovnice touto maticí {\it zleva}
dostáváme 
$$
  \X = (\A-\E)^{-1}\cdot(-4\,\A) = -4\,(\A-\E)^{-1}\cdot\A.
$$
Je tedy potøeba 
najít inverzní matici k~matici $\A-\E$
(napøíklad metodou popsanou v~pøíkladu\cite[metodainverse]).
Nalezenou inverzní matici
vynásobíme ètyømi a nakonec provedeme maticové
násobení $4\,(\A-\E)^{-1}\cdot\A$ podle definice.
Ní¾e uvádíme jednotlivé mezivýpoèty:
$$
  \catcode`+=13 \def+{\hphantom{-}}
  \displaylines{
  \A-\E = \pmatrix{+0&+2&+3\cr-1&-1&+1\cr+2&+2&+0}, \quad
  (\A-\E)^{-1} = 
  \pmatrix{-{1\over2}&+{3\over2}&+{5\over4}\cr\noalign{\kern4pt}
    +{1\over2}&-{3\over2}&-{3\over4}\cr\noalign{\kern4pt}
    +0&+1&+{1\over2}}, \quad
  4\,(\A-\E)^{-1} =
  \pmatrix{-2&+6&+5\cr+2&-6&-3\cr+0&+4&+2}, \cr
  \X = -4\,(\A-\E)^{-1}\cdot\A = 
  - \pmatrix{-2&+6&+5\cr+2&-6&-3\cr+0&+4&+2} \cdot 
  \pmatrix{+1&2&3\cr-1&0&1\cr+2&2&1} =
  \pmatrix{-2&-6&-5\cr-2&+2&+3\cr+0&-4&-6}.}
$$

\okraj Hodnost souèinu s regulární maticí | Hodnost soucinu s
  regularni matici

\poznamka
%%%%%%%%%
Z vìty\cite[hodA.B] víme, ¾e hodnost matice se mù¾e zmen¹it, pokud ji
vynásobíme nìjakou maticí. Nyní uká¾eme, ¾e hodnost matice se nezmìní, 
pokud ji vynásobíme regulární maticí.
Pøipomeneme nejdøíve vìtu\cite[emulaceGEM], která øíká, ¾e
ka¾dému eliminaènímu procesu $\A\sim\B$ pøíslu¹í matice $\P$
tak, ¾e $\B=\P\cdot\A$. Tato vìta se dá v jistém smyslu obrátit:

\veta [P=sim]
%%%%%
Nech» $\A,\B\in\R^{m,n}$. Nech» $\P\in\R^{m,m}$ je regulární
matice a nech» $\B=\P\cdot\A$. Pak $\A\sim\B$.

\dukaz
%%%%%%
Proto¾e $\P$ je regulární, je podle podmínky (5) 
z~vìty\cite[regulpodminky] $\P\sim\E$ a ze symetrie relace $\sim$
plyne té¾ $\E\sim\P$. Tedy 
$(\E\,|\,\A)\sim(\P\,|\,\X)=\P(\E\,|\,\A)=(\P\,|\,\P\A)=(\P\,|\,\B)$.
Stejnou eliminaci provedeme pouze s pravým blokem, 
tj. dostáváme $\A\sim\B$.

\veta [hodPA]
%%%%%
Nech» $\A$ je libovolná matice (ne nutnì ètvercová) a $\P$, $\Q$ jsou
regulární matice takové, ¾e je definováno násobení $\P\cdot\A$ a $\A\cdot\Q$.
Pak $\hod\A=\hod(\P\cdot\A)=\hod(\A\cdot\Q)$.
Jinými slovy: násobení regulární maticí nemìní hodnost.
\inl[hodnost: matice, matice: regulární, regulární: matice]

\dukaz
Oznaème $\B=\P\cdot\A$. Podle vìty\cite[P=sim] je $\A\sim\B$, tak¾e
$\hod\A=\hod\B$ podle vìty\cite[hodAB].

K dùkazu $\hod\A=\hod(\A\cdot\Q)$ staèí 
podle~(5) vìty\cite[soucinAB-vlastnosti]
pøejít k~transponovaným maticím 
a pou¾ít pøedchozí výsledek spoleènì 
s~vìtou\cite[hA=hAT]:
$\hod(\A\cdot\Q)=\hod(\A\cdot\Q)^T=\hod(\Q^T\cdot\A^T)=\hod\A^T=\hod\A$.

\veta [AsimBequiv]
%%%%%
$\A\sim\B$ právì tehdy, kdy¾ $\lobr<\A>=\lobr<\B>$.

\dukaz
Implikaci \uv{je-li $\A\sim\B$, pak $\lobr<\A>=\lobr<\B>$} 
jsme dokázali v~odstavci\cite[lobalymatic]. Nyní tedy
pøedpokládáme $\lobr<\A>=\lobr<\B>$ a najdeme takový eliminaèní
proces, který pøevede matici $\A$ na matici~$\B$.

Nejprve najdeme schodovité matice s nenulovými øádky $\A'$ a $\B'$ takové, 
¾e $\A\sim\A'$ a $\B\sim\B'$. To je mo¾né díky vìtì\cite[simhornitroj].
Staèí tedy ukázat, ¾e $\A'\sim\B'$. Z vìty\cite[lobalymatic] plyne,
¾e $\lobr<\A>=\lobr<\A'>$ a $\lobr<\B>=\nobreak\lobr<\B'>$ a z pøedpokladu
$\lobr<\A>=\lobr<\B>$ plyne $\lobr<\A'>=\lobr<\B'>$. Matice
$\A'$ i $\B'$ mají lineárnì nezávislé øádky a jejich poèet
je v obou pøípadech roven
$k=\hod\A=\hod\B=\hod\A'=\hod\B'$. 
Ka¾dý øádek matice $\B'$ je lineární kombinací øádkù matice $\A'$,
tak¾e existuje ètvercová matice $\P$ (koeficientù tìchto lineárních
kombinací), pro kterou je $\P\cdot\A'=\B'$. 
Z vìty\cite[hodA.B] plyne, ¾e $\hod\P=k$, co¾ je poèet øádkù 
matice~$\P$. Tak¾e $\P$ je podle vìty\cite[hodreg]
regulární. Po pou¾ití vìty\cite[P=sim] vidíme, ¾e $\A'\sim\B'$.


\okraj Elementárni matice | Elementarni matice

\priklad* [P123]
%%%%%%%%
Jestli¾e $\A\sim\B$, pak podle vìty\cite[emulaceGEM] existuje matice
$\P$ taková, ¾e $\B=\P\A$. Podívejme se, jak vypadá matice $\P$ 
v~pøípadì jednotlivých elementárních krokù Gaussovy eliminaèní metody.

(1) Nech» $\B$ vznikla z $\A$ prohozením $i$-tého øádku s $j$-tým.
Snadno ovìøíme, ¾e $\B=\P_1\cdot\A$, kde $\P_1$ je ètvercová matice,
která vznikla z $\E$ prohozením $i$-ého øádku s~$j$-tým.

(2) Nech» $\B$ vznikla z $\A$ vynásobením $i$-tého øádku nenulovou 
konstantou $\alpha$.
Snadno ovìøíme, ¾e $\B=\P_2\cdot\A$, kde $\P_2$ je ètvercová matice,
kerá vznikla z $\E$ vynásobením $i$-ého øádku konstantou~$\alpha$.

(3) Nech» $\B$ vznikla z $\A$ pøiètením $\alpha$-násobku $j$-tého øádku $i$-tému.
Snadno ovìøíme, ¾e $\B=\P_3\cdot\A$, kde $\P_3$ je ètvercová matice,
kerá vznikla z $\E$ zámìnou nuly za prvek $\alpha$ na
pozici $i,j$.

\definice [delement]
%%%%%%%%%
Matice typu $\P_1$, $\P_2$ a $\P_3$ z pøíkladu\cite[P123] 
se nazývají {\em elementární matice}.
\inl[matice: elementární, elementární matice]

\veta [BsimPA]
%%%%%
Symbolem $\A\sim\B$ v~této vìtì znaèíme skuteènost, ¾e matice $\B$
vznikla z matice $\A$ koneènì mnoha
kroky Gaussovy eliminaèní metody, pøièem¾ není dovolen krok vynechání
nebo pøidání nulového øádku. Platí: $\A\sim\B$ právì tehdy, kdy¾
existuje regulární matice $\P$ taková, ¾e $\B=\P\cdot\A$.

\dukaz
Implikace \uv{je-li $\P$ regulární, pak $\P\A\sim\A$} 
je dokázána ve vìtì\cite[P=sim]. Je ov¹em potøeba dùkaz vìty projít znovu a
uvìdomit si, ¾e nebylo nutné pou¾ít krok vynechání nebo pøidání
nulového øádku.
Nyní doká¾eme opaènou implikaci.
Pøedpokládejme, ¾e $\A\sim\B$. Pak
$$
  \B = \C_m\cdot(\C_{k-1}\cdots(\C_2\cdot(\C_1\cdot \A))\cdots) =
     (\C_m\cdot\C_{k-1}\cdots\C_2\cdot\C_1)\cdot\A = \P\cdot\A,
$$
kde $\C_k$ je elementární matice jednoho z typù $\P_1$, $\P_2$ a
$\P_3$, která \uv{emuluje} provedení $k$-tého kroku eliminaèní metody.
Jednotlivé elementární matice jsou zøejmì regulární, proto¾e mají
lineárnì nezávislé øádky. Matice $\P$, která je souèinem tìchto
elementárních regulárních matic, je podle vìty\cite[regulkratregul] regulární.



\okraj Lineární kombinace skupin vektorù z~$L$ |
       Linearni kombinace skupin vektoru z L

\poznamka
%%%%%%%%%
V následujících odstavcích budeme pracovat se skupinou 
vektorù $\vecc x_n\in L$ a dal¹í skupinou vektorù
$\vecc y_m\in L$, která vznikne jejich lineárními kombinacemi. Tedy
$$
  \vec y_1 = \alpha_{1,1}\vec x_1 + \cdots + \alpha_{1,n}\vec x_n, \quad
  \vec y_2 = \alpha_{2,1}\vec x_1 + \cdots + \alpha_{2,n}\vec x_n, \quad \ldots,\quad
  \vec y_m = \alpha_{m,1}\vec x_1 + \cdots + \alpha_{m,n}\vec x_n
$$
Tyto rovnosti lze v souladu s poznámkou\cite[matvektoru]
zapsat jako maticový souèin
$$
  \pmatrix{\vec y_1\cr\vec y_2\cr\vdots\cr\vec y_m} = 
  \A\cdot \pmatrix{\vec x_1\cr\vec x_2\cr\vdots\cr\vec x_n},\quad
  \hbox{struènì }
  \Y = \A\cdot\X,
$$
kde $\A=(\alpha_{i,j})\in\R^{n,m}$, 
$\X=(\vecc x_n)^T\in L^{n,1}$, $\Y=(\vecc y_m)^T\in L^{m,1}$.

\veta [XtoY]
%%%%%
Oznaème $\A=(\alpha_{i,j})\in\R^{n,m}$, 
$\X=(\vecc x_n)^T\in L^{n,1}$, $\Y=(\vecc y_m)^T\in L^{m,1}$
a nech» $\Y=\A\cdot\X$. Oznaème je¹tì $\vecc a_m\in\R^n$
øádky matice $\A$ a nech» $\vec b=(\beta_1,\beta_2,\ldots,\beta_n)$
je nìjaký vektor z~$\R^n$ a $\vec z=\lkvecc \beta.y_m$.
 Pak platí

\noindent
(1) $\vec b\in\lob<\vecc a_m>$
    právì tehdy, kdy¾ $\vec z\in\lob<\vecc y_m>$.

\noindent
(2) Jsou-li $\vecc x_n$ lineárnì nezávislé v~$L$, pak
    $\vecc a_m$ jsou lineárnì nezávislé v~$\R^n$ právì tehdy, kdy¾
    $\vecc y_m$ jsou lineárnì nezávislé v~$L$.

\noindent
(3) Jsou-li $\vecc x_n$ lineárnì nezávislé, pak
    $\dim\lob<\vecc a_m> = \dim\lob<\vecc y_m>$.

\noindent
(4) Je-li $m=n$ a $\vecc a_n$ jsou lineárnì nezávislé,
    pak $\lob<\vecc x_n> = \lob<\vecc y_n>$.

\dukaz
%%%%%%
(1) Nech» $\vec b\in\lob<\vecc a_m>$, tedy 
$\vec b=\lkvecc\gamma.a_m$, tj.
$\vec b=(\gamma_1,\gamma_2,\ldots,\gamma_m)\cdot\A$.
Proto¾e $\A\cdot\X=\Y$, je 
$(\gamma_1,\gamma_2,\ldots,\gamma_m)\cdot\Y=
(\gamma_1,\gamma_2,\ldots,\gamma_m)\cdot\A\cdot\X=\vec b\cdot\X=\vec z$.
Tak¾e $\vec z\in\lob<\vecc y_m>$ a lineární kombinace vektorù
$\vecc y_m$, která tvoøí $\vec z$, má stejné koeficienty, 
jako lineární kombinace vektorù $\vecc a_m$, která tvoøí $\vec b$.

Nech» nyní $\vec z\in\lob<\vecc y_m>$, tedy 
$\vec z=(\gamma_1,\gamma_2,\ldots,\gamma_m)\cdot\Y$. Proto¾e
$\A\cdot\X=\Y$, musí být
$\vec b\cdot\X = \vec z=(\gamma_1,\gamma_2,\ldots,\gamma_m)\cdot\Y=
(\gamma_1,\gamma_2,\ldots,\gamma_m)\cdot\A\cdot\X$,
tak¾e je $\vec b=(\gamma_1,\gamma_2,\ldots,\gamma_m)\cdot\A$. Vektor
$\vec b$ je tedy lineární kombinací øádkù matice $\A$ s koeficienty
$\gamma_1,\gamma_2,\ldots,\gamma_m$.

(2) Nech» nejprve jsou vektory $\vecc a_m$ lineárnì nezávislé.
Oznaèíme symbolem $\vec o$ nulový vektor v~$L$ a uká¾eme, ¾e lineární kombinace
$(\gamma_1,\gamma_2,\ldots,\gamma_m)\cdot\Y=\vec o$ musí být pouze triviální.
Pøi oznaèení $\vec b =\nobreak(\gamma_1,\gamma_2,\ldots,\gamma_m)\cdot\A$
je 
$\vec o=(\gamma_1,\gamma_2,\ldots,\gamma_m)\cdot\A\cdot\X=\vec b\cdot\X$.
Lineární kombinace vektorù $\vecc x_n$ je zde rovna nulovému vektoru.
Proto¾e jsou vektory $\vecc x_n$ lineárnì nezávislé, musí být tato
kombinace triviální, neboli $\vec b=(0,0,\ldots,0)$. 
Je tedy $(\gamma_1,\gamma_2,\ldots,\gamma_m)\cdot\A=(0,0,\ldots,0)$.
Levá strana této rovnosti je lineární kombinace øádkù matice $\A$
s koeficienty $\gamma_i$, která je rovna nulovému øádku. Proto¾e jsou
tyto øádky lineárnì nezávislé, musí $\gamma_i=0$ pro $i=1,2,\ldots,m$.

Jsou-li vektory $\vecc a_m$ lineárnì závislé, pak podle vìty\cite[xr]
existuje jeden vektor $\vec a_r$, který je lineární kombinací
ostatních vektorù $\vec a_i$. Podobnì jako v dùkazu~(1) lze ukázat, ¾e
vektor $\vec y_r$ je pak lineární kombinací ostatních vektorù $\vec y_i$ 
a tato lineární kombinace má stejné koeficienty. Tak¾e 
i~vektory $\vecc y_m$ jsou lineárnì závislé.

(3) Bázi $\lob<\vecc a_m>$ lze najít jako nejvìt¹í podmno¾inu
mno¾iny øádkù $\vecc a_i$. Bázi $\lob<\vecc y_m>$ lze vybrat stejným
zpùsobem z mno¾iny vektorù $\vecc y_m$. Z vlastnosti (2) plyne, ¾e
obì tyto podmno¾iny musí být stejnì poèetné.

(4) Proto¾e $\Y=\A\cdot\X$, je $\lob<\vecc y_n>\subseteq\lob<\vecc x_n>$.
Proto¾e $\vecc a_n$ jsou lineárnì nezávislé, je matice $\A$ regulární,
tak¾e $\X=\A^{-1}\cdot\Y$. Z této rovnosti plyne, ¾e 
$\lob<\vecc x_n>\subseteq\lob<\vecc y_n>$, tak¾e platí obì inkluze a
uvedené lineární obaly se rovnají.


\poznamka* [XsimY]
%%%%%%%%%
Øádky matice $\A$ ve vìtì\cite[XtoY] 
jsou koeficienty lineárních kombinací, kterými
mìníme skupinu vektorù $\vecc x_n$ na novou skupinu vektorù $\vecc y_m$.
Speciálnì, je-li $\A$ nìkterá z~elementárních matic $\P_1$, $\P_2$ a $\P_3$ 
z~pøíkladu\cite[P123], pak je regulární a má tedy lineárnì nezávislé
øádky. Podle (2) pøedchozí vìty to znamená, ¾e lineární 
nezávislost skupiny vektorù se nezmìní zmìnou jejich poøadí, 
vynásobením jednoho vektoru nenulovou
konstantou, pøiètením násobku vektoru k jinému nebo koneèným opakováním
tìchto úkonù. Z vlastnosti (4) pøedchozí vìty dále vyplývá, ¾e uvedené
modifikace skupiny vektorù nezmìní jejich lineární obal.
To nám pøipomíná vìty\cite[GEMzav] a\cite[lobalymatic], 
ale tam jsme pracovali jen  s~øádky matice, tedy s~vektory 
z~$\R^n$. Nyní øíkáme toté¾ o~vektorech z~libovolného 
lineárního prostoru~$L$.


\shrnuti
%%%%%%%%
Souèin matic $\A\cdot\B$ je definován\lcite[soucinAB] 
jen pro matice, kde $\A$ má stejný poèet sloupcù jako $\B$ øádkù.
Souèin matic není obecnì komutativní ani pro ètvercové matice.
Ov¹em platí asociativní i distributivní 
zákon\lcite[soucinAB-vlastnosti].

Matice lze násobit i po blocích~/\ncite[ctyribloky], \ncite[soucinbloku]/.
Napøíklad souèin matic $\A\cdot\B$ obsahuje ve sloupcích souèiny
matice $\A$ s jednotlivými sloupci matice $\B$\lcite[soucinsloupcu].

Blokovým násobením matic je inspirován Strassenùv algoritmus, který má
slo¾itost pouze $n^{2,8}$, zatímco slo¾itost maticového souèinu podle
definice je $n^3$.

Existuje skupina matic, která s pevnì danou ètvercovou maticí
komutuje. Tato skupina tvoøí podprostor v¹ech ètvercových matic.

Iverzní matice ke ètvercové matici $\A$ ja taková ètvercová matice
$\A^{-1}$ stejného typu, která musí splòovat
$\A\cdot\A^{-1}=\A^{-1}\cdot\A=\E$\lcite[inverseA], 
kde $\E$ je jednotková matice\lcite[defE]. Inverzní matice je
jediná\lcite[jedinainv]. Z jedné definièní rovnosti plyne 
druhá\lcite[stacipul].
Matici, která má inverzní, nazýváme regulární\lcite[dregul].
Souèin regulárních matic je matice 
regulární\lcite[regulkratregul]. Mezi ekvivalentní podmínky s regularitou
matice $\A$ patøí: $\hod\A={}$poèet øádkù, $\hbox{r:}\,\A$ je lineárnì
nezávislá mno¾ina, maticová rovnice $\A\X=\B$ má øe¹ení pro ka¾dou
pravou stranu, platí $\A\sim\E$\lcite[regulpodminky].

Na výpoèet inverzní matice je mo¾né pou¾ít 
algoritmus\lcite[algolinverse] zalo¾ený na Gaussovì eliminaèní metodì.
®e metoda skuteènì poèítá inverzní matici plyne z tvrzení, ¾e
pokud $\A\sim\B$, pak existuje matice $\P$ tak, ¾e 
$\B=\P\cdot\A$~/\ncite[emulaceGEM]/.
Vìtu mù¾eme za podmínky regularity $\P$ zformulovat jako 
ekvivalenci\lcite[BsimPA]. V takovém pøípadì je $\P$ souèinem
emelmentárních matic\lcite[delement].

Hodnost souèinu matic je nejvý¹e rovna hodnosti jednotlivých 
èinitelù\lcite[hodA.B]. Násobíme-li matici regulární maticí, hodnost
se nezmìní\lcite[hodPA].

Maticové násobení jsme pou¾ili k vyjádøení pøechodu jedné skupiny
vektorù z~$L$ k lineárním kombinacím této skupiny vektorù. Odvodili
jsme, ¾e také na abstraktní vektory z~$L$ mù¾eme uplatnit kroky Gaussovy
eliminaèní metody jako na øádky matice, pøitom jejich lineární nezávislost a
jejich lineární obal zùstávají v takovém pøípadì zchovány\lcite[XsimY].


\icviceni 3


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\kapitola LU rozklad | LU rozklad
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\poznamka
%%%%%%%%%
V této krátké kapitole uká¾eme, ¾e ka¾dou regulární matici lze (a¾ na
pøípadné prohození sloupcù) zapsat jako souèin matic $\L$ a $\U$, kde
$\L$ je dolní trojúhelníková matice (má nenulové prvky soustøedìny
v~dolním trojúhelníku) a $\U$ je horní trojúhelníková matice.  Tento
rozklad se pou¾ívá pøi numerickém øe¹ení soustav lineárních 
rovnic\lcite[LUsoustava], zejména pøi vìt¹ím poètu pravých stran.

Toto téma spadá spi¹e do numerické matematiky. Pøesto jsem se rozhodl
je sem zaøadit, proto¾e hlavní my¹lenka LU rozkladu vyu¾ívá dùle¾itý
poznatek, který byl vysloven v pøedchozí kapitole: jednotlivé kroky
eliminaèní metody lze \uv{emulovat} násobením pøíslu¹nými regulárními
maticemi zleva. Následující kapitoly nepøedpokládají znalosti
o LU rozkladu. Pokud tedy ètenáø nemá zájem tuto zále¾itost poznat 
hloubìji, mù¾e bez uzardìní tuto kapitolu pøeskoèit.


\okraj Horní a dolní trojúhelníková matice | Horni a dolni trojuhelnikova matice

\definice
%%%%%%%%%
Nech» $\A=(a_{ij})$ je ètvercová matice. Matici $\A$ nazýváme 
{\em horní trojuhelníkovou}, pokud má pod diagonálou jen nulové prvky
(nenulové prvky jsou soustøedìny v \uv{horním tojúhelníku}), tedy
$a_{i,j}=0$ pro $i>j$. Matici $\A$ nazýváme 
{\em dolní trojúhelníkovou}, pokud má nad diagonálou jen nulové prvky,
tedy $a_{i,j}=0$ pro~$i<j$.
\inl[matice: horní trojúhelníková, horní trojúhelníková matice]
\inl[matice: dolní trojúhelníková, dolní trojúhelníková matice]

\veta [Linverz] \relax
%%%%%
(1) Souèin dvou dolních trojúhelníkových matic s jednièkami na
diagonále je dolní trojúhelníková matice s jednièkami na diagonále.

\noindent
(2) Je-li $\L$ dolní trojúhelníková matice s jednièkami 
na diagonále, pak je regulární a $\L^{-1}$ je také dolní
trojúhelníková matice s jednièkami na diagonále.

\dukaz
(1) Staèí si uvìdomit, jak funguje maticové násobení.

\noindent
(2) Uká¾eme, ¾e eliminaci 
$(\L\,|\,\E) \sim (\E\,|\,\L^{-1}) = \P\cdot(\L\,|\,\E)$ lze v¾dy 
provést, tak¾e $\L$ je regulární.
$\P=\L^{-1}$ je souèin elmentárních matic Gaussovy eliminace.
Po pøímém chodu Gaussovy eliminaèní metody jistì vytvoøíme z dolní
trojúhelníkové matice $\L$ matici $\E$. Zpìtný chod není nutné pou¾ít,
nebo» nad diagonálou se u¾ nuly vyskytují a eliminací nejsou
znehodnoceny. Na diagonále matice $\L$ zùstávají jednièky.
Tak¾e není potøeba ani prohazovat øádky, ani násobit øádky
konstantou. Matice $\P$ je tedy souèinem
jen elematárních matic typu $\P_3$ pro $j<i$, tedy dolních
trojúhelníkových matic s jednièkami na diagonále. 
Podle (1) je tedy $\P=\L^{-1}$ dolní trojúhelníková s jednièkami na diagonále.

\algoritmus [LUalgol]
%%%%%%%%%%%
Je dána ètvercová matice $\A\in\R^{n,n}$.
Popí¹eme algoritmus vzniku matic $\L$ a $\U$, pro které platí $\A=\L\cdot\U$.

Matici $(\A\,|\,\E)$ pøevedeme eliminací na
$(\U\,|\,\L')$. Pøedpokládáme, ¾e v eliminaci nejsme nuceni
prohazovat øádky. Pouze pøièítáme násobky øádkù k øádkùm {\it pod nimi}.
Tím máme zaruèeno, ¾e $\L'$ je dolní trojúhelníková matice s
jednièkami na diagonále.

Proto¾e podle vìty\cite[emulaceGEM] existuje
regulární ètvercová matice $\P$ taková, ¾e
$$
  (\U\,|\,\L') = \P\cdot (\A\,|\,\E) = (\P\cdot\A|\,\P)
$$
dostáváme $\L'=\P$ a $\U=\P\cdot\A = \L'\cdot\A$, neboli
$(\L')^{-1}\cdot\U = \A$. Pro hledanou matici $\L$ tedy platí
$\L=(\L')^{-1}$. 
Matice $\L$ je podle vìty\cite[Linverz] dolní trojúhelníková
s~jednièkami na diagonále.
\inl[LU rozklad]

\priklad [pLU]
%%%%%%%%
Platí
$$
  \catcode`+=13 \def+{\hphantom{-}}
  \A=\pmatrix{1&2&3\cr2&3&1\cr4&2&0} =
  \pmatrix{1&0&0\cr2&1&0\cr4&6&1} \cdot 
  \pmatrix{1&+2&+3\cr0&-1&-5\cr0&+0&\,\,18}=\L\U,
$$
proto¾e
$$
 \catcode`+=13 \def+{\hphantom{-}}
 \def\mmatrix#1{\left(\,\vcenter{\offinterlineskip
    \ialign{\hfil$##$&\quad\hfil$##$&\quad\hfil$##$&\hskip.7em
     \vrule\strut\hskip.7em\hfil$##$&&\quad\hfil$##$\cr#1\crcr}}\,\right)}
 %
 \mmatrix{1&2&3&1&0&0\cr2&3&1&0&1&0\cr4&2&0&0&0&1} \sim
 \mmatrix{1&2&3&1&0&0\cr0&-1&-5&-2&1&0\cr0&0&18&8&-6&1} = (\U\,|\L'),\quad
 (\L')^{-1} = \pmatrix{1&0&0\cr2&1&0\cr4&6&1}.
$$

\poznamka
%%%%%%%%%
Pokud se pøi eliminaci pou¾ité v algoritmu\cite[LUalgol]
vyskytne na diagonále (v místì pivota) nulový prvek, jsme nuceni
prohodit øádky nebo sloupce. V takovém pøípadì matice $\A$ nemá pøímý
rozklad na $\L\cdot\U$. Místo toho rozkládáme modifikovanou matici
$\A'$, která obsahuje vhodnì pøehozené øádky nebo sloupce 
matice $\A$ tak, aby k problému výskytu nulového diagonálního 
prvku bìhem eliminace nedo¹lo. Prohazovaní øádkù lze emulovat
násobením tzv. {\em permutaèní maticí} zleva a prohazování sloupcù lze
emulovat tzv. {\em permutaèní maticí} zprava. V následujících
odstavcích je tato problematika rozvedena podrobnìji. 


\okraj Permutaèní matice | Permutacni matice

\definice
%%%%%%%%%
Matice typu $\P_1$, $\P_2$ a $\P_3$ z pøíkladu\cite[P123] se nazývají 
{\em elementární matice Gaussovy eliminaèní metody}. Speciálnì matice typu
$\P_1$ se nazývají {\em elementární permutaèní matice}. 
Souèin elementárních permutaèních matic se nazývá {\em permutaèní matice}. 
\inl[matice: permutaèní, permutaèní matice]
\inl[matice: elementární GEM]
\inl[matice: elementární permutaèní]

\veta
%%%%%
Nech» $\A\in\R^{m,n}$ je libovolná matice a $\P\in\R^{n,n}$ je
permutaèní matice. Pak $\P\A$ se li¹í od matice $\A$
jen prohozením nìkterých øádkù. Dále matice $\A\P$ se li¹í od matice
$\A$ jen prohozením nìkterých sloupcù.

\dukaz
Jednotlivé elementární permutaèní matice prohazují pøi
násobení zleva dvojici øádkù. Souèin takových matic zpùsobí 
prohození více dvojic øádkù za sebou, tedy nová matice $\P\A$ má
prohozeny nìkteré øádky. Toté¾ platí pro souèin $\A\P$ a 
pro sloupce.

\veta
%%%%%
Pro permutaèní matici platí, ¾e $\P^{-1}=\P^T$.

\dukaz
Staèí si uvìdomit, ¾e ka¾dá elementární permutaèní matice $\P$
má uvedenou vlastnost, tedy pro ni platí $\P^{-1}=\P^T$. Dokonce je $\P=\P^T=\P^{-1}$.
Nech» nyní $\P=\C_1\C_2\cdots\C_k$, kde $\C_i$ jsou elementární
permutaèní matice. Pak
$$
  \P\cdot\P^T = (\C_1\C_2\cdots\C_k)(\C_1\C_2\cdots\C_k)^T =
    (\C_1\C_2\cdots\C_k)(\C_k^T\cdots\C_2^T\cdots\C_1^T) = \E
$$
a analogicky $\P^T\cdot\P=\E$. je tedy $\P^{-1}=\P^T$. 


\okraj LU rozklad s~prohozením sloupcù | LU rozklad s prehozenim sloupcu

\veta [LUrozkladsloupce]
%%%%%
Pro ka¾dou regulární matici $\A\in\R^{n,n}$ existuje permutaèní matice
$\P\in\R^{n,n}$, dolní trojúhelníková matice $\L\in\R^{n,n}$ s
jednièkami na diagonále a horní trojúhelníková matice 
$\U\in\R^{n,n}$ tak, ¾e $\A\P=\L\U$.
\inl[LU rozklad]

\dukaz
Provedeme eliminaci $\A\sim\U$ jako v algoritmu\cite[LUalgol].
Pokud narazíme na nulový diagonální prvek, pak v místì tohoto prvku
nemù¾e být celý øádek nulový, proto¾e matice $\A$ je
regulární. Prohodíme v~eliminované matici sloupce tak, aby diagonální
prvek byl nenulový. Toto prohození sloupcù je mo¾né podchytit
maticovým násobením permutaèní matice zprava. Proto¾e øádkové
eliminaèní úpravy lze podchytit násobením odpovídaícími maticemi zleva,
do souèinu tìchto matic se nám permutaèní matice \uv{nemíchají} a
po dokonèení eliminace dostáváme $\L'\A\P = \U$. Pøi oznaèení $\L=(\L')^{-1}$
dostáváme $\A\P=\L\U$. 
 
\priklad [LUpsloupce]
%%%%%%%%
Pro následující matici $\A$ dostaneme pøi eliminaci na pozici $(2,2)$
nulu. Je tedy:
$$
  \catcode`+=13 \def+{\hphantom{-}}
  \A\P=\pmatrix{1&2&3\cr2&4&1\cr4&2&0} \cdot
  \pmatrix{1&0&0\cr0&0&1\cr0&1&0} =
  \pmatrix{1&0&0\cr2&1&0\cr4&12/5&1} \cdot 
  \pmatrix{1&+3&+2\cr0&-5&+0\cr0&+0&-6}=\L\U.
$$
V tomto pøípadì není matice $\A$ rozlo¾itelná na souèin $\L\U$
bez pøedchozího prohození jejích sloupcù.


\okraj LU rozklad s~prohozením øádkù | LU rozklad s prohozenim radku

\veta [LUrozkladradky]
%%%%%
Pro ka¾dou regulární matici $\A\in\R^{n,n}$ existuje permutaèní matice
$\P\in\R^{n,n}$, dolní trojúhelníková matice $\L\in\R^{n,n}$ s
jednièkami na diagonále a horní trojúhelníková matice 
$\U\in\R^{n,n}$ tak, ¾e $\P\A=\L\U$.
\inl[LU rozklad]

\dukaz
Provedeme eliminaci $\A\sim\U$ jako v algoritmu\cite[LUalgol].
Pokud narazíme na nulový diagonální prvek, pak pod tímto prvkem
nemohou být samé nuly, proto¾e matice $\A$ je
regulární. Prohodíme v~eliminované matici øádky tak, aby diagonální
prvek byl nenulový. Toto prohození øádkù je mo¾né podchytit
maticovým násobením permutaèní matice zleva. Proto¾e øádkové
eliminaèní úpravy jsou podchyceny také násobením odpovídajícími
maticemi zleva, bohu¾el, permutaèní matice se nám do
souèinu \uv{pøimíchaly} a nemáme jistotu, ¾e je mo¾né je v souèinu
pøesunout doprava bez poru¹ení vlastnosti, ¾e zbytek zùstane dolní
diagonální matice. Pomù¾e ale následující pøedstava. V okam¾iku, kdy
rozhodneme o prohození øádkù, se vátíme k pùvodní matici $\A$ a
prohodíme stejné øádky této matice. Pak eliminujeme znovu. Je
zøejmé, ¾e eliminace probìhne podobnì, ale na nulový diagonální prvek
u¾ nyní nenarazíme. Pokraèujeme v eliminaci dále. Narazíme-li pozdìji
znovu na problém nulového prvku na diagonále, prohodíme odpovídající øádky
znovu v matici $\A$ a znovu eliminaci provedeme od zaèátku.

Pokud provádíme eliminaci celého bloku $(\A\,|\,\E)\sim(\U\,|\,\L')$,
pak není nutné se po prohození øádkù vracet na zaèátek eliminace, ale
staèí prohodit v tomto bloku jen jisté èásti øádkù. Pøesnìji. Nech» 
$a_{k,k}=0$ a rozhodli jsme $k$-tý øádek prohodit s $(k+j)$-tým.
V dané chvíli je v pravém bloku v $(n+k)$-tém sloupci a ve v¹ech
dal¹ích vrpavo od nìj torzo je¹tì nezmìnìné jednotkové matice.
S tímto blokem pøi prohazování øádkù nehýbeme, pouze prohodíme
zkrácené øádky délky $(n+k-1)$. Pak je mo¾né rovnou v~eliminaci pokraèovat.

\priklad
%%%%%%%%
Najdeme LU rozklad matice $\A$ z pøíkladu\cite[LUpsloupce].
$$
%  \pmatrix{1&2&3\cr2&4&1\cr4&2&0}
 \catcode`+=13 \def+{\hphantom{-}}
 \def\mmatrix#1{\left(\,\vcenter{\offinterlineskip
    \ialign{\hfil$##$&\quad\hfil$##$&\quad\hfil$##$&\hskip.7em
     \vrule\strut\hskip.7em\hfil$##$&&\quad\hfil$##$\cr#1\crcr}}\,\right)}
 %
 \mmatrix{1&2&3&1&0&0\cr2&4&1&0&1&0\cr4&2&0&0&0&1} \sim
 \mmatrix{1&2&3&1&0&0\cr0&0&-5&-2&1&0\cr0&-6&-12&-4&0&1}
 \mathop{\leftrightarrow}\limits^2_3  
 \mmatrix{1&2&3&1&0&0\cr0&-6&-12&-4&1&0\cr0&0&-5&-2&0&1}
$$
Pøi prohození druhého øádku s tøetím jsme ponechali nezmìnìný
pøedposlední a poslední sloupec pravého bloku. Platí:
$$
  \def\+{\hfill}
  \P = \pmatrix{1&0&0\cr0&0&1\cr0&1&0}, \quad
  \L = \pmatrix{\+1&0&0\cr-4&1&0\cr-2&0&1}^{-1} =
       \pmatrix{1&0&0\cr4&1&0\cr2&0&1},\quad
  \U = \pmatrix{1&\+2&\+3\cr0&-6&-12\cr0&\+0&\+-5}, \quad
  \P\A = \L\U.
$$

\poznamka
%%%%%%%%%
Proto¾e pro permutaèní matici $\P$ platí $\P^{-1}=\P^T$, co¾ je také
permutaèní matice, èasto se setkáváme s následujícími vzorci, které
jsou dùsledky pøedchozích dvou vìt:
$$
  \A = \L\U\P, \qquad \A = \P\L\U.
$$
První vzorec je dùsledkem eliminace s výbìrem pivota prohazováním
sloupcù a druhý je dùsledkem eliminace s výbìrem pivota prohazováním
øádkù. 

\veta [jednoznacnostLU]
%%%%%
Má-li matice $\A\in\R^{n,n}$ LU rozklad bez
nutnosti prohodit sloupce/øádky matice $\A$, je tento rozklad jednoznaèný.
Je-li nutné prohodit sloupce/øádky v matici $\A$, pak pro ka¾dou mo¾nou 
volbu prohození sloupcù/øádkù je LU rozklad jednoznaèný.

\dukaz
Nech» $\A=\L\U=\L_1\U_1$, tj. pøedpokládáme dva LU rozklady matice $\A$.
Proto¾e je podle vìty\cite[Linverz] matice $\L$ regulární, mù¾eme
rovnost pronásobit zleva maticí $\L^{-1}$ a dostáváme
$\L^{-1}\A=\U=\L^{-1}\L_1\U_1$. Proto¾e $\A$ i $\L^{-1}$ jsou
regulární, je regulární i matice $\U$, která je jejich souèinem. 
Analogicky se odvodí, ¾e matice $\U_1$ je regulární, tedy má na
diagonále nenulové prvky. Dále
po oznaèení $\L^{-1}\L_1=\L'$, co¾ je podle vìty\cite[Linverz] dolní
trojúhelníková matice s jednièkami na diagonále, dostáváme rovnost
$\U=\L'\,\U_1$. Dá se ukázat pomocí vìty\cite[Linverz] 
a pøechodem k transponovaným maticím, ¾e
inverze horní trojúhelníkové matice je horní trojúhelníková a ¾e
souèin horních trojúhelníkových matic je horní trojúhelníková. Tak¾e
$\U\U_1^{-1}=\L'\,\U_1\U_1^{-1}=\L'$ je horní trojúhelníková matice.
Proto¾e $\L'$ je zároveò dolní trojúhelníková, musí mít nenulové prvky pouze
na diagonále. Tam má ale jednièky, tak¾e $\L'=\E$. Platí tedy
$\U=\L'\,\U_1=\E\U_1=\U_1$ Po dosazení do pùvodního vztahu
máme rovnost, $\L\U=\L_1\U$, kterou pronásobíme zprava inverzí k $\U$
a dostáváme $\L=\L_1$. 

\poznamka
%%%%%%%%%
V numerických metodách se pou¾ívají efektivnìj¹í algoritmy, ne¾ zde
popsaný\cite[LUalgol]. Pøi výpoètu LU rozkladu se v ¾ádném pøípadì
dodateènì nepoèítá $\L=(\L')^{-1}$, ale vyu¾ije se toho, ¾e $\L$
obsahuje pøímo koeficienty eliminace (s opaèným znaménkem). 

Existují algoritmy LU rozkladu, které mají stejnou
slo¾itost jako maticové násobení. Tak¾e pøi pou¾ití 
Strassenova algoritmu\cite[strassen] máme slo¾itost $n^{2{,}807}$.

\shrnuti
Regulární matici lze (a¾ na prohození sloupcù nebo øádkù) zapsat jednoznaènì jako
souèin horní a dolní trojúhelníkové matice pøíslu¹ných vlastností
/\ncite[LUrozkladradky], \ncite[LUrozkladsloupce],
\ncite[jednoznacnostLU], \ncite[LUalgol]/.




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\kapitola Determinant | Determinant
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Determinant je èíslo, které jistým zpùsobem charakterizuje ètvercovou
matici a které se vyu¾ívá napøíklad pøi výpoètech øe¹ení soustav 
lineárních rovnic. Toto èíslo má mnoho dùle¾itých významù, se kterými se setkáme
nejen v~lineární algebøe, ale i v~jiných matematických disciplínách.
Determinant se podle definice poèítá z~prvkù matice pomìrnì 
komplikovaným zpùsobem. Ne¾ budeme schopni tuto definici formulovat,
musíme si nìco øíci o~permutacích. Na tomto pojmu je toti¾ definice
determinantu zalo¾ena.

\okraj Permutace | Permutace

\definice [permutace]
%%%%%%%%%
Nech» $M$ je koneèná mno¾ina o~$n$ prvcích. {\em Permutace prvkù
mno¾iny $M$} je uspoøádaná \hbox{$n$-tice} prvkù mno¾iny $M$ taková, ¾e ¾ádný
prvek z~mno¾iny $M$ se v~ní neopakuje. Permutaci prvkù mno¾iny 
$M=\{1,2,\ldots,n\}$ nazýváme struènì {\em permutací $n$ prvkù}.
\inl[permutace]

\priklad
%%%%%%%%
Uvedeme nìkteré permutace pìti prvkù: $(1,2,4,5,3)$,
$(5,4,3,2,1)$, $(3,5,4,1,2)$. Uspoøádanou pìtici $(1,2,3,2,4)$
nepova¾ujeme za permutaci, proto¾e se zde opakuje prvek $2$.

\veta [pocetperm]
%%%%%
Poèet rùzných permutací $n$ prvkù je roven èíslu $n!\,$.

\dukaz
%%%%%%
Pøipomínáme, ¾e $n!=n(n-1)(n-2)\cdots2\cdot1$. Dùkaz vìty provedeme
matematickou indukcí. Pro ètenáøe, který se s~takovou formou dùkazu
je¹tì nesetkal, nejprve vysvìtlíme princip matematické indukce.
\ifbook Viz té¾ poznámku\cite[mat-indukce].\fi
\inl[matematická: indukce, indukce: matematická]

Matematickou indukcí dokazujeme tvrzení, které má platit pro v¹echna
$n\in\N$. Postupujeme ve dvou krocích. Nejprve doká¾eme toto tvrzení
pro $n=1$. Pak doká¾eme tzv. indukèní krok, který je formulován ve
tvaru implikace: \uv{jestli¾e tvrzení platí pro $n$, pak platí pro $n+1$}.
Obhájíme-li platnost této implikace, máme dokázáno tvrzení pro v¹echna
$n\in\N$. Vysvìtlíme si, proè.  V~prvním kroku jsme dokázali, ¾e
tvrzení platí pro $n=1$. Uplatníme nyní indukèní krok ve tvaru
\uv{jestli¾e tvrzení platí pro $n=1$, pak platí pro $n=2$}. Tím máme
zaruèeno, ¾e tvrzení platí pro $n=2$. Zopakujeme indukèní krok,
tentokrát ve tvaru \uv{jestli¾e tvrzení platí pro $n=2$, pak 
platí pro $n=3$}. To dokazuje platnost tvrzení pro $n=3$. 
Opakovaným uplatnìním indukèního kroku jsme schopni dolo¾it
platnost tvrzení pro libovolnì velké~$n$.

Tvrzení na¹í vìty je: \uv{poèet rùzných permutací $n$ prvkù je
roven èíslu $n!$}. Doká¾eme v~prvním kroku pro $n=1$, 
tj.~\uv{poèet rùzných permutací jednoho prvku je roven èíslu $1!=1$}.
O~tom ale asi nikdo nepochybuje, nelze toti¾ vytvoøit nic jiného ne¾
permutaci~(1).

Nyní doká¾eme indukèní krok. Pøedpokládáme tedy, ¾e 
poèet rùzných permutací $n$ prvkù je roven èíslu $n!$ a doká¾eme,
¾e poèet rùzných permutací $n+1$ prvkù je roven èíslu $(n+1)!\,$.
Prozkoumejme nejprve, kolik existuje permutací $n+1$ prvkù, které
mají v~první slo¾ce zapsáno èíslo~1. Je jich $n!$, proto¾e zbylých
$n$ slo¾ek mù¾eme zaplnit èísly $\{2,3,\ldots,n,n+1\}$ a máme v~tomto
pøípadì stejné mno¾ství mo¾ností, jako je poèet permutací 
$n$ prvkù. Tìch je podle indukèního pøedpokladu $n!\,$. 
Ze stejného dùvodu existuje $n!$ rùzných permutací $n+1$ prvkù,
které mají v~první slo¾ce zapsáno èíslo~2. Toté¾ platí pro èísla 
$3,4,\ldots,n,n+1$ v~první slo¾ce permutace. Existuje tedy 
$(n+1)\cdot n! = (n+1)!$ rùzných permutací $n+1$ prvkù. 

\priklad [ukazkaperm]
%%%%%%%%
Uvedeme si v¹echny permutace tøí prvkù. Podle 
vìty\cite[pocetperm] je jejich poèet roven ¹esti. Hledané permutace
jsou:
$$
 (1,2,3),\quad (1,3,2),\quad (2,1,3),\quad (2,3,1),\quad (3,1,2),\quad (3,2,1).
$$
Zkusíme je¹tì zapsat v¹echny permutace ètyø prvkù. Je jich~24.
$$\displaylines{
 (1,2,3,4),\enskip (1,2,4,3),\enskip (1,3,2,4),\enskip (1,3,4,2),\enskip
 (1,4,2,3),\enskip (1,4,3,2),\enskip
 (2,1,3,4),\enskip (2,1,4,3),\cr     (2,3,1,4),\enskip (2,3,4,1),\enskip
 (2,4,1,3),\enskip (2,4,3,1),\enskip
 (3,2,1,4),\enskip (3,2,4,1),\enskip (3,1,2,4),\enskip (3,1,4,2),\cr
 (3,4,2,1),\enskip (3,4,1,2),\enskip
 (4,2,3,1),\enskip (4,2,1,3),\enskip (4,3,2,1),\enskip (4,3,1,2),\enskip
 (4,1,2,3),\enskip (4,1,3,2).\cr
}
$$
Kdybychom chtìli zapsat v¹echny permutace 50 prvkù, po pou¾ití
vìty\cite[pocetperm] bychom si to rychle rozmysleli. Tìch permutací
toti¾ je pøibli¾nì $3\cdot10^{64}$. Kdyby se nám na jeden øádek ve¹la
jedna permutace a na stránku 60 øádkù, spotøebovali bychom
$5\cdot10^{62}$ stránek. Pøi oboustranném tisku vá¾í 500 stránek asi
jeden kilogram, tak¾e bychom spotøebovali $10^{57}$ tun papíru. Kdyby
tisk jedné stránky trval vteøinu, strávili bychom u~tiskárny
zhruba $10^{55}$ let. Jistì uznáte, ¾e to daleko pøesahuje ve¹keré
lidské mo¾nosti.

\definice [invp]
%%%%%%%%%
Nech» $(i_1,i_2,\ldots,i_n)$ je permutace $n$ prvkù. {\em Inverze} 
této permutace je taková dvojice $(i_k,i_l)$, pro
kterou platí $i_k>i_l$, a pøitom $k<l$.
\inl[inverze: permutace]

\priklad [ukazkainverzi]
%%%%%%%%
Permutace $(1,2,3)$ nemá ¾ádnou inverzi. Permutace $(1,3,2)$ má jednu
inverzi, toti¾ dvojici $(3,2)$, pro kterou platí $3>2$. Jednotlivé
inverze jsou na následujících permutacích vyznaèeny oblouèkem
$$
  \let\braceru=\relax \let\bracelu=\relax 
  \def\o#1{\setbox0=
    \hbox{$\kern2pt\overbrace{\kern-2pt#1\kern-2pt}\kern2pt$}\ht0=2.1ex\box0}
  \def\to#1{\hbox{#1\rlap{\t{}}}}
  %
  (1,2,3),\quad (1,\o{3,2}), \quad
  (\o{2,1},3),\quad (\o{2,\o{3,1}}),\quad (\o{\o{3,1},2}),
  \quad (\o{\o{3,2},\kern-8pt\o{\kern8pt 1}}). 
$$
Jako cvièení doplòte oblouèky (tj. jednotlivé inverze) 
ke v¹em permutacím ètyø prvkù.

\okraj Znaménko permutace | Znamenko permutace

\definice [znper]
%%%%%%%%%
Pro ka¾dou permutaci $\pi=(i_1,\ldots,i_n)$ definujeme 
{\em znaménko permutace $\sgn\pi$} takto: 
$$
  \sgn\pi=\cases{+1& \quad\hbox{má-li $\pi$ sudý poèet inverzí} \cr 
                 -1& \quad\hbox{má-li $\pi$ lichý poèet inverzí}}
$$
\par\inl[znaménko: permutace, permutace: sudá, permutace: lichá]

\priklad
%%%%%%%%
Permutace z~pøíkladu\cite[ukazkainverzi] mají tato znaménka:
$$ \displaylines{
 \sgn(1,2,3)=+1,\quad \sgn(1,3,2)=-1,\quad \sgn(2,1,3)=-1,\cr
 \sgn(2,3,1)=+1,\quad \sgn(3,1,2)=+1,\quad \sgn(3,2,1)=-1.}
$$
Jako cvièení si rozmyslete, jak vypadají znaménka v¹ech 
permutací ètyø prvkù.

\veta [prohperm]
%%%%%
Prohození jediné dvojice prvkù v~permutaci zpùsobí zmìnu jejího
znaménka.

\dukaz
%%%%%%
Nech» $\pi=(\ldots,a,\ldots,b,\ldots)$ a
$\pi_1=(\ldots,b,\ldots,a,\ldots)$ jsou dvì permutace, které se li¹í
jen prohozením prvkù $a, b$. Uká¾eme, ¾e rozdíl poètu inverzí
permutací $\pi$ a $\pi_1$ je liché èíslo.

Inverze, ve kterých se nevyskytuje ani $a$, ani $b$, zùstávají v~obou
permutacích stejné. Tvoøí-li dvojice $(a,b)$ z~permutace $\pi$
inverzi, pak $(b,a)$ z~permutace $\pi_1$ inverzi netvoøí a naopak.
Zatím jsme tedy zjistili, ¾e se permutace $\pi$ a $\pi_1$ li¹í o~jednu
inverzi, co¾ je liché èíslo. Je¹tì prozkoumáme v¹echny inverze, ve
kterých vystupuje $a$ nebo $b$ s~nìjakým jiným prvkem. Uká¾eme, ¾e
pokud tam dojde ke zmìnì, pak jedinì o~sudý poèet inverzí.

Uva¾ujme nìjaký prvek $x$ s~men¹ím indexem, ne¾ indexy prvkù $a$ i $b$,
nìjaký prvek $y$ s~vìt¹ím indexem, ne¾ indexy prvkù $a$ i $b$ a nìjaký
prvek $z$, který má index mezi indexy $a$ a $b$. Názornì:
$$
  \pi=(\ldots,x,\ldots,a,\ldots,z,\ldots,b,\ldots,y,\ldots), \quad
  \pi_1=(\ldots,x,\ldots,b,\ldots,z,\ldots,a,\ldots,y,\ldots).
$$
Nemusejí v~ka¾dém pøípadì v¹echny tyto prvky existovat. Dal¹í rozbor
tedy provedeme jen tehdy, pokud pøíslu¹ný prvek existuje.
Zabývejme se nejprve prvky $x$ a $y$. Pøípadné inverze mezi 
prvky $(x,a)$, $(x,b)$, $(a,y)$ a $(b,y)$ zùstanou po prohození prvkù 
$a,b$ v~nezmìnìném stavu. Zajímavý je tedy jen prvek $z$.

Nech» nejprve $a<z<b$, tj.~v~permutaci $\pi$ netvoøí dvojice
$(a,z)$ ani $(z,b)$ inverzi. Pak v~permutaci $\pi_1$ vznikají dvì nové
inverze $(b,z)$ a $(z,a)$, a to je sudé èíslo. Nech» dále $b<z<a$,
pak v~permutaci $\pi$ máme dvì inverze, které v~permutaci $\pi_1$
zanikají. Probìhla rovnì¾ zmìna o~sudý poèet inverzí. Je¹tì mù¾e dojít
k~situaci $z<a$ a $z<b$. Pak v~permutaci $\pi$ dvojice $(a,z)$ tvoøí
inverzi a dvojice $(z,b)$ netvoøí, zatímco v~permutaci $\pi_1$ dvojice
$(b,z)$ tvoøí inverzi a dvojice $(z,a)$ netvoøí. Poèet inverzí se tedy
v~tomto pøípadì nezmìnil. Poslední pøípad $a<z$ a $b<z$ ovìøíme
podobnì, jako pøedchozí.

\definice [inverznip]
%%%%%%%%%
Nech» $\pi=(i_1,i_2,\ldots,i_n)$ je permutace $n$ prvkù. {\em
Inverzní permutací k~permutaci~$\pi$} je permutace 
$(j_1,j_2,\ldots,j_n)$, pro kterou platí $j_{i_k}=k$ pro v¹echna
$k\in\{1,2,\ldots,n\}$. Tuto permutaci oznaèujeme znakem~$\pi^{-1}$.
\inl[permutace: inverzní, inverzní: permutace]

\poznamka [inverzniperm]
%%%%%%%%%
Existuje nìkolik mo¾ností, jak si pøedstavit inverzní permutaci k~dané
permutaci. 

(1) Je-li v~permutaci $\pi$ na $x$-tém místì prvek $y$, pak
v~permutaci $\pi^{-1}$ musí být na $y$-tém místì prvek~$x$.

(2) Zapi¹me pod sebe permutaci $\pi$ a permutaci $(1,2,\ldots,n)$
takto:
$$
  \pmatrix{i_1&i_2&i_3&\ldots&i_n\cr 1&2&3&\ldots&n}
$$
a zamìòme poøadí sloupcù této matice tak, abychom v~prvním øádku mìli
vzestupnì èísla $(1,2,3,\ldots,n)$. Pak ve spodním øádku je zapsána
inverzní permutace k~permutaci $\pi$. Uva¾ujme kupøíkladu permutaci
$(3,4,2,6,1,5)$ a pi¹me:
$$
  \pmatrix{3&4&2&6&1&5\cr 1&2&3&4&5&6} \longrightarrow
  \pmatrix{1&2&3&4&5&6\cr 5&3&1&2&6&4}.
$$
Je tedy $(3,4,2,6,1,5)^{-1} = (5,3,1,2,6,4)$.

(3) Pøedstavme si ¹achovnici o~rozmìru $n\times n$ a rozestavme na 
ní~$n$ ¹achových vì¾í tak, aby se vzájemnì neohro¾ovaly. Takových
rozestavení mù¾e být více a ka¾dé rozestavení mù¾eme popsat 
jednoznaènì jako permutaci. V~ka¾dém øádku i sloupci toti¾ stojí
jediná vì¾ a my mù¾eme èíst rozestavení po øádcích takto: do první
slo¾ky permutace napí¹eme èíslo sloupce, na kterém stojí vì¾ z~prvního
øádku, do druhé slo¾ky èíslo sloupce, na které stojí vì¾ z~druhého
øádku atd. Dostáváme tak permutaci $\pi$. Pokud nyní èteme toté¾
rozestavení po sloupcích, tj. do první slo¾ky permutace napí¹eme èíslo
øádku vì¾e z~prvního sloupce, do druhé slo¾ky èíslo øádku vì¾e 
z~druhého sloupce atd., dostáváme permutaci $\pi^{-1}$.

(4) Permutace $(i_1,i_2,\ldots,i_n)$ vymezuje zobrazení 
$\pi: \{1,2,\ldots,n\}\to\{1,2,\ldots,n\}$, pro které platí $\pi(k)=i_k$.
Toto zobrazení je zjevnì prosté a na mno¾inu $\{1,2,\ldots,n\}$.
Inverzní zobrazení $\pi^{-1}$ pak vymezuje inverzní permutaci.
Platí $\pi\circ\pi^{-1}=\i$, kde $\i$ je identické zobrazení.


\veta [inverzeinverzi]
%%%%%
Nech» $\pi$ je permutace $n$ prvkù. Pak $\pi^{-1}$ má stejný poèet
inverzí, jako $\pi$.
\inl[inverze: permutace, inverzní: permutace, permutace: inverzní]

\dukaz
%%%%%%
Pro názornost si pøedstavíme inverzní permutaci zpùsobem (2)
z~poznámky\cite[inverzniperm]. Zamìøme se na dva sloupce uvedené
dvouøádkové matice pøed prohozením sloupcù:
$$
  \pmatrix{\ldots,&x,&\ldots,&y,&\ldots\cr
           \ldots,&a,&\ldots,&b,&\ldots}.
$$
Proto¾e jde o~stav pøed prohozením sloupcù, víme, ¾e $a<b$.
Pokud $x<y$, tj. $(x,y)$ netvoøí inverzi v~permutaci $\pi$, 
zùstanou po prohození sloupcù tyto dva sloupce za sebou ve 
stejném poøadí. Tak¾e se nová inverze v~permutaci $\pi^{-1}$ 
nevytvoøí. Pokud ale $x>y$, tj. $(x,y)$ tvoøí inverzi 
v~permutaci $\pi$, pak po prohození sloupcù budou tyto dva sloupce 
v~opaèném poøadí. Dvojice prvkù $(b,a)$ tedy bude tvoøit inverzi 
v~permutaci $\pi^{-1}$.

\veta [znpi-1]
%%%%%
Permutace $\pi$ a $\pi^{-1}$ mají v¾dy stejná znaménka.

\dukaz
%%%%%%
Vìta je pøímým dùsledkem vìty\cite[inverzeinverzi].

\poznamka
%%%%%%%%%
V~pøedchozích definicích a vìtách jsme si øekli minimum toho, co
potøebujeme vìdìt o~permutacích, abychom pochopili definici
determinantu a odvodili jednoduché vlastnosti determinantu.
Ve skuteènosti se u~permutací dá studovat je¹tì mnoho dal¹ích
vlastností, které zde nebudeme potøebovat.

\okraj Definice\hb determi\-nantu | Definice determinantu

\definice* [ddet]
%%%%%%%%%
Nech» $\A=(a_{i,j})\in\R^{n,n}$ je ètvercová matice. Èíslo
$$
  \sum_{\pi=(i_1,i_2,\ldots,i_n)} 
  \sgn\pi\cdot a_{1,i_1}\,a_{2,i_2}\cdots\,a_{n,i_n}
  \rce(vdetA)
$$
nazýváme {\em determinantem matice $\A$} a znaèíme je $\det\A$.
V~uvedeném vzorci se sèítá pøes v¹echny permutace $n$ prvkù, tj. jedná
se podle vìty\cite[pocetperm] o~$n!$ sèítancù.
\inl[determinant, detA]

\poznamka
%%%%%%%%%
Je mo¾né, ¾e vzorec z~definice\cite[ddet] je pro nìkteré ètenáøe málo
srozumitelný. Pokusíme se jej proto v~této poznámce trochu vysvìtlit
a zlid¹tit.

Pøedstavme si ètvercovou matici jako ¹achovnici rozmìru $n\times n$ a
pokusme se na ni rozmístit $n$ ¹achových vì¾í tak, aby se vzájemnì
neohro¾ovaly. Podle poznámky\cite[inverzniperm], odst.~(3) je mo¾né
ka¾dé takové rozmístìní popsat jednou permutací 
(pozice vì¾í èteme po øádcích). Podle
vìty\cite[pocetperm] vidíme, ¾e existuje $n!$ rùzných permutací, tedy
existuje $n!$ rùzných øe¹ení této ¹achové úlohy. 
Pro ka¾dé øe¹ení této
úlohy zapí¹eme odpovídající permutaci,
zjistíme znaménko této permutace, nadzvedneme vì¾ièky a zapí¹eme si
hodnoty prvkù, na kterých ty figurky stojí, vynásobíme tyto hodnoty
mezi sebou a výsledek je¹tì násobíme znaménkem permutace. Pak si tento
výsledek ulo¾íme do pamìti. A¾ projdeme v¹ech $n!$ mo¾ností
rozmístìní vì¾í, získáme v~pamìti $n!$ sèítancù a ty
seèteme. Výsledkem je determinant matice.

\priklad [sarrus]
%%%%%%%%
Hledejme determinant matice z $\R^{3,3}$ tvaru
$$
  \A =  \pmatrix{a_{1,1}&a_{1,2}&a_{1,3}\cr 
        a_{2,1}&a_{2,2}&a_{2,3}\cr a_{3,1}&a_{3,2}&a_{3,3}}.
$$
Podle vzorce z~definice\cite[ddet] budeme sèítat pøes v¹echny
permutace tøí prvkù. Tìch je podle vìty\cite[pocetperm] $3!=6$.
Zapí¹eme v¹echny tyto permutace, jejich znaménka a odpovídající
rozmístìní \uv{¹achových vì¾í}.
$$
  \font\bigO=cmsy10 scaled\magstep4 
  \def\o#1{{\ooalign{\hfil\hbox{$#1$}\hfil\crcr
     \raise-.8ex\hbox{\bigO\char"0D}}}}
  \displaylines{
  \pi=(1,2,3),\quad \sgn\pi=+1, \quad  
     \pmatrix{\o{a_{1,1}}&a_{1,2}&a_{1,3}\cr 
     a_{2,1}&\o{a_{2,2}}&a_{2,3}\cr a_{3,1}&a_{3,2}&\o{a_{3,3}}}, \quad
     \hbox{sèítanec:}\quad + a_{1,1}\cdot a_{2,2}\cdot a_{3,3}. \cr
  \pi=(2,3,1),\quad \sgn\pi=+1, \quad  
     \pmatrix{a_{1,1}&\o{a_{1,2}}&a_{1,3}\cr 
     a_{2,1}&a_{2,2}&\o{a_{2,3}}\cr \o{a_{3,1}}&a_{3,2}&a_{3,3}}, \quad
     \hbox{sèítanec:}\quad + a_{1,2}\cdot a_{2,3}\cdot a_{3,1}. \cr
  \pi=(3,1,2),\quad \sgn\pi=+1, \quad  
     \pmatrix{a_{1,1}&a_{1,2}&\o{a_{1,3}}\cr 
     \o{a_{2,1}}&a_{2,2}&a_{2,3}\cr a_{3,1}&\o{a_{3,2}}&a_{3,3}}, \quad
     \hbox{sèítanec:}\quad + a_{1,3}\cdot a_{2,1}\cdot a_{3,2}. \cr
  \pi=(3,2,1),\quad \sgn\pi=-1, \quad  
     \pmatrix{a_{1,1}&a_{1,2}&\o{a_{1,3}}\cr 
     a_{2,1}&\o{a_{2,2}}&a_{2,3}\cr \o{a_{3,1}}&a_{3,2}&a_{3,3}}, \quad
     \hbox{sèítanec:}\quad - a_{1,3}\cdot a_{2,2}\cdot a_{3,1}. \cr
  \pi=(2,1,3),\quad \sgn\pi=-1, \quad  
     \pmatrix{a_{1,1}&\o{a_{1,2}}&a_{1,3}\cr 
     \o{a_{2,1}}&a_{2,2}&a_{2,3}\cr a_{3,1}&a_{3,2}&\o{a_{3,3}}}, \quad
     \hbox{sèítanec:}\quad - a_{1,2}\cdot a_{2,1}\cdot a_{3,3}. \cr
  \pi=(1,3,2),\quad \sgn\pi=-1, \quad  
     \pmatrix{\o{a_{1,1}}&a_{1,2}&a_{1,3}\cr 
     a_{2,1}&a_{2,2}&\o{a_{2,3}}\cr a_{3,1}&\o{a_{3,2}}&a_{3,3}}, \quad
     \hbox{sèítanec:}\quad - a_{1,1}\cdot a_{2,3}\cdot a_{3,2}. \cr
  \let\cdot=\,
  \det\A =   a_{1,1}\cdot a_{2,2}\cdot a_{3,3} 
           + a_{1,2}\cdot a_{2,3}\cdot a_{3,1}
           + a_{1,3}\cdot a_{2,1}\cdot a_{3,2}
           - a_{1,3}\cdot a_{2,2}\cdot a_{3,1}
           - a_{1,2}\cdot a_{2,1}\cdot a_{3,3}
           - a_{1,1}\cdot a_{2,3}\cdot a_{3,2}.
}
$$  
Tento vzorec se dá zapamatovat pomocí mnemotechnické pomùcky: nejprve
násobíme prvky na hlavní diagonále, dále ve smìrech rovnobì¾ných s~hlavní
diagonálou a souèiny sèítáme. Pak násobíme prvky na vedlej¹í
diagonále, dále ve smìrech
rovnobì¾ných s~vedlej¹í diagonálou, pøièem¾ tyto souèiny odeèítáme. 
Této \uv{pouèce o~diagonálách},
která je pou¾itelná jen pro matice typu $(3,3)$, øíkáme
{\em Sarrusovo pravidlo}.
Toto populární pravidlo tedy není nic jiného ne¾ rozepsání definice
determinantu pro matice z~$\R^{3,3}$.
\inl[pravidlo: Sarrusovo, Sarrusovo: pravidlo]

Pro matici typu $(4,4)$ bychom dostali pøi výpoètu determinantu podle
definice $4!=24$ sèítancù. Pro takovou matici se u¾ tì¾ko hledají
mnemotechnické pomùcky. Má-li ètenáø èas a místo na papíøe, mù¾e se
pokusit sestavit v¹echny permutace ètyø prvkù, najít jejich znaménka a
seèíst odpovídající souèiny. Pokud ètenáø nemá èas nebo místo na
papíøe, udìlá nejlíp, kdy¾ si poèká na dal¹í metodu na poèítání
determinantù, která bude vy¾adovat daleko ménì poèetních úkonù.
Na druhé stranì rozepsání vzorce pro determinant matice typu $(4,4)$
je u¾iteèné cvièení pro pochopení definice determinantu.

\priklad [krizdet]
%%%%%%%%
Podobnì, jako v~pøedchozím pøíkladì, odvodíme vzorec pro výpoèet
determinantu matice z~$\R^{2,2}$.
$$
  \font\bigO=cmsy10 scaled\magstep4 
  \def\o#1{{\ooalign{\hfil\hbox{$#1$}\hfil\crcr
     \raise-.8ex\hbox{\bigO\char"0D}}}}
\displaylines{
  \pi=(1,2),\quad \sgn\pi=+1, \quad  
     \pmatrix{\o{a_{1,1}}&a_{1,2}\cr 
     a_{2,1}&\o{a_{2,2}}}, \quad
  \pi=(2,1),\quad \sgn\pi=-1, \quad  
     \pmatrix{a_{1,1}&\o{a_{1,2}}\cr 
     \o{a_{2,1}}&a_{2,2}}, \cr
  \det\A = a_{1,1}\cdot a_{2,2} - a_{1,2}\cdot a_{2,1}.}
$$
Pro úplnost uvedeme je¹tì hodnotu determinantu matice $\A=(a_{1,1})$ 
typu $(1,1)$. Zøejmì je $\det\A=a_{1,1}$.

\definice [diagonala]
%%%%%%%%%
Nech» $\A=(a_{i,j})\in\R^{n,n}$ je ètvercová matice. {\em Hlavní diagonála
matice $\A$} je skupina jejích prvkù 
$a_{1,1}, a_{2,2}, \ldots, a_{n,n}$.
{\em Vedlej¹í diagonála matice $\A$} zahrnuje prvky
$a_{1,n}, a_{2,n-1}, \ldots, a_{n,1}$. {\em Prvek pod hlavní
diagonálou} je ka¾dý prvek $a_{i,j}$, pro který platí $i>j$.
{\em Prvek nad hlavní diagonálou} je ka¾dý prvek $a_{i,j}$, pro který
platí $i<j$.
\inl[diagonála: matice: hlavní, hlavní: diagonála: matice]
\inl[diagonála: matice: vedlej¹í, vedlej¹í: diagonála: matice]
\inl[prvek: nad diagonálou]

\priklad [dettrojmatice]
%%%%%%%%
Nech» matice $\A\in\R^{n,n}$ má pod hlavní diagonálou jen nulové
prvky. Matice tedy názornì vypadá takto:
$$
  \A = \pmatrix{a_{1,1}, & a_{1,2}, &\ldots, & a_{1,n-1}, & a_{1,n} \cr
                      0, & a_{2,2}, &\ldots, & a_{2,n-1}, & a_{2,n} \cr
                      0, &       0, &\ldots, & a_{3,n-1}, & a_{3,n} \cr
                         &          &\vdots  & & \cr
                      0, &       0, &\ldots, &         0, & a_{n,n} \cr}.
\rce(trojmatice)
$$
Zkusíme spoèítat $\det\A$.

V~definici determinantu\cite[ddet] se pracuje se souètem souèinù 
$\sgn\pi\cdot a_{1,i_1}\cdot a_{2,i_2}\cdots a_{n,i_n}$. 
Pokud aspoò jeden z~tìchto èinitelù je nulový, je nulový celý 
souèin. V~celkovém souètu nás zajímají jen nenulové
souèiny. Prozkoumejme, které to jsou. Z~posledního øádku musíme vzít
jen prvek $a_{n,n}$, proto¾e v¹echny ostatní prvky v~posledním øádku 
jsou nulové. Z~pøedposledního øádku mù¾eme vzít jen prvek 
$a_{n-1,n-1}$, proto¾e ostatní jsou nulové. Prvek $a_{n-1,n}$ nelze
do souèinu zahrnout, proto¾e z~posledního sloupce u¾ v~souèinu máme
prvek $a_{n,n}$ (vì¾e by se vzájemnì ohro¾ovaly). 
Analogickou úvahou zahrneme do souèinu prvky
$a_{n-2,n-2},\ldots,a_{2,2},a_{1,1}$. Není tedy jiná mo¾nost 
nenulového souèinu, ne¾ souèin 
$a_{1,1}\cdot a_{2,2}\cdots a_{n,n}$. Ten odpovídá permutaci
$(1,2,\ldots,n)$, která nemá ¾ádnou inverzi a její znaménko je 
tedy~$+1$. Ostatní sèítanci z~definice determinantu jsou
nuloví. Proto 
$\det\A = a_{1,1}\cdot a_{2,2}\cdot a_{3,3}\cdots a_{n,n}$.

\okraj Základní vlastnosti | Zakladni vlastnosti

\veta* [zvdet]
%%%%%
Základní vlastnosti determinantu.

\noindent
(V1) Jestli¾e se matice $\B$ li¹í od matice $\A$ jen prohozením jedné
dvojice øádkù, pak $\det\B=-\det\A$.

\noindent
(V2) Jestli¾e matice $\A$ má dva stejné øádky, pak $\det\A=0$.

\noindent
V~dal¹ích vlastnostech (V3) a¾ (V5) oznaèujeme symbolem 
$\pmatrix{\vdots\cr\vec a_i\cr\vdots}$ matice, které se li¹í
pouze v~$i$-tém øádku, zde oznaèeném $\vec a_i$. V~øádcích, které 
jsou vyznaèeny teèkami, se jednotlivé matice shodují. 
$$\eqalign{
\bod (V3) \det\pmatrix{\vdots\cr\alpha\,\vec a_i\cr\vdots} =
          \alpha\,\det\pmatrix{\vdots\cr\vec a_i\cr\vdots}. \cr
\bod (V4) \det\pmatrix{\vdots\cr\vec a_i\cr\vdots} + 
          \det\pmatrix{\vdots\cr\vec b_i\cr\vdots} =
          \det\pmatrix{\vdots\cr\vec a_i+\vec b_i\cr\vdots}. \cr
\bod (V5) \det\pmatrix{\vdots\cr\vec a_i+\alpha\,\vec a_j\cr\vdots} =
          \det\pmatrix{\vdots\cr\vec a_i\cr\vdots}, \quad 
          \hbox{kde $\vec a_j$ je nìjaký jiný øádek té¾e matice}.
}
$$

\dukaz
%%%%%%
(V1) Souèin $a_{1,i_1}\cdots a_{n,i_n}$ odpovídá 
ve vzorci pro výpoèet $\det\A$ permutaci $\pi=(i_1,i_2,\ldots,i_n)$. 
Tentý¾ souèin najdeme i ve vzorci pro výpoèet $\det\B$, pouze 
bude odpovídat permutaci $\pi'$, která
vznikne z~permutace $\pi$ pøehozením dvou prvkù. To podle 
vìty\cite[prohperm] znamená, ¾e $\sgn\pi'=-\sgn\pi$. V~ka¾dém z~$n!$
sèítancù pro výpoèet $\det\B$ tedy máme opaèné znaménko, ne¾ ve 
sèítancích pro výpoèet $\det\A$. Musí tedy být $\det\B=-\det\A$.

(V2) Prohodíme-li v~matici $\A$ mezi sebou dva stejné øádky, dostáváme
zase matici $\A$. Podle~(V1) pro tuto matici platí $\det\A=-\det\A$,
co¾ nemù¾e být splnìno jinak, ne¾ ¾e $\det\A=0$.

Vlastnosti (V3) a (V4) plynou pøímo z~definice determinantu:
$$\eqalign{
\bod (V3)  \sum
  \sgn\pi\,
  a_{1,j_1}\,a_{2,j_2}\cdots(\alpha\,a_{i,j_i})\,a_{i+1,j_{i+1}}\cdots
  a_{n,j_n} = 
  \alpha\,\sum
  \sgn\pi\,
  a_{1,j_1}\,a_{2,j_2}\cdots a_{i,j_i}\,a_{i+1,j_{i+1}}\cdots
  a_{n,j_n}. \cr
\bod (V4)  \sum
  \sgn\pi\,
  a_{1,j_1}\,a_{2,j_2}\cdots(a_{i,j_i}+b_{i,j_i})\,a_{i+1,j_{i+1}}\cdots 
  a_{n,j_n} = \cr
  & \quad  = \sum
  \sgn\pi\,
  a_{1,j_1}\,a_{2,j_2}\cdots a_{i,j_i}\,a_{i+1,j_{i+1}}\cdots a_{n,j_n} +
  \sum
  \sgn\pi\,
  a_{1,j_1}\,a_{2,j_2}\cdots b_{i,j_i}\,a_{i+1,j_{i+1}}\cdots
  a_{n,j_n}. \cr
}
$$
(V5) doká¾eme pou¾itím právì dokázaných vlastností:
$$\let\quad=\enskip
  \det\pmatrix{\vdots\cr\vec a_j\cr\vdots\cr\vec a_i + 
  \alpha\,\vec a_j\cr\vdots} 
  \quad\buildrel({\rm V4})\over= \quad
  \det\pmatrix{\vdots\cr\vec a_j\cr\vdots\cr\vec a_i\cr\vdots} +
  \det\pmatrix{\vdots\cr\vec a_j\cr\vdots\cr\vec \alpha\,\vec a_j\cr\vdots} 
  \quad\buildrel({\rm V3})\over= \quad
  \det\pmatrix{\vdots\cr\vec a_j\cr\vdots\cr\vec a_i\cr\vdots} +
  \alpha\,\det\pmatrix{\vdots\cr\vec a_j\cr\vdots\cr \vec a_j\cr\vdots} 
  \quad\buildrel({\rm V2})\over= \quad
  \det\pmatrix{\vdots\cr\vec a_j\cr\vdots\cr\vec a_i\cr\vdots}.
$$

\okraj Metoda poèítání determinantu | Metoda pocitani determinantu

\poznamka [metodadet]
%%%%%%%%%
Vlastnosti (V1), (V3) a (V5) nám ukazují, jak se zmìní
determinant, zmìníme-li matici pomocí Gaussovy eliminaèní
metody. Prohození øádkù zmìní znaménko, vynásobení øádku nenulovým
èíslem $\alpha$ zpùsobí, ¾e se determinant $\alpha$-krát zvìt¹í a
koneènì pøiètení $\alpha$-násobku jiného øádku ke zvolenému øádku
nezmìní hodnotu determinantu. Jsme tedy schopni upravovat matice
Gaussovou eliminaèní metodou, a pøitom si poznamenávat, jak se mìní 
determinant. Tím mù¾eme pøevést matici na tvar\cite(trojmatice).
O~této matici víme, ¾e má determinant roven souèinu prvkù 
na hlavní diagonále.

Uvìdomme si, ¾e tato metoda dává výraznou úsporu èasu a výpoèetních
prostøedkù pøi poèítání determinantù. Pøedstavme si, ¾e poèítáme
determinant matice typu $(n,n)$. Pøi Gaussovì eliminaèní metodì
potøebujeme zhruba $n$ operací na výrobu jednoho nulového prvku.
Tìch nul potøebujeme vytvoøit zhruba $n^2/2$, tak¾e k~výpoètu
determinantu nám staèí $n^3/2$ operací. Pro matici typu $(50,50)$ 
to je zhruba $62\,500$ operací. Pokud bychom chtìli poèítat 
determinant stejnì velké matice pøímo z~definice, potøebovali 
bychom na to $50\cdot3\cdot10^{64}$ operací (viz komentáø 
v~pøíkladu\cite[ukazkaperm]). Není
v~silách ¾ádné výpoèetní techniky spoèítat to v~rozumném èase.
\inl[metoda: poèítání: determinantu]

\priklad [elimdet]
%%%%%%%%
Právì popsanou metodou spoèítáme determinant matice
$$
  \catcode`+=13 \def+{\hphantom{-}}
  \A = \pmatrix{1&+2&+4&-1\cr2&+1&+2&+2\cr1&+3&+1&+2\cr2&+1&+2&+1}.
$$
V~literatuøe se pro $\det\A$ èasto pou¾ívá znaèení $|\A|$. Ní¾e tedy
zapisujeme prvky jednotlivých matic mezi svislé èáry a tím dáváme na
jevo, ¾e poèítáme determinant.
$$
  \catcode`+=13 \def+{\hphantom{-}} \def\0{\hphantom{0}}
  \def\dmatrix#1{\left|\matrix{#1}\right|}
  \displaylines{
  \dmatrix{1&+2&+4&-1\cr2&+1&+2&+2\cr1&+3&+1&+2\cr2&+1&+2&+1}
  \buildrel (1)\over=
  \dmatrix{1&+2&+4&-1\cr0&-3&-6&+4\cr0&+1&-3&+3\cr0&-3&-6&+3} 
  \buildrel (2)\over=
  - \dmatrix{1&+2&+4&-1\cr0&+1&-3&+3\cr0&-3&-6&+4\cr0&-3&-6&+3}
  \buildrel (3)\over= 
  - \dmatrix{1&+2&+4&-1\cr0&+1&-3&+3\cr0&+0&-15&\013\cr0&+0&-15&\012}
  \buildrel (4)\over= \cr \buildrel (4)\over=
  - \dmatrix{1&+2&+4&-1\cr0&+1&-3&+3\cr0&+0&-15&\013\cr0&+0&+0&-1} =
  -(-15)\cdot(-1) = -15.
}
$$
V~kroku (1) jsme první øádek násobili $-2$ a pøièítali k~druhému, pak
jsme první øádek násobili $-1$ a pøièítali k~tøetímu a nakonec jsme
první øádek násobili $-2$ a pøièítali ke ètvrtému. Tyto operace 
podle~(V5) nemìní hodnotu determinantu. V~kroku~(2) jsme prohodili druhý
øádek se tøetím, co¾ podle~(V1) zmìní znaménko determinantu. Napsali
jsme toto znaménko pøed determinant modifikované matice. 
V~kroku~(3) jsme druhý øádek
násobili tøemi a pøièetli ke tøetímu a ètvrtému. To podle~(V5) nemìní
hodnotu determinantu. Koneènì v~kroku~(4) jsme tøetí øádek násobili
$-1$ a pøièetli ke ètvrtému. Tím dostáváme matici 
tvaru\cite(trojmatice) z~pøíkladu\cite[dettrojmatice],
o~které víme, ¾e má determinant roven souèinu
prvkù na diagonále.

Upozoròujeme na èastou zaèáteènickou chybu pøi poèítání
determinantù. V~Gaussovì eliminaèní metodì se vìt¹inou neklade dùraz
na to, který øádek od kterého odeèítáme, proto¾e výsledný øádek mù¾eme
kdykoli pozdìji násobit èíslem $-1$. Pøi poèítání determinantù to ale
jedno není. Napøíklad v~kroku (1) jsme od druhého øádku odeèítali
dvojnásobek prvního a výsledek psali na druhý øádek. Kdybychom od 
dvojnásobku prvního øádku odeèítali druhý a výsledek psali do druhého
øádku, dopustili bychom se chyby, která nám zmìní znaménko
determinantu. Mnemotechnická pomùcka: pí¹eme-li výsledek souètu 
na $i$-tý øádek, pak $i$-tý øádek pùvodní matice nesmí být v~souètu
násoben ¾ádnou konstantou. Ostatní øádky mohou být násobeny libovolnou
konstantou a pøièítány k~tomuto øádku. Je tøeba si tedy uvìdomit, ¾e
\uv{pøiètení násobku øádku~$\vec a$ k øádku $\vec b$} (korektní krok) 
není toté¾, jako \uv{pøiètení øádku $\vec a$ k násobku øádku $\vec b$}
(nekorektní krok).

\priklad
%%%%%%%%
Jednotková matice má determinant roven jedné. Jednotková matice je
toti¾ tvaru\cite(trojmatice), tak¾e staèí pronásobit prvky na
diagonále. 

\priklad
%%%%%%%%
Nech» $\A\in\R^{n,n}$ má prvky na vedlej¹í
diagonále rovny jedné a ostatní prvky jsou nulové. Spoèítáme její
determinant.

Prohodíme první øádek s posledním, druhý s pøedposledním atd. a¾ se
dostaneme k prostøednímu øádku. Pro liché $n$ necháváme prostøední
øádek na místì, pro sudé $n$ prohodíme naposled mezi sebou øádky
$n/2$ a $n/2+1$. V obou pøípadech jsme udìlali $[n/2]$
prohození (symbolem $[x]$ zde znaèíme celou èást z $x$). Matici $\A$
jsme tìmito úpravami pøevedli na jednotkovou matici $\E$. Podle
pøedchozího pøíkladu je $\det\E=1$, tak¾e podle vlastnosti~(V1) 
z~vìty\cite[zvdet] je $\det\A=(-1)^{[n/2]}\det\E = (-1)^{[n/2]}$.

\priklad
%%%%%%%%
Nech» $\A\in\R^{n,n}$ má nad vedlej¹í diagonálou
nulové prvky. Spoèítáme její determinant.

Prohazováním øádkù, stejnì jako v pøedchozím pøíkladì, pøevedeme
matici na tvar\cite(trojmatice). Prvky z~vedlej¹í diagonály se pøi
tìchto úpravách pøestìhují na hlavní diagonálu. Determinant takto
upravené matice je podle pøíkladu\cite[dettrojmatice] roven souèinu
prvkù na diagonále, tak¾e máme 
$\det\A=(-1)^{[n/2]}a_{1,n}\,a_{2,n-1}\cdots a_{n,1}$.

\veta [reguldet]
%%%%%
Ètvercová matice $\A$ je regulární právì tehdy, kdy¾ $\det\A\not=0$.

\dukaz
%%%%%%
V¹imneme si nejprve, ¾e Gaussova eliminaèní metoda realizovaná kroky
(V1), (V3) a (V5) podle pøedchozí vìty\cite[zvdet] nemìní
\uv{nulovost} determinantu. Pøesnìji, je-li $\A\sim\B$, pak
$\det\A\not=0$ právì tehdy kdy¾ $\det\B\not=0$.

Je-li matice $\A$ regulární je podle vìty\cite[hodreg]
$\hod\A=n$. Po úpravì Gaussovou eliminaèní
metodou na matici $\B$ tvaru\cite(trojmatice) musejí být v¹echny 
prvky na diagonále nenulové, proto¾e 
podle vìty\cite[hodAB] je také
$\hod\B=n$.
To znamená, ¾e $\det\B\not=0$ a tedy i
$\det\A\not=0$. 

Je-li matice $\A$ singulární, je $\hod\A<n$. Po úpravì 
Gaussovou eliminaèní metodou na matici 
$\B$ tvaru\cite(trojmatice) bude existovat 
aspoò jeden øádek v~matici $\B$ celý
nulový. Nulový je tedy i diagonální prvek, tak¾e $\det\B=0$.
Podle pøedchozího nutnì musí být $\det\A=0$.

\veta* [det=detT]
%%%%%
Nech» $\A$ je ètvercová matice. Pak $\det\A=\det\A^T$.

\dukaz
Souèinu $a_{1,i_1}\, a_{2,i_2}\cdots a_{n,i_n}$ ze 
vzorce\cite(vdetA) pro
$\det\A$ odpovídá permutace $\pi=(i_1,i_2,\ldots,i_n)$. 
Uspoøádáme èinitele tohoto
souèinu podle velikosti druhého indexu a dostaneme
$a_{j_1,1}\, a_{j_2,2}\cdots a_{j_n,n}$, kde pro permutaci
$\pi_1=(j_1,j_2,\ldots,j_n)$ platí $\pi_1=\pi^{-1}$. Právì takové
souèiny se objevují ve vzorci pro $\det\A^T$. Vidíme tedy, ¾e oba vzorce
$\det\A$ i $\det\A^T$ obsahují sumu stejných souèinù, pouze permutace
odpovídajících souèinù je v~prvním pøípadì $\pi$ a v~druhém
$\pi^{-1}$. Tyto permutace mají podle vìty\cite[inverzeinverzi] stejný
poèet inverzí, tak¾e i stejné znaménko. Musí tedy být $\det\A=\det\A^T$.
\inl[matice: transponovaná, transponovaná: matice]

\poznamka
%%%%%%%%%
Z~právì dokázané vìty plyne, ¾e vlastnosti vyjmenované ve 
vìtì\cite[zvdet] platí nejen pro øádky matice, ale té¾ pro
sloupce. Pøi poèítání determinantu podle metody popsané 
v~poznámce\cite[metodadet] mù¾eme tedy svobodnì pøecházet od øádkových
úprav ke sloupcovým a zpìt, proto¾e vlastnosti (V1), (V3) a (V5)
vìty\cite[zvdet] platí nejen pro øádky, ale i pro sloupce
(tzv. øádkovì-sloupcová dualita).
\inl[dualita: øádkovì-sloupcová]

\okraj Rozvoj determinantu | Rozvoj determinantu

\veta (o~rozvoji determinantu podle $r$-tého øádku) * [rozvojdet]
%%%%%
Nech» $\A=(a_{r,s})\in\R^{n,n}$ je ètvercová matice 
a $\A_{i,j}\in\R^{n-1,n-1}$ jsou matice,
které vzniknou z~matice $\A$ vynecháním $i$-tého 
øádku a $j$-tého sloupce. Pak pro ka¾dé $r\in\{1,\ldots,n\}$
platí
$$
  a_{r,1}\,(-1)^{r+1}\det\A_{r,1} + a_{r,2}\,(-1)^{r+2}\,\det\A_{r,2} 
  + \cdots + a_{r,n}\,(-1)^{r+n}\det\A_{r,n} 
  = \det\A.
  \rce(rozvojkk)
$$
Je-li dále $t\in\{1,\ldots,n\}$, $t\not=r$, pak platí
$$
  a_{r,1}\,(-1)^{t+1}\det\A_{t,1} + a_{r,2}\,(-1)^{t+2}\det\A_{t,2} 
  + \cdots + a_{r,n}\,(-1)^{t+n}\det\A_{t,n} 
  = 0.
  \rce(rozvojkl)
$$
\par\inl[determinant: rozvoj, rozvoj: determinantu]
\inl[vìta: o rozvoji determinantu]

\exdukaz
%%%%%%%%
Podívejme se na vzorec\cite(vdetA) pro $\det\A$.
Seskupíme v~nìm v¹echny sèítance, které obsahují prvek
$a_{1,1}$ k~sobì, dále seskupíme k~sobì sèítance, které obsahují prvek
$a_{1,2}$ a tak dále a¾ po poslední skupinu, ve které se vyskytují
sèítanci s~prvkem $a_{1,n}$. Tyto prvky ze souètù vytkneme. 
Pro $s$-tou skupinu sèítancù tedy máme:
$$
  \sum_{\pi=(s,i_2,\ldots,i_n)} 
   \sgn\pi\cdot a_{1,s}\,a_{2,i_2}\cdots a_{n,i_n} =
  a_{1,s}\left(\sum_{\pi=(s,i_2,\ldots,i_n)} 
   \sgn\pi\cdot a_{2,i_2}\cdots a_{n,i_n}\right) = \ast
$$
Z~permutace $\pi=(s,i_2,\ldots,i_n)$ prvkù mno¾iny 
$M=\{1,2,\ldots,n\}$ vytvoøme permutaci $\pi'=(i_2,\ldots,i_n)$
prvkù mno¾iny $M\setminus\{s\}$ tak, ¾e odebereme první prvek 
z~permutace~$\pi$. Nová permutace $\pi'$ má o~$s-1$ ménì inverzí
ne¾ permutace $\pi$. (Nakreslete si v¹echny inverze spojené s~prvkem
$s$.) Pro znaménka permutací tedy platí
$\sgn\pi=(-1)^{s-1}\sgn\pi'=(-1)^{s+1}\sgn\pi'$. Pokraèujme nyní dále
v~na¹em výpoètu:
$$
  \ast =
   a_{1,s}\,(-1)^{1+s}\left(\sum_{\pi'=(i_2,\ldots,i_n)} 
   \sgn\pi'\cdot a_{2,i_2}\cdots a_{n,i_n}\right) = 
   a_{1,s}\,(-1)^{1+s} \det\A_{1,s}.
$$
Determinant $\A$ je souètem v¹ech skupin sèítancù pro $s=1,2,\ldots,n$, co¾
dokazuje vzorec\cite(rozvojkk) pro $r=1$.

Nech» nyní $r\not=1$. Prohodíme $r$-tý øádek matice $\A$ s~pøedchozím,
pak jej prohodíme s~dal¹ím pøedcházejícím øádkem, atd. a¾ dostaneme
pùvodnì $r$-tý øádek na první øádek modifikované matice $\B$. K~tomu
potøebujeme provést $r-1$ prohození, tak¾e platí 
$\det\B=(-1)^{r-1}\det\A$. Provedeme rozvoj determinantu
matice $\B$ podle prvního øádku ($\B_{1,s}$ je matice, která vznikne 
z~matice $\B$ vynecháním prvního øádku a $s$-tého sloupce):
$$
  \det\B =  a_{r,1}\,(-1)^{1+1}\det\B_{1,1} + 
   a_{r,2}\,(-1)^{2+1}\det\B_{1,2} + \cdots + 
   a_{r,n}\,(-1)^{1+n}\det\B_{1,n}.
$$
Proto¾e $\det\A=(-1)^{r-1}\det\B$ a proto¾e $\B_{1,s}=\A_{r,s}$, máme
vzorec\cite(rozvojkk) dokázán.

Uva¾ujme $t\not=r$ a nahraïme $t$-tý øádek v~matici $\A$ øádkem
$r$-tým. Novou matici oznaème $\C$. Má dva stejné øádky, tak¾e je
$\det\C=0$. Rozvoj tohoto determinantu podle $t$-tého
øádku odpovídá vzorci\cite(rozvojkl).

\poznamka [rozvojsloupce]
%%%%%%%%%
Vzhledem k~platnosti vìty\cite[det=detT] platí analogická vìta o~rozvoji
determinantu podle $s$-tého sloupce. Zkuste si ji zformulovat jako
cvièení. 

\definice [doplnek]
%%%%%%%%%
Nech» $\A\in\R^{n,n}$. {\em Doplnìk matice $\A$
v~pozici $(i,j)$} je èíslo $D_{i,j}$, definované vzorcem:
$D_{i,j} = (-1)^{i+j}\,\det\A_{i,j}$, 
kde $\A_{i,j}\in\R^{n-1,n-1}$ je matice, 
která vznikne z~matice $\A$ vynecháním 
$i$-tého øádku a $j$-tého sloupce.
\inl[matice: doplnìk, doplnìk: matice]

\poznamka [rozvojdoplnku]
%%%%%%%%%
Vìtu\cite[rozvojdet] lze pøi pou¾ití definice\cite[doplnek]
a poznámky\cite[rozvojsloupce]
pøeformulovat. Nech» $\A\in\R^{n,n}$ je ètvercová matice a 
$D_{i,j}$ jsou její doplòky. Nech» $r,s,t\in\{1,2,\ldots,n\}$,
$r\not=t$, $s\not=t$. Pak platí
$$\eqalign{
  \det\A &= a_{r,1}\,D_{r,1} + a_{r,2}\,D_{r,2} + \cdots + 
            a_{r,n}\,D_{r,n}, \quad
       0 = a_{r,1}\,D_{t,1} + a_{r,2}\,D_{t,2} + \cdots + 
            a_{r,n}\,D_{t,n}, \cr
  \det\A &= a_{1,s}\,D_{1,s} + a_{2,s}\,D_{2,s} + \cdots + 
            a_{n,s}\,D_{n,s}, \quad
       0 = a_{1,s}\,D_{1,t} + a_{2,s}\,D_{2,t} + \cdots + 
            a_{n,s}\,D_{n,t}. \cr }
$$
\par\inl[doplnìk: matice, determinant: rozvoj, rozvoj: determinantu]

\priklad
%%%%%%%%
Uva¾ujme matici $\A$ z~pøíkladu\cite[elimdet]. Provedeme rozvoj 
determinantu~$\A$ podle prvního øádku.
$$\displaylines{
  \def\dmatrix#1{\left|\matrix{#1}\right|}
  \det\A = 1\cdot (-1)^{1+1}\cdot\dmatrix{1&2&2\cr3&1&2\cr1&2&1}
         + 2\cdot (-1)^{1+2}\cdot\dmatrix{2&2&2\cr1&1&2\cr2&2&1} 
         + 4\cdot (-1)^{1+3}\cdot\dmatrix{2&1&2\cr1&3&2\cr2&1&1}
         - 1\cdot (-1)^{1+4}\cdot\dmatrix{2&1&2\cr1&3&1\cr2&1&2} =\cr
  = 1\cdot5 + 2\cdot0 + 4\cdot(-5) - 1\cdot0 = -15.
}
$$
Vidíme, ¾e jsme si pøi výpoètu moc nepomohli. Rozvoj determinantu
podle øádku nebo sloupce matice typu $(n,n)$ obecnì vede na $n$
determinantù matic, které mají o~jediný øádek a sloupec ménì. To není
¾ádná výhra. 

Kdybychom opakovanì provádìli rozvoj vzniklých determinantù podle
øádku nebo sloupce, mohli bychom dojít a¾ k~maticím typu (1,1),
u~kterých je determinant pøímo roven hodnotì prvku dané matice.
Programátory mù¾e napadnout, ¾e lze tedy vìtu o~rozvoji determinantu
vyu¾ít pøi implementaci výpoètu determinantu rekurzivním
algoritmem. Ov¹em pozor\kern1pt! Tento algoritmus potøebuje zcela
stejné mno¾ství operací, jako pøi výpoètu determinantu pøímo
z~definice. Jak u¾ jsme si uvádìli, pøi matici typu $(50,50)$ se jedná
zhruba o~$10^{64}$ operací. Prakticky to znamená, ¾e bychom se
pravdìpodobnì výsledku nedoèkali za celou dobu pøedpokládané
existence na¹í sluneèní soustavy a kdo ví, jestli by se døíve
nezhroutil vesmír.
\inl[vesmír, soustava: sluneèní]

Mù¾ete namítnout, k~èemu ¾e je metoda rozvoje determinantu dobrá?
Pokud se v~nìjakém øádku nebo sloupci matice vyskytuje mnoho nul,
mù¾eme zmen¹it velikost matic, ze kterých poèítáme determinant. Je-li
na øádku nebo sloupci jediný nenulový prvek, dostáváme jedinou matici
o~jeden øádek a sloupec men¹í. V~pøíkladu\cite[elimdet] jsme mohli
napøíklad pøed provedením kroku~(2) provést rozvoj determinantu podle
prvního sloupce a dále pracovat jen s~maticí typu $(3,3)$. Pøed 
krokem~(4) jsme mohli znovu provést rozvoj determinantu podle prvního
sloupce:
$$
  \catcode`+=13 \def+{\hphantom{-}} \def\0{\hphantom{0}}
  \def\dmatrix#1{\left|\matrix{#1}\right|}
  \displaylines{
  \dmatrix{1&+2&+4&-1\cr2&+1&+2&+2\cr1&+3&+1&+2\cr2&+1&+2&+1}
  =
  \dmatrix{1&+2&+4&-1\cr0&-3&-6&+4\cr0&+1&-3&+3\cr0&-3&-6&+3} 
  =
  1\cdot \dmatrix{-3&-6&+4\cr+1&-3&+3\cr-3&-6&+3} =
  - \dmatrix{+1&-3&+3\cr-3&-6&+4\cr-3&-6&+3}
  = \cr =
  - \dmatrix{+1&-3&+3\cr+0&-15&\013\cr+0&-15&\012} =
  - 1\cdot\dmatrix{-15&13\cr-15&12} =
  15\cdot12 - 15\cdot13 = -15.
}
$$
Výhoda se projeví výraznìji, pokud napøíklad èísla v prvním øádku èi
sloupci jsou nesoudìlná a je výhodnìj¹í zaèít vyrábìt nuly v jiném
øádku nebo sloupci. Eliminaèní metodou v nìm vytvoøíme nuly a pak
provedeme podle tohoto øádku nebo sloupce rozvoj determinantu.
  
\okraj Souèin determinantù | Soucin determinantu

\veta* [soucindet]
%%%%%
Nech» $\A$, $\B$ jsou ètvercové matice. Pak 
$\det\A\,\det\B = \det(\A\cdot\B)$.
\inl[souèin: determinantù, determinant: souèinu: matic]
\inl[vìta: o determinantu souèinu]

\exdukaz
%%%%%%%%
Uvìdomíme si, ¾e lze matici $\A$ pøevést pouze øádkovými úpravami na
matici $\A'$, která je tvaru\cite(trojmatice). Navíc mù¾eme provádìt
pouze takové úpravy, které nemìní determinant: pøièítání násobku
jiného øádku k øádku podle~(V5) vìty\cite[zvdet] nemìní
determinant a pokud potøebujeme prohodit øádky, pak okam¾itì
pronásobíme jeden z nich konstantou $-1$. Tyto operace skuteènì staèí
na pøevedení matice na tvar\cite(trojmatice), a pøitom máme zaruèeno,
¾e $\det\A=\det\A'$. Podle vìty\cite[emulaceGEM] existuje ètvercová
matice $\P$, pro kterou platí
$$
  \A' = \P\cdot\A.
$$
Dále pøevedeme matici $\B$ na matici $\B'$ tvaru\cite(trojmatice) 
pouze sloupcovými úpravami takovými, které nemìní determinant. 
Máme tedy $\det\B=\det\B'$
a navíc podle poznámky\cite[emulacesloupcu] existuje matice 
$\Q$ taková, ¾e
$$
  \B' = \B\cdot\Q.
$$
Platí
$$
  \det\A\,\det\B = \det\A'\,\det\B' = \det(\A'\cdot\B').
$$
Poslední rovnost ovìøíme z definice maticového násobení a vyu¾ijeme
toho, ¾e obì matice $\A'$ i $\B'$ jsou tvaru\cite(trojmatice). Matice 
$\A'\cdot\B'$ je také tvaru\cite(trojmatice) a pro její
diagonální prvky $g_{i,i}$ platí, ¾e $g_{i,i} = a'_{i,i}\,b'_{i,i}$.
Proto¾e se determinanty matic tvaru\cite(trojmatice) poèítají jako
souèin prvkù na diagonále, máme skuteènì 
$\det\A'\,\det\B' = \det(\A'\cdot\B')$.

Na matici $\A\cdot\B$ provedeme stejné øádkové a sloupcové úpravy,
jako jsme provedli na matice $\A$ resp.~$\B$. Dostaneme matici
$\A'\cdot\B'$, proto¾e
$$
  \P\cdot(\A \cdot\B)\cdot\Q = (\P\cdot\A) \cdot (\B\cdot\Q) =
  \A'\cdot\B'.
$$
Provedené øádkové a sloupcové úpravy nemìní determinant, tak¾e 
matice $\A'\cdot\B'$ má stejný determinant jako matice $\A\cdot\B$.
Dostáváme výsledek
$$
  \det\A\,\det\B = \det\A'\,\det\B' = \det(\A'\cdot\B') =
  \det(\A\cdot\B).
$$

\veta
%%%%%
Nech» $\A=\L\U$ je LU rozklad matice $\A$. Pak $\det\A$ je roven
souèinu diagonálních prvkù matice $\U$.

\dukaz
Podle vìty\cite[soucindet] je $\det\A=\det\L\cdot\det\U$. Proto¾e
$\det\L=1$ (má na diagonále pouze jednièky), je $\det\A=\det\U$ co¾ je
podle pøíkladu\cite[dettrojmatice] souèin diagonálních prvkù matice $\U$.


\okraj Inverzní\hb matice a\hb determinant | Inversni matice a determinant

\veta [detA-1]
%%%%%
Nech» $\A$ je regulární matice. Pak $\det\A^{-1} = 1/\det\A$.

\dukaz
%%%%%%
Staèí pou¾ít vìtu\cite[soucindet] na souèin $\A\cdot\A^{-1}=\E$, tedy
$\det\A\cdot\det\A^{-1}=\det\E=1$. Vydìlením obou stran rovnice èíslem
$\det\A$ (které je podle vìty\cite[reguldet] nenulové) dostáváme
dokazovaný vzorec.


%\poznamka
%%%%%%%%%
%Na závìr kapitoly o determinantech pøedvedeme slíbený dùkaz 
%vìty\cite[existinverse] o
%existenci inverzní matice pro ka¾dou regulární matici. 
%Mù¾eme to pova¾ovat za první praktické vyu¾ití pojmu
%determinant. Dal¹í vyu¾ití najdeme v následující kapitole o soustavách
%lineárních rovnic a dále pozdìji pøi poèítání objemù jistých tìles.
%
%Vìtu\cite[existinverse] o existenci inverzní matice zde pøepí¹eme znovu.

\veta [A-1D]
%%%%%
Je-li $\A\in\R^{n,n}$ regulární, pak
$$
  \A^{-1} = {1\over\det\A}\,\D^T, 
$$
kde $\D=(D_{i,j})$ je matice doplòkù $\A$ v pozicích $(i,j)$.
\inl[metoda: poèítání: inverzní matice]
\inl[matice: inverzní, inverzní: matice]

\dukaz
%%%%%%
Proto¾e je $\A$ regulární, má nenulový determinant, tak¾e ve vzorci
nedìlíme nulou. Musíme ovìøit, ¾e pro matici $\A^{-1}$ vypoèítanou 
z~uvedeného vzorce, platí
$\A\cdot\A^{-1}=\E$. Je-li $\D=(D_{i,j})$,
pak samozøejme je $\D^T=(D_{j,i})$. Podle definice souèinu
matic\cite[soucinAB] vypoèítáme prvek $e_{i,k}$ matice
$\A\cdot\A^{-1}$:
$$
  e_{i,k} = \sum_{j=1}^n a_{i,j}\,{1\over\det\A}\,D_{k,j} =
            {1\over\det\A}\bigl(a_{i,1}D_{k,1} + a_{i,2}D_{k,2} + 
            \cdots + a_{i,n}D_{k,n}\bigr) = 
  \cases {\displaystyle {1\over\det\A\mathstrut}\,\det\A = 1 &\hbox{pro $i=k$,}\cr
          \displaystyle {\mathstrut1\over\det\A}\cdot 0 = 0  &\hbox{pro $i\not=k$.}}
$$
Zde jsme vyu¾ili vìtu o rozvoji determinantu podle $i$-tého
øádku, viz poznámku\cite[rozvojdoplnku]. Zji¹»ujeme, ¾e prvky
$e_{i,k}$ jsou skuteènì prvky jednotkové matice\cite[defE].
Rovnost $\A^{-1}\cdot\A=\E$ bychom dokazovali podobnì. Pou¾ili
bychom vìtu o rozvoji $i$-tého sloupce namísto øádku.

\poznamka [imatice-dop]
%%%%%%%%%
Vìta\cite[A-1D] kromì teoretických dùsledkù, které uvidíme pozdìji, 
nám také dává návod, jak vypoèítat inverzní matici 
k matici $\A$. Je to vlastnì vedle 
v~algoritmu\cite[algolinverse], který vyu¾ívá eliminaèní metodu,
dal¹í zpùsob hledání inverzní
matice. Mù¾eme ji øíkat \uv{metoda hledání inverzní matice pomocí doplòkù}.
Uvìdomíme si ale, ¾e pro velké matice je eliminaèní metoda
podstatnì úèelnìj¹í ne¾ metoda pomocí doplòkù, která vy¾aduje spoèítat
$n^2$ determinantù matic typu $(n-1,n-1)$ a je¹tì spoèítat $\det\A$.
V~následujících pøíkladech si proto tuto metodu ilustrujeme jen na malých
maticích. 
\inl[metoda: poèítání: inverzní matice]

\priklad
%%%%%%%%
Najdeme inverzní matici k matici
$$
  \A=\pmatrix{a&b\cr c&d}.
$$
Oznaème $\D$ matici doplòkù k matici $\A$. V tomto pøípadì se doplòky
dobøe poèítají, proto¾e obsahují determinanty matic typu $(1,1)$:
$$
  \D = \pmatrix{d&-c\cr -b&a}, \quad
  \A^{-1} = {1\over\det\A}\,\D^T = 
  {1\over ad-bc}\pmatrix{d&-b\cr -c&a}.
$$

\priklad [pr-imatice-dop]
%%%%%%%%
Najdeme inverzní matici ke stejné matici, jako v
pøíkladu\cite[metodainverse], tj. k matici
$$
  \catcode`+=13 \def+{\hphantom{-}}
  \A = \pmatrix{+1&2&3\cr-1&0&1\cr+2&2&1}.
$$
Doplòky nyní budeme poèítat z determinantù matic typu $(2,2)$, co¾ u¾
nám dá trochu práce.
$$
  \def\+{\hphantom{-}}
  \def\dmatrix#1,#2,#3,#4,{\vcenter{\kern2pt
     \hbox{$\left|\matrix{#1&#2\cr#3&#4}\right|$}\kern2pt}}
  \displaylines{
  \D = 
  \pmatrix{+\dmatrix 0,1,2,1,&-\dmatrix-1,1,\+2,1,&+\dmatrix-1,0,\+2,2,\cr
           -\dmatrix 2,3,2,1,&+\dmatrix 1,3,2,1,&-\dmatrix 1,2,2,2,\cr
           +\dmatrix 2,3,0,1,&-\dmatrix \+1,3,-1,1,&+\dmatrix \+1,2,-1,0,}
  = \pmatrix{-2&\+3&-2\cr\+4&-5&\+2\cr\+2&-4&\+2}, \cr
  \det\A = -2, \qquad \A^{-1} = {1\over\det\A}\,\B^T =
  -{1\over2} \pmatrix{-2&\+4&\+2\cr \+3&-5&-4\cr-2&\+2&\+2}.
}
$$
Výsledek mù¾eme srovnat s~výsledkem v~pøíkladu\cite[metodainverse].


\okraj Determinant a bloky | Determinant a bloky

\priklad
%%%%%%%%
Matici $\A\in\R^{2n,2n}$ rozdìlme na bloky typu $(n,n)$:
$$
  \A=\pmatrix{\A_1&\A_2\cr \A_3&\A_4}.
$$
Uká¾eme, ¾e obecnì neplatí $\det\A = \det\A_1\,\det\A_4 - \det\A_2\,\det\A_3$.

Zvolme matici
$$
  \A=\pmatrix{1&0&0&0\cr0&0&1&0\cr0&1&0&0\cr0&0&0&1}
$$
Ta má zøejmì determinant roven mínus jedné. Pøitom 
$\det\A_1\,\det\A_4 - \det\A_2\,\det\A_3 = 0-0=0$.

®e uvedený blokový vzorec neplatí, nás mù¾e napadnout i z poètu souèinù, které
obsahuje definice determinantu. Determinant matice z~$\R^{2n,2n}$ 
obsahuje $(2n)!$ souèinù, zatímco blokový vzorec obsahuje jen
$2(n!)^2$ souèinù. To je zcela jiné èíslo.

\priklad [detdvabloky]
%%%%%%%%
Matici $\A\in\R^{n,n}$ rozdìlme na bloky tak, ¾e $\A_1$ a
$\A_4$ jsou ètvercové matice:
$$
  \A=\pmatrix{\A_1&\A_2\cr \O&\A_4}, 
$$
pøitom $\O$ je nulová matice. Uká¾eme, ¾e pak $\det\A = \det\A_1\,\det\A_4$.

Nech» blok $\A_1$ je typu $(m,m)$, kde $m<n$.
V matici $\A$ lze pøevést øádkovými úpravami Gaussovy eliminaèní
metody blok $\A_1$ na
schodovitou matici. Dá se to navíc provést tak, 
¾e matice $\A$ se zmìní v~matici 
$\A'=(a'_{i,j})$ se stejným determinantem a pracujeme jen s prvními
$m$ øádky matice $\A$. Podle\cite[dettrojmatice] platí
$\det\A_1 = a'_{1,1}\cdot a'_{2,2}\cdots a'_{m,m}$.
Dokazovaný vzorec je pak výsledkem
opakovaného rozvoje determinantu matice $\A'$ 
podle prvního sloupce, podle druhého sloupce, atd. a¾ podle 
$m$-tého sloupce.


\veta [detbloku]
%%%%%
Nech» matice $\A\in\R^{n,n}$ je rozdìlena do blokù
$$
  \A = \pmatrix {\A_{1,1}&\A_{1,2}&\A_{1,3}&\ldots&\A_{1,k}\cr
                 \O&\A_{2,2}&\A_{2,3}&\ldots&\A_{2,k}\cr
                 \O&\O&\A_{3,3}&\ldots&\A_{3,k}\cr
                   &  &       & \ldots & \cr
                 \O&\O&\O&\ldots&\A_{k,k}}
$$
tak, ¾e diagonální bloky $\A_{i,i}$ jsou ètvercové a $\O$ znaèí nulové
bloky (obecnì rùzných typù). Pak 
$$\det\A = \det\A_{1,1}\cdot\det\A_{2,2}\cdots\det\A_{k,k}.$$

\dukaz
Analogicky, jako v pøíkladu\cite[detdvabloky]. Má-li se to provést
poøádnì, je potøeba pou¾ít indukci podle~$k$, pøièem¾ argumenty 
v~pøíkladu\cite[detdvabloky] poslou¾í pro indukèní krok.


\shrnuti
%%%%%%%%
Determinant ètvercové matice je definován jako souèet souèinù prvkù 
matice opatøených jistým znaménkem. Podrobnìji viz\cite[ddet].

Determinant je mo¾né vypoèítat i rekurzivním algoritmem pomocí vìty 
o rozvoji determinantu podle øádku èi sloupce~/\ncite[rozvojdet], 
\ncite[rozvojdoplnku]/. 

Determinant se nezmìní, pokud modifikujeme matici tak, ¾e k~jednomu
øádku/sloupci pøièítáme $\alpha$-násobek øádku/sloupce
jiného. Násobíme-li jeden øádek/sloupec nenulovou konstantou, stejnou
konstantou je násoben determinant. Prohodíme-li dva øádky/sloupce,
determinant zmìní znaménko\lcite[zvdet]. 
Díky tìmto vlastnostem mù¾eme hlídat zmìny
v determinantu pøi v¹ech krocích Gaussovy eliminaèní metody. Ta nám
umo¾ní pøevést matici na schodovitou, tedy horní trojúhelníkovou matici. Ta má
determinant roven souèinu prvkù na diagonále\lcite[dettrojmatice]. 
To nám dává metodu na
poèítání determinantù pomocí Gaussovy eliminaèní metody. Tato metoda
je výpoètovì výraznì ménì nároèná ne¾ u¾ití definice nebo rekurzivního
algoritmu, který vychází z vìty o rozvoji\lcite[rozvojdet]. 

Determinant matice je nenulový, právì kdy¾ je matice regulární\lcite[reguldet].

Determinant souèinu matic je roven souèinu determinantù\lcite[soucindet].

Inverzní matici mù¾eme poèítat jako matici doplòkù\lcite[doplnek]
transponovanou a násobenou pøevrácenou hodnotou determinantu\lcite[A-1D].
To není efektivní metoda, ale má své teoretické dùsledky, napøíklad
pøi dùkazu Cramerova pravidla\lcite[cramer] z~následující kapitoly.

\icviceni 4


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\kapitola [soustavy] Soustavy lineárních rovnic | Soustavy linearnich rovnic
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\definice [dsoustava]
%%%%%%%%%
Nech» $\A\in\R^{m,n}$ je matice reálných èísel, nech» dále 
$\vec x=(x_1, x_2, \ldots, x_n)^T$ je sloupcový vektor symbolù 
a  $\vec b=(b_1, b_2, \ldots, b_m)^T\in\R^{m,1}$ je sloupcový vektor
reálných èísel. Pak maticovou rovnost
$$
  \A\cdot\vec x = \vec b
$$
navýváme {\em soustavou $m$ lineárních rovnic o $n$ neznámých}.
Matici $\A$ nazýváme {\em maticí soustavy} a vektor
$\vec b = (b_1, \ldots, b_m)^T$ nazýváme 
{\em vektorem pravých stran}. Pøipí¹eme-li k~matici soustavy do
dal¹ího sloupce vektor $\vec b$ oddìlený (pouze pro pøehlednost)
svislou èarou, dostáváme matici $(\A|\vec b)\in\R^{m,n+1}$, kterou
nazýváme {\em roz¹íøenou maticí soustavy}.
\inl[soustava: lineárních: rovnic, lineární: soustava rovnic]
\inl[vektor: pravých stran, matice: soustavy]
\inl[matice: soustavy: roz¹íøená, roz¹íøená: matice: soustavy]

%\poznamka
%%%%%%%%%%
%Sloupcový vektor $\vec x$ mù¾e obsahovat i jiné symboly ne¾ jen
%$x_1, x_2, \ldots, x_n$. Tøeba $x,y,z$.

\definice [dreseni]
%%%%%%%%%
{\em Øe¹ením soustavy\/} $\A\,\vec x = \vec b$ je takový vektor 
$\vec v = (\alpha_1, \alpha_2, \ldots, \alpha_n)^T \in \R^{n,1}$, pro 
který platí: dosadíme-li hodnoty $\alpha_i$ za symboly $x_i$, pak
je splnìna po¾adovaná maticová rovnost, tj. 
$$
  \A\cdot\pmatrix{\alpha_1\cr\alpha_2\cr\vdots\cr\alpha_n} =
         \pmatrix{b_1\cr b_2\cr\vdots\cr b_m}.
  \rce(resenisoustavy)
$$ 
{\em Øe¹it soustavu\/} $\A\,\vec x = \vec b$ znamená nalézt v¹echna její
øe¹ení, tj. nalézt podmno¾inu $\R^{n,1}$ v¹ech øe¹ení této soustavy.
\inl[øe¹ení: soustavy]

\poznamka [Rn=Rn1]
%%%%%%%%%
Aèkoli pøesnì øeèeno je mno¾ina øe¹ení podmno¾inou sloupcových vektorù
$\R^{n,1}$, èasto slo¾ky tìchto øe¹ení nakonec pí¹eme do øádkù 
(viz izomorfismus zmínìný v poznámce\cite[radkovevektory]). Mluvíme tedy 
o~mno¾inì øe¹ení jako o podmno¾inì $\R^n$. Jinými slovy, nedojde-li 
k nedorozumìní, zapisujeme jednotlivá øe¹ení soustavy 
$\vec v=(\alpha_1,\alpha_2, \ldots,\alpha_n)$ jako prvky z $\R^n$.

\okraj {}Frobeniova vìta | Frobeniova veta

\veta (Frobeniova) * [frobeni]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Soustava $\A\,\vec x = \vec b$ má øe¹ení právì tehdy, kdy¾
$\hod\A = \hod (\A|\vec b)$, tj.~kdy¾ hodnost matice soustavy se rovná 
hodnosti roz¹íøené matice soustavy.
\inl[vìta: Frobeniova, Frobeniova: vìta]

\dukaz
%%%%%%
Vektor $\vec v = (\alpha_1, \ldots, \alpha_n)^T$ je øe¹ením soustavy
$\A\,\vec x = \vec b$ právì tehdy, kdy¾ platí\cite(resenisoustavy). 
To znamená, ¾e sloupec $\vec b$ je lineární kombinací sloupcù
matice $\A$ s~koeficienty $\alpha_1, \alpha_2, \ldots, \alpha_n$. 
To platí právì tehdy, kdy¾ 
$$
  \hod \pmatrix{\A^T \cr \vec b^T} = \hod\A^T.
$$
Proto¾e platí vìta\cite[hA=hAT], je Frobeniova vìta dokázána.

\poznamka
%%%%%%%%%
V úvodní kapitole o Gaussovì eliminaèní metodì jsme vlastnì nevìdomky
vyslovili Frobeniovu vìtu.  V této kapitole jsme si øíkali, jak
poznáme, ¾e soustava má øe¹ení. Mluvili jsme tam o~tom, ¾e soustava
nemá øe¹ení právì tehdy, kdy¾ poslední øádek roz¹íøené matice soustavy
po pøímém chodu eliminace je tvaru
$$
   (0\quad 0\quad\cdots\quad 0 \enspace|\enspace c), \quad c\not=0.
$$
Vzpomeneme-li si na metodu poèítání hodnosti z pøíkladu\cite[AsimB],
vidíme, ¾e existence takového øádku je ekvivalentní s tím, ¾e
roz¹íøená matice soustavy má o jednièku vìt¹í hodnost, ne¾ matice 
soustavy. Uvìdomíme si je¹tì, ¾e hodnost roz¹íøené matice soustavy 
mù¾e být buï o jednièku vìt¹í nebo pøímo rovna hodnosti matice
soustavy. ®ádná jiná mo¾nost pro hodnosti tìchto matic neexistuje.

\definice [eqsoust]
%%%%%%%%%
Nech» $\A\,\vec x = \vec b$ je soustava $m$ lineárních rovnic o $n$
neznámých a $\C\,\vec x = \vec d$ je soustava $k$ lineárních rovnic
o~stejném poètu $n$ neznámých. Øíkáme, ¾e tyto soustavy jsou 
{\em ekvivalentní}, pokud obì soustavy mají stejné mno¾iny øe¹ení.
\inl[soustava: ekvivalentní, ekvivalentní: soustava]

\okraj Princip\hb eliminaèní metody | Princip eliminacni metody

\poznamka
%%%%%%%%%
Gaussova eliminaèní metoda øe¹ení soustav lineárních rovnic popsaná 
v~úvodní kapitole spoèívá v~pøevedení soustavy 
$\A\,\vec x = \vec b$ na soustavu $\C\,\vec x = \vec d$, 
která je s pùvodní soustavou rovnic ekvivalentní. Pøitom øe¹ení
soustavy $\C\,\vec x = \vec d$ lze nalézt snadnìji, proto¾e
$\C$ je schodovitá matice (srovnejte vìtu\cite[simhornitroj]).
Tuto skuteènost zaznamenáme do následující vìty.
\inl[GEM, metoda: eliminaèní: Gaussova, Gaussova: eliminaèní metoda]

\veta [exeqsoust]
%%%%%
Ke ka¾dé soustavì $\A\,\vec x = \vec b$ lze nalézt ekvivalentní
soustavu $\C\,\vec x = \vec d$, její¾ matice $\C$ je schodovitá.
\inl[matice: schodovitá, schodovitá matice]

\dukaz
%%%%%%
Podle vìty\cite[simhornitroj] lze nalézt $(\C|\vec d)$ takovou, ¾e
$(\A|\vec b)\sim(\C|\vec d)$, a pøitom $\C$ je
schodovitá matice. Proto¾e operace \uv{$\sim$} zde oznaèuje
koneènì mnoho elementárních krokù Gaussovy eliminaèní metody, a
proto¾e jsme si øekli v úvodní kapitole, ¾e tyto elementární kroky
nemìní mno¾inu øe¹ení odpovídající soustavy, je soustava
$\C\,\vec x = \vec d$ ekvivalentní s pùvodní soustavou 
$\A\,\vec x = \vec b$.

\okraj Øe¹ení homogenní soustavy | Reseni homogenni soustavy

\definice [dhomo]
%%%%%%%%%
Existuje-li v matici $\vec b$ aspoò jeden prvek nenulový, øíkáme, ¾e
je soustava lineárních rovnic $\A\,\vec x = \vec b$ 
{\em nehomogenní}. 
Jsou-li v¹echny prvky v matici $\vec b$ nulové, nazýváme soustavu rovnic
{\em homogenní} a zapisujeme ji takto:
$$
  \A\,\vec x = \vec o \qquad
  \hbox{(symbolem $\vec o\in\R^{m,1}$ zde znaèíme sloupcový nulový vektor).} 
$$
\par\inl[homogenní: soustava: rovnic, soustava: rovnic: homogenní]
\inl[nehomogenní: soustava: rovnic, soustava: rovnic: nehomogenní]

\veta* [homolinprst]
%%%%%
Mno¾ina v¹ech øe¹ení homogenní soustavy $\;\A\,\vec x = \vec o\;$ s~$n$
neznámými tvoøí lineární podprostor lineárního prostoru $\R^n$.

\dukaz
%%%%%%
Vìta by správnì mìla znít: mno¾ina øe¹ení homogenní soustavy tvoøí
lineární podprostor lineárního prostoru $\R^{n,1}$, ov¹em v~souladu 
s~poznámkou\cite[Rn=Rn1] nebudeme rozli¹ovat mezi $\R^{n,1}$ a $\R^n$.

Pøedev¹ím mno¾ina øe¹ení homogenní soustavy je neprázdná, proto¾e
nulový vektor v~$\R^{n,1}$ je samozøejmì øe¹ením této soustavy.

Podle definice\cite[dlpp] musíme dále dokázat: (1) jsou-li $\vec u\in\R^{n,1}$ a
$\vec v\in\R^{n,1}$ øe¹ení soustavy $\A\,\vec x = \vec o$, pak té¾ 
$\vec u + \vec v$ je øe¹ením stejné soustavy.
(2) je-li $\vec u\in\R^{n,1}$ øe¹ením soustavy $\A\,\vec x = \vec o$ 
a $\alpha\in\R$, pak té¾ $\alpha\,\vec u$ je øe¹ením stejné soustavy.

Proto¾e $\vec u$ a $\vec v$ jsou øe¹ení soustavy 
$\A\,\vec x = \vec o$, platí: $\A\,\vec u = \vec o$ a 
$\A\,\vec v = \vec o$. Máme dokázat, ¾e pak také 
$\A\,(\vec u+\vec v) = \vec o\,$ a $\,\A\,(\alpha\,\vec u) = \vec o$.
Podle vìty\cite[soucinAB-vlastnosti] je 
$$
  \displaylines{
  \A\,(\vec u+\vec v) = \A\,\vec u + \A\,\vec v = \vec o +
  \vec o = \vec o,  \cr
  \A\,(\alpha\,\vec u) = \alpha\,\A\,\vec u = \alpha\,\vec o =
  \vec o.}
$$

\priklad [homoprikl]
%%%%%%%%
Najdeme mno¾inu v¹ech øe¹ení homogenní soustavy lineárních rovnic se
¹esti neznámými:
$$
  \soustava{x_1 +\1x_2 + 2x_3 + 3x_4 + 3x_5 + 3x_6 = 0 \cr
            x_1 +\1x_2 +\1x_3 + 3x_4 +\1x_5 +\1x_6 = 0 \cr
           2x_1 + 2x_2 + 2x_3 + 6x_4 + 2x_5 + 8x_6 = 0 }
$$
Eliminujeme matici soustavy (vektor pravých stran je nulový, tak¾e je
zbyteèné jej psát).
$$
  \def\+{\kern3pt}
  \matice{1 & 1 & 2 & 3 & 3 & 3 \cr
          1 & 1 & 1 & 3 & 1 & 1 \cr
          2 & 2 & 2 & 6 & 2 & 8 } \sim
  \matice{1 &\+1 & 2 &\+3 & 3 & 3 \cr
          0 & 0 &-1 & 0 &-2 &-2 \cr
          0 & 0 &-2 & 0 &-4 & 2 } \sim
  \matice{1 & 1 & 2 & 3 & 3 & 3 \cr
          0 & 0 & 1 & 0 & 2 & 2 \cr
          0 & 0 & 0 & 0 & 0 & 6 }.
$$ 
Z poslední rovnice budeme poèítat $x_6$, z pøedposlední rovnice $x_3$
a z první rovnice $x_1$. Hodnoty neznámých $x_2, x_4, x_5$ mohou být
libovolné. Zaveïme pro nì parametry $x_2=t$, $x_4=u$, $x_5=v$. 
Z poslední rovnice vychází jedinì $x_6=0$, z pøedposlední rovnice 
máme $x_3 = -2v$ a
koneènì z první rovnice dostáváme $x_1 = -t +4v -3u -3v = -t +v -3u$.
Výsledek sumarizujeme takto:
$$\eqalign{
  (x_1, x_2, x_3, x_4, x_5, x_6) &= 
  (-t +v -3u,\; t,\; -2v,\; u,\; v,\; 0) =\cr
   &= t\,(-1,1,0,0,0,0) + u\,(-3,0,0,1,0,0) + v\,(1,0,-2,0,1,0). }
$$
Z tohoto zápisu vyplývá, ¾e mno¾ina v¹ech øe¹ení dané homogenní
soustavy je mno¾inou v¹ech lineárních kombinací uvedených tøí vektorù,
co¾ mù¾eme zapsat pomocí lineárního obalu takto:
$$
  M_0 = \bigl<(-1,1,0,0,0,0), (-3,0,0,1,0,0), (1,0,-2,0,1,0)\bigr>.
$$

\poznamka
%%%%%%%%%
Proto¾e uvedené tøi vektory z výsledku pøíkladu\cite[homoprikl] jsou
lineárnì nezávislé, tvoøí jednu z mo¾ných bází prostoru $M_0$.
To se nestalo náhodou, ale platí to v¾dy, jak ukazuje následující
vìta.

\veta [homoveta]
%%%%%
Nech» $\A\,\vec x = \vec o$ je homogenní soustava lineárních rovnic
o~$n$ neznámých, $k=n-\hod\A$. Pak existuje $k$ lineárnì nezávislých
vektorù $\vecc u_k$ z~$\R^n$ takových, ¾e pro mno¾inu $M_0$ v¹ech 
øe¹ení soustavy $\A\,\vec x = \vec o$ platí
$$
  M_0 = \lob<\vecc u_k> \quad\hbox{pro $k>0$},\qquad M_0 = \{\vec o\}\quad\hbox{pro $k=0$}.
$$
Vektory $\vecc u_k$ tvoøí jednu z mo¾ných bází lineárního
prostoru v¹ech øe¹ení~$M_0$.

\dukaz
%%%%%%
Vektory $\vecc u_k$ najdeme analogicky, jako jsme to udìlali
v~pøíkladu\cite[homoprikl]. Algoritmus\cite[metodahodnosti] zaruèuje, ¾e
poèet rovnic soustavy po eliminaci je roven $\hod\A$ a je roven poètu
neznámých, které mù¾eme z rovnic vypoèítat. Ostatních $k=n-\hod\A$
neznámých $x_{i_1}, x_{i_2}, \ldots, x_{i_k}$ 
mù¾e nabývat libovolných hodnot a zaveïme pro nì parametry 
$x_{i_1}=p_1, x_{i_2}=p_2, \ldots, x_{i_k}=p_k$.
V¹echna øe¹ení získáme napøíklad dosazovací 
metodou pou¾itou na rovnice po eliminaci (zaèínáme poslední rovnicí 
a konèíme první). Z~tohoto øe¹ení mù¾eme vytknout parametry:
$$
  (x_1, x_2, \ldots, x_n) = \lkvecc p.u_k
  \rce(uhomo)
$$
a dostáváme hledané vektory $\vecc u_k$. Z uvedené rovnosti 
a z definice lineárního obalu\cite[linobal] pøímo
plyne, ¾e pro mno¾inu v¹ech øe¹ení platí $M_0 = \lob<\vecc u_k>$.

Zbývá dokázat, ¾e vektory $\vecc u_k$ jsou lineárnì nezávislé.
Oznaème $\vec u'_1\in\R^k$, $\vec u'_2\in\R^k, \ldots,$ $\vec u'_k\in\R^k$
ty èásti vektorù $\vecc u_k$, které obsahují
jen slo¾ky $i_1, i_2, \ldots, i_k$. Proto¾e platí rovnost\cite(uhomo)
a také platí oznaèení $x_{i_1} = p_1, x_{i_2}=p_2, \ldots,
x_{i_k}=p_k$, dostáváme
$$
  \vec u'_1 = (1,0,0, \ldots,0),\quad 
  \vec u'_2 = (0,1,0, \ldots,0),\quad \ldots,\quad
  \vec u'_k = (0,0,0, \ldots,1).
$$
Toto jsou lineárnì nezávislé vektory. Z toho plyne, ¾e jsou lineárnì
nezávislé i vektory $\vecc u_k$, proto¾e $\vecc {u'}_k$ jsou jejich èásti. 
 
Závìreèné tvrzení vìty, ¾e vektory $\vecc u_k$ tvoøí bázi prostoru
øe¹ení homogenní soustavy, plyne pøímo z definice báze\cite[dbase].

\veta* [dimhomo]
%%%%%
Nech» $M_0$ je lineární prostor v¹ech øe¹ení homogenní soustavy
lineárních rovnic $\A\,\vec x = \vec o$ s~$n$ neznámými. 
Pak $\dim M_0 = n - \hod\A$.

\dukaz
%%%%%%
Vìta je pøímým dùsledkem pøedchozí vìty\cite[homoveta].

\poznamka
%%%%%%%%%
Nech» $n$ je poèet neznámých homogenní soustavy $\A\,\vec x = \vec o$.
Pak z vìty\cite[dimhomo] plyne tento dùsledek:
$$\eqalign{
  \hod\A = n &\quad \hbox{pak soustava má jen nulové øe¹ení},\cr
  \hod\A < n &\quad \hbox{pak soustava má nekoneènì mnoho øe¹ení}.}
$$


\okraj Øe¹ení nehomogenní soustavy | Reseni nehomogenni soustavy

\definice [partikul]
%%%%%%%%%
Nech» $\A\,\vec x = \vec b$ je nehomogenní soustava lineárních rovnic
o~$n$ neznámých a $\vec v\in\R^n$ je nìjaké jedno její øe¹ení. Takovému
øe¹ení $\vec v$ øíkáme {\em partikulární øe¹ení\/} nehomogenní
soustavy. 

Pokud zamìníme sloupcový vektor $\vec b$ za nulový vektor stejného typu, 
dostáváme homogenní soustavu $\A\,\vec x = \vec o$, kterou
nazýváme {\em pøidru¾enou homogenní soustavou\/} k~soustavì
$\A\,\vec x = \vec b$.
\inl[soustava: rovnic: nehomogenní, nehomogenní: soustava rovnic]
\inl[øe¹ení: soustavy: patrikulární, partikulární: øe¹ení soustavy]
\inl[soustava: homogenní: pøidru¾ená, pøidru¾ená homogenní soustava]

\veta [nehomoprst]
%%%%%
{(1)} Nech» $\vec v$ je partikulární øe¹ení nehomogenní soustavy 
$\A\,\vec x = \vec b$ a $\vec u$ je libovolné øe¹ení pøidru¾ené
homogenní soustavy $\A\,\vec x = \vec o$. Pak $\vec v + \vec u$ je
také øe¹ením soustavy $\A\,\vec x = \vec b$.

(2) Nech» $\vec v$ a $\vec w$ jsou dvì partikulární øe¹ení nehomogenní
soustavy $\A\,\vec x = \vec b$. Pak $\vec v - \vec w$ je øe¹ením
pøidru¾ené homogenní soustavy $\A\,\vec x = \vec o$.

\dukaz
%%%%%%
(1) Podle pøedpokladu platí $\A\,\vec v = \vec b$, 
$\A\,\vec u = \vec o$. Pro souèet $\vec v + \vec u$ pak platí
$$
  \A\,(\vec v + \vec u) = \A\,\vec v + \A\,\vec u = 
  \vec b + \vec o = \vec b.
$$
(2) Podle pøedpokladu platí $\A\,\vec v = \vec b$, 
$\A\,\vec w = \vec b$. Pro rozdíl $\vec v - \vec w$ pak platí
$$
  \A\,(\vec v - \vec w) = \A\,\vec v - \A\,\vec w =
  \vec b - \vec b = \vec o.
$$

\veta* [partikul+obal]
%%%%%
Nech» $\vec v$ je partikulární øe¹ení soustavy $\A\,\vec x = \vec b$ a
$M_0$ je lineární prostor v¹ech øe¹ení pøidru¾ené homogenní soustavy
$\A\,\vec x = \vec o$. Pak pro mno¾inu $M$ v¹ech øe¹ení soustavy 
$\A\,\vec x = \vec b$ platí
$$
  M = \bigl\{\vec v + \vec u;\enspace \vec u\in M_0\bigr\}.
$$

\dukaz
%%%%%%
Z vlastnosti (1) vìty\cite[nehomoprst] plyne, ¾e 
$\{\vec v + \vec u;\enspace \vec u\in M_0\} \subseteq M$. Staèí
dokázat obrácenou inkluzi. Pokud $\vec w\in M$, pak podle vlastnosti
(2) vìty\cite[nehomoprst] existuje $\vec u = \vec w - \vec v \in M_0$,
tak¾e $\vec w\in \{\vec v + \vec u;\enspace \vec u\in M_0\}$. Platí
tedy i obrácenná inkluze.

\poznamka [v+M0]
%%%%%%%%%
Mno¾inu v¹ech øe¹ení nehomogenní soustavy lineárních rovnic zapisujeme
vìt¹inou zjednodu¹enì jako souèet partikulárního øe¹ení a lineárního
prostoru v¹ech øe¹ení pøidru¾ené homogenní soustavy takto:
$$
  M = \vec v + M_0 = \vec v + \lob<\vecc u_k>.
  \rce(nehomoreseni)
$$
Øe¹it nehomogenní soustavu tedy znamená 
najít partikulární øe¹ení $\vec v$ a dále najít
$k$ lineárnì nezávislých øe¹ení pøidru¾ené homogenní
soustavy $\vecc u_k$ ($k$ je rovno poètu neznámých mínus hodnost
matice soustavy). 
Výsledek je obvyklé psát ve tvaru\cite(nehomoreseni).

\priklad [nehomoruc]
%%%%%%%%
Najdeme mno¾inu v¹ech øe¹ení soustavy lineárních rovnic se
¹esti neznámými:
$$
  \soustava{x_1 +\1x_2 + 2x_3 + 3x_4 + 3x_5 + 3x_6 =& 1 \cr
            x_1 +\1x_2 +\1x_3 + 3x_4 +\1x_5 +\1x_6 =& \!\!-1 \cr
           2x_1 + 2x_2 + 2x_3 + 6x_4 + 2x_5 + 8x_6 =& 10 }
$$
Eliminujeme roz¹íøenou matici soustavy.
$$
  \def\+{\kern3pt} \def\|{\kern4pt\strut\vrule}\!
  \thickmuskip=3mu
  \matice{1 & 1 & 2 & 3 & 3 & 3 \|&  1 \cr
          1 & 1 & 1 & 3 & 1 & 1 \|& -1 \cr
          2 & 2 & 2 & 6 & 2 & 8 \|& 10 } \sim
  \matice{1 &\+1 & 2 &\+3 & 3 & 3 \|&  1 \cr
          0 & 0 &-1 & 0 &-2 &-2   \|& -2  \cr
          0 & 0 &-2 & 0 &-4 & 2   \|&  8 } \sim
  \matice{1 & 1 & 2 & 3 & 3 & 3 \|& 1 \cr
          0 & 0 & 1 & 0 & 2 & 2 \|& 2 \cr
          0 & 0 & 0 & 0 & 0 & 6 \|& 12 } \sim
  \matice{1 & 1 & 2 & 3 & 3 & 3 \|& 1 \cr
          0 & 0 & 1 & 0 & 2 & 2 \|& 2 \cr
          0 & 0 & 0 & 0 & 0 & 1 \|& 2 }.\!
$$ 

Z poslední rovnice budeme poèítat $x_6$, z pøedposlední rovnice $x_3$
a z první rovnice $x_1$. Hodnoty neznámých $x_2, x_4, x_5$ mohou být
libovolné. Zaveïme pro nì parametry $x_2=t$, $x_4=u$, $x_5=v$. 

Z poslední rovnice máme $x_6=2$, z pøedposlední rovnice 
$x_3 = 2 -2v -2\cdot2 = -2 -2v$ a
koneènì z~první rovnice dostáváme 
$x_1 = 1 -t -2(-2-2v) -3u -3v -3\cdot2 = -1 -t +v -3u$.
Výsledek sumarizujeme takto:
$$\eqalign{
  (x_1, x_2, x_3, x_4, x_5, x_6) &= (-1 -t +v -3u, t, -2 -2v, u, v, 2) =\cr
   &= (-1,0,-2,0,0,2) + 
      t\,(-1,1,0,0,0,0) + u\,(-3,0,0,1,0,0) + v\,(1,0,-2,0,1,0). }
$$
Z tohoto zápisu vyplývá, ¾e mno¾ina v¹ech øe¹ení dané nehomogenní
soustavy je rovna
$$
  M = (-1,0,-2,0,0,2) + 
      \bigl<(-1,1,0,0,0,0), (-3,0,0,1,0,0), (1,0,-2,0,1,0)\bigr>.
$$
Vektor $(-1,0,-2,0,0,2)$ je partikulárním øe¹ením dané nehomogenní soustavy a 
vektory $(-1,1,0,0,0,0)$, $(-3,0,0,1,0,0)$, $(1,0,-2,0,1,0)$ tvoøí
bázi prostoru øe¹ení pøidru¾ené homogenní soustavy.

\poznamka
%%%%%%%%%
Ve vý¹e uvedeném pøíkladì jsem spoèítali partikulární øe¹ení i bázi
mno¾iny øe¹ení pøidru¾ené homogenní soustavy v jediném postupu. Èasto
ale takovéto lineární úlohy øe¹íme ve dvou krocích. Nejprve najdeme
bázi øe¹ení pøidru¾ené homogení soustavy (to jsme provedli 
v~pøíkladu\cite[homoprikl]) a poté je tøeba \uv{uhodnout} jedno øe¹ení
dané nehomogení soustavy. Takové øe¹ení prohlásíme za partikulární
øe¹ení. Nakonec zapí¹eme výsledek v souladu s poznámkou\cite[v+M0]
ve formì \uv{partikulární øe¹ení plus
lineární obal báze mno¾iny øe¹ení pøidru¾ené homogenní soustavy}.

Partikulární øe¹ení mù¾eme najít po pøímém chodu eliminaèní metody, 
kdy¾ rozhodneme, které promìné budeme pomocí rovnic poèítat. Tìm ostatním promìným 
mù¾eme pøidìlit jakákoli èísla, tøeba nuly. Po dosazení tìchto èísel
vzniká soustava, která má stejnì rovnic jako neznámých a má regulární 
matici, tedy má jediné øe¹ení. Toto øe¹ení obsahuje hodnoty hledaných
promìnných.

Tøeba v pøíkladì\cite[nehomoruc] jsme rozhodli, ¾e budeme poèítat
promìnné $x_1, x_3, x_6$, tak¾e pøi hledání partikulárního øe¹ení
promìnným $x_2, x_4, x_5$ pøidìlíme tøeba nuly. Po dosazení tìchto nul
dostáváme soustavu s maticí
$$
  \def\|{\kern4pt\strut\vrule}
  \matice{1 & 2 & 3 \|& 1 \cr
          0 & 1 & 2 \|& 2 \cr
          0 & 0 & 1 \|& 2 }.\!
$$
Nyní mù¾eme pou¾ít zpìtný chod Gaussovy eliminaèní metody nebo poèítat
dosazovací metodou od poslední rovnice k první. Dostáváme øe¹ení
$x_1=-1, x_3=-2, x_6=2$, tak¾e partikulárním øe¹ením je $(-1,0,-2,0,0,2)$.

\okraj Strojové\hb øe¹ení\hb soustav | Strojove reseni soustav

\poznamka %{\it O strojovém zpracování soustav lineárních rovnic}.
%%%%%%%%%
Pøi strojovém hledání øe¹ení rozsáhlých soustav vìt¹inou jde o to najít jedno
partikulární øe¹ení a bázi prostoru øe¹ení pøidru¾ené homogenní
soustavy. Pøitom není nutné programovat symbolické výpoèty, jako je
napøíklad vytýkání parametrù podle rovnosti\cite(uhomo). 
V následujícím textu uká¾eme, ¾e staèí vyu¾ít Gaussovu
eliminaèní metodu.

K nalezení báze pøidru¾ené homogenní soustavy mù¾eme pou¾ít
následující vìtu\cite[genbasehomo] a k nalezení partikulírního 
øe¹ení vyu¾ijeme vìtu\cite[genpartikul].

\veta [genbasehomo]
%%%%%
Nech» homogenní soustava lineárních rovnic $\A\vec x = \vec o$ má
matici soustavy ve tvaru $$\A=(\E\,|\,\C),$$ 
kde $\E\in\R^{m,m}$ je jednotková matice
a $\C\in\R^{m,k}$ je libovolná matice. 
Pak existuje báze øe¹ení této soustavy $\vecc b_k$, 
která má tvar:
$$
  \pmatrix {\vec b_1\cr \vec b_2\cr \vdots \cr \vec b_k} = (-\C^T \,|\, \E'), 
$$
kde $\E'\in\R^{k,k}$ je jednotková matice.

\dukaz
Nejprve pøekontrolujeme rozmìry matic. Nech» poèet neznámých soustavy
je $n$, tak¾e matice soustavy $\A$ je typu $(m,n)$. Poèet sloupcù $n$
této matice se skládá z~$m$ sloupcù (matice $\E$) a $k$ sloupcù
(matice $\C$). Je tedy $n=m+k$. Dimenze prostoru øe¹ení je podle 
vìty\cite[dimhomo] rovna poètu neznámých minus $\hod\A$, co¾ je $n-m=k$. To
sedí. Skuteènì matice $\B=(-\C^T|\E')$ má $k$ øádkù a tyto jsou
lineárnì nezávislé (díky matici $\E'$). Matice $\B$ tedy mù¾e
obsahovat øádky báze prostoru øe¹ení. Staèí jen ovìøit, ¾e ka¾dý øádek
matice $\B$ øe¹í soustavu $\A\vec x = \vec o$. Tj. staèí ovìøit, ¾e
$\A\cdot\B^T={\bf O}$, kde ${\bf O}$ je nulová matice typu $(m,k)$:
$$
  \A\cdot\B^T = 
  (\E\,|\,\C)\cdot \pmatrix{-\C\cr\noalign{\smallskip\hrule\smallskip}\E'} =
  \E\cdot(-\C) + \C\cdot\E' = -\C+\C = {\bf O}.
$$

\poznamka
%%%%%%%%%
Tato vìta nám umo¾òuje rovnou napsat bázi øe¹ení homogenní soustavy,
pokud je matice soustavy v uvedeném tvaru. Dokonce, pokud
matice soustavy není v uvedeném tvaru, je nìkdy mo¾né jí eliminací do
tohoto tvaru pøevést, tj. ekvivalentní soustava mù¾e mít tento tvar.
Pokud ani ekvivalentní soustava nemá tento tvar, dá se prohozením
poøadí neznámých dospìt k po¾adovanému tvaru matice soustavy. 
V takovém pøípadì je ov¹em nutné pøed zapsáním báze prostoru øe¹ení
prohodit sloupce matice $\B=(-\C^T|\E')$ zpìt. Místo dlouhého
vysvìtlování uká¾eme pou¾ití vìty na na¹em pøíkladu\cite[homoprikl].

\priklad [homostroj]
%%%%%%%%
Najdeme bázi prostoru øe¹ení soustavy
z pøíkladu\cite[homoprikl].
Eliminujeme matici soustavy:
$$
  \def\+{\kern3pt} \def\|{\kern4pt\strut\vrule}\!
  \matice{1 & 1 & 2 & 3 & 3 & 3  \cr
          1 & 1 & 1 & 3 & 1 & 1  \cr
          2 & 2 & 2 & 6 & 2 & 8  } \sim
  \matice{1 &\+1 & 2 &\+3 & 3 & 3 \cr
          0 & 0 &-1 & 0 &-2 &-2   \cr
          0 & 0 &-2 & 0 &-4 & 2  } \sim
  \matice{1 & 1 & 2 & 3 & 3 & 3 \cr
          0 & 0 & 1 & 0 & 2 & 2 \cr
          0 & 0 & 0 & 0 & 0 & 6  } \sim
  \matice{1 & 1 & 2 & 3 & 3 & 3 \cr
          0 & 0 & 1 & 0 & 2 & 2 \cr
          0 & 0 & 0 & 0 & 0 & 1  }.
$$
Eliminujeme dále zpìtným chodem, abychom ve sloupcích 1, 3 a 6 dostali jednotkové
vektory:
$$
  \matice{1 & 1 & 2 & 3 & 3 & 3 \cr
          0 & 0 & 1 & 0 & 2 & 2 \cr
          0 & 0 & 0 & 0 & 0 & 1  } \sim
  \matice{1 & 1 & 2 & 3 & 3 & 0 \cr
          0 & 0 & 1 & 0 & 2 & 0 \cr
          0 & 0 & 0 & 0 & 0 & 1  } \sim
  \matice{1 &\ 1 &\ 0 &\ 3 & -1 &\ 0 \cr
          0 & 0 & 1 & 0 & 2 & 0 \cr
          0 & 0 & 0 & 0 & 0 & 1  } .
$$
Prohodíme druhý sloupec s tøetím a poslední sloupec s novým tøetím
(mìníme poøadí promìnných)
$$
  \matice{1 &\ 0 &\ 0 &\ 3 & -1 &\ 1 \cr
          0 & 1 & 0 & 0 & 2 &  0 \cr
          0 & 0 & 1 & 0 & 0 &  0 } 
$$
a dostáváme matici podle pøedpokladu vìty\cite[genbasehomo]. Bázi øe¹ení soustavy 
s takovou maticí mù¾eme podle této vìty zapsat do matice, kde ka¾dý øádek
obsahuje jeden vektor báze:
$$
  \matice { -3 &  0 &\ 0 &\ 1 &\ 0 &\ 0 \cr
             1 & -2 & 0 & 0 & 1 & 0 \cr
            -1 &  0 & 0 & 0 & 0 & 1 }.
$$
Zpìtnì pøehodíme poslední sloupec s tøetím a druhý s novým tøetím
a dostáváme matici, obsahující (po øádcích) bázi øe¹ení pùvodní soustavy
$$
  \matice { -3 &\ 0 &  0 &\ 1 &\ 0 &\ 0 \cr
             1 & 0 & -2 & 0 & 1 & 0 \cr
            -1 & 1 &  0 & 0 & 0 & 0 }.
$$

\veta [genpartikul]
%%%%%
Nech» soustava lineárních rovnic $\A\vec x=\vec b$ má matici soustavy
ve tvaru $$\A=(\E\,|\,\C),$$ kde $\E\in\R^{m,m}$ je jednotková matice
a $\C\in\R^{m,k}$ je libovolná matice. Pak partikulárním øe¹ením
soustavy je vektor $\vec v=(\vec b^T,\vec o)$, kde $\vec o\in\R^k$ je
nulový vektor.

\dukaz
%%%%%%
Staèí dosadit: $$\A\cdot\pmatrix{\vec b\cr\vec o}=
(\E\,|\,\C)\pmatrix{\vec b\cr\vec o} = \E\vec b + \C\vec o = \vec b.$$

\priklad [pstroj]
%%%%%%%%
V tomto pøíkladì si uká¾eme \uv{strojové} øe¹ení soustav
lineárních rovnic s vyu¾itím vìt\cite[genbasehomo]
a\cite[genpartikul]. K øe¹ení nepotøebujeme nic jiného ne¾ dobøe
namazaný stroj zvládající pøímý a zpìtný chod Gaussovy eliminaèní
metody.

Najdeme mno¾inu øe¹ení soustavy lineárních rovnic s roz¹íøenou maticí:
$$
  \def\+{\kern3pt} \def\|{\kern4pt\strut\vrule}\!
  \thickmuskip=3mu
  \matice{1 & \+1 & -1 & \+11 & \+1 \|&  3 \cr
          1 & 2 & 2 & 8 & 2 \|& 5 \cr
          2 & 5 & 7 & 17 & 6 \|& 18 \cr
          3 & 6 & 6 & 28 & 7 \|& 21 }
$$

Pomocí pøímého chodu eliminaèní metody matici pøevedeme na schodovitou
matici. Po prohození tøetího sloupce s posledním pak dostáváme matici,
na které mù¾eme pou¾ít zpìtný chod Gaussovy eliminaèní metody 
tak, ¾e v levém bloku dostaneme jednotkovou matici. Nad matici jsme si
poznamenali zmìnìné poøadí promìných.
$$
  \def\+{\kern3pt} \def\|{\kern4pt\strut\vrule}\!
  \thickmuskip=3mu
  \!\matice{1 & \+1 & -1 & \+11 & \+1 \|&  3 \cr
          1 & 2 & 2 & 8 & 2 \|& 5 \cr
          2 & 5 & 7 & 17 & 6 \|& 18 \cr
          3 & 6 & 6 & 28 & 7 \|& 21 } \sim
  \mathop{\matice{1 & \+1 & -1 & \+11 & \+1 \|&  3 \cr
          0 & 1 & 3 & -3 & 1 \|& 2 \cr
          0 & 0 & 0 & 4 & 1 \|& 6 }}  
  \limits^{\vbox{\hbox to90pt
    {$x_1\hss x_2\hss x_3\hss x_4\hss x_5$\kern 18pt}\kern3pt}} 
  {\!\leftrightarrow\!}
  \mathop{\matice{1 & \+1 & \+1 & \+11 & -1 \|&  3 \cr
          0 & 1 & 1 & -3 & 3 \|& 2 \cr
          0 & 0 & 1 & 4 & 0 \|& 6 }}
  \limits^{\vbox{\hbox to90pt
    {$x_1\hss x_2\hss x_5\hss x_4\hss x_3$\kern 18pt}\kern3pt}}  
  \sim
  \matice{1 & \+0 & \+0 & \+14 & -4 \|&  1 \cr
          0 & 1 & 0 & -7 & 3 \|& -4 \cr
          0 & 0 & 1 & 4 & 0 \|& 6 } \!
$$
Podle vìty\cite[genbasehomo] má tato soustava bázi øe¹ení pøidru¾ené
homogení soustavy zapsanou v øádcích matice:
$$
  (-\C^T\,|\,\E') = \matice{-14 & 7 & -4 & \+1 & \+0 \cr
                             4 &  -3 & 0 & 0 & 1}
$$
a podle vìty\cite[genpartikul] je partikulární øe¹ení ve tvaru
$(1, -4, 6, 0, 0)$. 
Po zpìtném pøehození sloupcù tak, abychom popsali výsledek pro
neznámé v poøadí $(x_1,x_2,x_3,x_4,x_5)$ dostáváme øe¹ení:
$$
  (1,-4,0,0,6) + \lob<(-14,7,0,1,-4),\, (4,-3,1,0,0)>,
$$
které jsme zapsali jako souèet partikulárního øe¹ení a 
lineárního obalu báze mno¾iny øe¹ení pøidru¾ené homogenní soustavy,
tedy v souladu s poznámkou\cite[v+M0].



\okraj Geometrická interpretace\hb mno¾iny\hb øe¹ení | 
       Geometricka interpretace mnoziny reseni

\dolu 2mm
\obrazek .5+.02 11 obr6
{
  \p 18 200 {\varrho}
  \p 95 200 {\varrho'}
  \p 45 120 \vec v
  \p 97 55 O
  \p 100 105 \vec u_1
  \p 85 103 \vec u_2
  \p 23 152 \vec u_1
  \p 7 175 \vec u_2
}
\poznamka [geomnadroviny]
%%%%%%%%%
Pøedstavme si soustavu lineárních rovnic se tøemi neznámými a 
s~jedinou nenulovou rovnicí. Pokud interpretujeme ka¾dou
uspoøádanou trojici, která je øe¹ením soustavy, jako souøadnice bodu 
v~geometrickém prostoru, pak mno¾ina v¹ech tìchto bodù vyplní rovinu.
V pøípadì, ¾e je na¹e soustava homogenní, pak mno¾ina øe¹ení tvoøí
lineární podprostor dimenze $3-1=2$, tj. vyplní rovinu $\varrho'$
procházející poèátkem~$O$, tj. bodem se souøadnicemi $(0,0,0)$. 
V pøípadì, ¾e soutava má nenulovou pravou stranu, pak mno¾inou øe¹ení je
rovina, která neprochází poèátkem. Je to rovina $\varrho$ rovnobì¾ná s mno¾inou
øe¹ení pøidru¾ené homogenní soustavy $\varrho'$ a prochází bodem, který je dán
jako partikulární øe¹ení $\vec v$. Viz obrázek.
{\emergencystretch=2em\par}

\dolu 2mm
\obrazek .5+.02 11 obr7
{
  \p 18 200 {\varrho}
  \p 90 135 {\sigma}
  \p 52 120 p
}
\poznamka [pruniknadrovin]
%%%%%%%%%
Pøedstavme si soustavu dvou lineárnì nezávislých lineárních rovnic o
tøech neznámých. Mno¾inu øe¹ení interpretujme jako body v prostoru
stejnì jako v pøedchozí poznámce. Øe¹ení první rovnice 
vyplní rovinu $\varrho$ a øe¹ení druhé rovnice vyplní rovinu 
$\sigma$ (viz obrázek). Tak¾e øe¹ení 
obou rovnic \uv{spoleènì} je prùnikem rovin $\varrho$ a $\sigma$.
To je pøímka, oznaème ji $p$. 
Dimenze mno¾iny øe¹ení pøidru¾ené homogenní soustavy je
podle vìty\cite[dimhomo] rovna $3-2=1$. 

\poznamka
%%%%%%%%%
Tøi lineárnì nezávislé rovnice o tøech neznámých mají jednobodové
øe¹ení, které je prùnikem tøí rovin, kde ka¾dá rovina je mno¾inou
øe¹ení jedné rovnice.

\poznamka
%%%%%%%%%
Nemá-li soustava tøí rovnic o tøech neznámých øe¹ení, pak jednotlivé
rovnice mají jako své mno¾iny øe¹ení roviny, které nemají spoleèný
prùnik. Uvìdomíme si, jakým zpùsobem se to mù¾e stát: buï jsou dvì
roviny rovnobì¾né a nikoli toto¾né, nebo mají roviny jako prùnik pøímky,
které jsou rovnobì¾né.

\poznamka* [nadrovina]
%%%%%%%%%
Má-li soustava lineárních rovnic $n$ neznámých, pak mno¾inou 
øe¹ení je podmno¾ina~$\R^n$. Pøedstavme si, ¾e nyní $n>3$.
S trochou fantazie je mo¾né si i tyto podmno¾iny pøedstavit
geometricky jako {\em zobecnìné roviny}.

Pojem {\em zobecnìná rovina} se pou¾ívá pro
analogický geometrický útvar jako je rovina nebo pøímka 
v~geo\-metrickém prostoru, ale mù¾e mít libovolnou (tøeba vìt¹í)
dimenzi. Zobecnìná rovina nemusí na rozdíl od lineárního podprostoru
procházet poèátkem. Pokud ji ale posuneme do poèátku, tvoøí
podprostor. Mluvíme-li tedy o {\em dimenzi zobecnìné roviny}, máme na mysli
dimenzi lineárního podprostoru, který vznikne posunutím zkoumané
zobecnìné roviny tak, aby procházela poèátkem.
\inl[zobecnìná rovina]

Mno¾ina øe¹ení jedné rovnice ze soustavy je zobecnìná rovina, která má
dimenzi $n-1$. Mno¾ina øe¹ení celé soustavy $\A\vec x=\vec b$
je prùnikem tìchto zobecnìných rovin a je to zase zobecnìná 
rovina~$\varrho$,
která má podle vìty\cite[dimhomo] dimenzi $n-\hod\A$. Mno¾ina 
øe¹ení pøidru¾ené homogenní soustavy $\A\vec x=\vec o$ je zobecnìná rovina
$\varrho'$ taková, ¾e prochází poèátkem a 
$\varrho=\vec v+\varrho'$, kde $\vec v$ je
partikulární øe¹ení. Tedy $\varrho$ vzniká z $\varrho'$ posunutím 
o~$\vec v$. Nebo obrácenì, $\varrho'$ vzniká posunutím $\varrho$ 
o~vektor~$-\vec v$. 

Obrázky u poznámek\cite[geomnadroviny] a\cite[pruniknadrovin]
lze vyu¾ít jako ilustraci pro mno¾iny øe¹ení libovolné soustavy
lineárních rovnic. První obrázek øíká, ¾e zobecnìná rovina, která je mno¾inou 
øe¹ení nehomogenní soustavy lineárních rovnic, je posunutá z poèátku
o partikulární øe¹ení. Druhý obrázek øíká, ¾e mno¾ina øe¹ení je
zobecnìná rovina, která je prùnikem nadrovin, které jsou øe¹eními jednotlivých
rovnic. 

\poznamka
%%%%%%%%%
Øe¹ení soustavy jako prùnik øe¹ení jednotlivých rovnic, jak je popsáno
v pøedchozích poznámkách, je pohled na øe¹ení po rozdìlení roz¹íøené matice
soustavy $(\A\,|\,\vec b)$ na jednotlivé øádky. Ka¾dý øádek odpovídá jedné rovnici.
Nìkdy se hodí jiný, sloupcový pohled, na øe¹ení sousavy. Rozepi¹me
matici soustavy na sloupce $\A=(\A_1,\A_2,\ldots,\A_n)$. Pak maticové
násobení ve výrazu $\A\vec x=\vec b$ mù¾eme pøepsat takto:
$$
    \A\cdot{\bf x}\ = \
  (\A_1,\A_2,\ldots,\A_n)\cdot\pmatrix{x_1\cr x_2\cr\vdots\cr x_n} = \
  x_1\A_1 + x_2\A_2 + \cdots + x_n\A_n \ = \ {\bf b}
$$
tak¾e øe¹ení obsahuje koeficienty takové lineární kombinace sloupcù,
která je rovna vektoru pravých stran~$\vec b$.

\okraj Nejedno\-znaènost zápisu øe¹ení | Nejednoznacnost zapisu reseni

\poznamka [popis-reseni]
%%%%%%%%%
Ji¾ v úvodní kapitole o Gaussovì eliminaèní metodì jsme zmínili, ¾e
mno¾inu øe¹ení soustavy lineárních rovnic neumíme popsat jednoznaèným
zpùsobem. Výjimkou je pouze pøípad, kdy má soustava jediné øe¹ení.
Víme toti¾, ¾e ka¾dý netriviální lineární podprostor má nekoneènì 
mnoho bází a má-li soustava více øe¹ení, pak i partikulární øe¹ení
mù¾e ka¾dý øe¹itel zapsat jiné.  

K rùzným zápisùm té¾e mno¾iny øe¹ení mù¾eme dospìt pøi výpoètu tøeba
tak, ¾e volíme rozdílnou skupinu neznámých, které mohou nabývat
libovolných hodnot. I pøi stejné skupinì tìchto neznámých nás nikdo
nenutí, abychom tyto neznámé polo¾ili rovny jednonásobku parametru.
V~modelových øe¹eních pøíkladù ze skript se mù¾eme setkat nìkdy i
s~jinak volenými parametry tak, aby výsledek vy¹el bez pou¾ití zlomkù
pouze s malými celými èísly. Tuto dovednost nebudeme v praktických
pøíkladech (které nejsou modelové) potøebovat, tak¾e nás nemusí
frustrovat, ¾e nám vycházejí ve výsledcích zlomky.  Mù¾eme ov¹em v
závìru výpoètu ka¾dý vektor báze vynásobit spoleèným jmenovatelem
v¹ech zlomkù v jednotlivých slo¾kách a znovu dostáváme vektory báze
stejného lineárního prostoru, tentokrát s celoèíselnými slo¾kami.  
\inl[pøíklad: modelový, modelový pøíklad]

Kvùli nejednoznaènosti popisu øe¹ení soustav lineárních rovnic je
u¾iteèné vìdìt, jak poznáme, ¾e dva rùzné popisy øe¹ení
popisují stejnou mno¾inu øe¹ení. To je
rozebráno podrobnì v následující poznámce. 

%Mù¾e nás zajímat, zda ná¹ výsledek a výsledek, který tøeba najdeme
%ve skriptech, popisují stejnou mno¾inu øe¹ení. Jak to poznáme?
%Pøedev¹ím báze prostoru øe¹ení pøidru¾ené homogenní soustavy musí
%obsahovat v obou výsledcích podle vìty\cite[stejnebase] 
%stejný poèet prvkù. Ovìøíme je¹tì, ¾e jsou v obou výsledcích skuteènì
%báze, tj.~¾e jsou vektory popisující prostor øe¹ení pøidru¾ené
%homogenní soustavy skuteènì lineárnì nezávislé. Dále zjistíme, zda
%oba výsledky popisují stejný podprostor øe¹ení pøidru¾ené homogenní
%soustavy. Na to máme lagoritmus porovnávání lineárních obalù\cite[algolrovnost].
%Pøitom rozdíl dvou partikulárních øe¹ení musí rovnì¾ le¾et v mno¾inì
%pøidru¾ené homogenní soustavy. V následující poznámce shrneme, jak lze
%tento test provést.

\poznamka* [ruznareseni]
%%%%%%%%%
Co udìláme, pokud se nám dostanou do ruky dva zápisy øe¹ení nìjaké
soustavy lineárních rovnic, a pøitom nemáme k dispozici pùvodní
soustavu a nemù¾eme tedy dosazovat? Jak v~tomto pøípadì poznáme, ¾e
oba zápisy popisují stejné øe¹ení? Jsou dány tøeba tyto zápisy:

\line{\hss\vbox to0pt{\hsize=.2\hsize \kern20pt 
$$
  \C = \pmatrix {\vec u_1\cr \vec u_2\cr \vdots\cr \vec u_k \cr
                 \vec g_1\cr \vec g_2\cr \vdots\cr \vec g_k \cr
                 \vec v - \vec w}
$$
\vss}}
\nobreak\vskip-\baselineskip


{\hsize=.77\hsize
$$
  \vec v + \lob<\vecc u_k> \ \buildrel ?\over = \ 
  \vec w + \lob<\vecc g_k> 
$$
Nejprve ovìøíme lineární nezávislost vektorù $\vecc u_k$ a lineární
nezávislost vektorù $\vecc g_k$.
Dále zjistíme algoritmem\cite[algolrovnost], zda jsou rovny lineární obaly. 
Nakonec zjistíme, zda obì
partikulární øe¹ení popisují stejnou mno¾inu øe¹ení tøeba 
podle vlastnosti~(2) vìty\cite[nehomoprst]
tímto testem: $\vec v - \vec w \in \lob<\vecc u_k>$.
Na to se hodí algoritmus\cite[algoljeprvkem]. 

Spojením obou algoritmù
dostáváme následující test: uvedené mno¾iny se rovnají právì tehdy
kdy¾ vektory $\vecc u_k$ jsou lineárnì nezávislé i vektory $\vecc g_k$
jsou lineárnì nezávislé a hodnost matice $\C$ (zapsaná zde vpravo) je rovna~$k$.
Proto¾e pro velká $k$ je matice $\C$ \uv{pøíli¹ vysoká}, je nìkdy 
výhodné místo toho poèítat hodnost matice $\C^T$. Podle 
vìty\cite[hA=hAT] dostaneme stejný výsledek, ale navíc ¹etøíme 
papírem a dal¹ími kanceláøskými technologiemi.
\par}

\priklad
%%%%%%%%
Provìøíme, zda mno¾ina 
$$
  M_1 = (1,2,-4,-1,1,2) + 
        \bigl< (7,1,-4,-2,2,0), (-8,3,-2,2,1,0), (2,-2,-6,1,3,0) \bigr>
$$
je rovna mno¾inì $M$ z pøíkladu\cite[nehomoruc].

Díky tomu, ¾e na¹e øe¹ení z pøíkladu\cite[nehomoruc] obsahuje na
pozicích 2, 4 a 5 systematicky rozmístìné nuly a jednièky, mù¾eme
okam¾itì pohledem do tìchto pozic psát následující koeficienty 
lineárních kombinací:
$$
  \def\+{\hphantom{+}}
  \eqalign{
  (7,1,-4,-2,2,0) &=\+1\,(-1,1,0,0,0,0)-2\,(-3,0,0,1,0,0)+2\,(1,0,-2,0,1,0),\cr
  (-8,3,-2,2,1,0) &=\+3\,(-1,1,0,0,0,0)+2\,(-3,0,0,1,0,0)+1\,(1,0,-2,0,1,0),\cr
  (2,-2,-6,1,3,0) &=-2\,(-1,1,0,0,0,0)+1\,(-3,0,0,1,0,0)+3\,(1,0,-2,0,1,0),\cr
  (1,2,-4,-1,1,2) &= (-1,0,-2,0,0,2) +
                    2\,(-1,1,0,0,0,0)-1\,(-3,0,0,1,0,0)+1\,(1,0,-2,0,1,0). }
$$
Tyto rovnosti platí i v ostatních slo¾kách (nejen ve slo¾kách 2, 4 a 5) 
a mù¾eme tedy prohlásit, ¾e $M_1=M$.

Pro porovnání zkusíme je¹tì metodu poèítání hodnosti matice $\C$ 
z poznámky\cite[ruznareseni]. Nejprve musíme ovìøit, zda jsou vektory
$(7,1,-4,-2,2,0), (-8,3,-2,2,1,0), (2,-2,-6,1,3,0)$ lineárnì
nezávislé (napøíklad eliminací tøíøádkové matice obsahující tyto
vektory). Zjistíme, ¾e jsou lineárnì nezávislé. Pak spoèítáme hodnost
matice $\C$:
$$
 \thickmuskip=3mu
 \!\C^T = \matice{\!-1 &-3 & 1 & 7 &-8 & 2 &-2 \cr
                  1 & 0 & 0 & 1 & 3 &-2 &-2 \cr
                  0 & 0 &-2 &-4 &-2 &-6 & 2 \cr
                  0 & 1 & 0 &-2 & 2 & 1 & 1 \cr
                  0 & 0 & 1 & 2 & 1 & 3 &-1 \cr
                  0 & 0 & 0 & 0 & 0 & 0 & 0 } \sim
         \matice{\!-1 &-3 & 1 & 7 &-8 & 2 &-2 \cr
                  0 &-3 & 1 & 8 &-5 & 0 &-4 \cr
                  0 & 1 & 0 &-2 & 2 & 1 & 1 \cr
                  0 & 0 &-2 &-4 &-2 &-6 & 2 \cr
                  0 & 0 & 1 & 2 & 1 & 3 &-1 } \sim
         \matice{\!-1 &-3 & \,1 & \,7 &-8 & \,2 &-2 \cr
                  0 &-3 & 1 & 8 &-5 & 0 &-4 \cr
                  0 & 0 & 1 & 2 & 1 & 3 &-1 }.\!
$$
Je $\hod\C = 3$, tak¾e platí $M = M_1$.

\okraj Soustavy se ètvercovou maticí | Soustavy se ctvercovou matici

\poznamka
%%%%%%%%%
Je-li $\A$ ètvercová matice, pak je výhodné pøi øe¹ení soustavy 
$\A\,\vec x = \vec b$ spoèítat $\det\A$.

Pro $\det\A\not=0$ je $\hod\A$ rovna poètu neznámých, tj. matice $\A$
je regulární a soustava má jediné øe¹ení.
Mno¾ina øe¹ení pøidru¾ené homogenní soustavy obsahuje toti¾ v tomto
pøípadì jediné øe¹ení: nulový vektor.
Po vynásobení rovnosti $\A\,\vec x = \vec b$ inverzní maticí
$\A^{-1}$ zleva máme okam¾itì  øe¹ení soustavy
$\vec x = \A^{-1}\,\vec b$. Navíc mù¾eme pou¾ít pro zji¹tìní
jednotlivých slo¾ek øe¹ení tzv.~Cramerovo pravidlo (viz následující
vìtu).

Pro $\det\A=0$ je $\hod\A$ men¹í ne¾ poèet neznámých. Pokud má tato
soustava podle Frobeniovy vìty\cite[frobeni] øe¹ení, pak po
eliminaci a odstranìní nulových øádkù dostáváme soustavu, která 
u¾ nemá ètvercovou matici. V tomto pøípadì nezbývá nic jiného, ne¾
pou¾ít postup pro nalezení v¹ech øe¹ení, který byl ji¾ vylo¾en døíve.

\veta (Cramerovo pravidlo) * [cramer]
%%%%%
Nech» $\A$ je regulární ètvercová matice. Pak pro $i$-tou slo¾ku øe¹ení
soustavy $\A\,\vec x = \vec b$ platí
$$
  \alpha_i = {\det \B_i \over \det\A}\,,
$$
kde matice $\B_i$ je shodná s maticí $\A$ a¾ na $i$-tý sloupec, který
je zamìnìn za sloupec pravých stran.
\inl[pravidlo: Cramerovo, Cramerovo: pravidlo]

\dukaz
%%%%%%
Víme, ¾e platí $\vec x = \A^{-1}\,\vec b$. Podle vìty\cite[A-1D] platí
$$
  \A^{-1} = (c_{i,j}) = \left({ D_{j,i} \over \det\A }\right), \quad
  \hbox{kde $D_{i,j}$ je matice doplòkù k matici $\A$.}
$$
Nech» $b_i$ jsou slo¾ky sloupce $\vec b$. Podle definice 
maticového násobení je
$$
  \alpha_i = \sum_{j=1}^n c_{i,j}\,b_j = 
            \sum_{j=1}^n { D_{j,i} \over \det\A }\, b_j =
           { 1 \over \det\A }\,\Bigl( D_{1,i}\,b_1 + D_{2,i}\,b_2 + \cdots
            + D_{k,i}\,b_k\Bigr) = {\det \B_i \over \det\A}.
$$
V poslední rovnosti jsme vyu¾ili vìtu o rozvoji determinantu matice 
$\B_i$ podle $i$-tého sloupce, viz poznámku\cite[rozvojdoplnku].

\priklad
%%%%%%%%
Pøi øe¹ení soustavy
$$
  \matice{1 & 2 & 3 \cr 3 & 4 & 5 \cr 5 & 6 & 8} \cdot
  \matice{x_1 \cr x_2 \cr x_3} = \matice{10 \cr 11 \cr 12}
$$
pou¾ijeme Cramerovo pravidlo. Dostáváme:
$$
  x_1 = {1\over D}
        \left| \matrix{10 & 2 & 3 \cr 11 & 4 & 5 \cr 12 & 6 & 8}\right|
        , \quad
  x_2 = {1\over D}
        \left| \matrix{1 & 10 & 3 \cr 3 & 11 & 5 \cr 5 & 12 & 8}\right|
        , \quad
  x_3 = {1\over D}
        \left| \matrix{1 & 2 & 10 \cr 3 & 4 & 11 \cr 5 & 6 & 12}\right|
        , \quad
  \hbox{kde }  D = 
        \left| \matrix{1 & 2 & 3 \cr 3 & 4 & 5 \cr 5 & 6 & 8}\right|.
$$
Vypoèítáním ètyø determinantù z uvedených matic typu (3,3) dostáváme výsledek
$$
  x_1 = { 18 \over -2 } = -9, \quad
  x_2 = { -19 \over -2 } = { 19 \over 2 }, \quad
  x_3 = { 0 \over -2 } = 0, \quad 
  (x_1, x_2, x_3) = \left(\! -9, {19\over2}, 0 \right).
$$

\poznamka
%%%%%%%%%
Cramerovo pravidlo se nejeví pro výpoèet øe¹ení soustavy s regulární
maticí pøíli¹ úèelné. Potøebujeme spoèítat $n+1$ determinantù matic
typu $(n,n)$, co¾ je pro velká $n$ nároènìj¹í, ne¾ spoèítat 
inverzní matici eliminaèní metodou. Výhodná mù¾e být tato metoda pouze
tehdy, kdy¾ nepotøebujeme znát v¹echny slo¾ky øe¹ení, ale jen nìkteré.
Napøíklad mù¾eme mít nìjaký fyzikální model vyjádøený rozsáhlou soustavou 
lineárních rovnic, pøièem¾ z mnoha stovek výstupních velièin (tj. 
slo¾ek øe¹ení) nás zajímá jen~pár. 

\priklad
%%%%%%%%
Budeme øe¹it soustavu lineárních rovnic
$$
  \soustava{x +& py +& z  =& 1  \cr
            x +& 2y +& z  =& \!-1 \cr
               &  y +& pz =& \!-1 }
$$
Rozli¹íme rùzné mno¾iny øe¹ení této soustavy podle hodnot reálného
parametru $p$.

Determinant matice soustavy je roven $D = p\,(2-p)$, tak¾e pro 
$p\not=0$ a $p\not=2$ je matice soustavy regulární a soustava má
jediné øe¹ení. Napøíklad Cramerovým pravidlem zjistíme toto øe¹ení:
$$
  \def\+{\hphantom{+}}
  x = {1\over D} \,
      \left|\matrix{\+1&p&1\cr-1&2&1\cr-1&1&p}\right| = 
%      { p\,(p+1) \over p\,(2-p) } = 
      { p+1 \over 2-p }, \quad
  y = {1\over D} \,
      \left|\matrix{1&\+1&1\cr1&-2&0\cr0&-1&p}\right| = 
      { 2 \over p-2 }, \quad
  z = {1\over D} \,
      \left|\matrix{1&p&\+1\cr1&2&-1\cr0&1&-1}\right| = 
      { 1 \over 2-p }.
$$
Pro $p=0$ a $p=2$ musíme øe¹it soustavu individuálnì.
$$
  \def\|{\kern3pt\strut\vrule} \jot=0pt
\eqalign{
  p=0:&\enspace \matice{1&0&1\|&1\cr1&2&1\|&-1\cr0&1&0\|&-1} \sim
               \matice{1&0&1\|&1\cr0&1&0\|&-1}, \quad
  \vcenter{\vbox{\hsize=.5\hsize \noindent
     pøi $z=t$, vychází $y=-1$, $x=1-t$,  \hfil\break
     tj. $(x,y,z) = (1-t, -1, t)= (1,-1,0)+t(-1,0,1)$,
     \hfil\break
     mno¾ina øe¹ení: $M = (1,-1,0) + \bigl<(-1,0,1)\bigr>$.
  }} \cr \noalign{\medskip}
  p=2:&\enspace \matice{1&2&1\|&1\cr1&2&1\|&-1\cr0&1&2\|&-1} \sim
               \matice{1&2&1\|&1\cr0&0&0\|&-1}, \quad
     \hbox{podle Frobeniovy vìty soustava pro $p=2$ nemá øe¹ení.}
 }               
$$

%% Zarazeno nove od zari 2006

\okraj Více pravých stran |
       Vice pravych stran

\poznamka [AX=B]
%%%%%%%%%
Seznámíme se s mo¾nostmi øe¹ení vìt¹ího mno¾ství soustav
lineárních rovnic se stejnou maticí soustavy, ale s rùznými pravými
stranami. Máme tedy dánu následující \uv{soustavu soustav} lineárních
rovnic:
$$
  \A\cdot\vec x_1 = \vec b_1, \quad
  \A\cdot\vec x_2 = \vec b_2, \quad \ldots, \quad
  \A\cdot\vec x_k = \vec b_k.
$$
Matice soustavy $\A\in\R^{m,n}$ je spoleèná v¹em soustavám.
Podle vìty\cite[soucinsloupcu] vidíme, ¾e uvedená soustava soustav je
ekvivalentní maticové rovnici
$$
  \A\cdot\X = \B
$$
kde matice $\X=(\vec x_1\ \vec x_2\ \ldots\ \vec x_k)$ obsahuje vedle
sebe napsané sloupcové vektory neznámých z jednotlivých soustav a 
matice $\B=(\vec b_1\ \vec b_2\ \ldots \vec b_k)$ obsahuje sloupcové
vektory pavých stran.
  
Vyøe¹it tuto soustavu soustav znamená najít podmno¾iny z $\R^n$, které
jsou mno¾inami øe¹ení jednotlivých soustav. Tyto mno¾iny øe¹ení jsou tvaru
$\vec v_i + M_0$, $i\in\{1,2,\ldots,k\}$, kde $\vec v_i$ je partikulární 
$i$-té soustavy a $M_0$ je mno¾ina øe¹ení pøidru¾ené homogenní
soustavy $\A\vec x=\vec o$. Ta je spoleèná v¹em soustavám.

Pøi øe¹ení takových soustav soustav je pøirozené pøed zahájením
eliminace zapsat v¹echny sloupce pravých stran vedle
sebe a eliminovat spoleènì celou matici. To ilustruje následující
pøíklad. 


\priklad
%%%%%%%%
Øe¹me maticovou rovnost
$$
  \matice{1 & 1 & 2 & 3 & 3 & 3  \cr
          1 & 1 & 1 & 3 & 1 & 1  \cr
          2 & 2 & 2 & 6 & 2 & 8  } \cdot \X =
  \matice{2 & 4 & 3 & 3 \cr
          2 & 2 & 1 & 3 \cr
          1 & 2 & 3 & 4 }.
$$
Soustavu soustav øe¹íme eliminací:
$$
 \thickmuskip=3mu
 \def\|{\kern4pt\strut\vrule}\!
  \matice{1 & 1 & 2 & 3 & 3 & 3 \|& 2 & 4 & 3 & 3 \cr
          1 & 1 & 1 & 3 & 1 & 1 \|& 2 & 2 & 1 & 3 \cr
          2 & 2 & 2 & 6 & 2 & 8 \|& 1 & 2 & 3 & 4 } \sim
  \matice{1 & 1 & 2 & 3 & 3 & 3 \|& 2 & 4 & 3 & 3 \cr
          0 & 0 & 1 & 0 & 2 & 2 \|& 0 & 2 & 2 & 0 \cr
          0 &\ 0 &\ 2 &\ 0 &\ 4 &-2 \|&\ 3 &\ 6 &\ 3 &\ 2 } \sim
  \matice{1 & 1 & 2 & 3 & 3 & 3 \|& 2 & 4 & 3 & 3 \cr
          0 & 0 & 1 & 0 & 2 & 2 \|& 0 & 2 & 2 & 0 \cr
          0 & 0 & 0 & 0 & 0 & 6 \|&-3 &-2 &\ 1 &-2 }.
$$
Pøidru¾enou homogenní soustavu známe u¾ z pøedchozích pøíkladù, tak¾e
víme, ¾e její prostor øe¹ení má bázi
$\{(-1,1,0,0,0,0), (-3,0,0,1,0,0), (1,0,-2,0,1,0)\}$. Partikulární
øe¹ení budeme hledat pro ka¾dý sloupec pravých stran zvlá¹». Poèítat
budeme poslední, tøetí a první slo¾ku, v ostatních pøedpokládáme nuly.
Pro sloupec $(2,0,-3)^T$ máme øe¹ení $({3\over2},0,1,0,0,-{1\over2})$,
pro sloupec $(4,2,-2)^T$ máme øe¹ení $(-{1\over3},0,{8\over3},0,0,-{1\over3})$,
pro sloupec $(3,2,1)^T$ máme øe¹ení $(-{5\over6},0,{5\over3},0,0,{1\over6})$
a koneènì pro sloupec $(3,0,-2)^T$ máme øe¹ení 
$({8\over3},0,{2\over3},0,0,-{1\over3})$. Zapí¹eme-li tato øe¹ení do
sloupcù vedle sebe, máme jedno z mo¾ných øe¹ení pro hledanou matici
$\X$. Kdy¾ k této matici pøièteme matici, která bude mít ètyøi stejné
sloupce tvaru
$\alpha\,(-1,1,0,0,0,0)^T+ \beta\,(-3,0,0,1,0,0)^T + \gamma\,(1,0,-2,0,1,0)^T$,
$\alpha,\beta,\gamma\in\R$,
dostáváme zápis obecnì v¹ech matic $\X$, které vyhovují zadané
maticové rovnici.

\poznamka
%%%%%%%%%
Maticovou rovnici $\X\A=\B$ (pøi daných maticích $\A$, $\B$)
bychom øe¹ili napøíklad tak, ¾e transponujeme obì strany
rovnosti. Tím dostáváme $\A^T\cdot\X^T=\B^T$ a problém
je pøeveden na tvar, se kterým u¾ si víme rady.

\veta [AXBsimEX]
%%%%%
Nech» $\A$ je regulární matice a $\B$ je libovolná matice se stejným
poètem øádkù. Platí:

\noindent (1) Maticová rovnost $\A\X=\B$ má jediné øe¹ení a tím
øe¹ením je $\X=\A^{-1}\,\B$,

\noindent (2) Je-li $(\A\,|\,\B) \sim (\E\,|\,\C)$, kde $\E$ je
jednotková matice, pak $\C=\A^{-1}\,\B$. Neboli 
$(\A\,|\,\B)\sim(\E\,|\,\A^{-1}\,\B)$.

\dukaz
%%%%%%
\noindent (1) Staèí rovnost $\A\X=\B$ vynásobit zleva maticí $\A^{-1}$.

\noindent (2) Soustava $\A\X = \B$ je podle pøedpokladu ekvivaletní se
soustavou $\E\X=\C$. Øe¹ením soustavy $\E\X=\C$ je zøejmì matice $\C$.
Proto¾e Gaussova eliminaèní metoda nemìní mno¾inu øe¹ení a podle (1)
víme, ¾e øe¹ením obou soustav je $\A^{-1}\B$. Tak¾e $\C=\A^{-1}\B$.

\poznamka
%%%%%%%%%
Dùsledkem této vìty je napøíkad metoda výpoètu inverzní
matice. Inverzní matice je podle definice\cite[inverseA] taková matice
$\X$, pro kterou platí $\A\X=\E$. Staèí tedy v pøedchozí vìtì volit
$\B=\E$.

\okraj Øe¹ení soustav pomocí LU rozkladu | Reseni soustav pomoci LU rozkladu

\poznamka
%%%%%%%%%
Pøedpokládejme regulární matici $\A\in\R^{n,n}$ a soustavu lineárních rovnic
$\A\vec x = \vec b$. Jediné øe¹ení této soustavy mù¾eme poèítat
ze vzorce $\A^{-1}\vec b$. K výpoètu matice $\A^{-1}$ eliminací
potøebujeme $2n^3$ operací (za jednu operaci pova¾ujeme pøiètení
násobku jednoho èísla k jinému). A pro maticové násobení $\A^{-1}\vec b$
potøebujeme dal¹ích $n^2$ operací. Je zøejmé, ¾e pøímá úprava
roz¹íøené matice eliminací spotøebuje nepatrnì ménì operací:
$n^2(n+1)=n^3+n^2$ operací. Je¹tì ménì operací potøebujeme pøi øe¹ení
této soustavy LU rozkladem. Postup øe¹ení je vysvìtlen v následujícím
algoritmu.

\algoritmus [LUsoustava]
%%%%%%%%%%%
Nech» $\A$ je regulární matice, $\A\P=\L\U$ je její LU rozklad.
Pak:
$$
\eqalign{
  \A=\L\U\P^T, \quad &\hbox{tedy soustavu }\A\vec x = \vec b
  \hbox{ lze zapsat ve tvaru } \L\,(\U\,(\P^T\vec x)) = \vec b\cr
  &\hbox{ a øe¹it postupnì tøi soustavy: } 
  \L\vec z = \vec b, \quad \U\vec y = \vec z, \quad \P^T\vec x = \vec y
}
$$
Pøitom první a tøetí soustavu není nutné øe¹it, proto¾e algoritmus LU
rozkladu\cite[LUalgol] poskytuje jako vedlej¹í produkt matici $L'=L^{-1}$ a dále
platí $\P=(\P^T)^{-1}$. Tak¾e øe¹íme jedinou soustavu
$\U\,\vec y = \L'\,\vec b$ a podle permutaèní matice $\P$ pøehodíme
pøípadnì poøadí promìnných, tedy provedeme $\vec x = \P\vec y$.

\priklad
%%%%%%%%
Øe¹me LU rozkladem soustavu lineárních rovnic s maticí
$$
   \def\|{\kern4pt\strut\vrule}
   \A=\pmatrix{1&2&3\|&5\cr2&3&1\|&7\cr4&2&0\|&6}
$$
LU rozklad matice této soustavy jsme provedli v pøíkladì\cite[pLU].
Tak¾e víme, ¾e
$$
 \catcode`+=13 \def+{\hphantom{-}}
 \L' = \pmatrix{+1&+0&+0\cr-2&+1&+0\cr+8&-6&+1}, \qquad
 \U =  \pmatrix{1&+2&+3\cr0&-1&-5\cr0&+0&\,18}, \qquad
 \L'\cdot \vec b = 
 \pmatrix{+1&+0&+0\cr-2&+1&+0\cr+8&-6&+1}\cdot\pmatrix{5\cr7\cr6} = 
 \pmatrix{+5\,\cr-3\,\cr+4\,}
$$
Soustava $\U\,\vec y = \L'\,\vec b$ má roz¹íøenou matici:
$$
  \catcode`+=13 \def+{\hphantom{-}}
  \def\|{\kern8pt\strut\vrule}
  \pmatrix{1&+2&+3\|&+5\,\cr0&-1&-5\|&-3\,\cr0&+0&\hfill18\|&+4\,},
$$
kterou vyøe¹íme postupným dosazením \uv{zespoda nahoru}:
$y_3={2\over9}$, $y_2= {17\over9}$, $y_1={5\over9}$. Permutaèní matice
$\P$ je v tomto pøípadì jednotková, tak¾e $x_1=y_1$, $x_2=y_2$,
$x_3=y_3$ a dostávéme øe¹ení soustavy $({5\over9},{17\over9},{2\over9})$.

\poznamka
%%%%%%%%%
Kolik operací (pøiètení násobku èísla k jinému) potøebujeme k
vyøe¹ení soustavy $\A\vec x=\vec b$ s regulární maticí
typu $(n,n)$?  K nalezení matic $\U$ a $\L'$ potøebuje algoritmus
LU rozkladu zhruba $n^3/2$ operací. K výpoètu pravé strany $\vec z$
potøebujeme $n^2/2$ operací a k vyøe¹ení soustavy $\U\vec y = \vec z$
potøebujeme také $n^2/2$ operací. K prohození promìnných (pøechod mezi
vektorem $\vec y$ a $\vec x$) potøebujeme zhruba $n$ operací, co¾ je
ve srovnání s poètem $n^2$ operací pro výpoèet $\vec y$ zanedbatelné.
Shrnutí: na pøípravu matice $\A$ (LU rozklad) je potøeba $n^3/2$
operací a na výpoèet øe¹ení pak u¾ staèí $n^2$ operací.

Zdá se, ¾e poèet operací pøi øe¹ení soustav pomocí LU rozkladu nebo
Gaussovou eliminaèní metodou se pøíli¹ neli¹í. Ov¹em jsou známy
algoritmy LU rozkladu se stejnou slo¾itostí jako násobení
matic. Pøitom násobení matic se dá optimalizovat tak, ¾e potøebuje
ménì operací ne¾ $n^3$ (viz\cite[strassen]). Za urèitých
okolností pøi rozsáhlých soustavách mù¾e tedy být øe¹ení soustav
LU rozkladem efektivnìj¹í.

%Je dobré si uvìdomit, ¾e pøi øe¹ení obecných
%soustav po pøímém chodu Gaussovy eliminaèní metody a po
%pøehození promìnných, které z rovnic poèítáme \uv{dopøedu}
%je levý blok v matici soustavy regulární. Viz tøeba 
%pøíklad\cite[pstroj]. Ostatní sloupce vpravo od regulárního bloku
%mù¾eme vnímat jako sloupce pravých stran. Tak¾e i pro tento pøípad je
%mo¾né pou¾ít LU rozklad.

\okraj Nulový prostor matice a~$\lobr<\A>$ | Nulovy prostor
matice a <r:A>

\definice [nullprst]
%%%%%%%%%
Nech» $\A\in\R^{m,n}$. {\em Nulový prostor matice $\A$} je lineární
podprostor v¹ech øe¹ení homogenní soustavy lineárních rovnic $\A\vec x=\vec o$.
Tento podprostor znaèíme $\nullsp\A$.
\inl[prostor: nulový matice, nulový: prostor matice]

\poznamka
%%%%%%%%%
Je-li dána matice $\A$, pak k ní mù¾eme sestrojit dva lineární
podprostory lineárního prostoru $\R^n$: nulový prostor $\nullsp\A$
a lineární obal øádkù matice $\lobr<\A>$. Mezi tìmito dvìma lineárními
podprostory je zajímavý vztah:

\veta
%%%%%
Nech» $\A\in\R^{m,n}$. Pak 

(1) pro ka¾dý vektor $\vec z\in\nullsp\A$ a pro ka¾dý vektor $\vec a\in\lobr<\A>$
platí:  $\vec a\cdot\vec z^T = 0$. 

(2) $\lobr<\A>\cap \nullsp\A = \{\vec o\}$. 

(3) $\dim\lobr<\A> + \dim\nullsp\A = n$.

(4) Pro ka¾dý vektor $\vec x\in\R^n$ existují jediné vektory $\vec
a\in\lobr<\A>$ a $\vec z\in\nullsp\A$ tak, ¾e $\vec x = \vec a + \vec z$.

\dukaz
(1) Rovnost $\vec a\cdot\vec x^T=0$ mù¾eme po slo¾kách rozepsat jako
$
  a_1x_1 + a_2x_2 + \cdots + a_nx_n = 0
$
a vnímat ji jako rovnici s koeficienty
$\vec a=(a_1,a_2,\ldots,a_n)$. Proto¾e $\vec a\in\lobr<\A>$, je $\vec a$
lineární kombinací øádkù matice~$\A$, tedy uvedená rovnice vznikla jako
lineární kombinace rovnic ze soustavy $\A\vec x=\vec o$. Øe¹ení
$\vec z\in\nullsp\A$ splòuje nejen v¹echny rovnice ze soustavy 
$\A\vec x=\vec y$, ale také v¹echny jejich lineární kombinace, tak¾e
platí $a_1z_1 + a_2z_2 + \cdots + a_nz_n = 0$.

(2) Je-li $\vec x=(x_1,x_2,\ldots,x_n)\in\lobr<\A>\cap\nullsp\A$, musí 
$x_1x_1+x_2x_2+\cdots+x_n x_n = x_1^2 + x_2^2 + \cdots + x_n^2 = 0$ a
to je mo¾né jen pro nulový vektor.

(3) $\dim\lobr<\A>$ je hodnost $\A$ (podle definice). Vztah byl
dokázán ve vìtì\cite[dimhomo].

(4) Pøedpokládejme, ¾e $\hod\A=k$ a nech» $\vecc b_k$ je nìjaká báze lineárního podprostoru
$\lobr<\A>$ a nech» $\vec b_{k+1}, \vec b_{k+2}, \ldots, \vec b_n$ je báze
lineárního podprostoru $\nullsp\A$. Pak podle vìty\cite[lnMcupN]
jsou vektory $\vecc b_n$ lineárnì nezávislé a tvoøí tedy bázi
lineárního prostoru $\R^n$. Vektor $\vec x\in\R^n$ má vzhledem k této
bázi souøadnice $\alpha_1, \alpha_2, \ldots, \alpha_n$ a platí
$$
  \vec x = (\alpha_1\vec b_1 + \alpha_2\vec b_2 + \cdots + \alpha_k\vec b_k) 
          + (\alpha_{k+1}\vec b_{k+1} + \alpha_{k+2}\vec b_{k+2} + \cdots + \alpha_n\vec b_n).
$$
První závorka v tomto výrazu je rovna vektoru $\vec a$ a druhá vektoru
$\vec z$. Jejich jednoznaènost plyne z~jednoznaènosti souøadnic
vzhledem k bázi.


\poznamka
%%%%%%%%%
Nech» $\A\in\R^{m,n}$ a $\vec a\in\lobr<\A>$. Nech» $\vec z$ le¾í v
nulovém prostoru matice~$\A$.
Proto¾e $\vec a\cdot\vec z^T=\vec z\cdot\vec a^T=0$, vidíme,
¾e vektor $\vec a$ øe¹í homogenní rovnici s koeficienty $\vec
z=(z_1,z_2,\ldots,z_n)$. Sestavíme matici $\B$, která v øádcích
obsahuje bázi nulového prostoru matice $\A$. Pak zøejmì $\vec a$ øe¹í
soustavu $\B\vec x=\vec o$. Tak¾e nejen 
$\nullsp\A=\lobr<\B>$, ale také $\nullsp\B=\lobr<\A>$.




\shrnuti
%%%%%%%%
Mno¾ina øe¹ení soustavy lineárních rovnic je dle Frobeniovy 
vìty\lcite[frobeni] prázdná, právì kdy¾ hodnost roz¹íøené
matice soustavy je vìt¹í ne¾ hodnost matice soustavy.

Mno¾ina øe¹ení homogenní soustavy lineárních rovnic s $n$ neznámými
tvoøí lineární podprostor lineárního prostoru $\R^n$\lcite[homolinprst]. 
Dimenze tohoto podprostoru je rovna $n-\hod\A$, kde $\A$ je matice
soustavy a $n$ je poèet neznámých\lcite[dimhomo].

Mno¾ina øe¹ení nehomogenní soustavy lineárních rovnic se
dá zapsat jako souèet patrikulárního øe¹ení a mno¾iny øe¹ení
pøidru¾ené homogenní soustavy~/\ncite[partikul+obal],~\ncite[v+M0]/. 

V této kapitole jsme si ukázali algoritmus na hledání báze mno¾iny
øe¹ení pøidru¾ené homogenní soustavy i na hledání partikulárního
øe¹ení~/\ncite[genbasehomo],\cite[genpartikul]/.

Mno¾ina øe¹ení soustavy lineárních rovnic tvoøí z geometrického
pohledu zobecnìnou rovinu, která je prùnikem zobecnìných rovin, které jsou  øe¹eními
jednotlivých rovnic~/\ncite[pruniknadrovin],\cite[nadrovina]/.
Je to také zobecnìná rovina, která vzniká posunutím zobecnìné roviny popisující 
mno¾inu øe¹ení pøidru¾ené homogenní soustavy z poèátku
o vektor partikulárního øe¹ení

Mno¾inu øe¹ení soustav lineárních rovnic nelze popsat 
jednoznaènì~/\ncite[popis-reseni],\cite[ruznareseni]/. Posali jsme si
algritmus, podle kterého poznáme, ¾e dva na první pohled rùzné zápisy
popisují stejnou mno¾inu øe¹ení.

Soustavy se ètvercovou maticí mají svou matici singulární (pak po eliminaci
u¾ nemají ètvercovou matici), nebo regulární. Ta má jediné øe¹ení ve
tvaru $\A^{-1}\vec b$. Jednotlivé slo¾ky takového øe¹ení se dají
spoèítat jako podíl determinantù~/Cramerovo pravidlo\cite[cramer]/.

Vyøe¹it maticovou rovnici $\A\X=\B$ znamená toté¾, 
jako vyøe¹it soustavu soustav se stejnou
maticí soustavy a s rùznými pravými stranami\lcite[AX=B]. 
Eliminace
$(\A\,|\,\B)\sim(\E\,|\,\C)$ poèítá souèin $\C=\A^{-1}\,\B$, co¾ je
jediné øe¹ení soustavy $\A\X=\B$ v pøípadì, ¾e matice $\A$ je
regulární\lcite[AXBsimEX].

V závìru kapitoly jsme ukázali øe¹ení soustav lineárních rovnic
LU rozkladem.


\icviceni 5


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\kapitola [linzob2] Matice lineárního zobrazení | Matice linearniho zobrazeni
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\okraj Zobrazení typu $\A\cdot\vec x$ | Zobrazeni A.x

\veta [aA]
%%%%%
Nech» $\A\in\R^{m,n}$ je matice. Pak zobrazení $\a:\R^n\to\R^m$
definované pøedpisem $\a(\vec x) = \A\cdot\vec x$ je lineární.

\dukaz
Podle definice\cite[linzob] staèí ovìøit, ¾e
$$
  \A\cdot(\vec x + \vec y) = \A\cdot\vec x + \A\cdot\vec y, \qquad
  \A\cdot(\alpha\vec x) = \alpha(\A\cdot\vec x),
$$
co¾ platí díky vìtì\cite[soucinAB-vlastnosti].

\poznamka
%%%%%%%%%
Zobrazení v pøedchozí vìtì zobrazuje sloupcové vektory na sloupcové
vektory, tedy pøesnìji bychom mìli psát
$\a:\R^{n,1}\to\R^{m,1}$. Ov¹em vzhledem k izomorfismu mezi $\R^{n,1}$
a $\R^n$ (viz poznámku\cite[radkovevektory]) nebudeme dále tuto
skuteènost zbyteènì zdùrazòovat.

\priklad [R4toR3]
%%%%%%%%
Najdeme jádro, defekt a hodnost zobrazení $\a:\R^4\to\R^3$,
které je dáno pøedpisem
$\a(x_1,x_2,x_3,x_4) = (x_1+3x_2+2x_3+2x_4,3x_1+x_2+2x_4,5x_1+7x_2+4x_3+6x_4)$.

Ze vzorce pro hodnotu zobrazení okam¾itì plyne, ¾e
$$
  \a(x_1,x_2,x_3,x_4)^T =  
   \pmatrix{x_1+3x_2+2x_3+2x_4\cr 3x_1+x_2+2x_4\cr 5x_1+7x_2+4x_3+6x_4} =
   \pmatrix{1 & 3 & 2 & 2\cr 3 & 1 & 0 & 2\cr 5 & 7 & 4 & 6}
   \cdot\pmatrix{x_1\cr x_2\cr x_3\cr x_4} = \A\cdot\vec x
$$
tak¾e $\a(\vec x) = \A\cdot\vec x$, kde $\A\in\R^{3,4}$.

Hodnost zobrazení $\a$ je podle definice\cite[defhod] rovna dimenzi
lineárního podprostoru v¹ech hodnot zobrazení a tento podprostor je
roven lineárnímu obalu v¹ech obrazù bázových vektorù. Ve vstupním
lineárním prostoru pou¾ijeme strandardní bázi. Platí 
$$
  \a(1,0,0,0)=(1,3,5), \quad
  \a(0,1,0,0)=(3,1,7), \quad
  \a(0,0,1,0)=(2,0,4), \quad
  \a(0,0,0,1)=(2,2,6).
$$
V¹imneme si, ¾e díky vlastnostem maticového násobení jsou obrazy
bázových vektorù rovny jednotlivým sloupcùm matice $\A$.
Hodnost zobrazení $\a$ je tedy rovna lineárnímu obalu sloupcù matice
$\A$, ale proto¾e podle vìty\cite[hA=hAT] je $\hod\A=\hod\A^T$, staèí
poèítat dimenzi lineárního obalu øádkù matice $\A$, neboli hodnost
matice $\A$. 
$$
  \A = \pmatrix{1 & 3 & 2 & 2\cr 3 & 1 & 0 & 2\cr 5 & 7 & 4 & 6} \sim
       \pmatrix{1 & 3 & 2 & 2\cr 0 & 8 & 6 & 4}, \qquad \hod\A=2
$$
Je tedy $\hod\a = \hod\A = 2$.

Jádro zobrazení $\a$ je podle definice\cite[jadro]
mno¾ina v¹ech $\vec x\in\R^4$ takových, ¾e $\A\cdot\vec x=\vec o$.
Je to tedy lineární podprostor v¹ech øe¹ení homogenní soustavy rovnic
s maticí $\A$. Øe¹it soustavy lineárních rovnic umíme:
$$
  \eqalign{
  \pmatrix{1 & 3 & 2 & 2\cr 3 & 1 & 0 & 2\cr 5 & 7 & 4 & 6} \sim
  \pmatrix{1 & 3 & 2 & 2\cr 0 & 1 & 3/4 & 1/2} \sim {}
  &\pmatrix{1 & 0 & -1/4 & 1/2\cr 0 & 1 & \hfill3/4 & 1/2}
  = (\E\,|\,\C),\cr  \noalign{\vskip-5pt}
   (-\C^T\,|\,\E) = {}
  &\pmatrix{\hfill1/4& -3/4& 1& 0\cr -1/2& -1/2& 0& 1} \sim
   \pmatrix{1 &-3 &4 & \hfill 0\cr 1 &\hfill 1 &0 &-2}
}
$$
Pøi výpoètu jsme pou¾ili vìtu\cite[genbasehomo].
$\ker\a = \lob<(1,-3,4,0),(1,1,0,-2)>$,
$\defekt\a = \dim\ker\a = 2$.

Tento pøíklad ilustruje lineární zobrazení, které není prosté (proto¾e
$\defekt\a>0$) a také není \uv{na}~$\R^3$ (proto¾e $\dim\R^3=3$, ale $\hod\a=2$).

\veta [hod=hod]
%%%%%
Nech» $\A\in\R^{m,n}$.
Hodnost lineárního zobrazení $\a:\R^n\to\R^m$, které je dáno pøedpisem
$\a(\vec x)=\A\cdot\vec x$, je rovna hodnosti matice $\A$, tedy:
$$
  \hod\a = \hod\A
$$

\dukaz
Dùkaz povedeme stejnì, jako kdy¾ jsme poèítali hodnost zobrazení 
v pøedchozím pøíkladu. Nech» $\{\vecc e_n\}$ je standardní 
báze lineárního prostoru $\R^n$. Díky vlastnostem maticového násobení
je $\A\cdot\vec e_i$ rovno $i$-tému sloupci matice $\A$. Podle 
definic\cite[defhod] a\cite[dhodnost] platí:
$$
  \hod\a = \dim\a(\R^n) = \dim \a(\lob<\vecc e_n>) =
  \dim \lob<\a(\vec e_1), \a(\vec e_2), \ldots, \a(\vec e_n)> =
  \hod\A^T = \hod\A.
$$

\poznamka
%%%%%%%%%
Je-li dána matice $\A\in\R^{m,n}$, pak jádrem lineárního zobrazení
$\A\cdot\vec x$ je lineární podprostor v¹ech øe¹ení homogenní soustavy
$\A\cdot\vec x=\vec o$, tedy její nulový prostor $\nullsp\A$.

\poznamka
%%%%%%%%%
Vìta\cite[def+hod] \uv{$\defekt\a+\hod\a=\dim L_1$} pøechází v pøípadì zobrazení
typu $\A\cdot\vec x$ na vìtu\cite[dimhomo] 
\uv{$\dim \nullsp\A+\hod\A = {}$poèet neznámých soustavy lineárních
rovnic s~maticí~$\A$}.
Defekt je toti¾ dimenze kernelu, co¾ je dimenze nulového prostoru
matice $\A$. Hodnost zobrazení je dle
vìty\cite[hod=hod] rovna hodnosti matice. Koneènì $\dim L_1$ je rovna
poètu sloupcù v matici $\A$, tedy poètu neznámých soustavy.

\poznamka
%%%%%%%%%
V následujícím textu na chvíli opustíme zobrazení typu $\A\cdot\vec x$, 
abychom se k nìmu pozdìji znovu vrátili obohaceni o dal¹í poznatky
o obecných lineárních zobrazeních. Pak u¾ budeme moci dokázat, ¾e
ka¾dé lineární zobrazení lineárních prostorù koneèné dimenze je 
(a¾ na izomorfismus) zobrazení typu $\A\cdot\vec x$, kde $\A$ je
nìjaká matice.

\okraj Lineární prostor\hb lineárních zobrazení |
       Linearni prostor linearnich zobrazeni

\poznamka
%%%%%%%%%
Nech» $L_1$ a $L_2$ jsou lineární prostory.
Symbolem $T$ oznaème mno¾inu v¹ech lineárních zobrazení z $L_1$ do $L_2$.
V následující definici zavedeme souèet dvou zobrazení, které jsou
prvky mno¾iny~$T$, a $\alpha$-násobek takového zobrazení. Ve vìtì\cite[lpZzob]
pak doká¾eme, ¾e mno¾ina $T$ s tìmito operacemi tvoøí lineární
prostor.

\definice [lplzob]
%%%%%%%%%
Nech» $\a:L_1\to L_2,\, \b: L_1\to L_2$ jsou lineární zobrazení a $\alpha\in\R$. 
Pak definujeme souèet lineárních zobrazení $\a+\b: L_1\to L_2$ pøedpisem
$(\a+\b)(\vec x) = \a(\vec x) + \b(\vec x)$ pro v¹echna 
$\vec x\in L_1$. Dále definujeme $\alpha$-násobek
zobrazení $\a$ jako zobrazení $\alpha\a : L_1\to L_2$,
které splòuje $(\alpha\a)(\vec x) = \alpha\a(\vec x)$ 
pro v¹echna $\vec x\in L_1$.

\veta [lpZzob]
%%%%%
Nech» $L_1$ a $L_2$ jsou lineární prostory a oznaème $T=\{\a: L_1\to L_2\}$.
Pak $T$ s operacemi podle definice\cite[lplzob] je lineární prostor.

\dukaz
%%%%%%
Nejprve je potøeba dokázat, ¾e souèet lineárních zobrazení je lineární
zobrazení a $\alpha$ násobek lineárního zobrazení je také lineární
zobrazení. Tedy pro nì musí platit vlastnosti (1) a (2) z definice\cite[linzob].
Nech» $\a\in T, \b\in T, \alpha\in\R$.
Pro $\vec x\in L_1, \vec y\in\nobreak L_1$ a $\gamma\in\R$ platí: 
$$
  \eqalign{
  (1)\ &\ (\a+\b)(\vec x+\vec y) = \a(\vec x+\vec y) + \b(\vec x+\vec y) = 
  \bigl(\a(\vec x)+\a(\vec y)\bigr) + \bigl(\b(\vec x)+\b(\vec y)\bigr) =\cr
   &\hskip 71pt = \bigl(\a(\vec x)+\b(\vec x)\bigr) + 
    \bigl(\a(\vec y)+\b(\vec y)\bigr) = 
     (\a+\b)(\vec x) + (\a+\b)(\vec y),\cr
  (2)\ &\ (\a+\b)(\gamma \vec x) = \a(\gamma \vec x) + \b(\gamma \vec x) =
                       \gamma \a(\vec x) + \gamma \b(\vec x) = 
                       \gamma\bigl(\a(\vec x)+\b(\vec x)\bigr) =
                       \gamma (\a+\b)(\vec x), \cr
       &\ \hbox{tj. $\a+\b$ je lineární,}\cr
  (1)\ &\ (\alpha\a)(\vec x+\vec y) = \alpha \a(\vec x+\vec y) = 
  \alpha \bigl(\a(\vec x) + \a(\vec y)\bigr) = \alpha\a(\vec x)
  + \alpha\a(\vec y) =
  (\alpha\a)(\vec x) + (\alpha\a)(\vec y), \cr
  (2)\ &\ (\alpha\a)(\gamma \vec x) = \alpha\a(\gamma \vec x) = 
  \alpha\bigl(\gamma\a(\vec x)\bigr) = (\alpha\gamma)\a(\vec x) =
  \gamma\bigl(\alpha\a(\vec x)\bigr) = \gamma (\alpha\a)(\vec x),\cr
       &\ \hbox{tj. $\alpha\a$ je lineární.} 
}
$$
Dále je tøeba dokázat, ¾e pro operace $+$ a $\cdot$ 
z definice\cite[lplzob] platí axiomy linearity, tedy vlastnosti
(1) a¾ (7) z definice\cite[dlp]. Argumentace je zcela stejná, jako 
v~pøíkadu\cite[LPfunkci], tak¾e ji zde nebudeme opakovat. Rozdíl je jen 
v tom, ¾e se pøi argumentaci neopíráme o vlastnosti sèítání a násobení
reálných èísel, ale opíráme se o axiomy linearity, které platí 
v~lineárním prostoru $L_2$. 

\okraj Lineární\hb zobrazení\hb na bázi | Linearni zobrazeni na basi

\poznamka
%%%%%%%%%
Následující vìta ukazuje, ¾e pokud známe hodnoty zobrazení 
$\a:L_1\to L_2$ jen na bázi lineárního prostoru $L_1$ a 
toto zobrazení má být lineární, pak takové zobrazení existuje a je
hodnotami na bázi jednoznaènì urèeno. 
% Z této vìty pak snadno odvodíme, ¾e ka¾dé lineární zobrazení $\a:\R^n\to\R^m$
% je typu $\A\cdot\vec x$, kde $\A$ je matice typu $(m,n)$.

\veta* [zobnabasi]
%%%%%
Nech» $\{\vecc b_n\}$ je báze lineárního prostoru $L_1$ a nech» jsou
dány libovolné vektory $\vecc y_n$ z~lineárního prostoru $L_2$. Pak
existuje právì jedno lineární zobrazení $\a:L_1\to L_2$, pro 
které platí
$$
  \a(\vec b_i) = \vec y_i, \quad \forall i \in \{1,2,\ldots,n\}.
  \rce(anabasi)
$$

\dukaz
%%%%%%
(1) Existence. Nech» $\vec x\in L_1$. Proto¾e $\{\vecc b_n\}$
je báze $L_1$, existují souøadnice $\alpha_i\in\R$ vektoru $\vec x$ 
takové, ¾e $\vec x = \lkvecc \alpha.b_n$.
Hodnotu zobrazení $\a$ v bodì $\vec x$ nyní definujeme takto:
$$
  \a(\vec x) = \lkvecc \alpha.y_n. \rce(apodlebase)
$$
Zobrazení, které vektorùm pøiøazuje jejich souøadnice, je lineární
(viz vìtu\cite[sour-lin]).
Z toho plyne, ¾e zobrazení $\a$ definované vzorcem\cite(apodlebase) je lineární.
Peèlivìj¹í ètenáø si to rozepí¹e podrobnìji.

Proto¾e souøadnice vektoru $\vec b_i$ vzhledem k bázi $(B)$ jsou
v¹echny nulové s výjimkou $i$-té souøadnice, která je rovna jedné,
platí 
$$
  \a(\vec b_i) = \sum_{\textstyle{j=0\atop j\not=i}}^n 0\cdot \vec y_j 
                 + 1\cdot \vec y_i = \vec y_i,
$$
tak¾e zobrazení definované vzorcem\cite(apodlebase) splòuje
po¾adovanou vlastnost\cite(anabasi). 

(2) Jednoznaènost. Nech» je¹tì $\b:L_1\to L_2$ je lineární a splòuje 
vlastnost\cite(anabasi). Pak je lineární i zobrazení 
$(\a-\b):L_1\to L_2$, proto¾e mno¾ina lineárních zobrazení tvoøí podle
vìty\cite[lpZzob] lineární prostor. Platí $(\a-\b)(\vec b_i) = \vec o$
$\forall i\in\{1,2,\ldots,n\}$, proto¾e $\a$ i $\b$ splòují
vlastnost\cite(anabasi).
Z~linearity zobrazení $\a-\b$ plyne, ¾e
$$
  \eqalign{
  (\a-\b)(\vec x) &= (\a-\b)(\lkvecc \alpha.b_n) = \cr
  &= \alpha_1\,(\a-\b)(\vec b_1) + \alpha_2\,(\a-\b)(\vec b_2) +
  \cdots + \alpha_n\,(\a-\b)(\vec b_n) = \cr
  &= \alpha_1\,\vec o + \alpha_2\,\vec o + \cdots + \alpha_n\,\vec o =
  \vec o. }
$$ 
Vidíme, ¾e zobrazení $\a-\b$ je nulové na celém definièním oboru,
tak¾e $\a=\b$.

\poznamka
%%%%%%%%%
V dùkazu vìty\cite[zobnabasi] jsme uvedli dùle¾itý
vzorec\cite(apodlebase), který ukazuje, jak najít hodnotu lineárního
zobrazení pro libovolný vektor $\vec x\in L_1$, známe-li hodnoty
tohoto zobrazení jen na nìjaké bázi lineárního prostoru $L_1$.

\priklad [R3toR4]
%%%%%%%%
Pøedpokládejme, ¾e $\a:\R^3 \to \R^4$ je lineární zobrazení.
Najdeme vzorec pro výpoèet hodnoty zobrazení $\a(x_1,x_2,x_3)$, je-li známo:
$$
  \a(1,1,2) = (1,0,1,0), \quad
  \a(1,2,2) = (2,0,2,0), \quad
  \a(2,1,5) = (1,2,2,1).
$$
Proto¾e jsou vektory $(1,1,2),(1,2,2),(2,1,5)$ lineárnì nezávislé a
jsou tøi, tvoøí podle poznámky\cite[dusl123] bázi 
lineárního prostoru~$\R^3$. Známe hodnoty hledaného zobrazení 
na bázi~$\R^3$, tak¾e podle vìty\cite[zobnabasi] mù¾eme 
jednoznaènì urèit hodnoty $\a$ i v ostatních bodech definièního oboru.
Budeme postupovat stejnì, jako v~dùkazu vìty\cite[zobnabasi].

Nech» $(x_1, x_2, x_3)$ je libovolný vektor z~$\R^3$. Najdeme
souøadnice tohoto vektoru vzhledem k~uspoøádané bázi 
$\bigl((1,1,2),(1,2,2),(2,1,5)\bigr)$:
$$
  (x_1,x_2,x_3) = \alpha\,(1,1,2) + \beta\,(1,2,2) + \gamma\,(2,1,5).
$$
To vede na soustavu tøí rovnic o tøech neznámých
$\alpha,\beta,\gamma$. Eliminujme její roz¹íøenou matici:
$$
  \def\|{\kern4pt\strut\vrule}
  \matice{1&1&2\|& x_1\cr 1&2&1\|& x_2\cr 2&2&5\|& x_3} \sim
  \matice{1&1&2\|& x_1\hfil\cr 0&1&\!-1\|& x_2-x_1\hfil\cr 
          0&0&1\|& x_3-2x_1} \sim
  \matice{1&0&0\|& 8x_1 - x_2 -3x_3\hfil\cr 
          0&1&0\|& -3x_1 + x_2 + x_3\hfil\cr 
          0&0&1\|& x_3-2x_1\hfil}.
$$
Platí tedy
$$
  \eqalign{
    (x_1,x_2,x_3) &= (8x_1 - x_2 -3x_3)\cdot(1,1,2) +
                    (-3x_1 + x_2 + x_3)\cdot(1,2,2) +
                    (x_3-2x_1)\cdot(2,1,5), \cr
    \a(x_1,x_2,x_3) &= \a\bigl((8x_1 - x_2 -3x_3)\cdot(1,1,2) +
                    (-3x_1 + x_2 + x_3)\cdot(1,2,2) +
                    (x_3-2x_1)\cdot(2,1,5)\bigr) = \cr
   &= (8x_1 - x_2 -3x_3)\cdot\a(1,1,2) +
                    (-3x_1 + x_2 + x_3)\cdot\a(1,2,2) +
                    (x_3-2x_1)\cdot\a(2,1,5) = \cr
   &= (8x_1 - x_2 -3x_3)\cdot(1,0,1,0) +
                    (-3x_1 + x_2 + x_3)\cdot(2,0,2,0) +
                    (x_3-2x_1)\cdot(1,2,2,1) = \cr
   &= (x_2,\; -4x_1+2x_3,\; -2x_1+x_2+x_3,\; -2x_1+x_3).
  }
$$   


\okraj Matice\hb zobrazení $\R^n\to\R^m$ | Matice zobrazeni Rn -> Rm

\veta [aRA]
%%%%%
Pro ka¾dé lineární zobrazení $\a: \R^n\to\R^m$ existuje právì jedna
matice $\A\in\R^{m,n}$ taková, ¾e $\a(\vec x) = \A\cdot\vec x$.

\dukaz
Nech» je dáno zobrazení $\a:\R^n\to\R^m$. Oznaème $(S_n)=(\vecc e_n)$
standardní bázi v~$\R^n$. Hodnoty $\a(\vec e_i)$ pro
$i=\{1,2,\ldots,n\}$ zapi¹me jako sloupcové vektory vedle sebe do
matice, kterou oznaèíme $\A$. Tedy 
$\A=\bigl(\a(\vec e_1)\ \a(\vec e_2)\ \ldots\ \a(\vec e_n)\bigr)$.
Je zøejmé, ¾e zobrazení, které vektoru $\vec x$ pøiøadí vektor
$\A\cdot\vec x$, má pro $\vec x\in\{\vecc e_n\}$ stejné
hodnoty, jako dané zobrazení $\a$. Podle vìty\cite[zobnabasi] existuje
jediné lineární zobrazení s takovou vlastností.

Proè je matice $\A$ zobrazením $\a$ jednoznaènì urèena? 
Jiná matice odpovídá zobrazení, které má jiné
hodnoty pro $\vec x\in\{\vecc e_n\}$, tak¾e to je jiné zobrazení.


\definice [defaRA]
%%%%%%%%%
Nech» $\a:\R^n\to \R^m$ je lineární zobrazení. Matici $\A$, pro kterou
je $\A\cdot\vec x = \a(\vec x)$ $\forall \vec x\in\R^n$, 
nazýváme {\em maticí lineárního
zobrazení $\a$}.

\poznamka
%%%%%%%%%
Dùkaz vìty\cite[aRA] dává návod, jak matici zobrazení $\a$ sestavit.
Do sloupcù matice je tøeba zapsat obrazy vektorù standardní báze.

\priklad [mR3toR4]
%%%%%%%%
V pøíkladu\cite[R3toR4] jsme mìli zobrazení $\a:\R^3\to\R^4$ dáno
hodnotami na bázi a vypoèítali jsme, ¾e 
$\a(x_1,x_2,x_3) = (x_2,\; -4x_1+2x_3,\; -2x_1+x_2+x_3,\; -2x_1+x_3)$.
Nyní najdeme jeho matici, hodnost, jádro a defekt.

Matici mù¾eme hledat dvìma zpùsoby. Obrazy bázových vektorù standardní
báze musejí být zapsány postupnì do sloupcù matice $\A$. Nebo jinak:
koeficienty lineárních kombinací jednotlivých slo¾ek obrazu vektoru 
$(x_1,x_2,x_3)$ musejí být zapsány do øádkù matice $\A$. Vyzkou¹ejte
si oba pøístupy. Tak¾e:
$$
  \A = \pmatrix{\hfill0&1&0\cr -4&0&2\cr -2&1&1\cr -2&0&1}
$$
Hodnost zobrazení je rovna hodnosti jeho matice 
(vìta\cite[hod=hod]), jádro zobrazení je
rovno nulovému prostoru jeho matice a defekt je roven
$\dim\R^n-\hod\a$. Ní¾e jsou uvedeny s tím související výpoèty.
$$
  \A = \pmatrix{\hfill0&1&0\cr -4&0&2\cr -2&1&1\cr -2&0&1} \sim
  \pmatrix{2&0&\!\!-1\cr 0&1&\hfill0}, \quad 
  \vcenter{\hbox{$\hod\a = \hod\A = 2$}
        \hbox{$\defekt\a = 3 - \hod\a = 1$, $\ker\a = \nullsp\A = \lob<(1,0,2)>$.}}
$$

\okraj Matice zobrazení vzhledem k bázím | Matice zobrazeni vzhledem k basim

\obrazek .33+.02 11 obr8
{
  \p 22 16 L_1
  \p 25 118 L_2
  \p 20 65 {\a}
  \p 55 14 (B)
  \p 60 120 (C)
  \p 95 8  \c_B
  \p 95 126 \c_C
  \p 135 80 \a'
  \p 150 27 \R^n
  \p 150 123 \R^m
  \p 160 70 \A\cdot\vec x
}
\poznamka
%%%%%%%%%
V definici\cite[defaRA] jsme pøiøadili matici ka¾dému lineárnímu
zobrazení z $\R^n$ do $\R^m$. Omezili jsme se tedy na zobrazení, která
zobrazují uspoøádané $n$-tice na uspoøádané $m$-tice. 
V~následující definici zavedeme matici lineárního zobrazení libovolných 
lineárních prostorù koneèné dimenze. 

\definice* [defAa]
%%%%%%%%%
Nech» $\a: L_1\to L_2$ je lineární zobrazení a
pøedpokládejme, ¾e $\dim L_1=n$ a $\dim L_2=m$. Vìta\cite[isoRn]
nám zaruèuje, ¾e $L_1$ je izomorfní s $\R^n$ a $L_2$ je izomorfní 
s~$\R^m$. V lineárním prostoru~$L_1$ zvolme nìjakou uspoøádanou bázi
$(B)$ a v~lineárním prostoru~$L_2$ zvolme uspoøádanou bázi $(C)$.
Oznaème $\c_B: L_1\to\R^n$ izomorfismus, který pøiøazuje vektoru 
$\vec u\in L_1$ jeho souøadnice vzhledem 
k~uspoøádané bázi $(B)$. Nech» dále $\c_C: L_2\to\R^m$ je
izomorfismus, který pøiøazuje vektoru 
$\vec v\in L_2$ jeho souøadnice vzhledem 
k~uspoøádané bázi $(C)$. Slo¾ené zobrazení
$\a' = \c_C \circ \a \circ \c_B^{-1}$ je zobrazením z~$\R^n$ do $\R^m$
a má tedy podle vìty\cite[aRA] svou matici $\A\in\R^{m,n}$. Tuto matici nazýváme
{\em maticí zobrazení $\a$ vzhledem k bázím $(B)$ a $(C)$}
a znaèíme ji $\A=\m_{B,C}(\a)$.
\ha 10
\inl[matice: zobrazení]
\inl[matice: lineárního zobrazení]

\veta* [Aasour]
%%%%%
Nech» $\a: L_1\to L_2$ je lineární zobrazení, $\dim L_1=n$ a $\dim L_2=m$. 
Nech» $(B)$ je uspoøádaná báze v $L_1$ a $(C)$ je uspoøádaná báze v
$L_2$. Nech» $\A=\m_{B,C}(\a)$ je matice zobrazení $\a$ vzhledem k bázím
$(B)$ a $(C)$.
Nech» $\vec u\in L_1$, $\vec v\in L_2$, $\a(\vec u) = \vec v$.
Nech» $\vec x=\c_B(\vec u)^T$ jsou souøadnice vektoru $\vec u$ vzhledem
k~bázi $(B)$ a $\vec y=\c_C(\vec v)^T$ jsou souøadnice vektoru $\vec v$
vzhledem k bázi $(C)$. Pak $\A\cdot\vec x=\vec y$. Lapidárnì øeèeno,
pro ka¾dé $\vec u\in L_1$ platí:
$$
  \A\cdot\pmatrix{\hbox{souøadnice}\cr\hbox{vektoru}\cr \vec u\cr
      \hbox{vzhledem}\cr\hbox{k $(B)$}} = 
  \pmatrix{\hbox{souøadnice}\cr\hbox{vektoru}\cr \a(\vec u)\cr
      \hbox{vzhledem}\cr\hbox{k $(C)$}}
  \rce(akratsouradnice)
$$
Obrácenì: ka¾dá matice $\A\in\R^{m,n}$, která
splòuje\cite(akratsouradnice) pro v¹echny vektory $\vec u\in L_1$, je
maticí zobrazení $\a$ vzhledem k~bázím $(B)$ a $(C)$.

\dukaz
Vìta je jen v jiné formì zapsaná definice\cite[defAa] matice
lineárního zbrazení vzhledem k bázím $(B)$ a $(C)$. Zobrazení $\a'$ z
této definice zobrazuje souøadnice vektoru $\vec u$ vzhledem k~bázi $(B)$ 
na souøadnice vektoru $\a(\vec u)$ vzhledem k~bázi $(C)$, 
tedy zobrazí $\vec x$ na $\vec y$. Matice $\A$ 
zobrazení $\a'$ podle definice\cite[defaRA] splòuje 
$\A\cdot\vec x = \vec y$. 

Obrácenì: staèí ukázat, ¾e nemohou existovat dvì rùzné 
matice splòující\cite(akratsouradnice) pro v¹echna $\vec u\in L_1$. 
Oznaème $(B)=(\vecc b_n)$ a dosadíme do rovnosti\cite(akratsouradnice) 
postupnì $\vec u=\vec b_i$. Souøadnice vektoru $\vec b_i$ vzhledem k bázi
$(B)$ je vektor $\vec e_i = (0,\ldots,0,1,0,\ldots,0)^T$, kde jednièka
je v~$i$-té slo¾ce. Maticové násobení $\A\cdot\vec e_i$ je rovno
$i$-tému sloupci matice $\A$. Tak¾e matice $\A$ musí v $i$-tém sloupci
obsahovat souøadnice vektoru $\a(\vec b_i)$ vzhledem k bázi $(C)$.
Taková matice je jenom jediná a je zøejmì maticí zobrazení $\a$
vzhledem k~bázím $(B)$ a $(C)$. 

\veta* [Asloupce]
%%%%%
Nech» $\a: L_1\to L_2$ je lineární zobrazení. 
Nech» $(B)=(\vecc b_n)$ je uspoøádaná báze v~$L_1$ a 
$(C)=(\vecc c_m)$ je uspoøádaná báze v $L_2$.
Matice $\A$ je maticí zobrazení $\a$ vzhledem k~bázím~$(B)$ a $(C)$ 
právì tehdy, kdy¾ obsahuje 
v $i$-tém sloupci souøadnice vektoru $\a(\vec b_i)$ 
vzhledem k~bázi~$(C)$ pro v¹echna $i\in\{1,2,\ldots,n\}$.

\dukaz
Viz druhou èást dùkazu pøedchozí vìty.

\veta* [matzob]
%%%%%
Nech» $\a: L_1\to L_2$ je lineární zobrazení. 
Nech» $(B)=(\vecc b_n)$ je uspoøádaná báze v~$L_1$ a 
$(C)=(\vecc c_m)$ je uspoøádaná báze v $L_2$. 
Matice $\A$ je maticí zobrazení $\a$ vzhledem k~bázím~$(B)$ 
a $(C)$ právì tehdy, kdy¾ splòuje maticovou rovnost
$$
  \bigl(\a(\vec b_1)\ \ \a(\vec b_2)\ \ \ldots\ \ \a(\vec b_n)\bigr) 
  = (\vec c_1\ \ \vec c_2\ \ \ldots\ \ \vec c_m)\cdot\A.
  \rce(mzob)
$$
Uvedenou rovnost èteme takto: jednoøádková matice s obrazy
bázových vektorù $\a(\vec b_i)$ je rovna souèinu jednoøádkové 
matice s bázovými vektory $\vec c_i$ a matice $\A\in\R^{m,n}$. 

\dukaz
Matice $\A$ splòuje rovnost\cite(mzob) právì tehdy,
kdy¾ $i$-tý sloupec matice $\A$ obsahuje souøadnice vektoru 
$\a(\vec b_i)$ vzhledem k bázi $(C)$. Staèí si rozepsat maticové
násobení na pravé stranì rovnosti\cite(mzob) po sloupcích matice $\A$.
Dále pou¾ijeme vìtu\cite[Asloupce].

\poznamka
%%%%%%%%%
Matici zobrazení jsme definovali jednak v definici\cite[defaRA] a
také v~definici\cite[defAa]. 
Je zøejmé, ¾e matice zobrazení bez uvedení bází 
(podle definice\cite[defaRA]) je z pohledu definice\cite[defAa]
maticí zobrazení vzhledem ke standardním bázím $(S_n)$ v $\R^n$ a
$(S_m)$ v $\R^m$. Je to z toho dùvodu, ¾e slo¾ky vektoru z $\R^n$ 
jsou podle vìty\cite[snsour] rovny souøadnicím vektoru vzhledem ke
standardní bázi.

Domluvíme se na tom, ¾e pokud budeme
pracovat s lineárními zobrazeními $\R^n\to\R^m$ a pouze se standardními
bázemi v $\R^n$ a $\R^m$, pak nemusíme 
v~pøípadì matice zobrazení explicitnì mluvit o bázích (jako v~definici\cite[defaRA]).
V ostatních pøípadech budeme báze v souvislosti s maticí zobrazení
v¾dy uvádìt.


\priklad [derpol]
%%%%%%%%
Nech» $L_1$ je lineární prostor v¹ech polynomù nejvý¹e tøetího stupnì
a $L_2$ je lineární prostor v¹ech polynomù nejvý¹e druhého
stupnì. Uva¾ujme zobrazení $\a: L_1\to L_2$, které derivuje polynomy,
tedy $\a(p)=p'$. Toto zobrazení je zøejmì lineární.
V lineárním prostoru $L_1$ zvolme uspoøádanou bázi
$(B)=(1,x,x^2,x^3)$ a v lineárním prostoru $L_2$ zvolme uspoøádanou bázi
$(C)=(1,x,x^2)$. Najdeme matici zobrazení $\a$ vzhledem k bázím $(B)$
a $(C)$.

Obrazy bázových vektorù jsou: $\a(1) = 0$, $\a(x) = 1$, 
$\a(x^2) = 2x$, $\a(x^3) = 3x^2$. Souøadnice tìchto obrazù vzhledem k
bázi $(C)$ jsou: $\c_C(0) = (0,0,0)$, $\c_C(1) = (1,0,0)$, 
$\c_C(2x) = (0,2,0)$, $\c_C(3x^2) =\nobreak (0,0,3)$. Abychom získali matici
zobrazení $\a$ vzhledem k bázím $(B)$ a $(C)$, je potøeba
podle vìty\cite[Asloupce] uvedené souøadnice zapsat do sloupcù:
$$
  \A = \pmatrix{0&1&0&0\cr 0&0&2&0\cr 0&0&0&3}
$$
Zkusme nyní derivovat polynomy pomocí maticového násobení.
Polynom $ax^3+bx^2+cx+d$ má v~uspoøádané bázi~$(B)$ souøadnice $(d,c,b,a)$.
Souøadnice jeho obrazu (tj. v tomto pøíkladì jeho derivace) 
vzhledem k~uspoøádané bázi $(C)$ najdeme podle vìty\cite[Aasour] 
maticovým násobením:
$$
  \pmatrix{0&1&0&0\cr 0&0&2&0\cr 0&0&0&3}\cdot
  \pmatrix{d\cr c\cr b\cr a} = \pmatrix {c\cr 2b\cr 3a}
$$
tedy zderivovaný polynom je $3a x^2 + 2bx + c$.

\priklad [bR3toR4]
%%%%%%%%
Najdeme matici zobrazení $\a:\R^3\to\R^4$ z pøíkladu\cite[R3toR4] 
vzhledem k uspoøádaným bázím $(B)$ a
$(S_4)$, kde $(B) = \bigl((1,1,2),(1,2,2),(2,1,5)\bigr)$ a $(S_4)$
je standardní báze v $\R^4$.

Proto¾e souøadnice vektorù z $\R^4$ vzhledem ke standardní bázi $S_4$ 
jsou pøímo rovny slo¾kám tìchto vektorù (viz vìtu\cite[snsour]), staèí
napsat slo¾ky obrazù vektorù z $(B)$ do sloupcù matice. Tyto obrazy
jsou pøímo v zadání pøíkladu:
$$
  \m_{B,S_4}(\a) = \pmatrix{1&2&1\cr 0&0&2\cr 1&2&2\cr 0&0&1}.
$$
Pov¹imneme si, ¾e k sestavení této matice jsme nepotøebovali znát
vzorec pro $\a(x_1,x_2,x_3)$, staèilo sepsat do sloupcù matice údaje,
které byly obsahem zadání pøíkladu. Na druhé stranì k sestavení 
matice~$\m_{S_3,S_4}$ (viz pøíklad\cite[mR3toR4]) jsme vzorec 
pro $\a(x_1,x_2,x_3)$ potøebovali znát.

\okraj Transfor\-mace | Transformace

\poznamka
%%%%%%%%%
V mnoha pøíkladech na lineární zobrazení se setkáváme se zobrazením do
stejného lineárního prostoru. Bude tedy u¾iteèné uvést následující definici.

\definice
%%%%%%%%%
Lineární zobrazení $\a:L\to L$ (tj. z lineárního prostoru do {\it tého¾\/}
lineárního prostoru) se nazývá {\em lineární transformace}. 
Nech» $\a: L\to L$ je lineární transformace, $\dim L=n$. Matici
$\m_{B,B}(\a)\in\nobreak\R^{n,n}$ nazýváme
{\em maticí transformace vzhledem k uspoøádané bázi $(B)$}. U¹etøíme si tedy koktání:
místo abychom mluvili o~matici lineárního zobrazení vzhledem k bázím
$(B)$ a $(B)$, øíkáme struènìji matice transformace vzhledem k~bázi~$(B)$.
\inl[lineární: transformace, transformace]
\inl[matice: transformace]


\priklad [projekce]
%%%%%%%%
V lineárním prostoru $U_O$ orientovaných úseèek se spoleèným 
poèátkem~$O$ (viz pøíklad\cite[lpvv]) jsou dány tøi lineárnì nezávislé
vektory $\vec b_1, \vec b_2, \vec b_3$. Uva¾ujme transformaci
$\a: U_O\to U_O$, která ka¾dé orientované úseèce pøiøadí její stín na
rovinì procházející vektory $\vec b_2, \vec b_3$, 
pøitom svìtelné paprsky jsou rovnobì¾né s~vektorem $\vec b_1$.
Taková transformace se nazývá {\em projekce}.
\inl[projekce]

Zøejmì je $(B)=(\vec b_1, \vec b_2, \vec b_3)$ uspoøádaná 
báze lineárního prostoru $U_O$. Najdeme matici $\m_{B,B}(\a)$ 
transformace $\a$ vzhledem k uspoøádané bázi $(B)$. 
 
Platí $\a(\vec b_1) = \vec o$, $\a(\vec b_2) = \vec b_2$, 
$\a(\vec b_3) = \vec b_3$. Souøadnice tìchto obrazù vzhledem k bázi
$(B)$ po øadì jsou $(0,0,0)$, $(0,1,0)$, $(0,0,1)$. Tyto souøadnice
zapí¹eme do sloupcù hledané matice:
$$
  \A = \pmatrix{0&0&0\cr0&1&0\cr0&0&1}.\qquad
  \hbox{Proto¾e platí:}\quad
  \pmatrix{0&0&0\cr0&1&0\cr0&0&1}\cdot\pmatrix{x\cr y\cr z} =
  \pmatrix{0\cr y\cr z},
$$
má vektor $\vec u\in U_O$ se souøadnicemi $(x,y,z)$ svùj stín, 
který má souøadnice $(0,y,z)$.

\priklad [rotace]
%%%%%%%%
V lineárním prostoru $U_O$ orientovaných úseèek s poèátkem v bodì $O$
(viz pøíklad\cite[lpvv]) zvolme podprostor $P$ dimenze~2 (vektory le¾ící
ve spoleèné rovinì). V~tomto prostoru $P$ zvolme bázi
$(B)=(\vec b_1,\vec b_2)$ tak, ¾e vektory báze jsou na sebe kolmé a
mají jednotkovou velikost (jako na obrázku ní¾e). Transformaci, 
která otoèí ka¾dý vzor o pevnì zvolený úhel $\alpha$ 
oznaèíme ${\cal R}_\alpha:P\to P$ a budeme jí øíkat 
{\em rotace}. Najdeme matici $\m_{B,B}({\cal R}_\alpha)$ 
této transformace vzhledem k bázi $(B)$.

\noendpar
\dolu 8mm
\obrazek .37+.02 12 obr10
{
  \p 110 54 O
  \p 103 160 \vec b_1
  \p 60 150 \vec b_1'
  \p -4 54 \vec b_2
  \p 6 8 \vec b_2'
  \p 95 86 {\alpha}
  \p 72 49 {\alpha}
  \p 110 136 {\cos\alpha}
  \p 110 0 {-\sin\alpha}
  \p 53 62 {\sin\alpha}
  \p 13 62 {\cos\alpha}
}
Na obrázku jsou kromì báze $(B)=(\vec b_1, \vec b_2)$ vyznaèeny té¾ obrazy báze
${\cal R}_\alpha(\vec b_1)=\vec b_1'$ a ${\cal R}_\alpha(\vec
  b_2)=\vec b_2'$, které jsou otoèeny vzhledem ke svým vzorùm o úhel $\alpha$.
Z vlastností funkcí kosinus a sinus plyne, ¾e
$$\vec b_1' = (\cos\alpha)\,\vec b_1 + (\sin\alpha)\,\vec b_2,$$
Z tohoto vztahu okam¾itì vidíme souøadnice obrazu $\vec b_1'$ 
vzhledem k~bázi $(B)$.
V souladu s vìtou\cite[Asloupce] zapí¹eme tyto souøadnice do prvního
sloupce sestavované matice. Dále ze vztahu 
$$\vec b_2' =(-\sin\alpha)\,\vec b_1 +(\cos\alpha)\,\vec b_2$$ 
odhalíme
souøadnice obrazu $\vec b_2'$ vzhledem k bázi $(B)$ a
zapí¹eme je do druhého sloupce hledané matice. Dostáváme
$$
\m_{B,B}({\cal R}_\alpha) = \pmatrix {\cos\alpha & -\sin\alpha\cr
                                    \sin\alpha & \phantom{+}\cos\alpha}
$$
Nech» vektor $\vec u\in P$ má souøadnice $(x,y)$ vzhledem k bázi
$(B)$. Vypoèítáme souøadnice vektoru, který vznikne
otoèením vektoru $\vec u$ o úhlel $\alpha$. Pou¾ijeme vìtu\cite[Aasour].
$$
  \pmatrix {\cos\alpha & -\sin\alpha\cr
            \sin\alpha & \phantom{+}\cos\alpha} \cdot
  \pmatrix {x\cr y} =
  \pmatrix {x\cos\alpha - y\sin\alpha \cr x\sin\alpha + y\cos\alpha}.
$$
Souøadnice otoèeného vektoru vzhledem k bázi $(B)$ tedy jsou $(x',y')$,
kde 
$$
  \eqalign{
  x'&=x\cos\alpha - y\sin\alpha, \cr 
  y'&=x\sin\alpha + y\cos\alpha.
}
$$

\okraj Hodnost\hb matice a zobrazení | Hodnost matice a zobrazeni

\veta* [hodhod]
%%%%%
Nech» $\a:L_1\to L_2$ je lineární zobrazení prostorù koneèné dimenze,
nech» $\A$ je jeho matice vzhledem k nìjaké bázi $(B)$ v $L_1$ a
bázi $(C)$ v $L_2$. Pak $\hod\a=\hod\A$.

\dukaz
Symboly $\a'$, $\c_B$ a $\c_C$ v tomto dùkazu znamenají toté¾ co 
v~definici\cite[defAa].
Díky vìtì\cite[hod=hod] staèí ukázat, ¾e $\hod\a=\hod\a'$, kde
$\a'=\c_C\circ\a\circ\c_B^{-1}$, neboli
$\a=\c_C^{-1}\circ\a'\circ\c_B$. Nech»
$(B)=(\vecc b_n)$ je báze v $L_1$ a 
$(S_n)=(\vecc e_n)$ je standardní báze v $\R^n$.
Platí $\vec e_i = \c_B(\vec b_i)$.
Nyní spoèítejme $\hod\a$:
$$
  \eqalign{
  \hod\a&=\dim\a(L_1) = \dim\a\bigl(\lob<\vecc b_n>\bigr) =
  \dim\bigl\langle\a(\vec b_1), \a(\vec b_2), \ldots, 
      \a(\vec b_n)\bigr\rangle =\cr &=
  \dim\bigl\langle\c_C^{-1}\circ\a'\circ\c_B(\vec b_1),\ 
           \c_C^{-1}\circ\a'\circ\c_B(\vec b_2),\ \ldots,\ 
           \c_C^{-1}\circ\a'\circ\c_B(\vec b_n)\bigr\rangle = \cr &=
  \dim\,\c_C^{-1}\bigl(\bigl\langle\a'(\vec e_1),
           \a'(\vec e_2), \ldots, 
           \a'(\vec e_n)\bigr\rangle\bigr) \buildrel\star\over =
  \dim\bigl\langle\a'(\vec e_1), \a'(\vec e_2), \ldots, 
         \a'(\vec e_n)\bigr\rangle = \cr &=
  \dim \a'\bigl(\lob<\vecc e_n>\bigr) = \dim\a'(\R^n) = \hod\a'
  }
$$
Rovnost oznaèená hvìzdièkou platí kvùli tomu, ¾e $\c_C^{-1}$ je isomorfismus,
tak¾e zachovává dimenzi lineárních podprostorù.

\veta [regultransf]
%%%%%
Lineární transformace prostoru koneèné dimenze 
je prostá právì tehdy, kdy¾ má regulární matici.

\dukaz
Lineární transformace 
$\a: L\to L$ je prostá právì kdy¾ má nulový defekt 
(viz vìtu\cite[defA=proste]). To platí právì tehdy, kdy¾ 
$\hod\a=\hod\A=\dim L=n$ (viz vìty\cite[def+hod] a \cite[hodhod]). 
Matice $\A\in\R^{n,n}$ transformace~$\a$ je regulární
právì tehdy, kdy¾ $\hod\A=n$ (viz vìtu\cite[hodreg]).

\priklad
%%%%%%%%
Urèíme hodnost a defekt lineárního zobrazení $\a$ z pøíkladu\cite[derpol].

Hodnost zobrazení $\a$ je rovna podle vìty\cite[hodhod] hodnosti jeho
matice. Tu jsme sestavili v pøíkladu\cite[derpol]. Matice zobrazení 
má hodnost~3, tedy i $\hod\a=3$. Defekt zobrazení $\a$ spoèítáme podle vzorce
$\defekt\a+\nobreak\hod\a = \dim L_1=4$, tak¾e $\defekt\a=1$.

\priklad
%%%%%%%%
Urèíme hodnost a defekt lineárního zobrazení $\a$ z~pøíkladu\cite[projekce].

Hodnost zobrazení $\a$ je rovna podle vìty\cite[hodhod] hodnosti jeho
matice. Tu jsme sestavili v pøíkladu\cite[projekce]. Matice zobrazení 
má hodnost~2, tedy i $\hod\a=2$. Defekt zobrazení $\a$ spoèítáme podle vzorce
$\defekt\a+\nobreak\hod\a = \dim L_1=3$, tak¾e $\defekt\a=1$.

Toto zobrazení tedy pøevede 3D vzor ($\dim L_1=3$) na 2D obraz 
($\hod\a=2$), tedy pøi tomto zobrazení ztrácíme informace z jedné
dimenze ($\defekt\a=1$). To vysvìtluje, proè se tomuto zobrazení
øíká projekce. S tímto slovem se jistì ètenáø setkal 
v souvislosti s promítáním filmù.

\priklad
%%%%%%%%
Proto¾e matice z pøíkladù\cite[mR3toR4] a\cite[bR3toR4] jsou maticemi stejného
lineárního zobrazení (jen vzhledem k rùzné bázi v $L_1$), mají hodnost
rovnu hodnosti tohoto zobrazení. Tím je zaruèeno, ¾e tyto matice mají
stejnou hodnost. Z výsledku pøíkadu\cite[mR3toR4] víme, ¾e tyto matice 
mají hodnost~3.

\priklad
%%%%%%%%
Matice rotace z pøíkladu\cite[rotace] je regulární, proto¾e 
$\det\m_{B,B}({\cal R}_\alpha) = \cos^2\alpha + \sin^2\alpha = 1$.
Podle vìty\cite[regultransf] je tedy rotace prostá transformace.

\priklad [scale]
%%%%%%%%
Budeme pracovat se stejným lineárním podprostorem $P$ orientovaných úseèek
jako v~pøíkladu\cite[rotace] a zvolíme stejnou uspoøádanou 
bázi $(B)$. Zvolme dále èísla $a\in\R$, $b\in\R$. 
Popí¹eme transformaci ${\cal S}_{a,b}:P\to P$, která má matici
$$
  \A = \pmatrix {a & 0 \cr 0 & b}
  \rce(mscale)
$$
vzhledem k bázi $(B)$. Po pou¾ití vìty\cite[Aasour] vidíme, ¾e vektor $\vec u\in P$ se
souøadnicemi $(x,y)$ se zobrazí na vektor se souøadnicemi $(ax,by)$.
Co to geometricky znamená pro rùzné parametry $a$, $b$?

Pøi $a=1$ a $b=1$ zobrazení $\cal S$ ponechává vektor $\vec u$
beze zmìny. Takové transformaci øíkáme {\em identita}.

V pøípadì $a=-1$ a $b=1$ zobrazení $\cal S$ transformuje vektor $\vec u$ na
jeho osovì soumìrný protìj¹ek podle osy, která prochází vektorem $\vec b_2$.
V pøípadì $a=1$ a $b=-1$ zobrazení $\cal S$ transformuje vektor $\vec u$ na
jeho osovì soumìrný protìj¹ek podle osy, která prochází vektorem $\vec b_1$.
Takové transformace se nazývají {\em osová soumìrnost}.

V pøípadì $a=-1$ a $b=-1$ zobrazení $\cal S$ zobrazí vektor $\vec u$
na vektor $-\vec u$ a této transformaci øíkáme støedová soumìrnost
(podle poèátku $O$).

V pøípadì $a=0$ a $b=1$ je zobrazení $\cal S$ projekcí na pøímku,
která prochází vektorem $\vec b_2$. V pøípadì $a=\nobreak1$ a $b=0$
je $\cal S$ projekcí na pøímku, která prochází vektorem $\vec b_1$.
V tìchto pøípadech se 2D vzor \uv{promítá} na 1D obraz, tak¾e zde máme
v mno¾inì vzorù i obrazù o jednu dimenzi ménì ne¾ 
v~pøíkladu\cite[projekce]. Je~$\hod{\cal S}=1$ a $\defekt{\cal S}=1$.

V pøípadì $a>0$ a $b=1$ je obraz $a$-krát deformován ve smìru vektoru
$\vec b_1$. V pøípadì $a=1$ a $b>0$ je obraz $b$-krát deformován ve
smìru vektoru $\vec b_2$. V pøípadì $a>0$ a $b>0$ je obraz deformován
v obou smìrech. Takové transformaci øíkáme {\em zmìna mìøítka}.
Pøi $a=b$ této transformaci øíkáme {\em stejnolehlost}.

Obecný pøípad $a\in\R$ a $b\in\R$ odpovídá transformaci zmìny mìøítka
pøípadnì slo¾enou s osovou nebo støedovou soumìrností. Pøi $a=0$ nebo
$b=0$ je $\cal S$ projekce. Pøi $a=0$ i $b=0$ je $\cal S$ zobrazení,
které ka¾dému vektoru pøiøadí nulový vektor. Defekt tohoto zobrazení
je~2 a hodnost nula. 

Zobrazení ${\cal S}_{a,b}:P\to P$ s maticí\cite(mscale) budeme nadále
øíkat {\em zmìna mìøítka}. Pod tímto pojmem budeme zahrnovat i v¹echny
speciální pøípady zde vyjmenované.

\okraj Jednoznaè\-nost matice zobrazení | Jednoznacnost matice zobrazeni

\veta* [aisoA]
%%%%%
Nech» $L_1$ a $L_2$ jsou lineární prostory, $\dim L_1=n$, $\dim L_2=m$.
Lineární prostor v¹ech lineárních zobrazení z $L_1$ do $L_2$ je
izomorfní s lineárním prostorem matic $\R^{m,n}$. 

\exdukaz
Oznaème $T$ lineární prostor v¹ech lineárních zobrazení z $L_1$ do $L_2$.
Zvolme nìjakou uspoøádanou bázi v $L_1$ a oznaème ji $(B)$. Také
oznaème $(C)$ uspoøádanou bázi v $L_2$. (viz té¾ obrázek 
u definice\cite[defAa]).
Uká¾eme, ¾e 
zobrazení $\m_{B,C}: T\to \R^{m,n}$, které pøiøazuje zobrazením z~$T$
jejich matice vzhledem k~bázím $(B)$ a $(C)$, je izomorfismus.

Obrazy zobrazení $\m_{B,C}$ jednoznaènì existují pro v¹echna $\a\in T$,
proto¾e ka¾dému $\a$ je jednoznaènì pøiøazeno 
$\a'=\c_C\circ\a\circ\c_B^{-1}$ a ka¾dému
takovému $\a':\R^n\to\R^m$ je jednoznaènì pøiøazena matice $\A$ díky 
vìtì\cite[aRA]. 

Zobrazení $\m_{B,C}$ je prosté a~\uv{na}~$\R^{m,n}$.
To plyne z rovnosti\cite(mzob), ve které vidíme, ¾e
matice $\A$ udává hodnoty zobrazení $\a$ na bázi $(B)$. Podle 
vìty\cite[zobnabasi] existuje jediné 
lineární zobrazení s takto urèenými hodnotami na bázi.
  
®e je $\m_{B,C}$ lineární plyne z~toho, ¾e
$\m_{B,C}(\a)$ obsahuje ve sloupcích souøadnice 
obrazù báze $(B)$ vzhledem k $(C)$. Tak¾e matice zobrazení $\a+\b$ je nutnì
souètem matic zobrazení $\a$ a $\b$ (obrazy báze se sèítají, jejich
souøadnice rovnì¾). Podobné tvrzení platí pro $\alpha$-násobek. 

Zobrazení $\m_{B,C}:T\to\R^{m,n}$ je tedy prosté, na $\R^{m,n}$ a lineární. 
Je to tedy izomorfismus.

\poznamka
%%%%%%%%%
V dùkazu pøedchozí vìty jsme ukázali, ¾e pøechod od lineárního
zobrazení k jeho matici je izomorfismus. To je dùvod, proè èasto
matematik napí¹e matici a myslí pøitom na lineární zobrazení nebo naopak,
pracuje s lineárním zobrazením a hledá k nìmu matici.

\vfil\break

\okraj Matice\hb slo¾eného zobrazení | Matice slozeneho zobrazeni

\dolu 7mm
\obrazek .4+.02 11 obr9
{
  \p 35 14 L_1
  \p 45 80 L_2
  \p 40 155 L_3
  \p 50 45 {\a}
  \p 50 120 {\b}
  \p -3 90 {\b\circ\a}
  \p 65 8 (B)
  \p 75 77 (C)
  \p 65 153 (D)
  \p 104 15  \c_B
  \p 113 82 \c_C
  \p 107 155 \c_D
  \p 135 12 \R^n
  \p 135 74 \R^m
  \p 135 140 \R^p
  \p 123 35 \A\cdot\vec x 
  \p 123 105 \B\cdot\vec y 
  \p 163 60 (\B\cdot\A)\cdot\vec x
}
\veta* [slozmzob]
%%%%%
Nech» $L_1$, $L_2$, $L_3$ jsou lineární prostory koneèné dimenze,
$\a:L_1\to L_2$, $\b:L_2\to L_3$ jsou lineární zobrazení. Nech»
dále $(B)$ je uspoøádaná báze~$L_1$, $(C)$ je uspoøádaná báze~$L_2$ a
$(D)$ je uspoøádaná báze~$L_3$. Pøedpokládejme je¹tì, ¾e
$\m_{B,C}(\a)=\A$ je matice zobrazení $\a$ vzhledem 
k~bázím $(B)$ a~$(C)$ a koneènì
$\m_{C,D}(\b)=\B$ je matice zobrazení $\b$ vzhledem k~bázím $(C)$ a~$(D)$.
Pak $\B\cdot\A$ je matice slo¾eného zobrazení $\b\circ\a$
vzhledem k~bázím $(B)$ a $(D)$.
\inl[matice: slo¾eného zobrazení]

\dukaz
%%%%%%
Pou¾ijeme dvakrát za sebou vìtu\cite[Aasour].
Pro ka¾dý vektor $\vec u\in L_1$ platí:
\ha5
$$
  \B\cdot\A\cdot\pmatrix{\hbox{souøadnice}\cr\hbox{vektoru}\cr \vec u\cr
      \hbox{vzhledem}\cr\hbox{k $(B)$}} = 
  \B\cdot\pmatrix{\hbox{souøadnice}\cr\hbox{vektoru}\cr \a(\vec u)\cr
      \hbox{vzhledem}\cr\hbox{k $(C)$}} =
   \pmatrix{\hbox{souøadnice}\cr\hbox{vektoru}\cr \b\bigl(\a(\vec u)\bigr)\cr
      \hbox{vzhledem}\cr\hbox{k $(D)$}}
$$
Platí $\b\bigl(\a(\vec u)\bigr) = (\b\circ\a)(\vec u)$. 
Z~vìty\cite[Aasour] plyne, ¾e $\B\cdot\A$ musí být maticí zobrazení
$\b\circ\a$ vzhledem k~bázím $(B)$ a $(D)$.

\poznamka
%%%%%%%%%
Vìtu\cite[slozmzob] mù¾eme struènì zapsat takto:
$$
   \m_{B,D}(\b\circ\a) = \m_{C,D}(\b) \cdot \m_{B,C}(\a)
   \rce(sloz)
$$

\veta [Aainvers]
%%%%%
Nech» $L$ je lineární prostor koneèné dimenze a $(B)$ je jeho
uspoøádaná báze. Nech» $\a: L\to L$ je prostá lineární tranformace.
Pak $\a$ je izomorfismus, tj. existuje inverzní transformace $\a^{-1}$
a platí
$$
  \m_{B,B}(\a^{-1}) = \bigl(\m_{B,B}(\a)\bigr)^{-1}.
$$

\dukaz
Proto¾e $\a$ je prostá, je
$\defekt\a=0$. Podle vìty\cite[def+hod] je
$\defekt\a+\hod\a=0+\hod\a=\dim L$. Je $\hod\a=n$ a vìta\cite[P=L] nám
zaruèí, ¾e $\a(L)=L$. Tak¾e transformace 
$\a$ je nejen prostá, ale i \uv{na}~$L$, tedy je to izomorfismus.
Symbolem $\i$ oznaème identické zobrazení na $L$. Pro $\a^{-1}$ 
platí $\i=\a^{-1}\circ\a$. Podle vìty\cite[slozmzob] tedy je
$$
  \m_{B,B}(\a^{-1})\cdot \m_{B,B}(\a) = \m_{B,B}(\i) = \E
$$
Matice identity je jednotková matice $\E$. 
Matice $\m_{B,B}(\a)$ je podle vìty\cite[regultransf] regulární, tak¾e
mù¾eme maticí $\bigl(\m_{B,B}(\a)\bigr)^{-1}$ vynásobit uvedenou
rovnost zprava. Tím dostáváme dokazovaný vztah.


\priklad
%%%%%%%%
Budeme pracovat v lineárním prostoru $P$ s uspoøádanou bází $(B)$
jako v pøíkladu\cite[rotace]. Lineární transformace $\a: P\to P$
otoèí vzor o stanovený úhel $\alpha$ a následnì jej promítne na pøímku
procházející vektorem $\vec b_2$. Najdeme matici této transformace.

Platí $\a={\cal S}_{0,1}\circ{\cal R}_\alpha$, kde ${\cal S}_{0,1}: P\to P$
je projekce a ${\cal R}_\alpha: P\to P$ je rotace o úhel $\alpha$. 
Matice tìchto transformací vzhledem k bázi $(B)$ jsou:
$$
  \m_{B,B}({\cal R}_\alpha) =
        \pmatrix {\cos\alpha & -\sin\alpha\cr
             \sin\alpha & \phantom{+}\cos\alpha}, \qquad
  \m_{B,B}({\cal S}_{0,1}) = \pmatrix {0&0\cr0&1}.
$$
Podle vìty\cite[slozmzob] je matice slo¾eného zobrazení $\a$ rovna
$$
  \m_{B,B}(\a) = \m_{B,B}({\cal S}_{0,1})\cdot\m_{B,B}({\cal R}_\alpha) =
        \pmatrix {0&0\cr0&1}\cdot
        \pmatrix {\cos\alpha & -\sin\alpha\cr
             \sin\alpha & \phantom{+}\cos\alpha}
  = \pmatrix {0&0\cr \sin\alpha & \cos\alpha}
$$
Má-li vektor $\vec u$ souøadnice $(x,y)$ vzhledem k $(B)$, pak
$\a(\vec u)$ má vzhledem k $(B)$ souøadnice $(x',y')$:
$$
 \pmatrix{x'\cr y'} =
 \pmatrix {0&0\cr \sin\alpha & \cos\alpha} \cdot \pmatrix{x\cr y}
 = \pmatrix {0\cr (\sin\alpha)\,x + (\cos\alpha)\,y}
$$
Pov¹imneme si, ¾e kdybychom zobrazení slo¾ili v opaèném poøadí, tj.
${\cal R}_\alpha\circ{\cal S}_{0,1}$, dostaneme jiný výsledek. Stejnì tak
souèin matic tìchto zobrazení v opaèném poøadí dává jiný výsledek.

\priklad
%%%%%%%%
Budeme stále pracovat v lineárním prostoru $P$ s uspoøádanou bází $(B)$
jako v pøíkladu\cite[rotace]. Nakreslíme v nìm pøímku $p$ procházející
poèátkem, která svírá s vektorem $\vec b_1$ úhel $\alpha$.
Najdeme matici osové soumìrnosti podle pøímky $p$.

Osovou soumìrnost podle $p$ vytvoøíme slo¾ením tøí zobrazení: 
nejprve otoèíme pøímku $p$ o úhel $-\alpha$. Její obraz
tedy prochází vektorem $\vec b_1$. Dále provedeme 
osovou soumìrnost podle pøímky procházející vektorem 
$\vec b_1$ a nakonec otoèíme obraz pøímky
na své místo otoèením o úhel $\alpha$.
Matice jednotlivých transformací vzhledem k~bázi $(B)$ jsou
$$
  \m_{B,B}({\cal R}_{-\alpha}) =
        \pmatrix {\phantom+\cos\alpha & \sin\alpha\cr
             -\sin\alpha & \cos\alpha}, \quad
  \m_{B,B}({\cal S}_{1,-1}) = \pmatrix{1&0\cr 0&\!\!\!-1}, \quad
  \m_{B,B}({\cal R}_\alpha) =
        \pmatrix {\cos\alpha & -\sin\alpha\cr
             \sin\alpha & \phantom{+}\cos\alpha}.
$$
Hledaná matice osové soumìrnosti podle pøímky $p$ je souèinem
tìchto matic ve správném poøadí:
$$
  \m_{B,B}(\a) = \pmatrix {\cos\alpha & -\sin\alpha\cr
             \sin\alpha & \phantom{+}\cos\alpha}\cdot
             \pmatrix{1&0\cr 0&\!\!\!-1} \cdot
    \pmatrix {\phantom+\cos\alpha & \sin\alpha\cr
             -\sin\alpha & \cos\alpha} =
    \pmatrix {\cos^2\alpha-\sin^2\alpha & 2\cos\alpha\sin\alpha\cr
             2\cos\alpha\sin\alpha & -\cos^2\alpha+\sin^2\alpha}
$$
Podle vzoreèkù o dvojnásobném úhlu mù¾eme výslednou matici pøepsat do
tvaru:
$$
  \m_{B,B}(\a) = \pmatrix{\cos2\alpha & \sin2\alpha\cr
                          \sin2\alpha & -\cos2\alpha}
$$
Má-li vektor $\vec u\in P$ souøadnice $(x,y)$ vzhledem k bázi $(B)$,
pak jeho osovì soumìrný obraz podle pøímky~$p$ má vzhledem k bázi
$(B)$ souøadnice $(x',y')$:
$$
  \pmatrix {x'\cr y'} =
  \pmatrix{\cos2\alpha & \phantom+\sin2\alpha\cr
                          \sin2\alpha & -\cos2\alpha} \cdot
  \pmatrix {x\cr y} =
  \pmatrix {(\cos2\alpha)\,x+(\sin2\alpha)\,y\cr (\sin2\alpha)\,x-(\cos2\alpha)\,y}
$$ 


\okraj Matice\hb pøechodu | Matice prechodu

\definice* [defprech]
%%%%%%%%%
Nech» $(B)=(\vecc b_n)$ a $(C)=(\vecc c_n)$ jsou dvì uspoøádané báze
lineárního prostoru $L$. Podle vìty\cite[zobnabasi] existuje jediná
lineární transformace $\a: L\to L$ taková, ¾e $\a(\vec b_i)=\vec c_i$
pro v¹echna $i\in\{1,2,\ldots,n\}$. Matici $\m_{B,B}(\a)$ transformace
$\a$ vzhledem k bázi $(B)$ nazýváme 
{\em maticí pøechodu od báze $(B)$ k bázi $(C)$} a znaèíme ji
$\P_{B\to C}$.

\veta* [mprech]
%%%%%
Nech» $(B)=(\vecc b_n)$ a $(C)=(\vecc c_n)$ jsou dvì uspoøádané báze
lineárního prostoru $L$. Matice pøechodu $\P_{B\to C}$ má
následující vlastnosti:

\noindent (1) $\P_{B\to C}$ má v $i$-tém sloupci souøadnice vektoru
              $\vec c_i$ vzhledem k bázi $(B)$ pro v¹echna $i\in\{1,2,\ldots,n\}$,

\noindent (2) platí maticová rovnost $(\vec c_1\ \vec c_2\ \ldots\ \vec c_n) =
               (\vec b_1\ \vec b_2\ \ldots\ \vec b_n) \cdot \P_{B\to C}$,

\noindent (3) $\P_{B\to C}=\m_{C,B}(\i)$, tj. $\P_{B\to C}$ je maticí
              identity vzhledem k bázím $(C)$ a $(B)$,

\noindent (4) pro ka¾dý vektor $\vec u\in L$ platí 
              $\P_{B\to C}\cdot \c_C(\vec u)^T = \c_B(\vec u)^T$, neboli
$$
  \P_{B\to C}\cdot \pmatrix{\hbox{souøadnice}\cr\hbox{vektoru}\cr \vec u\cr
      \hbox{vzhledem}\cr\hbox{k $(C)$}} =
  \pmatrix{\hbox{souøadnice}\cr\hbox{vektoru}\cr \vec u\cr
      \hbox{vzhledem}\cr\hbox{k $(B)$}}.
$$

\dukaz
(1) Podle vìty\cite[Asloupce] obsahuje matice $\P_{B\to C}$ ve sloupcích
souøadnice obrazù $\a(\vec b_i)=\vec c_i$ vzhledem k~bázi~$(B)$, kde $\a:L\to L$
je lineární transformace z~definice\cite[defprech].

(2) Rozepsáním souèinu $(\vec c_1\ \vec c_2\ \ldots\ \vec c_n) =
(\vec b_1\ \vec b_2\ \ldots\ \vec b_n) \cdot \P_{B\to C}$ po sloupcích
matice $\P_{B\to C}$ shledáváme, ¾e je tento souèin ekvivalentní s~(1).

(3) Vzorec (2) lze psát jako 
$\bigl(\i(\vec c_1)\ \i(\vec c_2)\ \ldots\ \i(\vec c_n)\bigr) =
(\vec b_1\ \vec b_2\ \ldots\ \vec b_n) \cdot \P_{B\to C}$ a dívat se
na nìj úhlem pohledu vzorce\cite(mzob), kde $\a=\i$, a kde jsou
prohozeny báze $(B)$ a $(C)$.

(4) plyne z (3) a z vìty\cite[Aasour].

\okraj Zmìna souøadnic pøi zmìnì báze | Zmena souradnic pri zmene base

\poznamka
%%%%%%%%%
Pov¹imneme si opaèného poøadí bází ve vlastnostech (3) a
(4) v pøedchozí vìtì. Vlastnost (4) øíká, ¾e 
matice pøechodu od báze $(B)$ k bázi $(C)$
umo¾ní poèítat souøadnice vektoru vzhledem k bázi $(B)$, pokud jeho
souøadnice známe vzhledem k bázi $(C)$. Je zde tedy opaèný smìr toku
informace, ne¾ by vyplývalo z názvu matice. Název matice je odvozen 
z~vlastnosti $(2)$, tj. matice transformuje pomocí maticového násobení
bázi $(B)$ na bázi $(C)$.

\poznamka
%%%%%%%%%
V¹echny vlastnosti ve vìtì\cite[mprech] jednoznaènì urèují matici
pøechodu $\P_{B\to c}$. Jinými slovy ka¾dá z nich by se dala
pou¾ít jako definice pojmu matice pøechodu. Je to tím, ¾e ka¾dá
podmínka vymezuje matici $\P_{B\to C}$ jednoznaènì a ve vìtì\cite[mprech] 
jsme dokázali, ¾e tato jediná matice je maticí pøechodu od báze 
$(B)$ k~bázi $(C)$.

\veta* [slozmprech]
%%%%%
Matice pøechodu je regulární a platí 

\noindent (1) $\P_{C\to B} = (\P_{B\to C})^{-1}$,

\noindent (2) $\P_{B\to C}\cdot \P_{C\to D} = \P_{B\to D}$.

\dukaz
$\P_{B\to C}$ je ètvercová matice, proto¾e to je matice transformace.
Proto¾e obsahuje podle (1) vìty\cite[mprech] 
ve sloupcích souøadnice bázových vektorù,
jsou tyto sloupce lineárnì nezávislé. Matice je tedy podle 
vìty\cite[hodreg] regulární.

(1) Vztah vyplyne napøíklad vynásobením rovnosti (2) ve
vìtì\cite[mprech] maticí $(\P_{B\to C})^{-1}$ zprava.
 
(2) U¾itím vzorce\cite(sloz) a vlastnosti (3) vìty\cite[mprech]
dostáváme:
$$
  \P_{B\to C}\cdot \P_{C\to D} = \m_{C,B}(\i)\cdot\m_{D,C}(\i) =
  \m_{D,B}(\i) = \P_{B\to D}.
$$
    
\algoritmus* [aprechod]
%%%%%%%%%%%
Odvodíme algoritmus na efektivní sestavení matice pøechodu 
vzhledem k libovolným bázím. Pravda, vlastnost~(1) vìty\cite[mprech]
dává návod, jak matici pøechodu sestavit. Ov¹em nìkdy se stává, ¾e se
souøadnice vzhledem k bázi $(B)$ obtí¾nì hledají.

Najdeme v lineárním prostoru $L$ nìjakou bázi, vzhledem ke které se
souøadnice dobøe hledají a oznaèíme ji $(S)$. Báze $(S)$ mù¾e být
standardní báze v $\R^n$, báze $(1,x,x^2,x^3)$ v lineárním prostoru
polynomù nejvý¹e tøetího stupnì, báze orientovaných úseèek jednotkové
velikosti a na sebe kolmých v~lineárním prostoru $U_O$ atd.

Nech» jsou dány báze $(B)$ a $(C)$ v lineárním prostoru $L$. 
Pro výpoèet matice pøechodu od báze $(B)$ k bázi $(C)$ 
pou¾ijeme vzorce z pøedchozí vìty:
$$
  \P_{B\to C} = \P_{B\to S} \cdot \P_{S\to C} = (\P_{S\to B})^{-1} \cdot \P_{S\to C}.
$$
Pøitom matice na pravé stranì rovnosti sestavíme snadno:
do sloupcù matice $\P_{S\to B}$ napí¹eme souøadnice vektorù báze $(B)$
vzhledem k $(S)$ a do sloupcù matice $\P_{S\to C}$ napí¹eme 
souøadnice vektorù báze $(C)$ vzhledem k $(S)$.

Abychom si je¹tì u¹etøili práci s výpoètem inverzní matice a následným
maticovým násobením, pou¾ijeme vìtu\cite[AXBsimEX], která øíká
$(\A\,|\,\B)\sim(\E\,|\,\A^{-1}\B)$, neboli
$$
(\P_{S\to B}^{\phantom1}\,|\,\P_{S\to C})\ \sim\ 
(\E\,|\,\P_{S\to B}^{-1} \cdot \P_{S\to C}^{\phantom1}) =
(\E\,|\,\P_{B\to C}).
$$
Tím dostáváme následující algoritmus:

Zapi¹me do sloupcù matice souøadnice báze $(B)$ vzhledem k bázi 
$(S)$ a vedle svislé èáry je¹tì souøanice báze $(C)$ vzhledem k bázi $(S)$.
Po elmininaci, která pøevede levý blok matice na jednotkovou matici,
dostáváme v pravém bloku $\P_{B\to C}$, neboli matici pøechodu od
$(B)$ k $(C)$.

\priklad
%%%%%%%%
V lineárním prostoru polynomù nejvý¹e tøetího stupnì jsou dány tøi
uspoøádané báze:
$$
  \eqalign {
    (B) &= \bigl(x+1,x-1,(x+1)^2,(x+1)^3\bigr), \cr
    (C) &= (1, x+1, x^2+2, x^3+3), \cr
    (S) &= (x^3, x^2, x, 1)
  }
$$
Najdeme matici pøechodu od $(B)$ k $(C)$. Je zøejmé, ¾e souøadnice
polynomu se nám dobøe poèítají vzhledem k bázi $(S)$, tak¾e
zapí¹eme-li do sloupcù souøadnice vektorù z báze $(B)$ vzhledem k
$(S)$, dostáváme okam¾itì $\P_{S\to B}$. Podobnì postupujeme u matice
$\P_{S\to C}$:
$$
  \P_{S\to B} = 
  \pmatrix {0&\hfill0&0&1\cr0&\hfill0&1&3\cr1&\hfill1&2&3\cr1&\!\!-1&1&1}, \qquad
  \P_{S\to C} = \pmatrix {0&0&0&1\cr0&0&1&0\cr0&1&0&0\cr1&1&2&3}.
$$
Pomocí algoritmu\cite[aprechod] najdeme $\P_{B\to C}$. 
$$
  \def\quad{\hskip7pt }
  \def\|{\kern7pt\strut\vrule}
  (\P_{S\to B}\,|\,\P_{S\to C}) =
  \pmatrix {0&\hfill0&0&1\|&0&0&0&1\cr0&\hfill0&1&3\|&0&0&1&0\cr
            1&\hfill1&2&3\|&0&1&0&0\cr1&\!\!-1&1&1\|&1&1&2&3} \sim
  \pmatrix {1&0&0&0\|& \,\,1/2 &1 &-1/2 &\hfill4\cr 
            0&1&0&0\|& \!\!-1/2 &0 &-3/2 &\!-1\cr
            0&0&1&0\|& 0 &0 &\,\,1 &\!-3\cr 0&0&0&1\|& 0&0&\,\,0&\hfill1}
  = (\E\,|\,\P_{B\to C}).
$$

Báze $(S)$, $(B)$ a $(C)$ vymezují v tomto pøíkladì tøi souøadnicové
systémy stejného lineárního prostoru. Vezmene nyní jeden vektor
(polynom) $p$ daný vzorcem $p(x)=2x^3+x^2-3x$.
Zapí¹eme postupnì souøadnice tohoto polynomu ve v¹ech tøech
souøadnicových sytémech.

Souøadnice polynomu $p$ vzhledem k $(S)$ odhalíme snadno:
$\c_S(p) = (2,1,-3,0)$. Zkusíme nyní najít jeho souøadnice vzhledem 
k bázi $(C)$. Podle vzorce (4) vìty\cite[mprech] k tomu potøebujeme
matici $\P_{C\to S}$. Tu~získáme jako inverzi k matici $\P_{S\to C}$:
$$
  \let\h=\hfill
  \P_{C\to S} = (\P_{S\to C})^{-1} = 
  \pmatrix {0&0&0&1\cr0&0&1&0\cr0&1&0&0\cr1&1&2&3}^{-1} =
  \pmatrix {-3 &-2 &-1 &1\cr \h0&\h0&\h0&1\cr \h0&\h0&\h1&0\cr \h1&\h0&\h0&0}.
$$   
Od souøadnic polynomu $p$ vzhledem k bázi $(S)$ k souøadnicím 
vzhledem k~bázi $(C)$ pøejdeme pomocí maticového násobení maticí
$\P_{C\to S}$:
$$
  \let\h=\hfill
  \c_C(p)^T = \P_{C\to S}\cdot \c_S(p)^T = 
  \pmatrix {-3 &-2 &-1 &1\cr \h0&\h0&\h0&1\cr \h0&\h0&\h1&0\cr \h1&\h0&\h0&0}
  \cdot \pmatrix {2\cr1\cr\!\!-3\cr0} =
  \pmatrix {\!-5\cr\!-3\cr1\cr2}.
$$
Od souøadnic polynomu $p$ vzhledem k bázi $(C)$ k souøadnicím 
vzhledem k~bázi $(B)$ pøejdeme pomocí maticového násobení maticí
$\P_{B\to C}$. Tu jsme spoèítali pomocí algoritmu\cite[aprechod].
$$
  \let\h=\hfill
  \c_B(p)^T = \P_{B\to C}\cdot \c_C(p)^T =
  \pmatrix {1/2 &1 &-1/2 &\hfill4\cr 
            \!\!-1/2 &0 &-3/2 &\!-1\cr
            0 &0 &\,\,1 &\!-3\cr 0&0&\,\,0&\hfill1} \cdot
  \pmatrix {\!-5\cr\!-3\cr1\cr2} =
  \pmatrix{2\cr\!-1\cr\!-5\cr2}.    
$$   
Od souøadnic polynomu $p$ vzhledem k bázi $(B)$ k souøadnicím 
vzhledem k~bázi $(S)$ pøejdeme pomocí maticového násobení maticí
$\P_{S\to B}$:
$$
    \let\h=\hfill
  \c_S(p)^T = \P_{S\to B}\cdot \c_B(p)^T =
  \pmatrix {0&\hfill0&0&1\cr0&\hfill0&1&3\cr1&\hfill1&2&3\cr1&\!\!-1&1&1}
  \cdot \pmatrix{2\cr\!-1\cr\!-5\cr2} =
  \pmatrix {2\cr1\cr\!\!-3\cr0}      
$$  
a dostáváme souøadnice, které jsme mìli na zaèátku. ©lo pouze o to
procvièit si zmìny souøadnicového systému za pou¾ití maticového
násobení. Výsledek mù¾eme srovnat s pøíkladem\cite[sourpolynomu], ve kterém jsme
poèítali toté¾, ale souøadnice jsme hledali jako øe¹ení soustavy
lineárních rovnic. 

\priklad
%%%%%%%%
V lineárním prostoru $\R^3$ jsou dány dvì uspoøádané báze:
$$
  (B) = \bigl( (1,1,1),(2,1,3),(1,0,4) \bigr), \qquad
  (C) = \bigl( (3,2,1),(2,1,4),(4,3,2) \bigr).
$$
Navrhneme algoritmus, který pøevádí souøadnice vektoru $\vec u\in\R^3$
vzhledem k bázi $(B)$ na jeho souøadnice vzhledem k bázi $(C)$.
Dané souøanice vzhledem k bázi $(B)$ oznaèíme $(x,y,z)$.
Hlednané souøadnice vzhledem k bázi $(C)$ oznaèíme $(x',y',z')$.
Pro pøechod ze souøadnic vektoru vzhledem k bázi $(B)$ k souøadnicím vzhledem k
bázi $(C)$ potøebujeme matici pøechodu $\P_{C\to B}$. Tu vypoèítáme
pomocí algoritmu\cite[aprechod]. Do výchozí matice zapisujeme do
sloupcù souøadnice báze $(C)$ vzhledem ke standardní bázi a následnì
souøadnice báze $(B)$ vzhledem ke standardní bázi. Tyto souøadnice
jsou pøímo slo¾ky jednotlivých vektorù.
$$
  \def\|{\kern9pt\strut\vrule} \let\h=\hfill
  (\P_{S\to C}\,|\,\P_{S\to B}) =
  \pmatrix {3&2&4\|&1&2&1\cr2&1&3\|&1&1&0\cr1&4&2\|&1&3&4} \sim
  \pmatrix {1&0&0\|&\!\!-1 &\h1/2 &\h1/2\,\cr 0&1&0\|&\h0 &\h3/4 &\h5/4\,\cr 
            0&0&1\|&\h1 &-1/4 &-3/4\,} = (\E\,|\,\P_{C\to B}) 
$$
Souøadnice vzhledem k bázi $(C)$ získáme maticovým násobením
$$
  \let\h=\hfill \def\f#1/#2{{#1\over#2}}
  \pmatrix {x'\cr y'\cr z'} = \P_{C\to B}\cdot\pmatrix{x\cr y\cr z} =
  \pmatrix {\!\!-1 &\h1/2 &\h1/2\,\cr\h0&\h3/4&\h5/4\,\cr\h1 &-1/4 &-3/4\,} 
  \cdot \pmatrix{x\cr y\cr z} = 
  \pmatrix {-x+\f1/2y+\f1/2z\cr \f3/4y+\f5/4z\cr x-\f1/4y-\f3/4z},
$$
{\def\f#1/#2{{#1\over#2}}
tak¾e $x'=-x+\f1/2y+\f1/2z$, $\,y'=\f3/4y+\f5/4z$, $\,z'=x-\f1/4y-\f3/4z$.
}

\okraj Zmìna matice zobrazení pøi zmìnì báze | Zmena matice zobrazeni pri zmene báze

\veta* [zmenabase]
%%%%%
Nech» $\a: L_1\to L_2$ je lineární zobrazení lineárních prostorù
koneèné dimenze. Nech» $(B)$ a $(B')$ jsou dvì báze v $L_1$ a dále
nìch» $(C)$ a $(C')$ jsou dvì báze v $L_2$. Pak platí:

\noindent (1) $\m_{B,C}(\a) \cdot \P_{B\to B'} = \m_{B',C}(\a)$,

\noindent (2) $\P_{C'\to C} \cdot \m_{B,C}(\a) = \m_{B,C'}(\a)$,

\noindent (3) $\P_{C'\to C} \cdot \m_{B,C}(\a) \cdot \P_{B\to B'} = \m_{B',C'}(\a)$.

\dukaz
Nech» $\i_1: L_1\to L_1$ je identita na $L_1$ a $\i_2: L_2\to L_2$ je
identita na $L_2$. Platí $\i_2\circ\a = \a = \a\circ\i_1$.
V dùkazu pou¾ijeme vzorec\cite(sloz) a vlastnost (3) vìty\cite[mprech]
pro matici pøechodu.

(1) $\m_{B,C}(\a) \cdot \P_{B\to B'} = \m_{B,C}(\a) \cdot \m_{B',B}(\i_1) 
               = \m_{B',C}(\a\circ\i_1) = \m_{B',C}(\a)$,

(2) $\P_{C'\to C} \cdot \m_{B,C}(\a) = \m_{C,C'}(\i_2) \cdot  \m_{B,C}(\a) 
               = \m_{B,C'}(\i_2\circ\a) = \m_{B,C'}(\a)$,

(3) doká¾eme postupným pou¾itím (1) a (2).


\algoritmus [algA]
%%%%%%%%%%%
Podobnì, jako v pøípadì algoritmu\cite[aprechod], odvodíme algoritmus
na nalezení matice zobrazení $\a: L_1\to L_2$ 
vzhledem k libovolným bázím. Zvolíme si bázi $(S)$ lineárního prostoru
$L_2$, vzhledem ke které se souøadnice dobøe hledají. Úkolem bude najít
matici zobrazení $\a$ vzhledem k bázím $(B)$ a $(C)$.

Pro matici $\m_{B,C}(\a)$ pou¾ijeme vzorec (2) vìty\cite[zmenabase]:
$$ 
  \m_{B,C}(\a) = \P_{C\to S} \cdot \m_{B,S}(\a) =
  (\P_{S\to C})^{-1} \cdot \m_{B,S}(\a).
$$
Matice na pravé stranì této rovnice zapí¹eme snadno:
Matice $\m_{B,S}(\a)$ obsahuje ve sloupcích
souøadnice obrazù $\a(\vec b_i)$ vzhledem k $(S)$ a 
matice $\P_{S\to C}$ má ve sloupcích
souøadnice $\vec c_i$ vzhledem k $(S)$. 

Abychom si je¹tì u¹etøili práci s výpoètem inverzní matice a následným
maticovým násobením, pou¾ijeme vìtu\cite[AXBsimEX], která øíká
$(\A\,|\,\B)\sim(\E\,|\,\A^{-1}\B)$, neboli
$$
  \bigl(\P_{S\to C}\,|\,\m_{B,S}(\a)\bigr)\sim 
  \bigl(\E\,|\,\P_{S\to C}^{-1} \cdot \m_{B,S}(\a)\bigr)
  = \bigl(\E\,|\,\m_{B,C}(\a)\bigr).
$$
Dostáváme následující algoritmus:

Do sloupcù napí¹eme pod sebe souøadnice vektorù $\vec c_i$ vzhledem k
$(S)$, vpravo od nich vedle svislé èáry napí¹eme do sloupcù
souøadnice vektorù $\a(\vec b_i)$ vzhledem k $(S)$. Pak matici
eliminujeme tak, abychom v~levé èásti dostali $\E$. V pravé èásti pak
máme matici zobrazení $\a$ vzhledem k~bázím $(B)$ a $(C)$.

\priklad
%%%%%%%%
Je dáno lineární zobrazení $\a:L_1\to L_2$, které derivuje polynomy, stejnì jako 
v~pøíkladu\cite[derpol]. Dále jsou dány báze:
$$
  (B) = (1,x+1,x^2+2,x^3+3) \quad \hbox{v prostoru $L_1$}, \qquad
  (C) = (x^2+3, x-2, x^2-x) \quad \hbox{v prostoru $L_2$}.
$$
Najdeme $\m_{B,C}(\a)$, tedy matici zobrazení $\a$ vzhledem k bázím $(B)$
a $(C)$. Pou¾ijeme k tomu algoritmus\cite[algA]. Proto¾e $\a$ derivuje
polynomy, platí:
$$
  \a(1) = 0,\quad \a(x+1) = 1,\quad \a(x^2+2) = 2x, \quad \a(x^3+3) = 3x^2.
$$
Souøadnice tìchto obrazù vzhledem k bázi $(S)=(x^2,x,1)$ zapí¹eme do
sloupcù matice a tím dostáváme matici $\m_{B,S}(\a)$. Matici $\P_{S\to C}$
sestavíme tak, ¾e do sloupcù zapí¹eme souøadnice báze $(C)$ vzhledem 
k~bázi $(S)$.
$$
  \def\quad{\hskip6pt }
  \def\|{\kern9pt\strut\vrule} \let\h=\hfill
  \bigl(\P_{S\to C}\,|\,\m_{B,S}(\a)\bigr) =
  \pmatrix {1&\h0&\h1\|&0&0&0&3\cr 0&\h1&-1\|&0&0&2&0\cr 3&-2&\h0\|&0&1&0&0}
  \sim \pmatrix {1&0&0\|& \h1/5& \h4/5& \,\,\,6/5\cr 
          0&1&0\|& -1/5& \h6/5& \h9/5\cr 0&0&1\|&-1/5& -4/5& \h9/5} =
  \bigl(\E\,|\,\m_{B,C}(\A)\bigr)
$$

\priklad
%%%%%%%%
Pokud jsou dány hodnoty lineárního zobrazení na bázi $(B)$, ale není znám
vzorec pro výpoèet hodnoty v libovolném bodì, pak podle
vìty\cite[zobnabasi] lineární zobrazení $\a$ s danou vlastností 
existuje a je právì jedno. Mù¾eme okam¾itì sestavit
matici $\m_{B,S}(\a)$. Pokud chceme najít vzorec pro toto zobrazení v
libovolném bodì $\vec x$ a chceme pracovat se souøadnicemi $\vec x$
vzhledem k $(S)$ (co¾ je obvyklé), je potøeba na matici $\m_{B,S}(\a)$
uplatnit pøechod od báze $(B)$ k $(S)$, neboli pou¾ít vzorec~(1)
vìty\cite[zmenabase]. Pøedvedeme si to na zobrazení 
$\a:\R^3\to\R^4$ z~pøíkladu\cite[R3toR4]. Tam je dána uspoøádaná báze
$$
  (B) = \bigl( (1,1,2),(1,2,2),(2,1,5) \bigr)\quad \hbox{v $\R^3$}
$$
a obrazy zobrazení $\a$ na této bázi
$$
   \a(1,1,2) = (1,0,1,0), \quad
  \a(1,2,2) = (2,0,2,0), \quad
  \a(2,1,5) = (1,2,2,1). 
$$
V pøíkladu\cite[bR3toR4] jsme na základì tìchto údajù sestavili matici
$\m_{B,S_4}(\a)$, kde $(S_4)$ je standardní báze v~$\R^4$. Nyní
potøebujeme provést je¹tì pøechod od $(B)$ ke standarní bázi $(S_3)$ v~$\R^3$.
K~tomu pou¾ijeme vzorec~(1) vìty\cite[zmenabase]:
$$
  \m_{S_3,S_4}(\a) = \m_{B,S_4}(\a) \cdot \P_{B\to S_3} = 
  \m_{B,S_4}(\a) \cdot (\P_{S_3\to B})^{-1}
$$
Matice za posledním rovnítkem lze zapsat snadno. Je¹tì si mù¾eme
u¹etøit výpoèet invernzí matice a následný maticový souèin, pokud
pou¾ijeme vìtu\cite[AXBsimEX], která øíká
$(\A\,|\,\B)\sim(\E\,|\,\A^{-1}\B)$. Bohu¾el, tentokrát máme
souèin v opaèném poøadí, tak¾e musíme pøejít k transponovaným maticím:
$$
  \m_{S_3,S_4}(\a)^T = (\P_{S_3\to B}^T)^{-1}\cdot \m_{B,S_4}(\a)^T, \quad
  \hbox{tak¾e:}\quad
  \bigl(\P_{S_3\to B}^T\,|\,\m_{B,S_4}(\a)^T\bigr) \sim
%  \bigl(\E\,|\,(\P_{S_3\to B}^T)^{-1}\cdot \m_{B,S_4}(\a)^T\bigr) =
  \bigl(\E\,|\m_{S_3,S_4}(\a)^T\bigr).
$$
Z toho plyne algoritmus: tentokrát {\it do øádkù} pod sebe napí¹eme
slo¾ky bázových vektorù z $(B)$ a vpravo od nich vedle svislé èáry
zapí¹eme {\it do øádkù} slo¾ky obrazù báze. Po eliminaci, kdy vlevo je
jednotková matice, najdeme vpravo transponovanou matici $\m_{S_3,S_4}(\A)$.
$$
  \def\|{\kern9pt\strut\vrule} \let\h=\hfill
  \pmatrix {1&1&2\|&1&0&1&0\cr 1&2&2\|&2&0&2&0\cr 2&1&5\|&1&2&2&1} \sim
  \pmatrix {1&0&0\|& 0&\!-4&\!-2&\!-2\cr 
             0&1&0\|& 1&\h0&\h1&\h0\cr 0&0&1\|& 0&\h2&\h1&\h1} =
  \bigl(\E\,|\m_{S_3,S_4}(\a)^T\bigr).
$$
Ná¹ výsledek se shoduje s výsledkem pøíkladu\cite[mR3toR4]. Ov¹em na
rozdíl od postupu v pøíkladu\cite[mR3toR4] jsme nyní nemuseli 
poèítat vzorec pro $\a(x_1,x_2,x_3)$.
Naopak, výstup z~právì odvozeného algoritmu se dá pou¾ít k~sestavení
hledaného vzorce pro $\a(x_1,x_2,x_3)$, proto¾e platí
$$
  \a(x_1,x_2,x_3)^T = \m_{S_3,S_4}(\a)\cdot \pmatrix {x_1\cr x_2\cr x_3}.
$$

\priklad
%%%%%%%%
Nech» $\a$ je transformace z definice matice
pøechodu\cite[defprech], která zobrazí bázi $(B)$ na bázi~$(C)$.
Víme, ¾e $\m_{B,B}(\a) = \P_{B\to C}$. Jak vypadá matice $\m_{C,C}(\a)$?

Podle vìty\cite[zmenabase] je $\P_{C\to B}\m_{B,B}(\a)\P_{B\to C} = \m_{C,C}(\a)$.
Tak¾e $\m_{C,C}(\a) = \P_{C\to B}\P_{B\to C}\P_{B\to C} = \P_{B\to C}$.
Matice pøechodu $\P_{B\to C}$ je tedy rovna nejenom
$\m_{B,B}(\a)$, ale také $\m_{C,C}(\a)$.


\shrnuti
%%%%%%%%
Lineární zobrazení z $L_1$ do $L_2$ lze mezi sebou sèítat a lze je
násobit konstantou, pøièem¾ tato lineární zobrazení s uvedenými
operacemi tvoøí lineární prostor~/\ncite[lplzob],~\ncite[lpZzob]/.

Jsou-li dány hodnoty na bázi, existuje právì jedno lineární zobrazení,
které má tyto hodnoty\lcite[zobnabasi].

Nech» $L_1$ má koneènou uspoøádanou bázi $(B)$ a $L_2$ má koneènou
uspoøádanou bázi $(C)$.
Ka¾dé lineární zobrazení $\a: L_1\to L_2$ lze
jednoznaènì reprezentovat maticí $\A$ takovou, ¾e platí
$\A\cdot\vec x=\vec y$, kde $\vec x$ jsou souøadnice vzoru vzhledem 
k bázi $(B)$ a $\vec y$ jsou souøadnice obrazu vzhledem 
k~bázi~$(C)$. Tuto matici nazýváme maticí zobrazení $\a$
vzhledem k bázím $(B)$ a $(C)$\lcite[defAa]. 

Pro matici $\A$ zobrazení $\a$ platí, ¾e ve sloupcích obsahuje souøadnice obrazù
báze $(B)$ vzhledem k~bázi~$(C)$\lcite[Asloupce]. Toté¾ lze vyjádøit
maticovým násobením\lcite[matzob].

Hodnost zobrazení $\a$ je rovna hodnosti jeho matice $\A$ 
/\ncite[hodhod],\cite[hod=hod]/.
Souøadnice v¹ech vektorù jádra zobrazení jsou mno¾inou øe¹ení 
homogenní soustavy rovnic $\A\vec x=\vec o$.

Pøiøazení, které lineárnímu zobrazení pøidìlí jeho matici vzhledem k
pevnì zvoleným bázím, je izomorfismus~/dùkaz vìty\cite[aisoA]/.

Matice slo¾eného zobrazení $\b\circ\a$ je rovna souèinu jejich matic
$\B\cdot\A$ ve stejném poøadí\lcite[slozmzob]. Matice inverzní transformace
je rovna inverzní matici pùvodní tansformace\lcite[Aainvers].

Matice pøechodu $\P_{B\to C}$ od báze $(B)$ k bázi $(C)$ je maticí
transformace, která zobrazí $\vec b_i$ z báze $(B)$ na $\vec c_i$ z
báze $(C)$\lcite[defprech]. Obsahuje ve sloupcích souøadnice
vektorù $\vec c_i$ vzhledem k bázi $(B)$ a je rovna matici identity
vzhledem k bázím $(C)$ a $(B)$\lcite[mprech]. 
Matice $\P_{B\to C}$ umo¾ní transformovat souøadnice vektoru $\vec x$
vzhledem k bázi $(C)$ na souøadnice tého¾ vektoru vzhledem k bázi
$(B)$\lcite[mprech]. Pozor: báze jsou zde v opaèném poøadí.

Platí $\P_{B\to C}\cdot\P_{C\to D} = \P_{B\to D}$ a 
$\P_{B\to C} = (\P_{C\to B})^{-1}$\lcite[slozmprech].

Ve vìtì\cite[zmenabase] jsme si uvìdomili, jak se zmìní matice
zobrazení, pohneme-li první nebo druhou bází. Je potøeba matici
zobrazení vynásobit z pøíslu¹né strany pøíslu¹nými maticemi pøechodu.

V odstavcích\cite[aprechod] a\cite[algA] jsme odvodili algoritmy na
sestavení matice pøechodu a matice zobrazení vzhledem k libovolným
bázím, tj. i bázím, vzhledem k nim¾ se souøadnice vektorù poèítají
obtí¾nìji. 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\kapitola Afinní transformace, matice v homogenních souøadnicích |
          Afinni transformace, matice v homogennich souradnicich
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\poznamka
%%%%%%%%%
V\kcite\ktere[linzob2] kapitole jsme se setkali s maticemi
transformací otoèení\lcite[rotace] a zmìny mìøítka\lcite[scale]. 
Do této skupiny tranformací øadíme je¹tì transformaci posunutí, která
ale není lineární, proto¾e nulový vektor \uv{posune} na nenulový vektor, 
co¾ zpùsobnì vychované lineární zobrazení kvùli vìtì\cite[zobnuly] nedìlá. 
Slo¾ením transformace posunutí s~lineární transformací dostáváme 
tzv.~{\em afinní transformaci}.

Afinní transformace tedy nemá obecnì svoji matici. 
V následujícím textu uká¾eme, ¾e pøi pou¾ití
speciálních souøadnic (tzv. {\it homogenních souøadnic\/}) je mo¾né 
sestavit i~matice v¹ech afinních transformací a pracovat s nimi stejnì 
jako s maticemi lineárních transformací. Tyto matice je mo¾né v pøípadì slo¾ené 
afinní transformace mezi sebou násobit. To má praktické vyu¾ití napøíklad 
pøi programování transformací v~poèítaèové grafice. 

\poznamka [Aprst]
%%%%%%%%%
Nejprve si upøesníme vlastnosti geometrického prostoru, ve
kterém budeme uvedené transformace uplatòovat. Tento prostor nazveme
{\it afinní}. V nìm budeme rozli¹ovat objekty dvou typù: {\em body\/} a
{\em vektory}. Mno¾inu v¹ech
bodù budeme znaèit $\X$. Do exaktního zavedení mno¾iny $\X$ se
nebudeme pou¹tìt, staèí snad inuitivní chápání pojmu bod.

Vektor je urèen orientovanou úseèkou, která je vymezena dvìma body
z~$\X$: poèáteèním a koncovým.  Na rozdíl od lineárního prostoru $U_O$
z pøíkladu\cite[lpvv] není nutné, aby orientovaná úseèka zaèínala 
v~poèátku. Navíc pova¾ujeme dvì orientované úseèky za
reprezentanty stejného vektoru, pokud jsou rovnobì¾né, stejnì velké a stejnì
orientované. Souèet dvou vektorù provedeme jako v lineárním prostoru
$U_O$, kdy¾ si narýsujeme jejich
orientované úseèky tak, aby zaèínaly ve spoleèném 
bodì a doplníme na rovnobì¾ník. Násobek
vektoru konstantou provedeme také obdobnì jako v lineárním prostoru
$U_O$. Mno¾inu v¹ech takových vektorù znaèíme $V$. Je zøejmé, ¾e
spoleènì s uvedenými operacemi sèítání vektorù a násobení vektoru
konstantou tvoøí tato mno¾ina vektorù lineární
prostor. Argumentuje se analogicky, jak v~pøípadì lineárního prostoru
orientovaných úseèek $U_O$ v pøíkladu\cite[lpvv].

Dále zavedeme nové sèítání bodu $P\in\X$ s vektorem $\vec u\in V$ takto:
souèet $P + \vec u$ je koncový bod orientované úseèky vektoru 
$\vec u$, pokud její poèáteèní bod umístíme do bodu $P$.

\okraj Afinní\hb prostor | Afinni prostor

\definice* [defAprst]
%%%%%%%%%
{\em Afinní prostor\/} je mno¾ina bodù $\X$ spoleènì s lineárním
prostorem vektorù $V$. Zapisujeme jej jako dvojici $(\X,V)$.

Kromì operací $+: V\times V\to V$ a $\cdot: \R\times V\to V$ splòující
axiomy linearity~(1) a¾~(7) definice\cite[dlp] je zavedena je¹tì
operace $+: \X\times V\to \X$ s vlastnostmi:
$$
  \eqalign{
    (1)\ & P + \vec o = P \quad \hbox{pro v¹echny body $P\in\X$ 
        \ ($\vec o\in V$ je nulový vektor)},\cr
    (2)\ & (P + \vec u) + \vec v = P + (\vec u+\vec v) \quad
             \hbox{pro v¹echny body $P\in\X$ a vektory 
                   $\vec u\in V$, $\vec v\in V$}, \cr
    (3)\ & \hbox{pro v¹echny body $P\in\X$, $Q\in\X$ existuje právì jeden vektor 
                 $\vec u\in V$ tak, ¾e}\quad
           P = Q + \vec u  
}
$$

\poznamka
%%%%%%%%%
Definice afinního prostoru je zavedena pomocí axiomù nové operace, 
jak je v algebøe obvyklé. Nemusíme se tedy obtì¾ovat pøesným vymezením
pojmù bod z mno¾iny $\X$ a vektor z~mno¾iny~$V$. Také nemusíme vìdìt,
jak konkrétnì pracuje operace \uv{bod plus vektor}. Staèí, ¾e tato operace 
splòuje uvedené axiomy. 

Z axiomù plyne, ¾e \uv{vektorù je stejný poèet jako bodù}. Pøesnìji,
lze najít prosté zobrazení z mno¾iny bodù na mno¾inu vektorù. Staèí
zvolit jeden bod $Q\in\X$ a dále pro v¹echna $P\in\X$ existuje podle
axiomu (3) jediný vektor $\vec u\in V$. Tím je urèeno prosté zobrazení
z mno¾iny bodù do mno¾iny vektorù. ®e je toto zobrazení \uv{na} plyne
z toho, ¾e ke ka¾dému vektoru $\vec u\in V$ lze zpìtnì sestrojit bod
$P=Q+\vec u$.

V dal¹ím textu si vystaèíme s pøedstavou geometrického prostoru 
s intuitivním pojetím bodù a vektorù podle
poznámky\cite[Aprst]. Uká¾eme, ¾e tato pøedstava je v souladu 
s definicí\cite[defAprst]. Tj. ovìøíme platnost axiomù pro operaci
sèítání bodu $P$ s vektorem $\vec u$ zavedenou 
geometricky: $P+\vec u$ je koncový bod orientované úseèky vektoru $\vec u$,
která zaèíná v bodì $P$. 

Axiom (1):  Vektor $\vec o$ má koncový bod ve stejném místì jako
poèáteèní. Tak¾e operace $P+\vec o$ bod $P$ nezmìní.

Axiom (2): Narýsujeme od bodu $P$ orientovanou úseèku vektoru $\vec u$
a od koncového bodu této úseèky narýsujeme druhou orientovanou úseèku
vektoru $\vec v$. Proto¾e tyto dvì orientované úseèky
vymezují \uv{sèítací rovnobì¾ník} pro výpoèet $\vec u+\vec v$, je
zøejmé, ¾e $(P + \vec u) + \vec v = P + (\vec u+\vec v)$.

Axiom (3): Vektor $\vec u$ je urèený orientovanou úseèkou 
zaèínající v bodì $Q$ a konèící v bodì $P$. Tento vektor 
budeme znaèit $P-Q$ nebo $\overrightarrow{QP}$.

\poznamka
%%%%%%%%%
Lapidární shrnutí: v afinním prostoru pou¾íváme následující operace:
$$\jot=0pt\eqalign{
  \hbox{vektor $+$ vektor} &= \hbox{vektor}, \cr
  \hbox{konstanta $\cdot$ vektor} &= \hbox{vektor}, \cr
  \hbox{bod $+$ vektor} &= \hbox{bod}, \cr
  \hbox{bod $-$ bod} &= \hbox{vektor}, \cr
  \hbox{bod + bod} &\dots{} \hbox{\it nemá smysl}.
}
$$
s vlastnostmi (1) a¾ (7) z definice\cite[dlp] a s vlastnostmi (1) a¾
(3) z definice\cite[defAprst].


\definice
%%%%%%%%%
{\em Souøadnicový systém\/} v afinním prostoru $(\X,V)$ zavedeme
tak, ¾e zvolíme nìjakou uspoøádanou bázi $(B)$ lineárního prostoru $V$ 
a zvolíme bod $O\in\X$, kterému budeme øíkat {\em poèátek}. 
Souøadnicový systém budeme znaèit $(O,B)$.

{\em Souøadnice vektoru $\vec u\in V$} vzhledem k systému $(O,B)$ jsou
souøadnice vektoru $\vec u$ vzhledem k~uspoøádané bázi $(B)$.

{\em Souøadnice bodu $P\in\X$} vzhledem k systému $(O,B)$ jsou
souøadnice vektoru $P-O$ vzhledem k~uspoøádané bázi $(B)$. Vektor $P-O$ se nazývá 
{\em radiusvektor bodu $P$}.

\definice
%%%%%%%%%
{\em Dimenze afinního prostoru\/} $(\X,V)$ je rovna dimenzi
lineárního prostoru~$V$. Typicky pou¾íváme afinní prostory
dimenze~2 (rovina) nebo dimenze~3 (na¹e geometrické vnímání svìta). 

\veta [esour-lin]
%%%%%
Nech» $(\X,V)$ je afinní prostor, nech» dále $(O,B)$ je jeho
souøadnicový systém. 
Nech» $\vec u\in V$, $\vec v\in V$
$\alpha\in \R$, $P\in\X$, $Q\in\X$.
Symbolem $\c(.)$ znaèíme souøadnice bodu nebo vektoru vzhledem 
k~$(O,B)$. Platí
$$
  \eqalign {
  (1)\ & \c(\vec u+\vec v) = \c(\vec u) + \c(\vec v) \cr
  (2)\ & \c(\alpha\cdot\vec u) = \alpha\cdot\c(\vec u) \cr
  (3)\ & \c(Q+\vec u) = \c(Q) + \c(\vec u) \cr
  (4)\ & \c(P-Q) = \c(P) - \c(Q) \cr
}
$$

\dukaz
%%%%%%
(1) a (2) plyne z toho ¾e $V$ je lineární prostor a $\c$ znaèí
souøadnice vektoru vzhledem k uspoøádané bázi~$(B)$. Zobrazení 
$\c$ je na mno¾inì $V$ podle vìty\cite[sour-lin] lineární.

(3) Radiusvektor bodu $Q+\vec u$ je souètem radiusvektoru bodu $Q$
s vektorem $\vec u$. Souøadnice bodù jsou definovány jako souøadnice
jejich radiusvektorù. Na $V$ je podle vìty\cite[sour-lin] zobrazení $\c$ lineární. 

(4) Vektor $P-Q$ je výsledkem operace \uv{radiusvektor bodu $P$ minus radiusvektor
bodu~$Q$}. Dal¹í argumentace je stejná jako v dùkazu~(3).

%\dolu -2mm
\obrazek .4+.03 11 obr11
{
  \p 128 20 \vec b_1
  \p 108 -1 \vec b_2
  \p 128 -1 \vec O
  \p 30 100 \vec u
  \p 98 80 \vec u
  \p 10 163 P
  \p 50 45 Q
}
\priklad [PQ]
%%%%%%%%
Na obrázku jsme vyznaèili souøadnicový systém $(O,B)$ afinního prostoru
dimenze~2. Vektory uspoøádané báze 
$(B)=(\vec b_1, \vec b_2)$ jsou stejné velikosti 
a na sebe kolmé. To není nutné, ale je to praktické. 

Na obrázku jsou radiusvektory bodù $P\in\X$ a $Q\in\nobreak\X$, 
tak¾e jsme schopni urèit souøadnice bodù: $\c(P) = (7,5)$ a 
$\c(Q) = (2,3)$.
Dále je vyznaèena orientovaná úseèka vektoru $\vec u=P-Q$. 
Vektor $\vec u$ urèený touto úseèkou má podle vìty\cite[esour-lin]
souøadnice rovny rozdílu 
souøadnic bodù:
\ha 7
$$\c(\vec u) = \c(P) - \c(Q) = (7,5) - (2,3) = (5,2).$$ 

Na obrázku je u dvou rùzných orientovaných úseèek pøipsáno stejné
písmeno $\vec u$, proto¾e tyto úseèky jsou rovnobì¾né, stejnì velké 
a stejnì orientované. Pova¾ujeme je za reprezentanty stejného 
vektoru~$\vec u$.

\okraj Homogenní souøadnice | Homogenni souradnice

\definice* [dhomosour]
%%%%%%%%%
Nech» $(\X,V)$ je afinní prostor dimenze $n$
a $(O,B)$ je jeho souøadnicový systém.
 
{\em Homogenní souøadnice} bodu $P\in\X$ jsou uspoøádaná \hbox{$(n+1)$}-tice,
která v prvních $n$ slo¾kách obsahuje souøadnice bodu $P$ vzhledem 
k $(O,B)$ a v poslední slo¾ce obsahuje jednièku.

{\em Homogenní souøadnice} vektoru $\vec u\in V$ jsou uspoøádaná
\hbox{$(n+1)$}-tice, která v prvních $n$ slo¾kách obsahuje souøadnice vektoru
$\vec u$ vzhledem k~$(O,B)$ a v poslední slo¾ce obsahuje nulu.

Upozornìní: roz¹íøenou verzi definice homogenních souøadnic bodu najde
ètenáø v odstavci\cite[dhomo2].


\priklad
%%%%%%%%
Vra»me se k bodùm $P$ a $Q$ v pøíkladu\cite[PQ].
Homogenní souøadnice bodu $P$ jsou $(7,5,1)$, homogenní souøadnice
bodu $Q$ jsou $(2,3,1)$. Homogenní souøadnice vektoru 
$\vec u=P-Q$ jsou $(5,2,0)$.

\veta*
%%%%%
Vlastnosti (1) a¾ (4) vìty\cite[esour-lin] jsou splnìny i v pøípadì,
¾e $\c(.)$ znaèí homogenní souøadnice.

\dukaz
%%%%%%
V pøípadì lineárních kombinací vektorù zùstává v poslední slo¾ce souøadnic
nula. Pøi souètu bodu s vektorem je v poslední slo¾ce souøadnic
odehrává výpoèet $1+0=1$, tedy dostáváme homogenní
souøadnice bodu. Pøi odeèítání bodù se v poslední slo¾ce souøadnic
odeèítají jednièky a vzniká nula, dostáváme tedy homogenní souøadnice 
vektoru. 

\okraj Matice v~homogenních souøadnicích | Matice v homogennich souradnicich

\definice* [Ahomo]
%%%%%%%%%
Nech» $(\X,V)$ je afinní prostor dimenze $n$ a $(O,B)$ jeho souøadnicový systém.
Øíkáme, ¾e {\em transformace $\a:\X\to\X$ má matici
$\A\in\R^{n+1,n+1}$ v homogeních souøadnicích vzhledem k $(O,B)$}, 
pokud pro ka¾dý bod $P\in\X$ jsou homogenní souøadnice obrazu 
$\a(P)$ rovny sloupcovému vektoru $\A\cdot\vec x$, 
kde $\vec x$ jsou homogenní souøadnice bodu
$P$. Jinak øeèeno, pro ka¾dý bod $P\in\X$ je
$$
    \A\cdot\pmatrix{\hbox{homogenní}\cr\hbox{souøadnice}\cr\hbox{bodu }P\cr
      \hbox{vzhledem}\cr\hbox{k $(O,B)$}} = 
  \pmatrix{\hbox{homogenní}\cr\hbox{souøadnice}\cr\hbox{bodu }\a(P)\cr
      \hbox{vzhledem}\cr\hbox{k $(O,B)$}}
$$

\poznamka
%%%%%%%%%
Nech» transformace $\a:\X\to\X$ má matici $\A$. Jak musí taková matice
vypadat? Je-li $\vec x$ vektor homogenních souøadnic bodu, pak musí
$\A\cdot\vec x$ být také vektor homogenních souøadnic bodu. Neboli
jednièka v poslední slo¾ce vektoru $\vec x$ musí zùstat zachována i po
maticovém násobení. Z vlastností maticového náspobení vyplývá, ¾e daný
po¾adavek splòují v¹echny matice $\A\in\R^{n+1,n+1}$, které je mo¾né
do blokù rozepsat následovnì:
$$
  \A = \pmatrix {\A' & \vec t\cr \vec o & 1}, \quad
  \rce(typA)
$$
kde $\A'\in\R^{n,n}$ je libovolná matice, $\vec t\in\R^{n,1}$ je
libovolný sloupcový vektor, $\vec o\in\R^{1,n}$ je nulový vektor a
vpravo dole je jednièka. Jinými slovy je to matice, která má v
posledním øádku nuly s výjimkou posledního prvku, který je roven
jedné.

Nech» bod $P$ má vzhledem k $(O,B)$ souøadnice $\vec p\in\R^n$, tak¾e jeho
homogenní souøadnice jsou $(\vec p,1)$. Pak platí: 
$$
   \A \cdot \pmatrix {\vec p^T\cr 1\,} =
    \pmatrix {\A' & \vec t\cr \vec o & 1} \cdot \pmatrix {\vec p^T\cr 1\,}
  = \pmatrix {\A'\vec p^T + \vec t\cr 1}.
$$
Z maticového násobení snadno plyne, ¾e souèin dvou matic typu\cite(typA)
je matice typu\cite(typA). Tento souèin je maticí odpovídajícího
slo¾eného zobrazení, jak uká¾eme ve vìtì\cite[slozhomo].

\priklad
%%%%%%%%
V afinním prostoru dimenze 2 jsou matice transformací v homogenních
souøadnicích tvaru:
$$
  \pmatrix {a&b&c\cr d&e&f\cr 0&0&1},\qquad
  \hbox{tj.} \quad
   \pmatrix {x'\cr y'\cr 1} = 
  \pmatrix {a&b&c\cr d&e&f\cr 0&0&1}\cdot \pmatrix{x\cr y\cr 1}  
  = \pmatrix {ax +by + c\cr dx+ ey + f\cr 1}.
$$
Transformace v 2D prostoru jsou tedy urèeny maticemi se ¹esti parametry
$a$ a¾ $f$.

\priklad
%%%%%%%%
V afinním prostoru dimenze 3 jsou matice transformací v homogenních
souøadnicích tvaru:
$$
  \pmatrix {a&b&c&d\cr e&f&g&h\cr i&j&k&l\cr 0&0&0&1},\qquad
  \hbox{tj.} \quad
   \pmatrix {x'\cr y'\cr z'\cr 1} = 
  \pmatrix {a&b&c&d\cr e&f&g&h\cr i&j&k&l\cr 0&0&0&1} \cdot
  \pmatrix {x\cr y\cr z\cr 1} = 
  \pmatrix {ax+by+cz+d\cr ex+fy+gz+h\cr ix+jy+kz+l\cr 1}.
$$
Transformace v 3D prostoru jsou tedy urèeny maticemi s dvanácti parametry
$a$ a¾ $l$.

\veta* [slozhomo]
%%%%%
Nech» $(\X,V)$ je afinní prostor dimenze $n$ a nech» $(O,B)$ je jeho
souøadnicový systém. Nech» transformace $\a:\X\to\X$ má matici $\A$ v
homogenních souøadnicích vzhledem k $(O,B)$ a transformace
$\b:\X\to\X$ má matici $\B$ v homogenních souøadnicích vzhledem k
$(O,B)$. Pak slo¾ené zobrazení $\b\circ\a$ má matici $\B\cdot\A$
v homogenních souøadnicích vzhledem k $(O,B)$.

\dukaz
Vìta se doká¾e stejnì jako vìta\cite[slozmzob]. Pouze místo
slov \uv{souøadnice vektoru vzhledem k bázi} v~dùkazu pou¾íváme slova
\uv{homogenní souøadnice bodu vzhledem k $(O,B)$}.

\priklad [elemhomo]
%%%%%%%%
Uvedeme matice elementárních transformací v afinním prostoru $(\X,V)$ dimenze~2. 

{\em Zmìna mìøítka} $a$-krát ve smìru první souøadnice a $b$-krát
ve smìru druhé má matici
$$
  \pmatrix {a& 0&0\cr 0&b&0\cr 0&0&1},\quad 
  \hbox{proto¾e}\quad
  \pmatrix {a& 0&0\cr 0&b&0\cr 0&0&1}\cdot
  \pmatrix {x\cr y\cr 1} =
  \pmatrix {a\,x\cr b\,y\cr 1}.
$$
Zmìna mìøítka tansformuje vektory stejnì jako body. Tento typ
transformace byl podrobnì diskutován v pøíkladu\cite[scale].

{\em Rotace} o úhel $\alpha$ kolem poèátku má matici
$$
  \pmatrix {\cos\alpha& -\sin\alpha&0\cr 
           \sin\alpha&\phantom+\cos\alpha&0\cr 0&0&1},\quad  
  \hbox{proto¾e}\quad
  \pmatrix {\cos\alpha& -\sin\alpha&0\cr 
           \sin\alpha&\phantom+\cos\alpha&0\cr 0&0&1}\cdot
  \pmatrix {x\cr y\cr 1} =
  \pmatrix {x\,\cos\alpha - y\,\sin\alpha\cr x\,\sin\alpha + y\,\cos\alpha\cr 1}.
$$
Rotace transformuje vektory stejnì jako body. Matice tohoto typu
transformace byla odvozena v pøíkladu\cite[rotace].
Doplòujícím pøedpokladem pro tuto matici je souøadnicový systém s~bází vektorù,
které jsou na sebe kolmé a mají stejnou velikost.

{\em Posunutí} o vektor se souøadnicemi $(t_x,t_y)$ má matici
$$
   \pmatrix {1&0& t_x\cr 0&1&t_y\cr 0&0&1},\quad  
   \hbox{proto¾e}\quad
   \pmatrix {1&0& t_x\cr 0&1&t_y\cr 0&0&1}\cdot
   \pmatrix {x\cr y\cr 1} =   
   \pmatrix {x+t_x\cr y+t_y\cr 1}.
$$
Tato transformace posunuje jenom body, vektory nechává nezmìnìny.

Dal¹í transformace v afinním prostoru $(\X, V)$
vznikají jako skládání tìchto elementárních trnasformací. Slo¾ené
zobrazení má podle vìty\cite[slozhomo]
matici rovnu souèinu matic jednotlivých zobrazení.

\priklad
%%%%%%%%
V afinním prostoru dimenze 2
najdeme matici $\A$ v homogenních souøadnicích
takové transformace, která otáèí
vzor kolem bodu se souøadnicemi $(2,3)$ o úhel $\alpha$.
Tato transformace je slo¾ením tøí transformací: nejprve posune bod
$(2,3)$ do poèátku, pak otoèí obraz kolem poèátku o~úhel~$\alpha$ a
nakonec posune poèátek zpìt do bodu $(2,3)$. Matice
transformace je souèinem matic transformací, ze kterých je slo¾ena,
pøitom nejdøíve aplikovaná transformace má svou matici nejvíce vpravo
(viz vìtu\cite[slozhomo]).
$$
  \displaylines {
  \A = \biggl( \hbox{matice posunutí o $(2,3)$} \biggr) \cdot 
  \biggl( \hbox{matice rotace o úhel $\alpha$} \biggr) \cdot 
  \biggl( \hbox{matice posunutí o $(-2,-3)$} \biggr) =\cr
  =  \pmatrix {1&0& 2\cr 0&1&3\cr 0&0&1} \cdot
     \pmatrix {\cos\alpha& -\sin\alpha&0\cr 
           \sin\alpha&\phantom+\cos\alpha&0\cr 0&0&1} \cdot
     \pmatrix {1&0& \!-2\cr 0&1&\!-3\cr 0&0&1} =
     \pmatrix {\cos\alpha& -\sin\alpha\ & -2\cos\alpha+3\sin\alpha+2\cr 
           \sin\alpha&\phantom+\cos\alpha\ &-2\sin\alpha-3\cos\alpha+3\cr 0&0&1}.
}
$$


\poznamka
%%%%%%%%%
V dal¹ím textu uká¾eme, ¾e v¹echny transformace $\a:\X\to\X$, které mají matici
v~homogenních souøadnicích, jsou tzv. {\em afinní transformace} a dále
doká¾eme, ¾e v¹echny afinní transformace mají matici v~homogenních souøadnicích.

\okraj Afinní\hb transformace | Afinni transformace

\definice* [Atrans]
%%%%%%%%%
Nech» $(\X,V)$ je afinní prostor. Transformace $\a:\X\to\X$ se nazývá
{\em afinní transformace} (krátce {\em afinita\/}), 
pokud existuje lineární transformace 
$\a': V\to V$ tak, ¾e pro ka¾dý bod $P\in\X$ a pro ka¾dý vektor 
$\vec u\in V$ platí
$$
  \a(P+\vec u) = \a(P) + \a'(\vec u).
$$

\veta* [anabasi]
%%%%%
Nech» $(\X,V)$ je afinní prostor dimenze $n$ a 
$(O,B)=(O,\vec b_1,\ldots,\vec b_n)$ je jeho souøadnicový systém. 
Pak afinní zobrazení $\a: \X\to\X$
je jednoznaènì urèeno svými obrazy v bodech $O$ a $O+\vec b_i$ pro
$i\in\{1,\ldots,n\}$.

\dukaz
Proto¾e $\a$ je afinní, existuje lineární zobrazení $\a': V\to V$,
pro které platí 
$$\a(O+\vec b_i) = \a(O) + \a'(\vec b_i).$$
Známe-li hodnoty $\a(O+\vec b_i)$ a $\a(O)$, pak jsou tímto vzorcem
urèeny i hodnoty $\a'(\vec b_i)$ pro v¹echny bázové vektory $\vec b_i$.
Lineární zobrazení $\a'$ je podle vìty\cite[zobnabasi] tìmito
hodnotami jednoznaènì urèeno. Hodnota zobrazení $\a$ v ka¾dém bodì
$P\in\X$ je pak jednoznaènì urèena ze vztahu 
$$\a(P) = \a\bigl(O+(P-O)\bigr) = \a(O) + \a'(P-O).$$

\veta [Ahomoa]
%%%%%
Nech» $(\X,V)$ je afinní prostor dimenze $n$ a $(O,B)$ je jeho souøadnicový
systém. Pak ka¾dá transformace $\a:\X\to\X$, která má matici $\A$ 
v homogenních souøadnicích vzhledem k $(O,B)$, je afinní transformace.

\dukaz
Nech» $\A$ je matice zobrazení $\a$ v homogenních souøadnicích.
Pak $\A$ je typu\cite(typA). 

Nech» $\vec u\in V$ má souøadnice $\vec c\in\R^n$ vzhledem k $(O,B)$. Pak má
homogenní souøadnice $(\vec c, 0)$ a platí:
$$
   \A \cdot \pmatrix {\vec c^T\cr 0\,} =
    \pmatrix {\A' & \vec t\cr \vec o & 1} \cdot \pmatrix {\vec c^T\cr 0\,}
  = \pmatrix {\A'\cdot\vec c^T \cr 0}
$$
tak¾e maticové násobení $\A\cdot\vec x$ transformuje také
homogenní souøadnice vektorù na homogenní souøadnice vektorù. 
K této transformaci homogenních souøadnic vektorù existuje
zpìtnì transformace vektorù samotných $\a':V\to V$ taková ¾e
homogenní souøadnice obrazu $\a'(\vec u)$ jsou rovny sloupcovému vektoru 
$$
   \A \cdot \pmatrix {\vec c^T\cr 0\,}.
$$
Tato transformace $\a':V\to V$ je zjevnì lineární a má matici $\A'$
vzhledem k bázi $(B)$.

Nyní staèí dokázat, ¾e $\a(P+\vec u) = \a(P) + \a'(\vec u)$ pro
v¹echny body $P\in\X$ a v¹echny vektory $\vec u\in V$. Tato rovnost
platí, proto¾e
$$
  \A \cdot \left(\pmatrix {\vec p^T\cr 1} + \pmatrix {\vec c^T\cr 0}\right) =
  \A \cdot \pmatrix {\vec p^T\cr 1} + 
  \A \cdot \pmatrix {\vec c^T\cr 0}
$$
 
\veta* [zobhomo]
%%%%%
Nech» $(\X,V)$ je afinní prostor dimenze $n$ se souøadnicovým systémem
$(O,B)$. Pak ka¾dé afinní zobrazení $\a$ má matici $\A$ v~homogenních
souøadnicích vzhledem k $(O,B)$.

\dukaz
Proto¾e $\a$ je afinní, existuje lineární transformace $\a':V\to V$ tak, ¾e
$\a(P+\vec u) = \a(P) + \a'(\vec u)$ pro v¹echny body $P\in\X$ a
v¹echny vektory $\vec u\in V$.
Do matice $\A$ zapí¹eme nejprve homogenní souøadnice obrazù 
bázových vektorù $\a'(\vec b_i)$ a do posledního sloupce zapí¹eme
obraz $\a(O)$. Takto sestavená matice je zjevnì typu\cite(typA).
Oznaème $\b:\X\to\X$ transformaci, která má matici $\A$ v homogenních souøadnicích.
Podle vìty\cite[Ahomoa] je $\b$ afinní transformace.
Kdy¾ uká¾eme, ¾e $\b(O)=\a(O)$ a dále $\b(O+\vec b_i) = \a(O+\vec b_i)$
pro v¹echny bázové vektory $\vec b_i$,
budeme podle vìty\cite[anabasi] vìdìt, ¾e $\a=\b$, tedy
$\a$ má matici $\A$.

Homogenní souøadnice poèátku $O$ jsou v¹ude nulové s výjimkou poslední
slo¾ky, kde je jednièka. Vektor tìchto souøadnic oznaème $\vec e_{n+1}\in\R^{n+1}$. 
Homogenní souøadnice $\b(O)$ se poèítají podle vzorce
$\A\cdot\vec e_{n+1}^T$ a tento souèin je roven poslednímu sloupci
matice $\A$. Ten podle pravidla sestavení matice $\a$ obsahuje 
homogenní souøadnice obrazu $\a(O)$. Tak¾e $\b(O)=\a(O)$.
Homogenní souøadnice bázového vektoru $\vec b_i$ jsou v¹ude nulové
s výjimkou $i$-té slo¾ky. Vektor
tìchto souøadnic oznaème $\vec e_i\in\R^{n+1}$. 
Homogenní souøadnice $\b(O+\vec b_i)$ poèítáme podle vzorce
$\A\cdot(\vec e_{n+1}^T+\vec e_i^T)$. Tento souèin je roven souètu $i$-tého 
sloupce matice $\A$ s posledním, tedy obsahuje (podle pravidla sestavení matice) 
homogenní souøadnice obrazu $\a(O) + \a'(\vec b_i) = \a(O+\vec b_i)$. 
Z toho plyne $\b(O+\vec b_i) = \a(O+\vec b_i)$.

\veta
%%%%%
Nech» má afinní prostor $(\X,V)$ dimenzi $n$.
Afinní transformace $\a:\X\to\X$ je prostá právì tehdy, kdy¾ je na.

\dukaz
Afinní transformace $\a:\X\to\X$ je prostá právì tehdy, kdy¾ 
její pøidru¾ená lineární transformace $\a': V\to V$ je prostá, právì
tehdy, kdy¾ $\defekt\a'=0$ právì tehdy, kdy¾ $\hod\a'=n$ (viz vìtu\cite[def+hod])
právì tehdy, kdy¾ $\a'$ je na $V$ právì tehdy, kdy¾ $\a$ je na $\X$.

\veta*
%%%%%
Slo¾ení dvou afinních transformací je afinní transformace.

\dukaz
Ve vìtì\cite[slozhomo] jsme ukázali, ¾e slo¾ením dvou transformací,
které mají svou matici v homogenních souøadnicích, je transfrormace, 
která má matici v homogenních souøadnicích. Dále ve
vìtách\cite[Ahomoa] a\cite[zobhomo] jsme ukázali, ¾e tranfsormace má
matici v homogenních souøadnicích právì tehdy, kdy¾ je afinní.

\veta
%%%%%
Inverzní transformace k prosté afinní transformaci je afinní.

\dukaz
Má-li pùvodní transformace matici $\A$ v homogenních souøadnicích, pak
inverzní transformace má matici $\A^{-1}$ v homogenních souøadnicích.

\veta
%%%%%
%Nech» $(\X,V)$ je afinní prostor dimenze aspoò 2 a $\a:\X\to\X$ je
%prostá afinní transformace. Pak $\a$ transformuje rovnobì¾né pøímky na
%rovnobì¾né pøímky.
Prostá afinní transformace transformuje rovnobì¾né pøímky na
rovnobì¾né pøímky.

\dukaz
Pøímka v afinním prostoru $(\X,V)$ je mno¾ina
$p=\{P+t\vec u;\,t\in\R\}$, kde $P\in\X$ je nìjaký bod a $\vec u\in V$
je nenulový vektor. 
Vektoru $\vec u$ v tomto kontextu øíkáme {\em smìrový vektor pøímky}.
Dvì pøímy jsou rovnobì¾né nebo toto¾né, pokud jejich smìrové vektory
jsou lineárnì závislé (tedy jeden je nenulovým násobkem druhého).

Nech» $\a:\X\to\X$ je prostá afinní transformace a oznaème
$p=\{P+t\vec u;\,t\in\R\}$
a $q=\{Q+t\vec v;\,t\in\R\}$ dvì rùzné rovnobì¾né pøímky. Tak¾e
$\vec u=\alpha\vec v$.
Pak 
$$
  \eqalign{  
    \a(p) &= \{\a(P+t\vec u);\,t\in\R\} = \{\a(P)+\a'(t\vec u);\,t\in\R\} =
           \{\a(P)+t\a'(\vec u);\,t\in\R\} =  p' \cr
    \a(q) &= \{\a(Q+t\vec v);\,t\in\R\} = \{\a(Q)+\a'(t\vec v);\,t\in\R\} =
           \{\a(Q)+t\a'(\vec v);\,t\in\R\} = q'
}
$$
Je zøejmé, ¾e $p'$ a $q'$ jsou pøímky. Proto¾e $\a$ je prosté, je
prosté také $\a'$, tak¾e vektory $\a'(\vec u)$ a $\a'(\vec u)$ jsou 
nenulové. Pøímky $p'$ a $q'$ jsou rovnobì¾né
proto¾e $\a'(\vec u) = \a'(\alpha\vec v) = \alpha \a'(\vec v)$.
Navíc nejsou toto¾né, proto¾e $\a$ je prosté. 
%V pøípadì, ¾e dimenze
%afinního prostoru je 1, pak prosté afinní zobrazení transformuje
%jedinou pøímku na tu samou pøímku a o rovnobì¾nosti nemá smysl mluvit. 

\poznamka [arovnobeznost]
%%%%%%%%%
Pøedpokládejme nyní, ¾e afinní zobrazení není prosté.
V tomto pøípadì se pøímky mohou zobrazit do bodu nebo dvì
rovnobì¾né pøímky se zobrazí do jedné pøímky. Projdìte si dùkaz
pøedchozí vìty znova a rozmyslete si, ¾e afinní zobrazení, které nemusí
být prosté, nikdy nezobrazí rovnobì¾ky na rùznobì¾ky.

\dolu 2mm
\obrazek .5+.03 11 obr12
{
  \p 150 48 \vec b_1
  \p 110 36 \vec b_2
  \p 151 24 \vec O
  \p 98 115 \vec O'
  \p 55 82 \vec b_1'
  \p 120 10 \vec b_1'
  \p 78 192 \vec b_2'
  \p 129 120 \vec b_2'
}
\priklad
%%%%%%%%
V afinním prostoru dimen\-ze~2
najdeme matici $\A$ v homogenních souøadnicích takové afinní transformace,
která zobrazí $\vec b_1$ na $\vec b_1'$, dále $\vec b_2$ zobrazí na
$\vec b_2'$ a koneènì $O$ zobrazí na $O'$ podle obrázku. Tato
transformace napøíklad vezme obrázek z vy¹rafovaného ètverce a protáhne
jej, zkosí jej, zrcadlí jej (osová soumìrnost), otoèí jej a posune jej 
a tím vytvoøí obraz pùvodního obrázku ve vyznaèeném rovnobì¾níku.

Uvìdomíme si, ¾e pokud je dána báze $(\vec b_1,\vec b_2)$ a pokud jsou
dány vektory $\vec b_1'$ a $\vec b_2'$, pro které má být
$\vec b_i'= \a'(\vec b_i)$ pro $i\in\{1,2\}$, pak lineární transformace
$\a': V\to V$ s uvedenou vlastností podle vìty\cite[zobnabasi]
existuje a je jediná. Kdy¾ k tomu pøidáme po¾adavek na posunutí
bodu $O$ do $O'$, je tím také urèena transformace $\a:\X\to\X$.
Matice této transformace má podle dùkazu 
vìty\cite[zobhomo] homogenní souøadnice vektorù $\vec b_i'$ a bodu
$O'$ v odpovídajících sloupcích. Aby se nám na obrázku souøadnice
vektorù $\vec b_i'$ vzhledem k bázi $(B)$ dobøe hledaly, pøekreslili
jsme jejich orientované úceèky také tak, aby zaèínaly v bodì $O$.
Vidíme, ¾e 
\ha 5
$$
  \eqalign {
    \vec b_1' &= -1\cdot \vec b_1 + 2\cdot\vec b_2, \quad
    \hbox{tak¾e vektor $\vec b_1'$ má souøadnice $(-1,2)$ vzhledem k $(B)$},\cr
    \vec b_2' &= \phantom+4\cdot \vec b_1 + 1\cdot\vec b_2, \quad
    \hbox{tak¾e vektor $\vec b_2'$ má souøadnice $(4,1)$ vzhledem k $(B)$},\cr
    O'-O &= \phantom+3\cdot\vec b_1 + 2\cdot\vec b_2,\quad
    \hbox{tak¾e bod $O'$ má souøadnice $(3,2)$ vzhledem k $(O,B)$}.\cr
}    
$$
Hledanou matici $\A$ nyní vyplníme po sloupcích homogenními
souøadnicemi vektorù $\vec b_1'$, $\vec b_2'$ a bodu $O'$:
$$
  \A = \pmatrix {\!-1&4&3\cr \hfill2&1&2\cr\hfill0&0&1}.
$$

\poznamka
%%%%%%%%%
Dá se ukázat, ¾e ka¾dá afinní transformace afinního prostoru
dimenze 2 je výsledkem skládání elementárních
operací zmìny mìøítka, otoèení a posunutí uvedených v pøíkladu\cite[elemhomo].
Dùkaz tohoto tvrzení
ponecháme a¾ do kapitoly\kcite\ktere[skalsoucin] v~pøíkladu\cite[elemsloz].

\okraj Perspektivní projekce | Perspektivni projekce

\poznamka [perspproj]
V poèítaèové grafice se øe¹í otázka zobrazení 3D modelu na 2D stínítko
monitoru. Mù¾eme to udìlat odstranìním napøíklad souøadnice $z$ ze tøí
pùvodních souøadnic 3D modelu, tedy $(x,y,z) \to (x,y)$. Toto
zobrazení nazýváme ortografickou projekcí. Pøirozenìj¹í ale je
pøedstavit si oko pozorovatele (nebo kameru) jako centrum, do kterého
se sbíhají v¹echny paprsky odrá¾ející se od pozorovaných objektù. 
Pøed pozorovatele postavíme stínítko monitoru -- prùhlednou rovinu. Ka¾dý
pozorvaný bod má svùj paprsek smìøující do oka a prùseèík tohoto
paprsku s rovinou stínítka je obraz pozorovaného bodu pøi perspektivní
projekci. Situace je znázornìná na obrázku. Zde je oko pozorovatele
umístìné do poèátku souøadnic afinního prostoru a rovina stínítka
je kolmá na osu $z$ a je umístìna ve vzdálenosti~1 od
pozorovatele. Pozorovatel se dívá \uv{nahoru}. Je docela pohodlné
le¾et na gauèi a zírat vzhùru. Za této situace se bod
3D scény se souøadnicemi $(x,y,z)$ zobrazí na stínítko do místa se
souøadnicemi $(x/z,y/z,1)$ a po zanedbání souøadnice $z$
máme výsledné 2D souøadnice $(x/z,y/z)$. Tuto perpektivní projekci tedy
mù¾eme popsat jako $(x,y,z)\to (x/z,y/z)$. Zjevnì body se souøadnicemi
$(x,y,0)$ pùvodní 3D scény nejsou vidìt a do 2D scény se nezobrazují. Pravda,
nejsou vidìt ani body za zády pozorovatele, tj. $(x,y,z)$ pro
$z<0$. Pokud bychom je pøed projekcí neodstranili, pak by se nám pøi
pou¾ití vzorce $(x,y,z)\to (x/z,y/z)$ také promítly do stínítka.

Perspektivní projekce není afinní zobrazení. Zobrazuje sice pøímky
(neprocházející okem) na pøímky, ale rovnobì¾né pøímky se mohou sbíhat
ve spoleèném bodì, co¾ není podle\cite[arovnobeznost] vlastnost 
afinního zobrazení. V pøedchozím textu jsme ukázali, ¾e matice
v¹ech afinních zobrazení v homogenních souøadnicích 
mají v posledním øádku $(0,\ldots,0,1)$. Dovolíme-li maticím
nemít tuto vlastnost, mù¾eme pomocí maticového násobení
postihnout i perspektivní projekci. Potøebujeme k tomu úèelu ov¹em
roz¹íøit pojem homogenní souøadnice bodu. V poslední souøadnici od
této chvíle pøipustíme jakékoli nenulové èíslo, ne nutnì jednièku:

\definice* [dhomo2]
%%%%%%%%%
Nech» $(\X,V)$ je afinní prostor a $(O,B)$ jeho souøadnicový systém.
Nech» bod $P\in\X$ má vzhledem k $(O,B)$
souøadnice $(x_1,x_2,\ldots,x_n)$. Pak jakoukoli uspoøádanou
$(n+1)$-tici $(tx_1,tx_2,\ldots,tx_n,t)$ pro $t\not=0$
nazýváme {\em homogenní souøadnice bodu\/}~$P$.
\inl[souøadnice: homogenní, homogenní: souøadnice]

\poznamka
%%%%%%%%%
Homogenní souøadnice bodu nejsou urèeny touto definicí jednoznaènì.
Mù¾eme pou¾ít následující geometrickou pøedstavu: v¹echny homogenní
souøadnice stejného bodu $P$ z~afinního prostoru $(\X,V)$ dimenze~$n$ 
vyplní (a¾ na poèátek) pøímku v prostoru $\R^{n+1}$ homogenních
souøadnic. Tato pøímka v¾dy prochází poèátkem prostoru $\R^{n+1}$.
V~prostoru homogenních souøadnic $\R^{n+1}$ si vytvoøme 
zobecnìnou rovinu $\varrho=\{(x_1,x_2,\ldots,x_n,1),\,x_i\in\R\}$. 
Bod $P$ je v~prostoru homogenních souøadnic reprezentován pøímkou, 
která protíná rovinu $\varrho$ v bodì $P$ 
(po zanedbání poslední souøadnice). V¹echny
objekty v $\X$ mají v prostoru homogenních souøadnic o jednu dimenzi
více, ne¾ v $\X$ samotném. Napøíklad pøímka v $\X$ je
rovinou v~$\R^{n+1}$ procházející poèátkem. 
Pøitom prùseèík této roviny se zobecnìnou rovinou $\varrho$ dává
pùvodní pøímku.

\poznamka
%%%%%%%%%
Pro popis perspektivní projekce 3D scény na 2D stínítko si vystaèíme 
s~afinním prostorem dimenze~3 a se ètyømi homogenními souøadnicemi na
vstupu a s afinním prostorem dimenze 2 a tøemi homogenními souøadnicemi
na výstupu. Popí¹eme perspektivní projekci, která 
je ve skuteèných souøadnicích popsána vzorcem $(x,y,z)\to(x/z,y/z)$
a byla zmínìna v~poznámce\cite[perspproj]. Nech» homogenní souøadnice 
vzoru v~této projekci jsou $(x,y,z,1)$. Homogenní souøadnice obrazu
jsou tøeba $(x/z,y/z,1)$, ale stejný bod má té¾ 
(v~souladu s definicí\cite[dhomo2] a pøi volbì $t=z$) homogenní souøadnice
$(x,y,z)$. Matice perspektivní projekce v homogenních souøadnicích
tedy vypadá následovnì:
$$
  \pmatrix{1&0&0&0\cr0&1&0&0\cr0&0&1&0}, \qquad
   \hbox{proto¾e}\quad
  \pmatrix{1&0&0&0\cr0&1&0&0\cr0&0&1&0}\cdot \pmatrix{x\cr y\cr z\cr 1}
    = \pmatrix{x\cr y\cr z}
$$
Pov¹imneme si, ¾e na vstupu máme bod z 3D popsaný ètyømi homogenními
souøadnicemi a na výstupu bod z 2D popsaný tøemi homogenními
souøadicemi. Bod na výstupu nemá poslední homogenní souøadnici v¾dy
rovnu jedné. Chceme-li zjistit skuteèné souøadnice tohoto bodu, musíme
najít jiné homogenní souøadnice stejného bodu, které mají v poslední
slo¾ce jednièku. Tedy: $(x/z,y/z,1)$. Skuteèné 2D souøadnice tedy
podle oèekávání jsou $(x/z,y/z)$.

 



\shrnuti
%%%%%%%%
Afinní prostor sestává z mno¾iny bodù $\X$ a z lineárního 
prostoru~$V$\lcite[Aprst]. Je definována operace \uv{bod plus vektor je bod},
která splòuje axiomy (1) a¾ (3)\lcite[defAprst].

Souøadnice bodu $P$ jsou souøadnice jeho radiusvektoru $P-O$.
Souøadnice bodù i vektorù zachovávají potøebné
operace\lcite[esour-lin].

Homogenní souøadnice bodu jsou souøadnice bodu následované jednièkou a
homogenní souøadnice vektoru jsou souøadnice vektoru následované 
nulou\lcite[dhomosour].

Transformace $\a:\X\to\X$ jsou afinní, právì kdy¾ mají matici 
v~homogenních souøadnicích~/\ncite[Ahomo], \ncite[Atrans], 
\ncite[Ahomoa],~\ncite[zobhomo]/. Skládání afinních transformací
má v homogenních souøadnicích matici rovnou souèinu matic jednotlivých 
transformací.

Matice v homogenních souøadnicích má v¾dy v posledním øádku
$(0,\ldots,0,1)$.

Uvedli jsme si matice elementárních transformací: zmìna mìøítka,
rotace a posunutí\lcite[elemhomo]. Skládáním elementárních
transformací lze vytvoøit libovolnou afinní transformaci.

Nech» $(\vecc b_n, O)$ je souøadnicový systém prostoru $(\X,V)$
Afinní transformace $\a:\X\to\X$ je jednoznaènì urèena svými obrazy
bodu $O$ a bodù $O+\vec b_i$\lcite[anabasi]. Matice této
transformace v homogeních souøadnicích má ve
sloupcích homogenní souøadnice obrazù $\vec b_i$ následované sloupcem
s homogenními souøadnicemi obrazu bodu~$O$.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
\kapitola [vlcisla] Vlastní èíslo, vlastní vektor |
                    Vlastni cislo, vlastni vektor
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\okraj Motivaèní pøíklad | Motivacni priklad

\priklad
%%%%%%%%
Pøedpokládejme, ¾e je dána lineární transformace $\a:\R^2\to\R^2$,
která má svou matici $\A\in\R^{2,2}$. Je-li $\vec u\in\R^2$ nenulový
vektor, pak mno¾ina $p=\{t\vec u;\, t\in\R\}$ je (z geometrického
pohledu) pøímka, procházející poèátkem. Nenulovému vektoru $\vec u$
øíkáme {\em smìrový vektor pøímky}. Transformace $\a$ zobrazuje
pøímky procházející poèátkem na pøímky procházející poèátkem. Pokusíme
se najít pøímku procházející poøátkem, která se tranformací $\a$
zobrazí sama na sebe.

Hledanou pøímku oznaèíme $p=\{t\vec u;\, t\in\R\}$. Musí platit
$p = \a(p) = \{t\a(\vec u);\, t\in\R\}$,
tak¾e smìrový vektor pøímky $p$ a smìrový vektor pøímky $\a(p)$
musejí být lineárnì závislé, tedy $\a(\vec u) = \lambda\vec u$. 

Je-li dána matice $\A$ zobrazení $\a$, pak se pøedchozí úloha dá
formulovat takto: najít nenulový vektor $\vec u\in\R^2$ a èíslo
$\lambda\in\R$ tak, aby $\A\cdot\vec u = \lambda\vec u$.
Rovnost se dá pøepsat takto: $\A\cdot\vec u = \lambda\E\cdot\vec u$,
neboli $(\A-\lambda\E)\cdot\vec u=\vec o$. Aby bylo mo¾né najít
nenulové øe¹ení $\vec u$ této homogenní soustavy (s parametrem $\lambda\in\R$),
musí její matice $\A-\lambda\E$ být singulární, neboli musí
$\det(\A-\lambda\E)=0$. Je-li dána matice $\A\in\R^2$, pak
rovnice $\det(\A-\lambda\E)=0$ je kvadratická rovnice v promìnné
$\lambda$. Tato rovnice mù¾e, ale nemusí mít reálné koøeny. Pokud má
reálné koøeny $\lambda_1$ a $\lambda_2$, pak lze najít nenulová øe¹ení
homogenních soustav $(\A-\lambda_1\E)\cdot\vec u=\vec o$ a 
$(\A-\lambda_2\E)\cdot\vec u=\vec o$. Oznaèíme-li tato øe¹ení
$\vec u_1$ a $\vec u_2$, pak jsme na¹li dvì pøímky
$p_1=\{t\vec u_1\}$ a $p_2=\{t\vec u_2\}$, které se zobrazí na sebe.
Uvedený postup uká¾eme v následujících pøíkladech znovu a konkrétnìji.

\priklad
%%%%%%%%
Nech» lineární transformace $\a:\R^2\to\R^2$ má matici
$$
  \A = \pmatrix {5&2\cr -3&0}
$$
Najdeme pøímky, které tato transformace ponechá beze zmìny.

Nech» $p=\{t(x_1,x_2);\,t\in\R\}$ je hledaná pøímka. Musí platit
$\a(x_1,x_2) = \lambda(x_1,x_2)$, neboli:
$$
  \pmatrix {5&2\cr -3&0}\cdot\pmatrix{x_1\cr x_2} = \lambda\pmatrix{x_1\cr x_2},
  \quad \hbox{tj.}\quad
  \pmatrix {5-\lambda&2\cr -3&-\lambda}\cdot\pmatrix{x_1\cr x_2} =
  \pmatrix{0\cr0}.
$$
Proto¾e hledaný vektor $(x_1,x_2)$ musí být nenulový, musí mít uvedená
homogenní soustava singulární matici. To znamená, ¾e:
$$
  \det\pmatrix {5-\lambda&2\cr -3&-\lambda} = 0, \quad
  \hbox{tj.}\quad
  \lambda^2 - 5\lambda + 6 = 0, \quad
  \hbox{tj.}\quad
  \lambda = 2\quad\hbox{nebo}\quad \lambda=3. 
$$
Koøeny $\lambda=2$ a $\lambda=3$ postupnì dosadíme do pùvodní
homogenní soustavy:
$$
  \lambda=2:\quad
  \pmatrix {5-2&2\cr -3&-2}\cdot\pmatrix{x_1\cr x_2} =
  \pmatrix{0\cr 0},\qquad
  \lambda=3:\quad
  \pmatrix {5-3&2\cr -3&-3}\cdot\pmatrix{x_1\cr x_2} =
  \pmatrix{0\cr 0}.
$$
Nenulové øe¹ení první soustavy je napøíklad 
$(-2,3)$ a nenulové øe¹ení druhé soustavy je 
$(-1,1)$. Tak¾e pøímky $p_1=\{t(-2,3);\, t\in\R\}$ a $p_2=\{t(-1,1);\, t\in\R\}$
jsou hledané pøímky, které se zobrazí na sebe.

\priklad
%%%%%%%%
Nech» lineární transformace $\a:\R^2\to\R^2$ má matici
$$
  \A = \pmatrix {1&2\cr -2&3}
$$
Najdeme pøímky, které tato transformace ponechá beze zmìny.

Postup nebudeme opakovat podrobnì znovu. V jedné fázi výpoètu dostáváme
determinant:
$$
  \det\pmatrix {1-\lambda&2\cr -2&3-\lambda} = 0, \quad
  \hbox{tj.}\quad
  \lambda^2 - 4\lambda + 7 = 0, \quad
  \hbox{tato rovnice nemá v $\R$ øe¹ení.}
$$
V tomto pøípadì neexistuje ¾ádná pøímka procházející poèátkem, kterou by daná lineární
transformace ponechala beze zmìny.

\poznamka
%%%%%%%%%
Èíslùm $\lambda$ v pøedchozích pøíkladech se øíká {\em vlastní èísla
matice}~$\A$, resp. {\em vlastní èísla transformace}~$\a$. Smìrovým vektorùm
pøímek, které transformace ponechává beze zmìny, øíkáme {\em vlastní
vektory}. Pøesnìj¹í definici tìchto pojmù zavedeme za chvíli.

\poznamka
%%%%%%%%%
Z uvedených pøíkladù plyne, ¾e vlastní èísla matice $\A$ lze poèítat
jako koøeny polynomu $\det(\A-\lambda\E)$. Tyto koøeny ov¹em nemusejí
být v¾dy reálné.  Abychom mìli zaruèenu v¾dy existenci vlastního
èísla, budeme muset pøipustit i~komplexní vlastní èísla a komplexní
vlastní vektory. V této kapitole tedy bude u¾iteèné pracovat
s~lineárními prostory nad komplexními èísly (viz
poznámku\cite[dlpnadC]) a s komplexními maticemi.  Pak budeme mít
zaruèeno, ¾e ka¾dá lineární transformace (resp. její matice) má v¾dy
vlastní èísla a vlastní vektory. Bohu¾el, pøechodem ke komplexním
èíslùm musíme ponìkud více pøimhouøit obì oèi, kdy¾ chceme vlastní
vektory interpretovat geometricky jako smìrové vektory pøímek, které
transformace ponechává beze zmìny. Geometrický prostor, na který jsme
zvyklí, je toti¾ izomorfní s~$\R^3$, nikoli s $\C^3$.

V~modelových pøíkladech se pokusíme komplexním èíslùm vyhnout.

\okraj Vlastní èíslo, vlastní vektor | Vlastni cislo, vlastni vektor

\definice* [dvl]
%%%%%%%%%
Nech» $L$ je lineární prostor koneèné dimenze nad $\C$ a
nech» $\a:L\to L$ je lineární transformace. Èíslo $\lambda\in\C$ se
nazývá 
{\em vlastním èíslem transformace~$\a$}, pokud existuje vektor $\vec x\in L$,
$\vec x\not=\vec o$ takový, ¾e $\a(\vec x) = \lambda\,\vec x$.
Vektor $\vec x$, který splòuje uvedenou rovnost, se nazývá {\em
vlastní vektor transformace $\a$ pøíslu¹ný vlastnímu èíslu $\lambda$}.
\inl[èíslo: vlastní, vlastní: èíslo, vektor: vlastní, vlastní: vektor]

\poznamka
%%%%%%%%%
Pokud existuje vlastní èíslo transformace $\a$, pak mu pøíslu¹í více
vlastních vektorù. Pøidáme-li k tìmto vektorùm vektor nulový,
dostáváme lineární podprostor prostoru $L$.
Skuteènì, pokud $\vec x$, $\vec y$ splòují 
$\a(\vec x) = \lambda\,\vec x$, $\a(\vec y) = \lambda\,\vec y$, pak
$$
  \a(\vec x+\vec y) = \a(\vec x)+\a(\vec y) = 
  \lambda\,\vec x+\lambda\,\vec y = \lambda\,(\vec x+\vec y), \qquad
  \a(\alpha\,\vec x) = \alpha\,\a(\vec x) = \alpha\lambda\,\vec x =
  \lambda\,(\alpha\,\vec x).
$$

\poznamka
%%%%%%%%%
Pojem vlastní èíslo definujeme nejenom pro lineární transformace, ale rovnì¾
pro ètvercové matice. Záhy zjistíme, ¾e mezi vlastním èíslem transformace
a její matice je úzká souvislost.

\definice* [dvA]
%%%%%%%%%
Nech» $\A$ je ètvercová matice typu $(n,n)$ reálných nebo komplexních
èísel. Èíslo $\lambda\in\C$ se
nazývá {\em vlastním èíslem matice $\A$}, pokud existuje vektor $\vec x\in
\C^{n,1}$, $\vec x\not=\vec o$, takový, ¾e $\A\cdot\vec x = \lambda\,\vec x$.
Vektor $\vec x$, který splòuje uvedenou rovnost, se nazývá {\em
vlastní vektor matice $\A$ pøíslu¹ný vlastnímu èíslu~$\lambda$}.
\inl[èíslo: vlastní, vlastní: èíslo, vektor: vlastní, vlastní: vektor]

\veta [vlavlA]
%%%%%
Nech» $\a:L\to L$ je lineární transformace a $\A$ je jeho matice vzhledem
k nìjaké bázi $(B)$. Pak $\lambda$ je vlastním èíslem transformace $\a$ právì 
tehdy, kdy¾ je vlastním èíslem matice $\A$. Navíc $\vec x$ je vlastní 
vektor transformace $\a$ pøíslu¹ný $\lambda$ právì tehdy, kdy¾ souøadnice
vektoru $\vec x$ vzhledem k bázi $(B)$ tvoøí
vlastní vektor matice $\A$ pøíslu¹ný $\lambda$.

\dukaz
%%%%%%
Oznaème $\vec u\in\C^n$ souøadnice vektoru $\vec x$ v~bázi $(B)$.
Podle vìty\cite[Aasour] sloupec $\A\cdot \vec u$ obsahuje 
souøadnice obrazu $\a(\vec x)$ vzhledem k~bázi~$(B)$.
Tak¾e $\a(\vec x)=\lambda\,\vec x$ právì tehdy, kdy¾ 
$\A\cdot\vec u =\lambda\,\vec u$.

\poznamka
%%%%%%%%%
Mno¾ina v¹ech vlastních èísel lineární transformace nebo matice se
nazývá \hbox{\em spektrum}. Vlastním èíslùm/vektorùm nìkteøí èe¹tí autoøi øíkají
{\em charakteristická èísla/vektory\/} (anglicky
eigen\-value, eigen\-vector, co¾ je odvozeno z nìmèiny).
\inl[spektrum: transformace, spektrum: matice]
\inl[charakteristické: èíslo, èíslo: charakteristické]
\inl[charakteristický: vektor, vektor: charakteristický]
\inl[eigenvalue, eigenvector]

\poznamka
%%%%%%%%%
Pøikroèíme nyní k výpoètu vlastních èísel, je-li dána ètvercová matice
$\A$. Vyjdeme z~rovnosti 
$\A\cdot\vec x = \lambda\,\vec x = \lambda\,\E\cdot\vec x$. 
Z~obou stran této rovnice odeèteme $\lambda\,\E\cdot\vec x$.
Dostáváme vztah $\A\cdot\vec x-\lambda\,\E\cdot\vec x = 
(\A-\lambda\,\E)\cdot \vec x = \vec o$.
Z definice vlastního èísla víme, ¾e pøíslu¹ný vlastní vektor 
$\vec x$ musí být nenulový.
Je tedy zøejmé, ¾e $\lambda$ bude vlastním èíslem matice $\A$ právì
tehdy, kdy¾ homogenní soustava s maticí $\A-\lambda\,\E$ bude mít
nenulové øe¹ení. Tímto øe¹ením pak bude vlastní vektor pøíslu¹ný
vlastnímu èíslu $\lambda$. Aby tato soustava mìla nenulové øe¹ení,
musí její matice být singulární, tj. musí $\det(\A-\lambda\,\E)=0$.
Tím máme odvozen vzorec na výpoèet vlastních èísel. Uvìdomíme si
je¹tì, ¾e $\det(\A-\lambda\,\E)$ je polynom v~promìnné~$\lambda$.
Tento polynom se nazývá {\em charakteristický polynom\/} matice $\A$.
Jeho stupeò je stejný, jako poèet øádkù matice $\A$. Oznaème toto
èíslo $n$.
Abychom tedy na¹li v¹echna vlastní èísla dané matice, staèí najít
v¹echny koøeny charakteristického polynomu této matice.
Podle základní vìty algebry tìchto koøenù (vèetnì jejich násobnosti)
je $n$. Ka¾dá matice má tedy $n$ vlastních èísel (obecnì ne vzájmenì
rùzných). Ka¾dá lineární transformace $\a:L\to L$ má tolik vlastních
èísel, kolik je dimeze~$L$. 
\inl[metoda: poèítání: vlastních èísel]

\definice [chpolynom]
%%%%%%%%%
Nech» $\A$ je ètvercová matice. Polynom $\det (\A-\lambda\,\E)$
nazýváme {\em charakteristický polynom matice $\A$} a rovnost
$\det (\A-\lambda\,\E)=0$ charakteristickou rovnicí. Je-li $\lambda$ 
$k$-násobným koøenem charakteristické rovnice, øíkáme, ¾e $\lambda$ je
{\em $k$-násobným vlastním èíslem}.
\inl[charakteristický: polynom, polynom: charakteristický]
\inl[násobnost: vlastního èísla]

\priklad [3vvektory]
%%%%%%%%
Uvedeme je¹tì celý postup odvození výpoètu vlastních
èísel matice (viz pøedchozí poznámku) znovu na konkrétním numerickém
pøíkladì, proto¾e odvození mù¾e pro nìkoho být na konkrétním
pøíkladì názornìj¹í. Budeme hledat vlastní èísla a vlastní vektory
matice
$$
  \A=\matice{5 & -2 & 2  \cr
            -1 &  4 & -1 \cr
            -4 &  4 & -1 \cr}.
$$
Podle definice\cite[dvA] hledáme takové èíslo $\lambda$ a vektor
$\vec x=(x_1, x_2, x_3)$, aby byla splnìna maticová rovnost
$$
  \matice{5 & -2 & 2  \cr
         -1 &  4 & -1 \cr
         -4 &  4 & -1 \cr}\cdot
  \matice {x_1\cr x_2\cr x_3\cr} = \lambda\,
  \matice {x_1\cr x_2\cr x_3\cr},
$$
a pøitom vektor $\vec x$ byl nenulový. Rozepí¹eme tuto rovnost do
slo¾ek:
$$
  \let\quad=\relax
  \matrix{
   5x_1& {}-2x_2& {}+2x_3  &{}= \lambda x_1 \cr
   -x_1& {}+4x_2& {}-x_3   &{}= \lambda x_2 \cr
   -4x_1& {}+4x_2& {}-x_3 &{}= \lambda x_3 \cr
} \qquad \hbox{tj.} \qquad
  \matrix{
   (5-\lambda)x_1& \hfill{}-2x_2& \hfill{}+2x_3  &{}= 0 \cr
   \hfill-x_1& +(4-\lambda)x_2& \hfill{}-x_3   &{}= 0 \cr
   \hfill-4x_1& \hfill{}+4x_2& +(-1-\lambda)x_3 &{}= 0 \cr
}
$$
Potøebujeme, aby uvedená homogenní soustava se ètvercovou maticí mìla
nenulové øe¹ení. Matice soustavy tedy musí být singulární, tj. musí
mít nulový determinant:
$$
  \det\pmatrix{5-\lambda & -2 & 2  \cr
         -1 &  4-\lambda & -1 \cr
         -4 &  4 & -1-\lambda \cr} = 0.
$$
Hledáme tedy $\lambda$ takové, aby $\det(\A-\lambda\E)=0$. Pøí¹tì u¾
toto odvození nebudeme opakovat, ale zaèneme rovnou od rovnice 
$\det(\A-\lambda\E)=0$.
$$
  \det(\A-\lambda\E)=(5-\lambda)(4-\lambda)(-1-\lambda)-16-
  \bigl(-8(4-\lambda) -4(5-\lambda) +2(-1-\lambda)\bigr) = 
 -(\lambda-3)^2(\lambda-2),
$$
tak¾e vlastní èísla jsou $\lambda=3$ a $\lambda=2$. Najdeme je¹tì
vlastní vektory. Nejprve najdeme vlastní vektory pøíslu¹né vlastnímu èíslu 3:
$$
  \pmatrix{5-3 & -2 & 2  \cr
         -1 &  4-3 & -1 \cr
         -4 &  4 & -1-3 \cr} =
  \matice {2 & -2 & 2  \cr
         -1 &  1 & -1 \cr
         -4 &  4 & -4 \cr} \sim \matice {1 & -1 & \ 1}.
$$
Báze øe¹ení homogenní soustavy s maticí $(1\ {-1}\ \ 1)$ je napøíklad
$\{(1,1,0),(-1,0,1)\}$. Toto jsou dva lineárnì nezávislé vlastní vektory,
které pøíslu¹í vlastnímu èíslu~3. V¹echny vlastní vektory pøíslu¹ející
vlastnímu èíslu~3 tvoøí lineární obal této báze, ov¹em bez nulového
vektoru. Nyní najdeme vlastní vektory, které pøíslu¹í vlastnímu
èíslu~2:
$$
  \pmatrix{5-2 & -2 & 2  \cr
         -1 &  4-2 & -1 \cr
         -4 &  4 & -1-2 \cr} =
  \matice {3 & -2 & 2  \cr
         -1 &  2 & -1 \cr
         -4 &  4 & -3 \cr} \sim
  \matice {-1 & 2  & -1 \cr
           0  & 4  & -1 \cr
           0  & -4 &  1 \cr} \sim
  \matice {-1 & 2  & -1 \cr
           0  & \ 4  & -1 \cr}.
$$
Dimenze prostoru øe¹ení homogenní soustavy s touto maticí je~1,
tj. staèí najít jeden vektor øe¹ení: $(-2,1,4)$ a ostatní vektory
øe¹ení jsou jeho násobky. Tato øe¹ení (bez nulového) jsou té¾ v¹echny vlastní
vektory matice~$\A$, které pøíslu¹í vlastnímu èíslu~2.

Celkem tedy má matice $\A$ tøi lineárnì nezávislé vlastní vektory:
$(1,1,0),(-1,0,1), (-2,1,4)$. První dva pøíslu¹ejí vlastnímu èíslu~3 a
poslední pøíslu¹í vlastnímu èíslu~2.

\priklad [2vvektory]
%%%%%%%%
Následující pøíklad ukazuje, ¾e nemusí existovat tolik lineárnì
nezávislých vlastních vektorù, kolik øádkù má matice. Budeme hledat
vlastní èísla a vlastní vektory matice:
$$
  \A=\matice{ 2 &  4 & -3 \cr
             -1 & 10 & -6 \cr
             -1 &  8 & -4 \cr}.
$$
Vypoèteme determinant matice $\A-\lambda\E$:
$$
  \det\pmatrix { 2-\lambda &  4 & -3 \cr
                -1 & 10-\lambda & -6 \cr
                -1 &  8 & -4-\lambda \cr} = -(\lambda-3)^2 (\lambda-2).
$$  
Vidíme, ¾e matice má stejná vlastní èísla, jako matice z pøedchozího
pøíkladu. Nyní vypoèítáme vlastní vektory:
$$
\eqalign{
  \matrix {\lambda=3:\cr{}\cr{}\cr}&
  \pmatrix{ 2-3 &  4 & -3 \cr
             -1 & 10-3 & -6 \cr
             -1 &  8 & -4-3 \cr} =
  \matice{ -1 &  \ 4 & -3 \cr
             -1 & 7 & -6 \cr
             -1 &  8 & -7 \cr} \sim
  \matice{ -1 &  \ 4 & -3 \cr
            0 & 3 & -3 \cr
            0 & 4 & -4 \cr} \sim
  \matice{ -1 &  \ 4 & -3 \cr
            0 & 1 & -1 \cr} \quad
  \matrix {\hbox{vlastní }\cr\noalign{\vskip-3pt}\hbox{vektor:}\cr
           (1,1,1)\cr}
  \cr
  \matrix {\lambda=2:\cr{}\cr{}\cr}&
  \pmatrix{ 2-2 &  4 & -3 \cr
             -1 & 10-2 & -6 \cr
             -1 &  8 & -4-2 \cr} =
  \matice {  0 & \ 4 & -3 \cr
             -1 & 8 & -6 \cr
             -1 &  8 & -6 \cr} \sim
  \matice {  -1 & \ 8 & -6 \cr
              0 & 4 & -3 \cr} \quad
  \matrix {\hbox{vlastní }\cr\noalign{\vskip-3pt}\hbox{vektor:}\cr
           (0,3,4)\cr}
}
$$
Na rozdíl od pøedchozího pøíkladu vícenásobnému vlastnímu èíslu~3
pøíslu¹í jen jeden lineárnì nezávislý vlastní vektor. Tato matice má tedy
dohromady jen dva lineárnì nezávislé vlastní vektory: $(1,1,1),
(0,3,4)$, které po øadì pøíslu¹ejí vlastním èíslùm~3 a~2.

\okraj Podobné\hb matice | Podobne matice

\poznamka [stejnavlcisla]
%%%%%%%%%
Vlastní èíslo transformace $\a$ je podle vìty\cite[vlavlA] 
vlastním èíslem v¹ech matic této transformace
(vzhledem k~rozlièným bázím). Dvì matice, které jsou maticemi stejné
lineární transformace (jen vzhledem k rùzné bázi) budeme nazývat 
{\em podobné}. Následující vìta ukazuje, jaký platí mezi podobnými
maticemi vztah.

\veta
%%%%%
Nech» $L$ je lineární prostor dimenze $n$ 
a nech» $(B)$ a $(B')$ jsou nìjaké jeho uspoøádané báze.
Nech» $\a: L\to L$ je lineární transformace a nech» $\A$ je její
matice vzhledem k bázi $(B)$ a $\B$ je její matice vzhledem k bázi
$(B')$. Pak existuje regulární matice $\P\in\R^{n,n}$ tak, ¾e
$\B=\P^{-1}\cdot\A\cdot\P$.

\dukaz
Oznaème $\P=\P_{B\to B'}$ matici pøechodu od $(B)$ k $(B')$. 
Podle vìty\cite[zmenabase] (vzorce tøetího) platí
$\m_{B'B'}(\a) = \P_{B'\to B}\cdot\m_{B,B}(\a)\cdot\P_{B\to B'}$.
Proto¾e $\P_{B'\to B} = (\P_{B\to B'})^{-1} = \P^{-1}$ (viz vìtu\cite[slozmprech]),
dostáváme $\m_{B'B'}(\a) = \P^{-1}\cdot\m_{B,B}(\a)\cdot\P$, neboli
$\B=\P^{-1}\cdot\A\cdot\P$.

\definice* [dpodobnost]
%%%%%%%%%
Matice $\A$ je {\em podobná\/} matici $\B$, pokud existuje
regulární matice $\P$ taková, ¾e platí $\B=\P^{-1}\cdot\A\cdot \P$.
\inl[matice: podobná, podobnost: matic]

\poznamka
%%%%%%%%%
Je-li $\A$ podobná $\B$, pak je i $\B$ podobná $\A$, proto¾e
místo matice $\P$ mù¾eme pou¾ít matici $\P^{-1}$.
Staèí tedy øíkat, ¾e matice jsou si vzájemnì podobné.
Je-li $\A$ podobná $\B$ a $\B$ podobná $\C$, pak je $\A$ podobná
$\C$, proto¾e souèin regulárních matic je matice regulární
a proto¾e $(\P\Q)^{-1}=\Q^{-1}\P^{-1}$.
Matice je podobná sama sobì, proto¾e $\E$ je regulární.

\poznamka
%%%%%%%%%
Proto¾e podobné matice jsou matice stejné lineární transformace, jen
vzhledem k pøípadnì rùzným bázím, mají samozøejmì v¹echny vzájemnì
podobné matice stejná vlastní èísla. V~následující vìtì uká¾eme, 
¾e mají i stejný charakteristický polynom.

\veta* [vlcisloPAP]
%%%%%
Podobné matice mají stejný charakteristický polynom.

\dukaz
Nech» $\P$ je regulární. Matice $\P^{-1}\A\P$ je podobná matici $\A$.
Vypoèteme její charakteristický polynom:
$$\eqalign{
 \det (\P^{-1}\A\P - \lambda\,\E) &=
 \det (\P^{-1}\A\P - \lambda\,\P^{-1}\E\P) =
 \det (\P^{-1}\A\P - \P^{-1}\lambda\,\E\P) =\cr &=
 \det (\P^{-1}\,(\A-\lambda\,\E)\,\P) =
 \det \P^{-1}\,\det (\A-\lambda\,\E)\, \det\P = 
 \det (\A-\lambda\,\E),\cr}
$$
proto¾e $\det\P^{-1}\det\P=1$.

\poznamka
%%%%%%%%%
Matice z pøíkladù\cite[3vvektory] a\cite[2vvektory] mají sice
stejný charakteristický polynom, ale za chvíli uká¾eme, ¾e si nejsou
podobné. Tvrzení vìty\cite[vlcisloPAP] tedy nelze obrátit. 

\okraj Podobnost s~diagonální maticí | Podobnost s diagonalni matici

\priklad
%%%%%%%%
Diagonální matice
$$
  \D = \pmatrix {\lambda_1 & 0 & 0 & \ldots & 0 \cr
                0 & \lambda_2 & 0 & \ldots & 0 \cr
                0 & 0 & \lambda_3 & \ldots & 0 \cr
                \noalign{\hbox to 10em{ \dotfill\quad}}
                 0 & 0 & 0 & \ldots & \lambda_n}
$$
má charakteristický polynom 
$(\lambda_1-\lambda)\,(\lambda_2-\lambda)\cdots(\lambda_n-\lambda)$,
proto¾e determinant diagonální matice $\D-\lambda\,\E$ 
je roven souèinu prvkù na diagonále. Vlastní èísla matice $\D$ tedy 
jsou $\lambda_1, \lambda_2, \ldots, \lambda_n$. 
\inl[matice: diagonální, diagonální: matice]

Vlastní vektor matice $\D$ pøíslu¹ný vlastnímu èíslu $\lambda_i$ je vektor
obsahující samé nuly s výjimkou $i$-té slo¾ky, ve které je nìjaké
nenulové èíslo, tøeba jednièka. 

Matici $\D$ z tohoto pøíkladu budeme znaèit 
$\D=\diag(\lambda_1, \lambda_2, \ldots, \lambda_n)$. Tím u¹etøíme papír.
\inl[diag]

\veta [PDAP]
%%%%%
Nech» $\A$ je ètvercová matice typu $(n,n)$.
Sestavme libovolná komplexní èísla $\lambda_1, \ldots, \lambda_n$ do
diagonální matice $\D=\diag(\lambda_1, \ldots, \lambda_n)$
a libovolné nenulové vektory $\vec x_1, \ldots, \vec x_n$ z~$\C^n$  
zapi¹me do sloupcù matice~$\P$, tj. $\P=(\vec x_1, \ldots, \vec x_n)$.
Pak platí: èísla $\lambda_1, \ldots, \lambda_n$ jsou vlastními èísly
matice $\A$ a $\vec x_1, \ldots, \vec x_n$ jsou jejich odpovídající
vlastní vektory právì tehdy, kdy¾ je splnìna rovnost $\P\D=\A\P$.

\dukaz
Rozepi¹me maticové násobení: 
$\P\D=(\vec x_1, \ldots, \vec x_n)\cdot \diag(\lambda_1, \ldots,
\lambda_n) = (\lambda_1\,\vec x_1, \ldots, \lambda_n\,\vec
x_n)$. Dále je $\A\P=\A(\vec x_1, \ldots, \vec x_n) = 
(\A\vec x_1, \ldots, \A\vec x_1)$. Máme tedy obì strany zkoumané
rovnosti $\P\D=\A\P$ rozepsány do sloupcù. Vidíme, ¾e rovnost v
$i$-tém sloupci $\lambda_i\,\vec x_i = \A\vec x_i$ platí právì
tehdy, kdy¾ $\lambda_i$ je vlastní èíslo matice $\A$ a $\vec x_i$ je
pøíslu¹ný vlastní vektor.

\veta [AjeD]
%%%%%
Nech» má ètvercová matice $\A$ s $n$ øádky $n$ lineárnì nezávislých
vlastních vektorù (ka¾dý z~nich pøíslu¹í nìjakému vlastnímu èíslu matice).
Pak je matice $\A$ podobná diagonální matici. 

\dukaz
%%%%%%
Sestavíme diagonální matici $\D$ z vlastních
èísel pøíslu¹ných vlastním vektorùm $\vec x_1, \ldots, \vec x_n$.
Dále pou¾ijeme pøedchozí vìtu.
Proto¾e matice $\P=(\vec x_1, \ldots, \vec x_n)$
obsahuje podle pøedpokladu vìty lineárnì nezávislé sloupce, 
je $\P$ regulární, tak¾e je mo¾né
vztah $\P\D=\A\P$ vynásobit zprava maticí $\P^{-1}$. Dostáváme
$\A=\P\D\P^{-1}$, tak¾e matice $\A$ je podobná matici $\D$.

\veta* [vPjsouvvektory]
%%%%%
Nech» je matice $\A$ podobná diagonální matici, to znamená, ¾e
existuje regulární matice $\P$ a diagonální matice $\D$ takové, 
¾e $\A=\P\D\P^{-1}$.
Pak $\D$ obsahuje vlastní èísla matice $\A$ a ve sloupcích matice $\P$
jsou vlastní vektory pøíslu¹né (podle poøadí) odpovídajícím 
vlastním èíslùm zapsaným v~$\D$.

\dukaz
%%%%%%
Po pøevedení vztahu $\A=\P\D\P^{-1}$ na $\A\P=\P\D$ staèí pou¾ít 
vìtu\cite[PDAP].

\priklad
%%%%%%%%
Matice z~pøíkladu\cite[3vvektory] má tøi øádky a tøi lineárnì
nezávislé vlastní vektory. Jsou tedy splnìny pøedpoklady vìty\cite[AjeD]
a matice je podobná diagonální matici. Vìta\cite[vPjsouvvektory] 
nám dává návod, jak najít matici~$\P$ a diagonální matici.
Sestavíme vlastní vektory $(1,1,0),(-1,0,1), (-2,1,4)$
do sloupcù a dostáváme matici $\P$. Sestavíme v~odpovídajícím poøadí
vlastní èísla do diagonální matice, a dostáváme matici $\D$, pro
kterou platí $\A=\P\D\P^{-1}$. Konkrétnì:
$$
  \A = \matice{5 & -2 & 2  \cr
              -1 &  4 & -1 \cr
              -4 &  4 & -1 \cr} =
       \matice { 1 & -1 & -2 \cr
                 1 &  0 &  1 \cr
                 0 &  1 &  4 \cr} \cdot
       \matice { 3 & \ 0 & \ 0 \cr
                 0 &  3 &  0 \cr
                 0 &  0 &  2 \cr} \cdot
       \matice { 1 & -1 & -2 \cr
                 1 &  0 &  1 \cr
                 0 &  1 &  4 \cr}^{-1}\!\!.
$$

\priklad
%%%%%%%%
Matice z pøíkladu\cite[2vvektory] nemá tolik lineárnì nezávislých
vlastních vektorù, jako je poèet jejích øádkù. To znamená, ¾e není
podobná diagonální matici (kdyby byla, pak dostaneme spor
s~vìtou\cite[vPjsouvvektory]. Proto¾e matice z~pøíkladu\cite[3vvektory]
je podobná diagonální matici, zatímco matice z pøíkladu\cite[2vvektory]
není, nejsou si tyto matice ani vzájemnì podobné.

\veta [vlastnijsouLN]
%%%%%
Vlastní vektory, které pøíslu¹ejí vzájemnì rùzným vlastním èíslùm, jsou
lineárnì nezávislé.

\dukaz
%%%%%%
Jeden vlastní vektor je samozøejmì lineárnì nezávislý, proto¾e je
podle definice nenulový. Dále postupujeme indukcí. Pøepokládáme, ¾e
matice $\A$ má lineárnì nezávislé vlastní vektory 
$\vec x_1, \ldots \vec x_k$ pøíslu¹ející rùzným
vlastním èíslùm $\lambda_1,\ldots,\lambda_k$
a pøidáme do této skupiny
vlastní vektor $\vec x_{k+1}$ pøíslu¹ející zatím nepou¾itému vlastnímu
èíslu $\lambda_{k+1}$. Pøedpokládáme rovnost
$\sum_{i=1}^{k+1}\alpha_i\vec x_i=\vec o$ a uká¾eme, 
¾e v¹echny koeficienty $\alpha_i$ musejí být nulové.
Tím doká¾eme lineární nezávislost.
Vektory v~uvedené rovnosti pí¹eme do sloupcù
a rovnost vynásobíme zleva 
maticí $\A-\lambda_{k+1}\E$. Dostáváme:
$$(\A-\lambda_{k+1}\E)\,\sum_{i=1}^{k+1}\alpha_i\vec x_i=
 \sum_{i=1}^{k+1}\alpha_i(\A\vec x_i-\lambda_{k+1}\vec x_i) =
 \sum_{i=1}^{k+1}\alpha_i(\lambda_i\vec x_i-\lambda_{k+1}\vec x_i) =
 \sum_{i=1}^{k+1}\alpha_i(\lambda_i-\lambda_{k+1})\,\vec x_i = \vec o.
$$
Koeficient u posledního sèítance v této rovnosti je nulový, proto¾e 
$\lambda_{k+1}-\lambda_{k+1}=0$. Podle indukèního pøedpokladu jsou
vektory $\vec x_1, \ldots \vec x_k$ lineárnì nezávislé, tak¾e i
ostatní koeficienty musejí být nulové. Proto¾e ale 
$\lambda_i\not=\lambda_{k+1}$, musí $\alpha_i=0$ pro $i\in\{1,\ldots,k\}$.
Dosadíme-li tento poznatek do výchozího tvaru rovnosti, máme
$0\,\vec x_1+\cdots+0\,\vec x_k+\alpha_{k+1}\vec x_{k+1} = 
\alpha_{k+1}\vec x_{k+1}=\vec o$. Proto¾e $\vec x_{k+1}$ je vlastní
vektor a tudí¾ nenulový, musí $\alpha_{k+1}=0$.

\poznamka [zarukapodobnosti]
%%%%%%%%%
Nech» $\A$ je typu $(n,n)$ a nech» jsou v¹echna vlastní èísla matice $\A$
jednonásobná. To znamená, ¾e existuje~$n$ rùzných vlastních èísel. Pak
podle pøedchozí vìty jim pøíslu¹ející vlastní vektory jsou lineárnì
nezávislé. Podle vìty\cite[AjeD] je tedy
matice $\A$ podobná diagonální matici.  

\poznamka
%%%%%%%%%
Má-li matice $\A$ vícenásobná vlastní èísla, pak se mù¾e stát, ¾e je
podobná s diagonální maticí. Zále¾í na tom, zda se povede najít $n$
lineárnì nezávislých vlastních vektorù. Vzhledem k tomu, ¾e vlastní 
vektory le¾í v nulových prostorech matic $\A-\lambda\E$ (kde $\lambda$
je vlastní èíslo), pùjde o to, jakou mají tyto prostory dimenzi.
Odpovìï na to dávají následující vìty.

\veta
%%%%%
Jestli¾e $\A$ a $\B$ jsou podobné matice, pak 
$\dim\nullsp(\A-\lambda\E) = \dim\nullsp(\B-\lambda\E)$.

\dukaz
Proto¾e $\dim\nullsp(\A-\lambda\E) = n-\hod(\A-\lambda\E)$, kde $n$ je
poèet øádkù matice $\A$, staèí
dokázat, ¾e $\hod(\A-\lambda\E) = \hod(\B-\lambda\E)$. 
Z~vìty\cite[hodPA] víme, ¾e platí:
$$
   \hod(\B-\lambda\E) = %\hod(\P^{-1}\A\P - \lambda\E) =
   \hod(\P^{-1}\A\P - \lambda\P^{-1}\E\P) = 
   \hod(\P^{-1}(\A-\lambda\E)\P) = \hod(\A-\lambda\E)
$$

\veta [nullgek]
%%%%%
Nech» $\lambda_i$ je $k$-násobné vlastní èíslo matice $\A$ a 
nech» $d$ je dimenze nulového prostoru matice $\A-\lambda_i\E$.
Pak $d\le k$.

\dukaz
V nulovém prostoru matice $\A-\lambda_i\E$ mù¾eme najít bázi, která má
$d$ vektorù: $\vecc b_d$ a doplníme ji na bázi
prostoru $\C^n$: $(B) = (\vecc b_d, \ldots, \vec b_n)$.
Nech» $\a: \C^n\to\C^n$ je transformace definována vzorcem 
$\a(\vec x) = \A\vec x$ a nech» $\B$ je matice této transformace
vzhledem k bázi $(B)$. Je zøejmé, ¾e matice $\A$ a $\B$ jsou si
vzájemnì podobné, proto¾e jsou to matice stejné lineární transformace.
Zvolme $\vec b_j$ z báze $(B)$ pro $j\le d$. Souøadnice tohoto
vektoru vzhledem k bázi $(B)$ oznaème $\vec y_j$. Tyto souøadnice
obsahují jedinou jednièku v $j$-té slo¾ce, jinak nuly. Platí
$\B\vec y_j = \lambda_i\vec y_j$, tak¾e $j$-tý sloupec matice $\B$
je roven $j$-tému sloupci matice 
$\lambda_i \E$. Matice $\B$ má tedy následující blokový tvar 
(první blok je ètvercový s $d$ øádky a sloupci):
$$
  \B = \pmatrix {\lambda_i \E & \B'\cr \O & \C}, \quad\hbox{tj.}\quad
  p(\lambda) =
  \det(\B-\lambda\E) = \det \pmatrix {(\lambda_i-\lambda)\,\E & \B'\cr \O & \C'}
  = (\lambda_i-\lambda)^d\,\det(\C'),
$$
tak¾e $\lambda_i$ je aspoò $d$-násobným koøenem
charakteristického polynomu matice $\B$, tj. podle vìty\cite[vlcisloPAP]
je aspoò $d$-násobným koøenem charakteristického polynomu matice $\A$.

\veta [N1cupN2]
%%%%%
Nech» $\lambda$ je vlastní èíslo matice $\A$. Nech» $N_1$ je
lineárnì nezávislá mno¾ina vlastních vektorù, které nepøíslu¹ejí
vlastnímu èíslu $\lambda$ a dále $N_2$ je lineárnì nezávislá mno¾ina
vlastních vektorù, které pøíslu¹ejí vlastnímu èíslu $\lambda$. Pak
mno¾ina $N_1\cup N_2$ je lineárnì nezávislá.

\dukaz
Oznaème
$N_1 = \{\vecc x_k\}$ a $N_2 = \{\vec x_{k+1}, \ldots, \vec x_m\}$.
Lineární nezávislost mno¾iny vektorù $N_1\cup\nobreak N_2 = \{\vecc x_m\}$ se ovìøí
stejnì jako v dùkazu vìty\cite[vlastnijsouLN]. Lineární kombinaci
tìchto vektorù, kterou polo¾íme rovnu nulovému vektoru, 
násobíme zleva maticí $\A-\lambda\E$. Tím
zjistíme, ¾e koeficienty u vektorù $\vecc x_k$ musejí být nulové.
Koneènì kvùli tomu, ¾e $N_2$ je lineárnì nezávislá, dostáváme nulové
koeficienty i u vektorù $\vec x_{k+1}, \ldots, \vec x_m$.

\veta*
%%%%%
Matice $\A$ je podobná s diagonální maticí právì tehdy, kdy¾
pro ka¾dé vlastní èíslo $\lambda_i$ násobnosti $k_i$ platí
$\dim\nullsp(\A-\lambda_i\E) = k_i$.

\dukaz
Nech» $\A$ typu $(n,n)$ je podobná s diagonální maticí. Pak $\P$ ve vzorci
$\A\P = \P\D$ musí být regulární. V matici $\P$ jsou ve sloupcích
vlastní vektory, tak¾e musí existovat $n$ lineárnì nezávislých
vlastních vektorù. Podle vìty\cite[nullgek] mù¾eme z ka¾dého nulového
prostoru matice $\A-\lambda_i\E$ vybrat maximálnì $k_i$ lineárnì
nezávislých vektorù. Jinde se vlastní vektory nenalézají. Abychom
získali $n$ lineárnì nezávislých vlastních vektorù, je tøeba z ka¾dého
nulového prostoru matice $\A-\lambda_i\E$ vzít právì $k_i$ lineárnì
nezávislých vektorù, tak¾e $\dim\nullsp(\A-\lambda_i\E) = k_i$.

Nech» obrácenì $\dim\nullsp(\A-\lambda_i\E) = k_i$. Z ka¾dého nulového
prostoru vybereme $k_i$ lineárnì nezávislých vektorù. Mno¾ina v¹ech
takto vybraných vektorù je podle vìty\cite[N1cupN2] lineárnì
nezávislá, tak¾e jimi sestavená matice $\P$ je regulární a je mo¾né
ze vzorce $\A\P=\P\D$ pøejít na $\A = \P\D\P^{-1}$.

\poznamka
%%%%%%%%%
Stále pøedpokládáme ètvercovou matici $\A$ typu $(n,n)$.
Jestli¾e $\dim\nullsp(\A-\lambda_i\E)$
je men¹í ne¾ násobnost vlastního èísla $\lambda_i$, pak
$\A$ není podobná s diagonální maticí.
Pøíklad\cite[2vvektory] ilustruje, ¾e takové
pøípady opravdu nastávají. Matice $\A$ je pak podobná jen \uv{skoro
diagonální matici}, která má na hlavní diagonále 
vlastní èísla a tìsnì nad touto
diagonálou se obèas vyskytují jednièky. Této matici se øíká {\em
Jordanùv kanonický tvar}. Je potøeba definovat tzv. {\em zobecnìný
vlastní vektor\/} a tento pojem pou¾ít k~vybudování regulární 
matice $\P$, která pøevádí matici $\A$ na Jordanùv kanonický tvar.
V¹echny tyto pojmy vy¾adují hlub¹í studium a pøesahují bohu¾el rámec tohoto
úvodního textu. Pro dal¹í studium lze doporuèit\bcite[krajnik].
\inl[Jordanùv: kanonický tvar, vlastní: vektor: zobecnìný, zobecnìný: vlastní vektor]

\poznamka
%%%%%%%%%
Vìty\cite[AjeD] a\cite[vPjsouvvektory] se dají formulovat z úhlu
pohledu lineární transformace:

\veta [vvlzob]
%%%%%
Nech» $\a:L\to L$ je lineární transformace, $\dim L=n$. Transformace $\a$ má
$n$ lineárnì nezávislých vlastních vektorù právì tehdy, kdy¾ existuje báze $(B)$
prostoru $L$ taková, ¾e $\a$ má vzhledem k této bázi diagonální
matici $\D$. Pøitom na diagonále matice $\D$ jsou vlastní èísla
transformace $\a$ a báze $(B)$ obsahuje vlastní vektory pøíslu¹né
vlastním èíslùm v~matici $\D$ ve stejném poøadí.

\dukaz
%%%%%%
Zvolme nìjakou výchozí bázi $(V)$ prostoru $L$. Oznaème symbolem $\A$ matici
transformace $\a$ vzhledem k~bázi~$(V)$. Existence báze $(B)$ takové, ¾e
matice transformace $\a$ vzhledem k ní je $\D$, je ekvivalentní s~platností
vztahu $\A=\P\D\P^{-1}$, kde $\P$ je matice pøechodu od $(V)$ k $(B)$.
Dále pøi dùkazu tvrzení \uv{právì tehdy kdy¾} pou¾ijeme v jednom smìru
vìtu\cite[AjeD]. V druhém smìru pou¾ijeme vìtu\cite[vPjsouvvektory] a
skuteènost, ¾e matice pøechodu $\P$ obsahuje ve sloupcích 
souøadnice báze $(B)$ vzhledem k bázi $(V)$.

\poznamka
%%%%%%%%%
Pøi práci s lineární transformací se nìkdy hodí zvolit takovou bázi, ve
které je matice této transformace \uv{co nejbli¾¹í} matici diagonální. 
Právì vyslovená vìta øíká, ¾e za jistých okolností lze zvolit bázi, 
vzhledem ke které je matice transformace pøímo diagonální. 
Pak mù¾eme na danou transformaci pohlí¾et jen jako na transformaci
zmìny mìøítka ($\lambda_1$ krát první souøadnice, $\lambda_2$ krát
druhá souøadnice, atd. a¾ $\lambda_n$ krát poslední souøadnice). 

\poznamka
%%%%%%%%%
Nech» dimenze $L$ je rovna $n$ a vra»me se k pøedstavì vlastních
vektorù jako smìrových vektorù pøímek, které
lineární transformace nechává beze zmìny (viz motivaèní pøíklady
v úvodu této kapitoly).
Povede-li se najít $n$ rùzných pøímek, které transformace $\a$ ponechává 
beze zmìny, pak jejich smìrové vektory tvoøí bázi, vzhledem ke které
má transformace $\a$ diagonální matici.

\shrnuti
%%%%%%%%
Definovali jsme vlastní èíslo a vlastní vektory 
transformace\lcite[dvl]. Vlastní vektor je smìrový vektor pøímky, kterou 
nechává transformace beze zmìny a vlastní èíslo je koeficient zmìny
mìøítka ve smìru vlastního vektoru. Vlastní èíslo
transformace je vlastním èíslem ka¾dé její matice, tøeba¾e jsou to
matice vzhledem k rùzným bázím~/\ncite[dvA],~\ncite[vlavlA]/.

Vlastní èísla poèítáme jako koøeny chrakteristického polynomu 
$\det(\A-\lambda\E)$\lcite[chpolynom].

Dvì matice stejné transformace vzhledem k rùzným bázím se nazývají
podobné\lcite[dpodobnost]. Mají stejný charakteristický 
polynom\lcite[vlcisloPAP].

Podobnost s diagonální maticí je zaruèena pro matice se
vzájemnì rùznými vlastními èísly\lcite[zarukapodobnosti].
Ov¹em i nìkteré matice s násobnými vlastními èísly jsou podobné 
s diagonální, ale ne v¹echny.

Je-li $\D$ diagonální matice, se kterou je podobná matice $\A$, pak
$\D$ obsahuje vlastní èísla matice $\A$ a sestavíme-li do sloupcù
matice $\P$ vlastní vektory odpovídající vlastním èíslùm $\A$, pak
$\A=\P\D\P^{-1}$.



\icviceni 7

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\kapitola [skalsoucin] Lineární prostory se skalárním souèinem |
                       Linearni prostory se skalarnim soucinem
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\poznamka
%%%%%%%%%
Lineární prostor je libovolná mno¾ina, na které je definováno sèítání
a násobení konstantou tak, aby byly splnìny vlastnosti~(1) a¾~(7)
z~definice\cite[dlp]. Pokud na takové mno¾inì navíc definujeme násobení
prvkù {\it mezi sebou\/} tak, ¾e výsledek násobení je reálné èíslo a
násobení splòuje ní¾e uvedené vlastnosti~(1) a¾~(4), definovali jsme
na lineárním prostoru skalární souèin. Ten nám umo¾ní pracovat s~novými
vlastnostmi prvkù lineárního prostoru, jako je jejich velikost a úhel
mezi dvìma prvky.

\okraj Definice\hb skalárního\hb souèinu | Definice skalarniho soucinu

\definice* [dlpss]
%%%%%%%%%
Nech» $L$ je lineární prostor. Operaci $\cdot: L\times L\to \R$
nazveme {\em skalárním souèinem}, pokud splòuje $\forall\vec x\in L$,
$\forall\vec y\in L$, $\forall \vec z\in L$, 
$\forall \alpha\in\R$ následující vlastnosti
$$
  \eqalign{
  \bod (1) \vec x\cdot\vec y = \vec y\cdot\vec x, \cr
  \bod (2) (\vec x + \vec y)\cdot \vec z =
            \vec x\cdot\vec z + \vec y\cdot\vec z, \cr
  \bod (3) (\alpha\cdot\vec x)\cdot\vec y = \alpha\cdot(\vec x\cdot\vec y), \cr
  \bod (4) \vec x\cdot\vec x \geq 0, \quad 
           \vec x\cdot\vec x = 0 \hbox{ jen tehdy, kdy¾ } \vec x = \vec o. }
$$
Ve vlastnosti (4) znaèí symbol $\vec o$ nulový vektor lineárního 
prostoru~$L$.
\inl[axiomy: skalárního souèinu, souèin: skalární, skalární: souèin]

Lineární prostor $L$, na kterém je definován skalární souèin,
nazýváme {\em lineárním prostorem se skalárním souèinem}.
\inl[prostor: se skalárním souèinem]

\poznamka
%%%%%%%%%
Je tøeba rozli¹ovat mezi podobnì znìjícími pojmy \uv{skalární násobek}
a~\uv{skalární souèin}. Skalární násobek 
$\cdot:\R\times L\to L$ je násobek vektoru reálným
èíslem, který je definován v ka¾dém lineárním prostoru. Na druhé
stranì skalární souèin 
$\cdot:L\times L\to\R$ je souèin vektorù mezi sebou.

\poznamka
%%%%%%%%%
Upozoròujeme, ¾e stejnì jako v definici lineárního prostoru\cite[dlp],
jsou ve vlastnostech~(1) a¾~(4) definice skalárního souèinu pou¾ívány 
symboly~\uv{$+$} a~\uv{$\cdot$} v rùzných významech podle toho, jakého
typu jsou jejich operandy. Napøíklad první~\uv{$+$} ve vlastnosti~(2)
oznaèuje sèítání vektorù podle definice lineárního prostoru, zatímco
druhé~\uv{$+$} v této vlastnosti je sèítáním reálných èísel. 
Nebo první symbol~\uv{$\cdot$} ve vlastnosti~(3)
znamená skalární násobek definovaný v~lineárním prostoru~$L$,
druhý symbol~\uv{$\cdot$} oznaèuje skalární souèin. Tøetí 
symbol~\uv{$\cdot$} ve vlastnosti~(3) je souèin reálných èísel a
poslední symbol~\uv{$\cdot$} v~této vlastnosti znovu znamená skalární
souèin.

Dále pøipomínáme, ¾e budeme symbol~\uv{$\cdot$} jako dosud èasto
vynechávat, tak¾e místo $\vec x\cdot\vec y$ budeme 
struènì psát $\vec x\vec y$.

\poznamka [complss]
%%%%%%%%%
V¹imneme si, ¾e jsme v definici\cite[dlp] lineárního prostoru
definovali tento prostor \uv{nad reálnými èísly}, proto¾e jsme
definovali násobek vektoru {\it reálným èíslem}.  Nic nám ale
nebránilo zcela stejnì definovat násobek vektoru komplexním èíslem.
A¾ dosud jsme mohli nahradit slovo \uv{reálné èíslo} slovem
\uv{komplexní èíslo} a na¹e teorie by zùstala platná. V¹echny
pøedchozí vìty by nadále platily.

Kdybychom ale chtìli definovat skalární souèin jako komplexní èíslo,
museli bychom upravit vlastnost~(1) definice\cite[dlpss] takto:
$$
  (1)\quad \vec x\vec y = \overline{\vphantom{i}\vec y\vec x},
$$
kde pruh nad komplexním èíslem $\vec y\vec x$ znaèí komplexnì sdru¾ené
èíslo. Nìkterá tvrzení se tedy budou v~pøípadì komplexního skalárního
souèinu nepatrnì li¹it od tvrzení, která ní¾e doká¾eme. Proto¾e se
vìt¹ina ètenáøù tohoto textu nachází zatím v~prvním semestru a nemá za
sebou analýzu komplexních èísel, zjednodu¹íme si ¾ivot tím, ¾e
zùstaneme u~reálných èísel. Pro odvození dùle¾itých vlastností
lineárních prostorù se skalárním souèinem nám to bude staèit.
Zájemce o dùsledky definice komplexního skalárního souèinu
odká¾eme napøíklad na uèebnici\bcite[bican].

\veta [nulaxx]
%%%%%
Nech» $L$ je lineární prostor se skalárním souèinem, $\vec o$ je jeho
nulový vektor. Pak pro v¹echna $\vec x\in L$, $\vec y\in L$ a 
$\vec z\in L$ platí: (1) $\vec x\cdot\vec o = \vec o\cdot\vec x = 0$,
(2) $\vec z\cdot(\vec x + \vec y) = \vec z\vec x + \vec z\vec y$.

\dukaz
%%%%%%
První vlastnost plyne z vlastnosti~(7) definice lineárního 
prostoru\cite[dlp] a z vlastnosti~(3) definice skalárního 
souèinu\cite[dlpss]. Platí 
$(0\vec y)\cdot\vec x = 0\cdot\vec x\vec y = 0$

Druhá vlastnost plyne z komutativity skalárního souèinu, 
tj.~z~vlastnosti~(1) definice\cite[dlpss] a dále 
z~vlastnosti~(2) této definice.

\okraj Skalární\hb souèiny na~$\R^n$ | Skalarni souciny na Rn

\priklad [stss]
%%%%%%%%
Pro $\vec x\in\R^n$, $\vec y\in\R^n$, 
$\vec x = (x_1, x_2, \ldots, x_n)$, 
$\vec y = (y_1, y_2, \ldots, y_n)$ definujme
$$
  \vec x\cdot\vec y = x_1 y_1 + x_2 y_2 + \cdots + x_n y_n.
  \rce(stss)
$$
Uká¾eme, ¾e takto definovaný souèin vektorù $\vec x$ a $\vec y$ je
skalárním souèinem. Je $\vec x\cdot\vec y\in\R$. Nech» je¹tì
$\vec z\in\R^n$, $\vec z = (z_1, z_2, \ldots, z_n)$ a $\alpha\in\R$.
Ovìøíme postupnì vlastnosti~(1) a¾ (4):
$$
  \eqalign{
  \bod (1) \vec x\cdot \vec y = x_1 y_1 + x_2 y_2 + \cdots + x_n y_n =
           y_1 x_1 + y_2 x_2 + \cdots + y_n x_n = \vec y\cdot\vec x, \cr
  \bod (2) (\vec x+\vec y)\cdot \vec z =
           (x_1+y_1)\,z_1 + (x_2+y_2 )\,z_2 + \cdots + 
           (x_n+y_n)\,z_n = \cr
  &\qquad\qquad  = x_1 z_1 + x_2 z_2 + \cdots + x_n z_n +
                   y_1 z_1 + y_2 z_2 + \cdots + y_n z_n =
           \vec x\cdot\vec z + \vec y\cdot\vec z, \cr
  \bod (3) (\alpha\cdot\vec x)\cdot\vec y =
           \alpha x_1 y_1 + \alpha x_2 y_2 + \cdots + \alpha x_n y_n =
           \alpha\,(x_1 y_1 + x_2 y_2 + \cdots + x_n y_n) =
           \alpha\,(\vec x\cdot\vec y), \cr
  \bod (4) \vec x\cdot\vec x = x_1^2 + x_2^2 + \cdots + x_n^2 \geq 0.
  }
$$
Vidíme, ¾e z~$x_1^2 + x_2^2 + \cdots + x_n^2 = 0$ plyne 
$x_1 = x_2 = \cdots = x_n = 0$, tak¾e  je splnìna i druhá èást
vlastnosti~(4). 

Skalární souèin na $\R^n$ definovaný vzorcem\cite(stss) nazýváme
{\em standardním skalárním souèinem}. 
Následující pøíklady ukazují, ¾e existují i jiné skalární 
souèiny na $\R^n$.
\inl[standardní: skalární souèin, skalární: souèin: standardní]

\priklad [nssnaR2]
%%%%%%%%
Definujme souèin na $\R^2$ takto
$$
  (x_1, x_2) \cdot (y_1, y_2) = x_1 y_1 + 6 x_2 y_2 + 
                                2 x_1 y_2 + 2 x_2 y_1.
$$
Uká¾eme, ¾e takto definovaný souèin je skalárním souèinem na $\R^2$.

Ovìøíme vlastnosti (1) a¾~(4) definice\cite[dlpss]
$$
  \eqalign{
  \bod (1) (x_1, x_2) \cdot (y_1, y_2) = 
          x_1 y_1 + 6 x_2 y_2 + 2 x_1 y_2 + 2 x_2 y_1 = \cr
  &\qquad\qquad = y_1 x_1 + 6 y_2 x_2 + 2 y_1 x_2 + 2 y_2 x_1 =
          (y_1, y_2)\cdot (x_1, x_2), \cr
  \bod (2) \bigl( (x_1, x_2)+(y_1, y_2) \bigr) \cdot (z_1, z_2) =
          (x_1+y_1)\,z_1 + 6 (x_2+y_2)\,z_2 + 
          2(x_1+y_1)\,z_2 + 2(x_2+y_2)\,z_1 = \cr
  &\qquad\qquad = x_1 z_1 + 6 x_2 z_2 + 2 x_1 z_2 + 2 x_2 z_1 +
          y_1 z_1 + 6 y_2 z_2 + 2 y_1 z_2 + 2 y_2 z_1 = \cr
  &\qquad\qquad = (x_1, x_2) \cdot (z_1, z_2) + (y_1, y_2) \cdot (z_1,z_2), \cr
  \bod (3) \bigl (\alpha\,(x_1,x_2)\bigr) \cdot (y_1, y_2) =
          (\alpha\,x_1, \alpha\,x_2) \cdot (y_1, y_2) =
          \alpha x_1 y_1 + 6\alpha x_2 y_2 + 
          2 \alpha x_1 y_2 + 2\alpha x_2 y_1 = \cr
  &\qquad\qquad = \alpha\,(x_1 y_1 + 6 x_2 y_2 + 2 x_1 y_2 + 2 x_2 y_1) =
          \alpha\,\bigl( (x_1, x_2) \cdot (y_1, y_2) \bigr), \cr
  \bod (4) (x_1, x_2)\cdot(x_1, x_2) = x_1^2 + 6 x_2^2 + 4 x_1 x_2 
          \buildrel ? \over \geq 0.
  }  
$$
Abychom dokázali vlastnost (4), potøebujeme pro $x_1\not=0$,
$x_2\not=0$ dokázat, ¾e $x_1^2 + 6 x_2^2 + 4 x_1 x_2 > 0$.
Nech» $a=x_2/x_1$, tj. $x_2 = a x_1$. Po dosazení je
$x_1^2 + 6 a^2 x_1^2 + 4 a x_1^2 = x_1^2 (1 + 6a^2 + 4a)$. Aby byl
daný výraz vìt¹í ne¾ nula, staèí aby $6a^2 + 4a + 1 > 0$, 
$\forall a\in\R$. Proto¾e diskriminant této kvadratické nerovnice 
je roven $D=16-24 = -8 < 0$, je nerovnost $6a^2 + 4a + 1 > 0$ splnìna
pro v¹echna $a\in\R$.

\priklad
%%%%%%%%
Uká¾eme, ¾e pøedpis 
$(x_1, x_2) \circ (y_1, y_2) = x_1 y_1 + 2 x_2 y_2 + 2 x_1 y_2 + 2 x_2 y_1$
není skalárním souèinem. Vlastnosti~(1) a¾~(3) jsou zøejmì splnìny.
Není splnìna vlastnost~(4), proto¾e napøíklad
$$
  (-1,1)\circ (-1,1) = 1 + 2 - 2 - 2 = -1 \not> 0.
$$


\okraj Symetrické a pozitivnì definitní\hb matice |
       Symetricke a pozitivne definitni matice

\poznamka
%%%%%%%%%
Vý¹e uvedené pøíklady nás vedou k otázce, jak charakterizovat v¹echny
skalární souèiny na $\R^n$ a jak je rychle poznat. Souvisí to 
s~tzv.~pozitivnì definitními a symetrickými maticemi. 
%Tato látka není
%obsahem tohoto semestru, nebyla odpøedná¹ena a nebudu ji ani zkou¹et.
Ní¾e uvádím nejdùle¾itìj¹í výsledky z~této oblasti jen pro
ètenáøe, který chce být lépe informován. Nám ostatním bude v~dal¹ím textu
staèit existence standardního skalárního souèinu na $\R^n$ a povìdomí,
¾e existují i jiné skalární souèiny. Téma symetrických a
pozitivnì definitních matic je mo¾no pøeskoèit a vìnovat se rovnou
definici velikosti vektoru\cite[velikost].

%Pokud vás téma symetrických a
%pozitivnì definitních matic v tuto chvíli více nezajímá, raète
%pøeskoèit následující dvì definice a vìtu a vìnujte se rovnou definici
%velikosti vektoru.

\definice [symmat]
%%%%%%%%%
Ètvercová matice $\A\in\R^{n,n}$ je {\em symetrická}, pokud platí
$\A^T = \A$.
\inl[matice: symetrická, symetrická: matice]

\definice [posdefmat]
%%%%%%%%%
Nech» $\A\in\R^{n,n}$ je ètvercová matice.
Oznaème $\A_i\in\R^{n-i,n-i}$ ètvercovou matici, která 
vzniká z~matice $\A$ vynecháním posledních $i$ øádkù a posledních
$i$ sloupcù. Matice $\A$ se nazývá {\em pozitivnì definitní}, 
pokud v¹echny determinanty $\det\A_i$, $i\in\{0,1,2,\ldots,n-1\}$ 
jsou kladné.
\inl[matice: pozitivnì definitní, pozitivnì definitiní: matice]

\poznamka
%%%%%%%%%
Pozitivnì definitní matice je v¾dy regulární, proto¾e 
$\det\A = \det\A_0 > 0$.

\veta [maticesoucinuRn]
%%%%%
Nech» $\A\in\R^{n,n}$ je ètvercová matice.
Definujme souèin na $\R^n$ takto. Pro $\vec x\in\R^n$, 
$\vec y\in\R^n$ je
$$
  \vec x\cdot\vec y = \vec x\cdot\A\cdot\vec y^T,
$$
kde na pravé stranì rovnosti je maticový souèin jednoøádkové matice 
$\vec x$, která obsahuje slo¾ky vektoru~$\vec x$,
s maticí $\A$ a s maticí $\vec y^T$, co¾
je sloupec slo¾ek vektoru $\vec y$.

Pak $\vec x\cdot\vec y$ je skalárním souèinem právì tehdy, kdy¾
$\A$ je symetrická a pozitivnì definitní matice.

\dukaz
%%%%%%
Uvedeme jen struèný náznak. Pro vlastnost~(1) skalárního 
souèinu je nutná symetrie matice~$\A$. Vlastnost~$(2)$ a $(3)$
je zaruèena pro jakoukoli ètvercovou matici~$\A$. Koneènì
vlastnost~$(4)$ je zaruèena díky tomu, ¾e matice~$\A$ je pozitivnì 
definitní.
Na oprávnìnou otázku \uv{proè} zde máme malý prostor pro odpovìï.
Odkazujeme napøíklad na uèebnici\bcite[bican].

\priklad
%%%%%%%%
Vra»me se k~pøíkladu\cite[nssnaR2]. Tam je skalární souèin definován
takto:
$$
  \vec x\cdot\vec y = (x_1, x_2)\cdot\matice{1&2\cr2&6}\cdot
                                \matice{y_1\cr y_2}.
$$
Proto¾e pro uvedenou matici platí $\A=\A^T$, jedná se o symetrickou
matici. Spoèteme dále jednotlivé determinanty:
$\det\A_0=\det\A=2$, $\det\A_1=\det(1)=1$. Proto¾e oba determinanty
jsou kladná èísla, jedná se o~pozitivnì definitní matici. Podle 
vìty\cite[maticesoucinuRn] je definovaný souèin skalárním souèinem.


\okraj Velikost\hb vektoru | Velikost vektoru

\poznamka
%%%%%%%%%
Budeme definovat velikost vektoru a úhel mezi dvìma nenulovými
vektory na obecných lineárních prostorech se skalárním souèinem. 
Tyto pojmy definujeme jen pomocí skalárního
souèinu pro zcela libovolné vektory. 
V následující kapitole uká¾eme, ¾e pokud
budeme pracovat s~vektory s~geometrickým významem 
(napø.~s~orientovanými úseèkami), pak pojmy velikost a úhel nyní 
zavedené abstraktnì budou znamenat pøesnì to, co od nich
z~geometrického hlediska oèekáváme. 
%Toto jsou docela názorné geometrické pojmy a souvislost
%tìchto pojmù s tím, na co jsme zvyklí z geometrie, uká¾eme 
%podrobnìji a¾ v následující kapitole. 

\definice* [velikost]
%%%%%%%%%
Nech» $L$ je lineární prostor se skalárním souèinem. Pro
$\vec x\in L$ definujeme {\em velikost vektoru~$\vec x$} hodnotou
$\sqrt{\vec x\cdot\vec x}$. Velikost vektoru $\vec x$ znaèíme
$\|\vec x\|$, tak¾e je
$$
  \|\vec x\| = \sqrt{\vec x\cdot\vec x}, \qquad \hbox{tj. }\
  \|\vec x\|^2 = \vec x\cdot\vec x.
$$ 
Místo pojmu \uv{velikost vektoru} se èasto pou¾ívá pojem 
{\em norma vektoru}\ifbook, viz té¾ definici\cite[dnorma]\fi.
\inl[velikost: vektoru, norma, 0normx]

\poznamka [poznvelikost]
%%%%%%%%%
Vidíme, ¾e velikost je nezáporné èíslo a ¾e
ka¾dý vektor má svou velikost. To nám zaruèuje
vlastnost~(4) definice\cite[dlpss]. Je $\vec x\cdot\vec x\geq0$, tak¾e
odmocnina z~tohoto èísla je definována.

Dále vidíme, ¾e jedinì nulový vektor má velikost rovnu nule a ¾ádný
jiný. To nám zaruèuje druhá èást vlastnosti~(4).

\veta [absvelikost]
%%%%%
Nech» $\vec x$ je prvkem lineárního prostoru se skalárním souèinem,
$\alpha\in\R$. Pak 
$$
  \|\alpha\,\vec x\| = |\alpha|\cdot\|\vec x\|.
$$

\dukaz
%%%%%%
$\|\alpha\,\vec x\| = 
\sqrt{\vphantom{{}^2}(\alpha\,\vec x)\cdot(\alpha\,\vec x)}
= \sqrt{\alpha^2\,\vec x\cdot\vec x} = 
\sqrt{\alpha^2} \cdot \sqrt{\vec x\cdot\vec x\vphantom{{}^2}} = 
|\alpha|\cdot\|\vec x\|$.

\okraj Úhel dvou vektorù | Uhel dvou vektoru

\definice* [uhel]
%%%%%%%%%
Nech» $L$ je lineární prostor se skalárním souèinem
a $\vec x\in L$, $\vec y\in L$, $\vec x\not=\vec o$,
$\vec y\not=\vec o$. Pak {\em úhel mezi vektory
$\vec x$ a $\vec y$} je takové èíslo~$\phi\in\langle0,\pi)$, pro které platí
$$
  \cos\phi = {\vec x\cdot\vec y \over \|\vec x\|\cdot\|\vec y\|}.
  \rce(uhel)
$$
\par\inl[úhel: vektorù]

\poznamka
%%%%%%%%%
Zabývejme se otázkou, zda ka¾dé dva nenulové vektory mají
definován úhel mezi sebou. Pøedev¹ím podle poznámky\cite[poznvelikost]
platí, ¾e $\|\vec x\|\not=0$, $\|\vec y\|\not=0$, proto¾e 
$\vec x\not=\vec o$, $\vec y\not=\vec o$. Tak¾e se ve 
zlomku z~rovnosti\cite(uhel) nedìlí nulou.

Aby existovalo $\phi$ takové, ¾e platí\cite(uhel), musí platit
$$
  -1 \leq {\vec x\cdot\vec y \over \|\vec x\|\cdot\|\vec y\|} \leq 1.
$$ 
Tento po¾adavek zaruèuje následující vìta.

\veta (Schwartzova nerovnost) * [schwartz]
%%%%%
Nech» $L$ je lineární prostor se skalárním souèinem a 
$\vec x\in L$, $\vec y\in L$. Pak platí: 
$$
  |\vec x\cdot\vec y| \leq \|\vec x\|\cdot\|\vec y\|.
  \rce(schwartz)
$$
\par\inl[nerovnost: Schwartzova, Schwartzova: nerovnost]

\dukaz
%%%%%%
Nech» $\alpha\in\R$. Násobme sám se sebou vektor $\vec x-\alpha\,\vec y$.
Podle vlastnosti~(4) definice\cite[dlpss] je
$$
  0\leq (\vec x-\alpha\,\vec y)\cdot(\vec x-\alpha\,\vec y) =
  \vec x\cdot\vec x - \alpha\cdot 2(\vec x\cdot\vec y) + 
  \alpha^2\cdot (\vec y\cdot\vec y) .
$$
V úpravách jsme pou¾ili vlastnosti~(2) a~(3) definice\cite[dlpss].
Oznaème $A=\vec y\cdot\vec y = \|\vec y\|^2$, 
$B=-2(\vec x\cdot\vec y)$, 
$C=\vec x\cdot\vec x= \|\vec x\|^2$. Dostáváme
$$
  0\leq A\,\alpha^2 + B\,\alpha + C .
$$
Tato nerovnost musí platit pro v¹echna $\alpha\in\R$. 
Diskriminant této kvadratické nerovnice tedy nesmí být kladný.
Z toho nám vyplývá podmínka pro èísla $A,B,C$:
$$
  \displaylines{
  B^2 - 4AC \leq 0,  
  \quad \hbox{tj.}\quad B^2 \leq 4AC,
  \quad \hbox{tj.}\quad \bigl(-2(\vec x\cdot\vec y)\bigr)^2 \leq 
       4\, \|\vec x\|^2 \|\vec y\|^2, \cr 
  \hbox{tj.}\quad 
       {(-2)^2}\, {(\vec x\cdot\vec y)^2} \leq 
       {4\, \|\vec x\|^2 \|\vec y\|^2},
  \quad \hbox{tj.}\quad
       \sqrt{(\vec x\cdot\vec y)^2} \leq 
       \sqrt{\|\vec x\|^2} \sqrt{\|\vec y\|^2}
 \quad \hbox{tj.}\quad 
       |\vec x\cdot\vec y| \leq \|\vec x\|\cdot\|\vec y\|.
 }
$$

\okraj Vzdálenost vektorù | Vzdalenost vektoru

\definice [vzdalenost]
%%%%%%%%%
Nech» $L$ je lineární prostor se skalárním souèinem. {\em Vzdálenost
vektoru $\vec x$ od vektoru $\vec y$} definujeme jako 
$\|\vec y-\vec x\|$. Podle vìty\cite[absvelikost] je 
$\|\vec y-\vec x\|=\|\vec x-\vec y\|$, tak¾e èasto mluvíme 
o {\em vzdálenosti dvou vektorù $\vec x$ a $\vec y$\/} (bez závislosti
na jejich poøadí).
\inl[vzdálenost: vektorù]

\veta (trojúhelníková nerovnost) * [trojnerovnost]
%%%%%
Pro velikosti vektorù platí 
$$
  \|\vec x+\vec y\| \leq \|\vec x\|+\|\vec y\|.
  \rce(trojnerovnost)
$$
\par\inl[nerovnost: trojúhelníková, trojúhelníková: nerovnost]

\dukaz
%%%%%%
$
  \|\vec x + \vec y\|^2 = (\vec x+\vec y)\cdot(\vec x+\vec y) =
  \vec x\,\vec x + 2\,\vec x\,\vec y + \vec y\,\vec y
  \leq \|\vec x\|^2 + 2\,\|\vec x\|\cdot\|\vec y\| + \|\vec y\|^2 =
  \bigl(\|\vec x\| + \|\vec y\|\bigr)^2
$.
Ve~výpoètu jsme pou¾ili Schwartzovu nerovnost\cite[schwartz]. Po
odmocnìní dostáváme dokazovanou nerovnost.

\poznamka
%%%%%%%%%
Vysvìtlíme si, proè se dokázaná nerovnost nazývá
trojúhelníková. Tu nìkteøí ètenáøi znají geometricky formulovanou
tøeba takto: souèet délek dvou stran v trojúhelníku je v¾dy vìt¹í ne¾
délka strany tøetí. Nech» vektory $\vec a$, $\vec b$ a $\vec c$ jsou prvky
lineárního prostoru se skalárním souèinem a pøedstavme si je jako 
vrcholy pomyslného trojúhelníka. Velikost stran je toté¾ jako 
vzdálenost odpovídajících vektorù. Geometrické tvrzení o velikostech stran
trojúhelníka tedy mù¾eme pomocí definice\cite[vzdalenost] pøepsat
takto:
$$
  \|\vec a-\vec b\| \leq \|\vec a-\vec c\| + \|\vec c-\vec b\|.
$$
Pøi volbì $\vec x = \vec a-\vec c$, $\vec y = \vec c-\vec b$
pøechází uvedená nerovnost na tvar\cite(trojnerovnost).

\priklad
%%%%%%%%
Uva¾ujme lineární prostor $\R^4$ se standardním skalárním 
souèinem\cite(stss). Uká¾eme, jak vypadá velikost vektoru
$(1,2,3,4)$ a jaký je úhel mezi vektory $(1,2,3,4)$ a $(1,0,0,2)$.

Podle definice\cite[velikost] a podle\cite(stss) je
$$
  \bigl\| (1,2,3,4) \bigr\| = \sqrt{ (1,2,3,4)\cdot(1,2,3,4) }
  = \sqrt { 1^2+2^2+3^2+4^2 } = \sqrt {30}.
$$
Podle definice\cite[uhel] platí pro úhel $\phi$ následující rovnost:
$$
  \cos\phi = { (1,2,3,4)\cdot(1,0,0,2) \over 
              \bigl\|(1,2,3,4)\bigr\| \cdot \bigl\|(1,0,0,2)\bigr\|} =
             { 1+0+0+4\cdot2 \over \sqrt{30}\cdot\sqrt{1+4} } =
             { 9 \over \sqrt{150} }, \quad \hbox{tj.}\quad
  \phi = \arccos { 9 \over \sqrt{150} }.
$$

\priklad [elemsloz]
%%%%%%%%
Oznaème symbolem $U_O$ mno¾inu orientovaných úseèek v rovinì se
spoleèným poèátkem~$O$. Uká¾eme, ¾e ka¾dá lineární transformace 
$\a: U_O\to U_O$ je rovna slo¾ení koneènì mnoha otoèení a zmìny mìøítka.

Je-li $\hod\a = 0$, pak transformace v¹e zobrazí do nulového vektoru.
Takovou transformaci zapí¹eme jako zmìnu mìøítka s koeficienty $0,0$.

Je-li $\hod\a=1$, pak transformace $\a$ je projekce. Jádrem zobrazení
jsou vektory v jedné pøímce. Aplikujme otoèení, které zajistí, ¾e tato
pøímka se kryje s první souøadnicovou osou. Pak aplikujeme zmìnu
mìøítka s koeficientem $0,r$ (jak zvolit parametr $r$ je popsáno ní¾e). 
Nakonec druhou souøadnicovou osu otoèíme tak, aby se kryla s $\a(U_O)$.

Je-li $\hod\a=2$, pak dva na sebe kolmé bázové vektory s jednotkovou
velikostí se zobrazí na dva lineárnì nezávislé vektory 
$\vec b_1', \vec b_2'$. Pokusíme se tyto vektory transformovat zpìt
pomocí otoèení a zmìny mìøítka na pùvodní bázové vektory. Tím popí¹eme
$\a^{-1}$. Proto¾e inverze k otoèení je otoèení a inverze ke zmìnì
mìøítka s nenulovými koeficienty je zmìna mìøítka, je mo¾né zapsat
jako slo¾ení tìchto transformací i pùvodní transformaci $\a$.

Nejprve aplikujeme otoèení, které zpùsobí, ¾e del¹í z vektorù
$\vec b_1', \vec b_2'$ se kryje s první souøadicovou osou. Pak
aplikujeme zmìnu mìøítka s koeficienty $1,t$, která nemìní del¹í z
vektorù. Parametr $t$ volíme tak, aby po zmìnì mìøítka mìl
(pùvodnì) krat¹í vektor stejnou velikost, jako jeho del¹í brá¹ka. Dále provedeme
otoèení tak, aby osa úhlu tìchto vektorù se kryla s první osou.
Poté provedeme zmìnu mìøítka s parametry $u,1$, aby sledované 
vektory byly na sebe kolmé. Dále otoèíme tyto vektory tak, aby se
kryly s osami a nakonec provedeme zmìnu mìøítka tak, aby mìly
jednotkovou velikost.  

Jak zvolíme parametr $r$? Zvolme vektor $\vec w$, který le¾í v $\a(U_O)$ a má
jednotkovou velikost. Jeho obraz $\a(\vec w)$ také le¾í na pøímce
$\a(U_O)$, tak¾e platí $\a(\vec w) = r\,\vec w$. Parametr $r$ je tedy
velikost obrazu $\a(\vec w)$.
 
Jak zvolíme paramter $t$? Nech» del¹í vektor má velikost $v$
a krat¹í vektor má souøadnice $(a,b)$ vzhledem k bázi $(B)$.
Po zmìnì mìøítka má tento vektor souøadnice $(a,tb)$ a má tedy
velikost $\sqrt{a^2+t^2b^2}$, co¾ se musí rovnat $v$. Tak¾e
$$
  a^2+t^2b^2 = v^2, \qquad t^2b^2 = v^2-a^2, \quad
  t = \sqrt{v^2-a^2\over b^2}.
$$
Èíslo $v^2-a^2$ je zaruèenì nezáporné, proto¾e $v^2$ je vìt¹í
ne¾ $a^2+b^2$. Èíslo $b$ je nenulové, proto¾e vektory jsou
lineárnì nezávislé.

Jak zvolíme parametr $u$? 
Nech» $\vec b_1''$ má souøadnice $(a,b)$
vzhledem k bázi $(B)$ a vektor $\vec b_2''$ má souøadnice $(a,-b)$
vzhledem ke stejné bázi. Po zmìnì mìøítka s parametry $u,1$ budou mít
tyto vektory souøadnice $(ua,b)$, $(ua,-b)$. Mají být na sebe kolmé,
tedy skalární souèin tìchto vektorù má být nulový:
$$
  (ua,b)\cdot(ua,-b) = u^2a^2-b^2 = 0, \quad
  \hbox{tak¾e} \quad
   u^2a^2 = b^2, \quad u = {b\over a}.
$$




\priklad [sskonv]
%%%%%%%%
Nech» $L$ je lineární prostor spojitých funkcí definovaných
na koneèném uzavøeném intervalu~$D\subseteq\R$. Uká¾eme, ¾e pøedpis
$$
  \def\dx{{\,\rm d}x}
  f\cdot g = \int_D f(x)\,g(x)\dx
$$
definuje skalární souèin na lineárním prostoru $L$. Ovìøíme
vlastnosti~(1) a¾~(4). Nech» $f\in L$, $g\in L$, $h\in L$ a 
$\alpha\in\R$. Pak platí
$$
  \def\dx{{\,\rm d}x}
  \eqalign{
  \bod (1) f\cdot g = \int_D f(x)\,g(x)\dx = \int_D g(x)\,f(x)\dx =
           g\cdot f, \cr
  \bod (2) (f+g)\cdot h = \int_D \bigl(f(x)+g(x)\bigr)\,h(x)\dx =
           \int_D \bigl(f(x)\,h(x) + g(x)\,h(x)\bigr)\dx = \cr
  &\hskip6em = \int_D f(x)\,h(x)\dx + \int_D g(x)\,h(x)\dx = 
           f\cdot h + g\cdot h, \cr
  \bod (3) (\alpha f)\cdot g = \int_D \alpha f(x)\,g(x)\dx =
           \alpha\cdot\int_D f(x)\,g(x)\dx = \alpha\,(f\cdot g), \cr
  \bod (4) f\cdot f = \int_D f^2(x) \dx \geq 0, \cr
  &\hskip6em   \int_D f^2(x)\dx = 0 \quad
           \hbox{jen tehdy, kdy¾ $f(x)=0\;\forall x\in D$, 
                 proto¾e $f$ je spojitá}.
  }
$$
Pøíklad ilustruje, ¾e i na lineárních prostorech nekoneèné dimenze
jsme schopni definovat skalární souèin. Z tohoto skalárního souèinu
odvozená~{\em norma funkce $f$} $\|f\|$, 
\uv{úhel $\phi$ mezi funkcemi~$f$ a $g$} a 
\uv{vzdálenost dvou funkcí~$f$ a~$g$} $\|f-g\|$ se poèítá takto:
$$
  \def\dx{{\,\rm d}x}
  \|f\| = \sqrt{ \int_D f^2(x)\dx }, \quad 
  \phi = \arccos {\int_D f(x)g(x)\dx \over 
         \sqrt {\int_D f^2(x)\dx \int_D g^2(x)\dx}}, \quad
  \|f-g\| = \sqrt{ \int_D \bigl(f(x)-g(x)\bigr)^2\dx }.
$$
\inl[norma: funkce]

\okraj Kolmé\hb vektory | Kolme vektory

\poznamka
%%%%%%%%%
Proto¾e máme na lineárních prostorech se skalárním souèinem definován
úhel mezi nenulovými vektory, mù¾eme pro ka¾dé dva nenulové vektory
rozhodnout, kdy jsou na sebe kolmé. Je to tehdy, kdy¾ je 
$\cos\phi = 0$, neboli $\vec x\cdot\vec y = 0$. Z~toho vyplývá
následující definice.

\definice [kolmost]
%%%%%%%%%
Nech» $L$ je lineární prostor se skalárním souèinem. Dva nenulové
vektory $\vec x\in L$ a $\vec y\in L$ {\em jsou na sebe kolmé\/}
(znaèíme $\vec x \kolmy\vec y$), pokud je $\vec x\cdot\vec y = 0$.
\inl[kolmé: vektory, vektor: kolmý]
\inl[0kolm]

\priklad
%%%%%%%%
(Pythagorova vìta.)
Nech» $\vec x\in L$, $\vec y\in L$ jsou nenulové vektory, které jsou
na sebe kolmé. Pak platí
$$
  \|\vec x\|^2 + \|\vec y\|^2 = \|\vec x-\vec y\|^2.
$$
Zdùvodnìní je jednoduché: 
$ \|\vec x-\vec y\|^2 = (\vec x-\vec y)\cdot(\vec x-\vec y) =
  \vec x\cdot\vec x - 2\vec x\cdot\vec y + \vec y\cdot\vec y =
  \|\vec x\|^2 -2\cdot0 + \|\vec y\|^2 $.
Geometrická interpretace tohoto pøíkladu je následující. Trojúhleník s
vrcholy $\vec o$, $\vec x$ a $\vec y$ je pravoúhlý s~pravým úhlem pøi
vrcholu $\vec o$. Èísla $\|\vec x\|$, $\|\vec y\|$ jsou velikosti odvìsen a
$\|\vec x-\vec y\|$ je velikost pøepony.
\inl[vìta: Pythagotova, Pythagotova: vìta]

\okraj Ortonor\-mální báze | Orthonormalni base

\definice* [ortonormalni]
%%%%%%%%%
Nech» $B=\{\vecc b_n\}$ je báze lineárního prostoru se skalárním souèinem.
Bázi $B$ nazýváme {\em ortogonální}, pokud
$\vec b_i\kolmy\vec b_j$ $\forall i\in\{1,2,\ldots,n\}$, 
$\forall j\in\{1,2,\ldots,n\}$, $i\not=j$.
\inl[báze: ortogonální, ortogonální: báze]

Bázi $B$ nazýváme {\em ortonormální}, pokud je ortogonální, a navíc
$\|\vec b_i\|=1$, $\forall i\in\{1,2,\ldots,n\}$.
\inl[báze: ortonormální, ortonormální: báze]

\veta [ortobase]
%%%%%
Báze $B=\{\vecc b_n\}$ je ortonormální právì tehdy, kdy¾ 
$$
  \vec b_i\cdot\vec b_j = \cases{ 0 \hbox{ pro } i\not=j, \cr 
                                  1 \hbox{ pro } i=j.}
$$

\dukaz
%%%%%%
Báze $B$ je ortonormální právì tehdy, kdy¾ (podle 
definice\cite[ortonormalni]) platí $\vec b_i\cdot\vec b_j = 1$ 
pro $i=j$ a navíc je ortogonální, 
tj.~$\vec b_i\kolmy\vec b_j$ pro $i\not=j$. To podle 
definice\cite[kolmost] znamená, ¾e 
$\vec b_i\cdot\vec b_j=0$ pro $i\not=j$.

\veta* [soucin-dle-souradnic]
%%%%%
Nech» $(B)$ je ortonormální uspoøádaná báze lineárního prostoru~$L$ se
skalárním souèinem. Pak pro v¹echna $\vec x\in L$, $\vec y\in L$,
$\vec x=(x_1,x_2,\ldots,x_n)_{(B)}$, $\vec y=(y_1,y_2,\ldots,y_n)_{(B)}$ 
lze skalární souèin poèítat ze souøadnic vektorù takto:
$$
  \vec x\cdot\vec y = x_1 y_1 + x_2 y_2 + \cdots + x_n y_n.
$$

\dukaz
%%%%%%
Podle pøedpokladu je $\vec x = \lkvecc x.b_n$, $\vec y =\lkvecc y.b_n$.
Poèítejme $\vec x\cdot\vec y$:
$$
  \displaylines{
  \vec x\cdot\vec y = (\lkvecc x.b_n)\cdot(\lkvecc y.b_n) = \cr
  = x_1 y_1\,\vec b_1\cdot\vec b_1 + x_1 y_2\,\vec b_1\cdot\vec b_2 +
  \cdots + x_1 y_n\,\vec b_1\cdot\vec b_n + 
  x_2 y_1\,\vec b_2\cdot\vec b_1 + x_2 y_2\,\vec b_2\cdot\vec b_2 +
  \cdots + x_2 y_n\,\vec b_2\cdot\vec b_n + \cdots +
  x_n y_n\,\vec b_n\cdot\vec b_n = \cr
  = x_1 y_1\cdot1 + x_1 y_2\cdot0 +
  \cdots + x_1 y_n\cdot0 + 
  x_2 y_1\cdot0 + x_2 y_2\cdot1 +
  \cdots + x_2 y_n\cdot0 + \cdots +
  x_n y_n\cdot1 = 
  x_1 y_1 + x_2 y_2 + \cdots + x_n y_n. 
}
$$
V úpravách jsme vyu¾ili vìtu\cite[ortobase] a toho, ¾e báze $B$ je 
ortonormální.

\priklad
%%%%%%%%
Nech» $\R^n$ je lineární prostor se standardním skalárním souèinem
zavedeným v~pøíkladu\cite[stss]. Pak standardní báze
$$
  S = \bigl\{ (1,0,0,\ldots,0), (0,1,0,\ldots,0), \ldots, 
              (0,0,0,\ldots,1) \bigr\}
$$
je ortonormální bází. 

\veta* [kolmeLN]
%%%%%
Nech» $\vecc x_n$ jsou nenulové vektory lineárního prostoru se skalárním
souèinem, které jsou na sebe navzájem kolmé, 
tj. $\vec x_i\cdot \vec x_j= 0$ pro $i\ne j$ a $\vec x_i\cdot \vec x_i>0$.
Pak jsou tyto vektory lineárnì nezávislé.

\dukaz
%%%%%%
Podle definice lineární nezávislosti staèí ovìøit, ¾e z rovnosti
$$
  \alpha_1\cdot\vec x_1+ \alpha_2\cdot\vec x_2+ 
  \cdots+\alpha_n\cdot\vec x_n = \vec o
$$
nutnì plyne, ¾e v¹echna èísla èísla $\alpha_i$ jsou nulová.
Vynásobíme-li obì strany uvedené rovnosti skalárnì vektorem $\vec x_i$,
dostáváme na levé stranì souèet nul s~výjimkou jediného sèítance,
proto¾e vektor $\vec x_i$ je kolmý na v¹echny v¹echny ostatní vektory
$\vec x_j$. Máme tedy
$$
  \alpha_i\,\vec x_i\cdot \vec x_i = \vec o\cdot \vec x_i = 0.
$$
Proto¾e $\vec x_i\cdot \vec x_i$ je nenulové èíslo, musí být $\alpha_i=0$.
Tuto operaci mù¾eme provést pro ka¾dý index $i\in\{1,2,\ldots,n\}$, tak¾e 
v¹echna èísla èísla $\alpha_i$ jsou nutnì nulová.

\veta* [karsouradnice]
%%%%%
Nech» $(B)=(\vecc b_n)$ je ortonormální báze lineárního prostoru se
skalárním souèinem. Pak pro souøadnice libovolného vektoru $\vec x$
platí
$$
  \vec x = (\vec x{\cdot}\vec b_1, \,\vec x{\cdot}\vec b_2, \,\ldots,\,
            \vec x{\cdot}\vec b_n)_{(B)}.
$$

\dukaz
%%%%%%
Oznaème $\vec y=(\vec x\cdot\vec b_1)\,\vec b_1 + 
(\vec x\cdot\vec b_2)\,\vec b_2 + \cdots + 
(\vec x\cdot\vec b_n)\,\vec b_n$. Podle definice souøadnic vzhledem 
k~bázi máme dokázat, ¾e $\vec x=\vec y$. 
Násobme vektor $\vec y$ vektorem $\vec b_i$:
$$
  \vec y\cdot\vec b_i = \bigl((\vec x\cdot\vec b_1)\,\vec b_1 + 
  (\vec x\cdot\vec b_2)\,\vec b_2 + \cdots + 
  (\vec x\cdot\vec b_n)\,\vec b_n\bigr)\cdot\vec b_i =
  (\vec x\cdot\vec b_i)\,\vec b_i\cdot\vec b_i =
  \vec x\cdot\vec b_i,
$$
proto¾e báze $(B)$ je ortonormální. 
Máme tedy výsledek
$\vec x\cdot\vec b_i =\vec y\cdot\vec b_i$
$\forall i \in \{1,2,\ldots,n\}$. 

Vektor $\vec x-\vec y$ je kolmý na v¹echny prvky $\vec b_i$, proto¾e z
pøedchozího výpoètu plyne
$(\vec x-\vec y)\cdot \vec b_i =0$.
Pokud by $\vec x\ne\vec y$, pak podle vìty\cite[kolmeLN] jsou vektory
$\vecc b_n, \vec x-\vec y$ lineárnì nezávislé, ale to je ve sporu 
s tím, ¾e $(B)$ je báze. Musí tedy být $\vec x = \vec y$.

\poznamka
%%%%%%%%%
Pøedchozí vìta má názornou geometrickou interpretaci. Souøadnice
$\vec x\cdot \vec b_i$ jsou vlastnì kolmé prùmìty vektoru $\vec x$ na vektory
báze $\vec b_i$. O tìchto pojmech pohovoøíme podrobnìji v následující
kapitole.

\veta [uhly-k-osam]
%%%%%
Nech» $(B)=(\vecc b_n)$ je ortonormální báze lineárního prostoru se
skalárním souèinem a $\vec x=(x_1,x_2,\ldots,x_n)_{(B)}$ je 
jeho libovolný vektor. Pak úhel
$\phi_i$ mezi vektorem $\vec x$ a vektorem $\vec b_i$ lze poèítat
podle vzorce
$$
  \cos\phi_i = {x_i\over \|\vec x\|}\,.
$$

\dukaz
%%%%%%
Podle definice\cite[uhel] je
$$
  \cos\phi_i = {\vec x\cdot\vec b_i \over \|\vec x\|\,\|\vec b_i\|} =
  {\vec x\cdot\vec b_i \over \|\vec x\|} = {x_i\over \|\vec x\|}\,.
$$
V úpravách jsme vyu¾ili toho, ¾e $\|\vec b_i\|=1$ (báze je ortonormální)
a dále vìty\cite[karsouradnice], podle které je $x_i=\vec x\cdot\vec b_i$.

\poznamka
%%%%%%%%%
Proto¾e je $\|\vec x\|^2 / \|\vec x\|^2 = 1$ a dále je
$\|\vec x\|^2 = x_1^2+x_2^2+\cdots+x_n^2$, plyne 
z vìty\cite[uhly-k-osam] zajímavý dùsledek:
$$
  \cos^2 \phi_1 + \cos^2 \phi_2 + \cdots + \cos^2 \phi_n = 1,
$$
kde $\phi_i$ jsou úhly mezi vektorem $\vec x$ a vektory ortonormální
báze.


\okraj Ortogonali\-zaèní proces | Orthogonalisacni proces

\poznamka
%%%%%%%%%
Je pøirozené se ptát, zda ka¾dý lineární prostor (aspoò koneèné
dimenze) má ortonormální bázi. Vìta\cite[existencebase] ukazuje,
¾e ka¾dý lineární prostor má bázi. Následující vìta ukazuje, ¾e ka¾dá
koneèná báze se dá v~jistém smyslu pozmìnit tak, aby se z~ní stala
ortonormální báze.

\veta (Schmidtùv ortogonalizaèní proces) * [ortogonalizace]
%%%%%
Nech» $\{\vecc b_n\}$ je báze lineárního prostoru~$L$ 
se skalárním souèinem. Pak existuje ortonormální báze
$\{\vecc c_n\}$ taková, ¾e
$$
  \lob<\vecc b_k> = \lob<\vecc c_k>, \qquad 
  \forall  k\in\{1,2,\ldots,n\}.
$$
\par\inl[Schmidtùv: ortogonalizaèní proces, ortogonalizaèní proces: Schmidtùv]

\dukaz
%%%%%%
Nejprve vysvìtlíme ideu dùkazu, která je v tomto pøípadì asi dùle¾itìj¹í
ne¾ podrobné poèítání. Vektor $\vec c_1$ volíme stejný jako $\vec b_1$
jen s tím rozdílem, ¾e jej~\uv{normalizujeme}. To znamená, ¾e jej
násobíme vhodnou konstantou, aby $\|\vec c_1\| = 1$.

Pøedstavme si dále, ¾e u¾ jsme na¹li $\vecc c_k$ takové, ¾e 
$\lob<\vecc b_k> = \lob<\vecc c_k>$, a pøitom vektory $\vecc c_k$ jsou
na sebe vzájemnì kolmé a mají jednotkovou velikost. Vektor 
$\vec b_{k+1}$ nyní~\uv{ortogonalizujeme}, tj. upravíme tak, aby byl
kolmý na v¹echny vektory z~$\lob<\vecc c_k>$. Uká¾eme pozdìji, ¾e 
k~tomu úèelu staèí od vektoru $\vec b_{k+1}$ odeèíst urèitou lineární
kombinaci vektorù $\vecc c_k$. Takto upravený vektor
dále~\uv{normalizujeme}, tj. vynásobíme vhodnou konstantou, aby
$\|\vec c_{k+1}\| = 1$. Tím se jeho kolmost vùèi ostatním vektorùm
z~$\lob<\vecc c_k>$ nepokazí. Proto¾e vektor $\vec c_{k+1}$ vznikl jako
lineární kombinace vektorù $\vecc c_k, \vec b_{k+1}$, je
$$
  \lob<\vecc c_k, \vec c_{k+1}> = \lob<\vecc c_k, \vec b_{k+1}> = 
  \lob<\vecc b_{k+1}>.
$$
Tím jsme roz¹íøili na¹i novou postupnì budovanou ortonormální bázi 
o dal¹í vektor. Opakovaným pou¾itím tohoto postupu dostáváme hledanou
ortonormální bázi $\{\vecc c_n\}$.

Nyní staèí jen podrobnìji ukázat, jak se vektor~\uv{normalizuje} a
\uv{ortogonalizuje}. Normalizaci libovolného vektoru $\vec x$ 
provedeme tak, ¾e polo¾íme $\vec x' = (1/\|\vec x\|)\cdot \vec x$.
Skuteènì je:
$$
  \|\vec x'\|^2 = \vec x'\cdot \vec x' = 
    {1\over\|\vec x\|}\,\vec x\cdot {1\over\|\vec x\|}\,\vec x =
    {1\over\|\vec x\|^2}\, \vec x\,\vec x =
    {1\over\|\vec x\|^2}\, \|\vec x\|^2 = 1.
$$
Nech» $\vec b_{k+1}\not\in\lob<\vecc c_k>$ a nech» vektory
$\vecc c_k$ jsou na sebe navzájem kolmé a mají jednotkovou velikost.
Vektor $\vec b_{k+1}$
\uv{ortogonalizujeme} tak, ¾e polo¾íme
$$
  \vec b_{k+1}' = 
  \vec b_{k+1} - \sum_{i=1}^k (\vec b_{k+1}\cdot\vec c_i)\,\vec c_i.
$$
Novì vytvoøený vektor $\vec b_{k+1}'$ je kolmý na v¹echny vektory
$\vecc c_k$, proto¾e:
$$
  \vec b_{k+1}'\cdot\vec c_j =
  \left(\vec b_{k+1}-\sum_{i=1}^k(\vec b_{k+1}\cdot\vec c_i)\,\vec c_i\right)
  \cdot\vec c_j = 
  \vec b_{k+1}\cdot\vec c_j -
  \sum_{i=1}^k(\vec b_{k+1}\cdot\vec c_i)\,(\vec c_i\cdot\vec c_j) =
  \vec b_{k+1}\cdot\vec c_j - \vec b_{k+1}\cdot\vec c_j = 0.
$$
V uvedeném souètu jsou ostatní sèítanci nuloví, proto¾e vektory
$\vecc c_k$ jsou podle pøedpokladu na sebe navzájem kolmé.

\okraj Ortogonální matice | Ortogonalni matice

\definice [dortomat]
%%%%%%%%%
Matice $\A\in\R^{n,n}$, pro kterou platí $\A^T\cdot\A = \E$, se nazývá
{\em ortogonální}.

\veta [ortomat-zaklad]
%%%%%
Nech» $\A\in\R^{n,n}$. V $\R^n$ pøedpokládejme standardní skalární souèin.
Následující podmínky jsou ekvivalentní:

(1) $\A$ je ortogonální.

(2) $\A\cdot\A^T = \E$

(3) $\A^T$ je ortogonální

(4) $\A$ obsahuje ve sloupcích ortonormální bázi $\R^n$.

(5) $\A$ obsahuje v øádcích ortonormální bázi $\R^n$.

(6) $\A$ je maticí pøechodu mezi dvìma ortonormálními bázemi.

(7) $\A$ je maticí transformace, kterí zobrazí ortonormální bázi
    na ortonormální bázi.

\dukaz
(1)$\impl$(2): Proto¾e $\A^T\cdot\A = \E$, je $\A$ regulární a
$\A^{-1}=\A^T$. Inverzní matice k matici $\A$ v¾dy komutuje s maticí $\A$. 

(2)$\impl$(3): Pøímo z definice ortogonální matice.

(3)$\impl$(1): Proto¾e $(\A^T)^T = \A$.

(1)$\equiv$(4): Rovnost $\A^T\cdot\A$ rozepsaná po sloupcích matice
$\A = (\vecc a_n)$ øíká, ¾e $\vec a_i^T\cdot \vec a_j = 0$ pro
$i\not=j$ a $\vec a_i^T\cdot \vec a_i = 1$. Pøitom souèin
$\vec a_i^T\cdot \vec a_j$ je standarní skalární souèin v $\R^n$.

(4)$\equiv$(5): proto¾e (1)$\equiv$(3).

(4)$\impl$(6): $\A$ je maticí pøechodu od strandardní báze k bázi 
$\A = (\vecc a_n)$, kterí je podle pøedpokladu ortogonální.

(6)$\impl$(1): $\A = (\vecc a_n)$. Sloupce $\vec a_i$
obsahují podle\cite[mprech] souøadnice vektorù $\vec b_i$
vzhledem k ortogonální bázi $(C)$, pøitom $(B) = (\vecc b_n)$
je také ortonormální báze. Tak¾e $\vec b_i\cdot\vec b_j$ je rovno nule
pro $i\not=j$ a jedné pro $i=j$.
Podle vìty\cite[soucin-dle-souradnic] se skalární souèin vektorù 
$\vec b_i$ dají spoèítat pomocí souøadnic:
$\vec a_i^T\cdot \vec a_j = 0$ pro
$i\not=j$ a $\vec a_i^T\cdot \vec a_i = 1$, tak¾e $\A$ je ortogonální.

(6)$\equiv$(7): Viz definici matice pøechodu\cite[defprech].

\priklad
%%%%%%%%
Matice otoèení a matice osové soumìrosti jsou ortogonální:
$$
  \pmatrix {\cos\alpha& -\sin\alpha\cr \sin\alpha&\cos\alpha}, \qquad
  \pmatrix {1&0\cr 0&-1}.
$$
Skuteènì:
$$
  \pmatrix {\cos\alpha& \sin\alpha\cr -\sin\alpha&\cos\alpha}\cdot
  \pmatrix {\cos\alpha& -\sin\alpha\cr \sin\alpha&\cos\alpha} =
  \pmatrix {1&0\cr 0&1}, \qquad
  \pmatrix {1&0\cr 0&-1}\cdot\pmatrix {1&0\cr 0&-1} =  \pmatrix {1&0\cr 0&1}.
$$
Tyto matice jsou maticemi transformací, které zobrazují ortonormální
bázi na ortonormální bázi (transformace zachovává velikosti a úhly).

\veta  [ortomat]
%%%%%
(1) Je-li $\A$ ortogonální, pak $\det\A = 1$ nebo $\det\A = -1$.

(2) Souèin ortogonálních matice je ortogonální.

(3) Je-li $\A$ ortogonální a je-li ${\bf x}$ sloupcový vektor, 
  pak $\A\cdot{\bf x}$ má stejnou velikost
  jako vektor ${\bf x}$.


\dukaz
(1): $
  1 = \det\E = \det(\A\cdot\A^T) = (\det\A)\, (\det\A^T)
  = (\det\A)^2.
$

(2): $
  (\A\cdot\B)^T\cdot (\A\cdot\B) = \B^T\cdot\A^T\cdot\A\cdot\B = 
  \B^T\cdot\E\cdot\B = \E.
$

(3): $
  \|\A{\bf x}\|^2 = (\A{\bf x})^T\cdot(\A{\bf x}) =
  {\bf x}^T\cdot\A^T\cdot \A\cdot{\bf x} = {\bf x}^T\cdot{\bf x}
  = \|{\bf x}\|^2.  
$

\okraj QR rozklad  | QR rozklad

\veta [QR]
%%%%%
Je-li $\A$ regulární matice, pak existuje ortogonální matice $\Q$ a
horní trojúhelníková matice~$\R$ tak, ¾e 
$$
  \A=\Q\cdot\R.
$$

\dukaz
Sloupce matice $\A$ tvoøí nìjakou bázi $(B)$. Tuto bázi
pozmìníme Schmidtovým ortogonalizaèním procesem\cite[ortogonalizace] 
na ortonormální bázi $(C)$. Bázi $(C)$ zapí¹eme do sloupcù matice $\Q$.
Matice $\R$ je maticí pøechodu od ortonormální báze $(C)$ k bázi $(B)$.
Obsahuje souøadnice vektorù $\vec b_k$ z báze $(B)$ vzhledem k~$(C)$.
Díky vlastnosti Schmidtova ortogonalizaèního procesu
$$
  \lob<\vecc b_k> = \lob<\vecc c_k>, \qquad 
  \forall  k\in\{1,2,\ldots,n\}.
$$
jsou souøadnice vektoru $\vec b_k$ vzhledem k $(C)$ pro 
$i>k$ nulové, tak¾e $\R$ je horní trojúhelníková.

\poznamka
%%%%%%%%%
Ortogonální matice jsou hojnì pou¾ívány v numerických metodách, nebo»
jsou numericky stabilní. Díky~(3) vìty\cite[ortomat] se toti¾
násobením ortogonální maticí chyba nezvìt¹uje. 

Vìta o QR rozkladu je jen jiný pohled na Schmidtùv ortogonalizaèní
proces. Øíká, ¾e máme-li ve sloupcích matice $\A$ nìjakou bázi, pak ji
mù¾eme \uv{narovnat}, aby byla ortonormální a takto opravenou bázi 
zapsat do matice $\Q$.
Pøitom matice $\R$ je maticí koeficientù tohoto \uv{narovnání}.

Dá se ukázat, ¾e ortonogonální matice je v¾dy maticí nìjakého otoèení
(pøi vìt¹í dimenzi je mo¾né otáèet v rùzných smìrech). Toto otoèení
je pøípadnì slo¾eno s osovou soumìrností 
(ve více dimenzích pøeklopením jednoho bázového vektoru do \uv{protismìru}). 

V pøípadì matic $\A\in\C^{n,n}$ je analogií ortogonální matice 
tzv.~{\em unitární matice\/} definovaná v\cite[unitarmat]. 
Dùvod pou¾ití komplexnì sdru¾ených èísel
v definici unitární matice souvisí s axiomem~(1) skalárního 
souèinu\cite[dlpss], který je pro komplexní èísla 
modifikován v souladu s poznámkou\cite[complss].

\definice [unitarmat]
%%%%%%%%%
Matice $\A^H\in\C^{n,m}$ se nazývá {\em Hermitovsky sdru¾ená} k matici $\A\in\C^{m,n}$ pokud
je transponovaná a místo ka¾dého prvku je v matici zapsán prvek
komplexnì sdru¾ený.

Matice $\A\in\C^{n,n}$ se nazývá {\em unitární}, pokud $\A^H\cdot\A = \E$. 


\shrnuti
%%%%%%%%
V lineárním prostoru jsme zavedli skalární souèin pomocí
axiomù\lcite[dlpss]. Ukázali jsme, ¾e axiomy vyhovují nejen standardnímu
skalárnímu souèinu\lcite[stss], ale je mo¾né zavést i jiné skalární
souèiny.

Je-li na lineárním prostoru $L$ definován skalární souèin, pak je mo¾no
mìøit velikosti vektorù\lcite[velikost] a úhly mezi nenulovými 
vektory\lcite[uhel]. Abychom mìli jistotu, ¾e vzorec pro úhel dává
výsledek pro libovolné nenulové vektory, museli jsme 
dokázat Schwartzovu nerovnost\lcite[schwartz].

Dva nenulové vektory jsou na sebe kolmé, právì kdy¾ jejich skalární
souèin je roven nule. Zavedli jsme ortonormální 
bázi\lcite[ortonormalni] a ukázali dùle¾ité vlastnosti této 
báze~/\ncite[soucin-dle-souradnic],\cite[karsouradnice],\cite[uhly-k-osam]/.

Ukázali jsme, ¾e lze ka¾dou koneènou bázi upravit Schmidtovým
ortogonalizaèním procesem tak, aby upravená báze byla ortonormální,
pøitom lineární obaly prvních $k$ vektorù obou bází zùstávají shodné.

Základní vlastnosti ortogonální matice\lcite[dortomat]
jsou shrnuty v\cite[ortomat-zaklad],\cite[ortomat] a\cite[QR].


\icviceni 8


\iffalse

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\kapitola [analgeom] Aplikace lineární algebry v geometrii |
                     Aplikace linearni algebry v geometrii
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\okraj Euklidovský prostor | Euklidovsky prostor

\poznamka
%%%%%%%%%
Budeme pracovat s bodovým euklidovským prostorem. Bohu¾el nemáme zde
místo na podrobné definování základních pojmù tohoto
prostoru. Vycházíme tedy z toho, ¾e ètenáø intuitivnì tu¹í, co to je
bod, úseèku si pøedstaví jako nejkrat¹í spojnici mezi dvìma body, nebo
jako mno¾inu bodù, která tuto spojnici vyplòuje. Jiné mno¾iny bodù
vytváøejí pøímky nebo roviny. V¹echny tyto mno¾iny bodù jsou
podmno¾inami tøírozmìrného bodového euklidovského prostoru,
oznaèovaného obvykle $\E_3$. Jeho \uv{tøírozmìrnost} vyplývá z toho,
¾e jsme schopni v tomto prostoru sestrojit maximálnì tøi na sebe
navzájem kolmé pøímky. Rovnì¾ to souvisí s tím, ¾e lineární prostory
orientovaných úseèek v~$\E_3$ mají dimenzi rovnu tøem.
\inl[bod, euklidovský: prostor, prostor: euklidovský, E3]%
\inl[geometrie: euklidovská, euklidovská: geometrie]%
%
V bodovém prostoru $\E_3$ umíme mìøit vzdálenost mezi libovolnými 
dvìma body a úhel mezi dvìma úseèkami, které mají spoleèný jeden
krajní bod. Pøedpokládáme tedy, ¾e jsme vybaveni nìjakým mìøítkem a
úhlomìrem. Stupnice na na¹em mìøítku vychází z nìjaké jednotky 
vzdálenosti (metr, stopa aj.) a nebudeme tuto jednotku
pøi popisování geometrických vlastností dále zmiòovat.

\priklad [UOznovu]
%%%%%%%%
V pøíkladech\cite[lpvv] a\cite[UOlnlz] jsme zavedli lineární prostor 
vázaných vektorù $U_O$ tak, ¾e jsme zvolili jeden bod prostoru $\E_3$ a
oznaèili jej $O$. Na mno¾inì v¹ech orientovaných úseèek zaèínajících 
v~bodì $O$ jsme definovali sèítání (doplnìním na rovnobì¾ník) a
násobení konstantou (násobením velikosti úseèky). 
V pøíkladì\cite[lpvv] jsme ukázali, ¾e mno¾ina takových úseèek 
tvoøí lineární prostor podle obecné definice lineárního prostoru a 
v pøíkladì\cite[UOlnlz] jsme naznaèili, jak souvisí pojmy lineární
závislost a nezávislost vektorù s geometrickými vlastnostmi lineárního
prostoru $U_O$.
\inl[prostor: UO, prostor: orientovaných úseèek]

Zopakujeme nyní hlavní výsledky tìchto pøíkladù a pøidáme dal¹í
poznatky. Nulový vektor $\vec o\in U_O$ je úseèka s nulovou velikostí,
tj. koncový bod splývá s poèáteèním bodem. Jeden vektor 
$\vec u\in U_O$ je lineárnì nezávislý právì tehdy, kdy¾ je
nenulový. Dva vektory $\{\vec u, \vec v\} \subset U_O$ jsou lineárnì
nezávislé právì tehdy, kdy¾ nele¾í ve spoleèné pøímce. Tøi vektory
$\{\vec u, \vec v, \vec w\}\subset U_O$ 
jsou lineárnì nezávislé právì tehdy, kdy¾
nele¾í ve spoleèné rovinì. Ètyøi vektory z~$U_O$ jsou v¾dy lineárnì
závislé. Z toho plyne, ¾e $\dim U_O=3$ a bázi $U_O$ tvoøí libovolné
tøi vektory, které nele¾í ve spoleèné rovinì.

Je-li $\vec u\in U_O$ nenulový, pak $\lob<\vec u>$ je mno¾ina vektorù,
jejich¾ koncové body vyplòují pøímku procházející bodem $O$. Jsou-li 
$\{\vec u, \vec v\} \subset U_O$ lineárnì nezávislé, pak 
$\lob<\vec u, \vec v>$ je mno¾ina vektorù, jejich¾ koncové body
vyplòují rovinu procházející bodem $O$. Jsou-li koneènì tøi vektory
$\{\vec u, \vec v, \vec w\}\subset U_O$ lineárnì nezávislé, pak 
koncové body vektorù z~$\lob<\vec u, \vec v, \vec w>$ vyplòují celý
prostor~$\E_3$. 

\okraj Souøadnice orientovaných úseèek | 
       Souradnice orientovanych usecek

Je-li $B = \{ \vec b_1, \vec b_2, \vec b_3 \} \subset U_O$ lineárnì
nezávislá mno¾ina, pak tvoøí bázi $U_O$ a pro ka¾dý
vektor $\vec u \in U_O$ existuje právì jedna lineární kombinace vektorù 
$\vec b_1, \vec b_2, \vec b_3$, která je rovna vektoru~$\vec u$.
Koeficienty této lineární kombinace jsou podle definice\cite[souradnice]
souøadnicemi vektoru $\vec u$ vzhledem k~uspoøádané bázi $(B)$.
Tyto souøadnice tvoøí uspoøádanou trojici reálných èísel a zobrazení,
které ka¾dému vektoru $\vec u\in U_O$ pøiøadí uspoøádanou trojici jeho
souøadnic z $\R^3$ je podle vìty\cite[sour-lin] izomorfismus.
Toto zobrazení pøená¹í pojmy lineární
závislost, podprostor a lineární obal
z~\uv{geometrického} lineárního prostoru $U_O$ na 
\uv{numerický} lineární prostor~$\R^3$. Jinými slovy, místo abychom
zji¹»ovali tyto pojmy na lineárním prostoru $U_O$, kde sèítání je
definováno doplòováním na rovnobì¾ník (potøebujeme dvì pravítka resp. kru¾ítko na
konstruování rovnobì¾níkù), budeme je ovìøovat jen numericky v~$\R^3$
(vystaèíme si se sèítáním a násobením reálných èísel). 
To je základním principem tzv. {\em analytické geometrie}.
Tuto teorii rozpracoval v 17.~století francouzský matematik René
Descartes. Po nìm se nazývá souøadnicový systém kartézský.
\inl[geometrie: analytická, analytická: geometrie]
\inl[Descartes René]
%Na tomto pøevodu
%geometrického a konstruktivního problému na numerický výpoèet je
%zalo¾ena disciplína, která se nazývá {\em analytická geometrie}.
 

\okraj Skalární\hb souèin orientovaných úseèek |
       Skalarni soucin orientovanych usecek

\priklad [ssnaUO]
%%%%%%%%
Na lineárním prostoru $U_O$ nyní definujeme skalární souèin.
Nech» $\vec u$ a $\vec v$ jsou dvì orientované úseèky zaèínající 
v bodì~$O$. Pokud je aspoò jedna z nich nulová, definujeme skalární
souèin~$\vec u\cdot\vec v = 0$. Jsou-li obì úseèky nenulové, pak 
existuje rovina $\varrho$, ve které le¾í spoleènì obì
úseèky. Pøilo¾íme v této rovinì úhlomìr k daným úseèkám a 
zmìøíme úhel $\phi$ mezi tìmito úseèkami. 
Skalární souèin pak definujeme vzorcem
$$
  \vec u\cdot\vec v = \|\vec u\|\,\|\vec v\|\,\cos\phi ,
  \rce(ssnaUO)
$$
kde $\|\vec u\|$ a $\|\vec v\|$ jsou velikosti tìchto úseèek zji¹tìné 
mìøítkem.
\inl[souèin: skalární, skalární: souèin]

Uká¾eme, ¾e uvedený vzorec definuje skalární souèin v souladu 
s obecnou definicí\cite[dlpss], tj. ¾e platí
vlastnosti~(1) a¾ (4).
$$
  \eqalign{
  \bod(1) \vec u\cdot\vec v = \|\vec u\|\,\|\vec v\|\,\cos\phi =
                              \|\vec v\|\,\|\vec u\|\,\cos\phi =
                              \vec v\cdot\vec u, \cr
  \bod(2) (\vec u + \vec v)\cdot\vec w \buildrel ? \over =  
           \vec u\cdot\vec w + \vec v\cdot\vec w \quad
           \hbox{(vysvìtlíme pozdìji)}, \cr
  \bod(3) (\alpha\,\vec u)\cdot\vec v = 
           \|\alpha\,\vec u\|\,\|\vec v\|\,\cos\phi =
           \cases {\alpha \|\vec u\|\,\|\vec v\|\,\cos\phi = 
                   \alpha\,(\vec u\cdot\vec v), \quad
                   \hbox{pro } \alpha\geq 0, \cr
                   -\alpha \|\vec u\|\,\|\vec v\|\,\cos(\phi+\pi) =
                   \alpha \|\vec u\|\,\|\vec v\|\,\cos\phi = 
                   \alpha\,(\vec u\cdot\vec v), \quad
                   \hbox{pro } \alpha< 0, } \cr
  \bod(4) \vec u\cdot\vec u = \|\vec u\|^2\,\cos 0 = \|\vec u\|^2 \geq 0.
}
$$
Pøedpokládejme je¹tì~$\vec u\cdot\vec u = \|\vec u\|^2 = 0$. Z toho
plyne, ¾e velikost úseèky $\vec u$ je nulová, tak¾e nutnì musí být 
$\vec u = \vec o$. 

Zbývá nám dokázat vlastnost~(2). 
Jsou-li nìkteré z úseèek nulové, je
tvrzení~(2) okam¾itì splnìno. Nech» jsou tedy v¹echny tøi úseèky nenulové.
Nech» dále $\phi_1$ je úhel mezi
$\vec u$ a $\vec w$. Oznaème $p_1 = \|\vec u\|\,\cos\phi_1$ velikost 
kolmého prùmìtu
úseèky $\vec u$ na úseèku $\vec w$. Ze vzorce\cite(ssnaUO)
vidíme, ¾e $p_1 = \vec u \cdot\vec w / \|\vec w\|$. Oznaème je¹tì 
$p_2$ velikost kolmého prùmìtu úseèky $\vec v$ na úseèku $\vec w$ a koneènì
$p_0$ velikost kolmého prùmìtu souètu $\vec u+\vec v$ na úseèku $\vec w$.
Z~geometrických vlastností rovnobì¾níkù a prùmìtù plyne, ¾e $p_0=p_1+p_2$
(udìlejte si náèrtek). Proto¾e platí 
$$
  p_1 = {\vec u \cdot\vec w \over \|\vec w\|},\quad 
  p_2 = {\vec v \cdot\vec w \over \|\vec w\|},\quad
  p_0 = {(\vec u+\vec v) \cdot\vec w \over \|\vec w\|},
$$ 
je po vynásobení rovnosti $p_0=p_1+p_2$ èíslem $\|\vec w\|$ po¾adovaná
rovnost~(2) dokázána.

\poznamka
%%%%%%%%%
Pøi ovìøování vlastnosti~(4) jsme mimochodem zjistili, ¾e
velikost úseèky odvozená ze skalárního souèinu (definice\cite[velikost]) je
rovna velikosti úseèky zji¹tìné mìøítkem. 
Úhel mezi úseèkami podle definice\cite[uhel] je také 
roven skuteènému úhlu mezi úseèkami. To plyne pøímo 
ze vzorce\cite(ssnaUO).

\poznamka
%%%%%%%%%
K definování skalárního souèinu na lineárním prostoru orientovaných
ú¹eèek jsme v~pøedchozím pøíkladu pou¾ili kromì mìøítka je¹tì úhlomìr
a nìjaký stroj, který nám vyhodnotí funkci kosinus. Uká¾eme, ¾e
lze modifikovat definici tak, ¾e místo úhlomìru a stroje na kosinus si
vystaèíme jen s~pravítkem s~ryskou (na sestrojování kolmic). 

Nech» $\vec u$ a $\vec v$ jsou nenulové orientované úseèky zaèínající ve
spoleèném bodì~$O$. Nech» $p$ je pøímka, která obsahuje úseèku~$\vec v$.
Pomocí pravítka s~ryskou sestrojíme kolmici na pøímku $p$, 
která prochází koncovým bodem úseèky~$\vec u$. Prùseèík
pøímky~$p$ a sestrojené kolmice oznaème $P$. Nyní definujeme
$$
  \vec u \cdot \vec v = \pm \|\vec v\|\cdot 
                        \hbox{velikost úseèky $OP$},
$$
kde místo znaku~\uv{$\pm$} pou¾ijeme znaménko~\uv{$+$}, je-li 
úseèka $OP$ shodnì orientovaná  s~úseèkou $\vec v$, a pou¾ijeme 
znaménko~\uv{$-$}, jsou-li tyto úseèky
opaènì orientované.

Uvìdomíme si, ¾e úseèka $OP$ je kolmým prùmìtem úseèky
$\vec u$ na pøímku~$p$, velikost tohoto prùmìtu je podle kosinové vìty
rovna (a¾ na znaménko) èíslu $\|\vec u\|\cos\phi$, kde $\phi$ 
je úhel mezi úseèkami $\vec u$ a $\vec v$. Vidíme tedy, ¾e 
je definice skalárního souèinu shodná s~definicí podle 
vzorce\cite(ssnaUO).

\okraj Kolmý prùmìt vektoru na vektor | kolmy prumet vektoru na vektor
 
Kolmý prùmìt vektoru $\vec u$ na nenulový vektor $\vec v$ je názorná
geometrická aplikace skalárního souèinu a má obecnou platnost i 
v lineárních prostorech s vìt¹í dimenzí. Stojí za to tento pojem
formálnì definovat pro libovolný lineární prostor se skalárním
souèinem:

\definice [kolmyprumet]
%%%%%%%%%
Nech» $L$ je lineární prostor se skalárním souèinem, $\vec u\in L, 
\vec v\in L, \vec v \ne \vec o$. Pak vektor
$$
  {\vec u \cdot \vec v \over \|\vec v\|^2}\,\,\vec v
$$
nazýváme {\em kolmý prùmìt vektoru $\vec u$ na vektor $\vec v$}.
\inl[kolmý prùmìt, prùmìt: kolmý]

Èíslo ${(\vec u \cdot \vec v) \,/\, \|\vec v\|}$ je
velikost kolmého prùmìtu vektoru $\vec u$ na vektor $\vec v$
\uv{a¾ na znaménko}. Toto èíslo je záporné právì tehdy, kdy¾ kolmý
prùmìt na vektor $\vec v$ má opaèný smìr ne¾ vektor $\vec v$.
\inl[velikost: kolmého prùmìtu]

\okraj Ortonor\-mální báze v~$U_O$ | Orthonormalni base v UO

\priklad [baseUO]
%%%%%%%%
Nech» $U_O$ je lineární prostor se skalárním souèinem 
z~pøíkladu\cite[ssnaUO]. 
Sestrojíme dvì orientované úseèky zaèínající v bodì $O$ 
s~velikostí~$1$, které jsou na sebe kolmé (ovìøíme úhlomìrem).
Tyto dvì úseèky le¾í v~jednoznaènì urèené rovinì $\varrho$.
Sestrojíme tøetí úseèku velikosti~$1$, která zaèíná v bodì~$O$ a
je kolmá na rovinu~$\varrho$. Tyto tøi úseèky oznaèíme
$\vec i$, $\vec j$, $\vec k$. Je zøejmé, ¾e
$B = \{\vec i, \vec j, \vec k\}$ je ortonormální bází lineárního
prostoru~$U_O$.
\inl[prostor: UO, prostor: orientovaných úseèek]
\inl[báze: ortonormální, ortonormální: báze]

\poznamka
%%%%%%%%%
Souøadnice vektoru $\vec u\in U_O$ vzhledem k ortonormální bázi 
$B = \{\vec i, \vec j, \vec k\}$ jsou podle vìty\cite[karsouradnice]
a definice\cite[kolmyprumet]
velikostmi (a¾ na znaménko) kolmých prùmìtù vektoru $\vec u$ na vektory 
$\vec i,\, \vec j,\, \vec k$. To nám umo¾òuje velmi snadno najít
souøadnice geometrickými prostøedky a dále se souøadnicemi 
(uspoøádanými trojicemi v~$\R^3$) pracovat numericky.
\inl[souøadnice: vektoru]

\priklad
%%%%%%%%
Nech» $B = \{\vec i, \vec j, \vec k\}$ je báze 
z~pøíkladu\cite[baseUO]. 
Uspoøádejme tuto bázi, tj. zále¾í nám na poøadí prvkù
$\vec i, \vec j, \vec k$.
Vidíme, ¾e jakákoli jiná uspoøádaná ortonormální báze
vzniká souèasným otoèením úseèek $\vec i, \vec j, \vec k$ kolem
bodu~$O$ nebo souèasným otoèením úseèek $\vec i, \vec j, -\vec k$
kolem bodu~$O$. Pøechod mezi bází 
$(B) = \bigl(\vec i, \vec j, \vec k\bigr)$
a $(B') = \bigl(\vec i, \vec j, -\vec k\bigr)$ nelze 
realizovat souèasným otoèením v¹ech úseèek. 

Dá se ukázat, ¾e pokud báze $C$ vzniká z báze $B$ otoèením úseèek
kolem bodu~$O$, má matice pøechodu $\A_{(B,C)}$ kladný determinant.
Dále matice pøechodu od báze $B$ k bázi $B'$ vypadá takto
$$
  \A_{(B,B')} = \matice{1&0&0\cr0&1&0\cr0&\kern6pt0&-1}.
$$
Je tedy $\det\A_{(B,B')} = -1$. To nás vede k následující definici kladnì
orientované báze.

\okraj Kladnì orientovaná báze | Kladne orientovana base

\definice [kladneUO]
%%%%%%%%%
Nech» $U_O$ je lineární prostor se skalárním souèinem podle 
pøíkladu\cite[ssnaUO]. Ortonormální uspoøádanou bázi 
$(B)=\bigl(\vec i, \vec j, \vec k\bigr)$ nazýváme 
{\em kladnì orientovanou}, pokud pøi vhodném umístìní a natoèení 
pozorovatele vzhledem k této bázi smìøuje úseèka 
$\vec i$ smìrem k~pozorovateli, $\vec j$ vpravo od pozorovatele 
a $\vec k$ nahoru.

Mnemotechnickou pomùckou je tzv.~{\em pravidlo pravé ruky}.
Pøilo¾íme-li pravou ruku k vektorùm $\vec i$, $\vec j$ tak, aby prsty 
smìøovaly od $\vec i$ k~$\vec j$, potom palec naznaèuje smìr
vektoru~$\vec k$.

V¹echny báze $(C)$ (ne nutnì ortonormální), které mají 
matici pøechodu od $(B)$ k~$(C)$ s kladným determinantem, 
nazýváme {\em kladnì orientované báze}.
V¹echny báze $(D)$, které mají matici pøechodu od $(B)$ k~$(D)$
se záporným determinantem, nazýváme {\em zápornì orientované báze}.
\inl[báze: kladnì orientovaná, kladnì orientovaná: báze]
\inl[báze: zápornì orientovaná, zápornì orientovaná: báze]
\inl[prostor: UO, prostor: orientovaných úseèek]
\inl[pravidlo: pravé ruky]

\poznamka
%%%%%%%%%
Na lineárním prostoru~$U_O$ jsme rozdìlili v¹echny báze do dvou
skupin: kladnì orientované báze a zápornì orientované báze. Matice
pøechodu je podle vìty\cite[slozmprech] v¾dy regulární, tak¾e je
jednoznaènì dáno, zda je báze kladnì nebo zápornì orientovaná
(determinant matice pøechodu je v¾dy nenulový).

Podle vìt\cite[slozmprech] a \cite[soucindet] také okam¾itì vidíme, ¾e
matice pøechodu mezi kladnì orientovanými bázemi má v¾dy kladný
determinant, matice pøechodu mezi zápornì orientovanými bázemi má také
kladný determinant a matice pøechodu od kladnì orientované báze
k~zápornì orientované bázi má záporný determinant stejnì jako matice
pøechodu od zápornì orientované báze ke kladnì orientované bázi.

\poznamka
%%%%%%%%%
V libovolném lineárním prostoru koneèné dimenze jsme schopni rozli¹it
dvì skupiny uspoøádaných bází tak, ¾e matice pøechodu od báze z jedné
skupiny k bázi v druhé skupinì má záporný determinant a matice
pøechodu od báze k bázi uvnitø skupiny má kladný determinant. Nejedná
se tedy jen o geometrickou vlastnost lineárního prostoru $U_O$. Je
proto vhodné uvést následující obecnou definici:

\definice [orientovat]
%%%%%%%%%
{\em Orientovat} libovolný lineární prostor s koneènou dimenzí znamená
prohlásit jednu jeho uspoøádanou bázi $(B)$ za výchozí kladnì orientovanou.
Uspoøádaná báze $(C)$ se nazývá {\em kladnì orientovaná}, pokud matice
pøechodu od výchozí báze $(B)$ k bázi $(C)$ má kladný determinant.
Uspoøádaná báze $(D)$ se nazývá {\em zápornì orientovaná}, pokud matice
pøechodu od výchozí báze $(B)$ k bázi $(D)$ má záporný determinant.
\inl[orientace: prostoru, prostor: orientovaný]
\inl[báze: kladnì orientovaná, kladnì orientovaná: báze]
\inl[báze: zápornì orientovaná, zápornì orientovaná: báze]

\priklad [orientaceUO]
%%%%%%%%
Orientaci lineárního prostoru $U_O$ jsme provedli v definici\cite[kladneUO].

\poznamka
%%%%%%%%%
Ji¾ døíve jsme mluvili o \uv{orientovaných} úseèkách. Aèkoli jsme
pou¾ili stejné slovo, s~orientací lineárního prostoru to pøíli¹
nesouvisí. Orientace úseèky znamená urèení poøadí jejích krajních
bodù, nebo (jinak øeèeno) rozli¹ení mezi poèáteèním a koneèným bodem
úseèky.

\okraj Vektorový souèin | Vektorovy soucin

\poznamka
%%%%%%%%%
V dal¹í èásti textu definujeme {\em vektorový souèin}, co¾ je operace, 
která dvìma vektorùm pøiøadí jako
výsledek vektor (na rozdíl od skalárního souèinu, který dvìma
vektorùm pøiøadí èíslo, neboli skalár). Vektorový souèin definujeme
prozatím na lineárním prostoru $U_O$ orientovaných úseèek, 
který ji¾ známe z~pøíkladù\cite[UOznovu],\cite[ssnaUO],\cite[baseUO]
a\cite[orientaceUO].

\definice [vs]
%%%%%%%%%
Nech» $U_O$ je lineární prostor orientovaných úseèek.
{\em Vektorový souèin\/} je zobrazení (oznaèujeme jej køí¾kem)
$\times: U_O\times U_O \to U_O$, které splòuje následující vlastnosti.

(A) Jsou-li vektory $\{\vec u, \vec v\}\subset U_O$ lineárnì závislé,
    definujeme $\vec u\times \vec v = \vec o$ (nulový vektor).

(B) Jsou-li vektory $\{\vec u, \vec v\}\subset U_O$ lineárnì
    nezávislé, pak je vektor $\vec u\times \vec v$ jednoznaènì urèen
    následujícími tøemi vlastnostmi:

(1) $(\vec u\times \vec v) \kolmy \vec u$, $(\vec u\times \vec v) \kolmy \vec v$,  

(2) $\|\vec u\times \vec v\| = \|\vec u\|\,\|\vec v\|\,\sin \phi$, kde
    $\phi$ je úhel mezi vektory $\vec u$ a $\vec v$.

(3) Uspoøádaná báze $(\vec u, \vec v, \vec u\times \vec v)$ je kladnì
    orientovaná.
\inl[prostor: UO, prostor: orientovaných úseèek]
\inl[souèin: vektorový, vektorový: souèin]

\poznamka
%%%%%%%%%
Vidíme, ¾e skuteènì vlastnosti (1) a¾ (3) urèují vektorový souèin
jednoznaènì. První vlastnost udává, ¾e výsledek bude kolmý na rovinu
urèenou $\lob<\vec u, \vec v>$, druhá vlastnost urèuje velikost
výsledného vektoru a tøetí vlastnost orientaci 
(zda výsledný vektor bude orientován vzhledem
k~rovinì urèené $\lob<\vec u, \vec v>$ \uv{nahoru} nebo \uv{dolu}.

\priklad
%%%%%%%%
Nech» $(B)=(\vec i, \vec j, \vec k)$ je ortonormální kladnì 
orientovaná uspoøádaná báze lineárního prostoru $U_O$. Pak
podle definice je
$$\displaylines{
  \vec i \times \vec i = \vec j \times \vec j = \vec k \times \vec k =
  \vec o, \cr
  \vec i \times \vec j = \vec k, \quad
  \vec j \times \vec i = - \vec k, \quad
  \vec i \times \vec k = - \vec j, \quad
  \vec k \times \vec i = \vec j, \quad
  \vec j \times \vec k = \vec i, \quad
  \vec k \times \vec j = - \vec i. }
$$  

\veta (souøadnice vektorového souèinu) [vs-souradnice]
%%%%%
Nech» $(B)=(\vec i, \vec j, \vec k)$ je ortonormální kladnì 
orientovaná uspoøádaná báze lineárního prostoru $U_O$,
$\vec u = (u_1, u_2, u_3)_{(B)}$, $\vec v = (v_1, v_2, v_3)_{(B)}$.
Pak platí:
$$
  \vec u\times \vec v = \left (
   \left |\matrix{u_2& u_3\cr v_2& v_3}\right|,
   - \left |\matrix{u_1& u_3\cr v_1& v_3}\right|,
   \,\left |\matrix{u_1& u_2\cr v_1& v_2}\right|
   \right )_{(B)}.
   \rce(vs-poc)
$$
\par\inl[souøadnice: vektorového souèinu]
   
\dukaz
%%%%%%
Pokud jsou vektory $\vec u, \vec v$ lineárnì závislé, pak v¹echny
determinanty ve vzorci\cite(vs-poc) jsou nulové a výsledný vektor 
$\vec u\times \vec v$ má nulové souøadnice, tak¾e je v~souladu 
s~definicí nulový. Zbývá tedy ovìøit vlastnosti (1) a¾ (3) z~definice
vektorového souèinu pro pøípad, ¾e vektory $\vec u, \vec v$ jsou
lineárnì nezávislé.

Ad (1). Ovìøíme $(\vec u\times \vec v)\kolmy \vec u$. 
Dva vektory jsou kolmé, pokud jejich skalární souèin je
nulový. Skalární souèin mù¾eme poèítat ze souøadnic podle 
vìty\cite[soucin-dle-souradnic]:
$$
  \left |\matrix{u_2& u_3\cr v_2& v_3}\right| \, u_1 - 
  \left |\matrix{u_1& u_3\cr v_1& v_3}\right| \, u_2 +
  \left |\matrix{u_1& u_2\cr v_1& v_2}\right| \, u_3 =
   \left |\matrix{u_1& u_2& u_3\cr v_1& v_2& v_3\cr u_1& u_2& u_3}\right| 
  = 0.
$$
Pøi úpravách jsme vyu¾ili rozvoje determinantu podle tøetího øádku a
dále toho, ¾e determinant je roven nule, pokud se v nìm dva øádky
opakují. Podobnì by to dopadlo pøi ovìøování 
$(\vec u\times \vec v)\kolmy \vec v$.

Ad (2).
$$\eqalign{
  \|\vec u\times \vec v\|^2 &=
  \left |\matrix{u_2& u_3\cr v_2& v_3}\right|^2 +
  \left |\matrix{u_1& u_3\cr v_1& v_3}\right|^2 +
  \left |\matrix{u_1& u_2\cr v_1& v_2}\right|^2 = 
  \hbox{\it ponìkud pracnìj¹í výpoèet je zde vynechán} = \cr
  &= (u_1^2 + u_2^2 + u_3^2)\,(v_1^2 + v_2^2 + v_3^2)
  - (u_1 v_1 + u_2 v_2 + u_3 v_3)^2 = 
     \|\vec u\|^2 \, \|\vec v\|^2 - (\vec u \cdot \vec v)^2 = \cr
  &= \|\vec u\|^2 \, \|\vec v\|^2 - \|\vec u\|^2 \, \|\vec v\|^2 \, \cos^2\phi =
     \|\vec u\|^2 \, \|\vec v\|^2 \, (1 - \cos^2\phi) =
     \|\vec u\|^2 \, \|\vec v\|^2 \, \sin^2\phi. 
}
$$ 
Po odmocnìní vychází po¾adovaná vlastnost.

Ad (3). Pøedev¹ím velikost vektoru $\vec u\times \vec v$ je pro
lineárnì nezávislé vektory $\vec u, \vec v$ nenulová a tento vektor je
kolmý na oba vektory $\vec u, \vec v$. Mno¾ina
$\{\vec u, \vec v, \vec u\times \vec v\}$ tedy tvoøí bázi lineárního
prostoru~$U_O$. Matice
$$
  \A = \pmatrix {u_1& v_1& %\phantom{+}
                 \left |\matrix{u_2& u_3\cr v_2& v_3}\right|\cr
                 u_2& v_2&
                 -\left |\matrix{u_1& u_3\cr v_1& v_3}\right|\cr
                 u_3& v_3& %\phantom{+}
                 \left |\matrix{u_1& u_2\cr v_1& v_2}\right|}
$$
je maticí pøechodu od kladnì orientované báze 
$(\vec i, \vec j, \vec k)$ k~bázi
$(\vec u, \vec v, \vec u\times \vec v)$. Její determinant spoèítáme
rozvojem podle tøetího sloupce:
$$
  \det\A = 
  \left |\matrix{u_2& u_3\cr v_2& v_3}\right|^2 +
  \left |\matrix{u_1& u_3\cr v_1& v_3}\right|^2 +
  \left |\matrix{u_1& u_2\cr v_1& v_2}\right|^2 > 0.
$$
Je tedy i báze $(\vec u, \vec v, \vec u\times \vec v)$ kladnì
orientovaná.  

\poznamka
%%%%%%%%%
Vìta\cite[vs-souradnice] nám nejen dává mo¾nost poèítat souøadnice
vektorového souèinu ze souøadnic vstupních vektorù, ale inspiruje nás
k definici vektorového souèinu na $\R^3$:

\definice [vsnaR3]
%%%%%%%%%
Nech» $\vec u\in\R^3$,  $\vec v\in\R^3$, 
$\vec u = (u_1, u_2, u_3)$, $\vec v = (v_1, v_2, v_3)$. Pak definujeme
{\em vektorový souèin na $\R^3$} pøedpisem:
$$
  \vec u\times \vec v = \left (
   \left |\matrix{u_2& u_3\cr v_2& v_3}\right|,
   - \left |\matrix{u_1& u_3\cr v_1& v_3}\right|,
   \,\left |\matrix{u_1& u_2\cr v_1& v_2}\right|
   \right ).
$$
\par\inl[vektorový: souèin, souèin: vektorový]

\poznamka
%%%%%%%%%
Definici vektorového souèinu lze roz¹íøit na libovolný lineární
prostor $L$ dimenze~3 se skalárním souèinem, který byl orientován. 
Staèí pou¾ít definici\cite[vs] a uvìdomit si, ¾e se tato definice
neopírá o~¾ádné speciální vlastnosti mno¾iny~$U_O$. 
Vychází pouze z~tìchto pøedpokladù:

(1) Dimenze lineárního prostoru $L$ musí být rovna tøem.

(2) Na lineárním prostoru $L$ musí být definován skalární souèin.

(3) Lineární prostor $L$ musí být orientován.

Rovnì¾ dùkaz vìty\cite[vs-souradnice] se opíral jen o vý¹e uvedené
vlastnosti lineárního prostoru a vìta tedy platí pro ka¾dý takový
lineární prostor.

Je tøeba si uvìdomit, ¾e definici vektorového souèinu nelze roz¹íøit
na lineární prostory jiných dimenzí ne¾~3. 


\veta (základní vlastnosti vektorového souèinu) [zv-vs]
%%%%%
Nech» $L$ je lineární prostor s vektorovým souèinem a 
$\vec u\in L$, $\vec v\in L$, $\vec w\in L$, 
$\alpha\in\R$.
Platí:
$$\eqalign{
  \vec u \times \vec u &= \vec o, \cr
  \vec u \times \vec v &= - (\vec v \times \vec u)
  \qquad \hbox{(antikomutativní zákon)},\cr
  (\alpha\,\vec u) \times \vec v &= \alpha \, (\vec u \times \vec v) =
  \vec u \times (\alpha\,\vec v), \cr
  (\vec u + \vec v)\times \vec w &= 
  \vec u \times \vec w + \vec v \times \vec w
  \qquad \hbox{(první distributivní zákon)},\cr
  \vec u \times (\vec v + \vec w) &= 
  \vec u \times \vec v + \vec u \times \vec w
  \qquad \hbox{(druhý distributivní zákon)}. \cr
}
$$
\par\inl[zákon: antikomutativní, anitkomutativní: zákon]
\inl[zákon: distributivní, distributivní: zákon]

\dukaz
%%%%%%
Snadno se dá ovìøit, ¾e tyto vzorce platí, pokud si zvolíme nìjakou
uspoøádanou kladnì orientovanou ortonormální bázi a budeme pracovat
podle vìty\cite[vs-souradnice] se souøadnicemi tìchto vektorù vzhledem k takto
zvolené bázi.

\poznamka
%%%%%%%%%
Asociativní zákon pro vektorový souèin neplatí, proto¾e je
$(\vec i\times \vec i)\times \vec j = \vec o\times \vec j = \vec o$,
zatímco 
$\vec i \times (\vec i \times \vec j) = \vec i \times \vec k = -\vec j$,
kde $(\vec i, \vec j, \vec k)$ je uspoøádaná kladnì orientovaná
ortonormální báze. Nemá tedy smysl psát
$\vec u\times \vec v \times \vec w$ bez pou¾ití závorek. Pøi
opakovaném vektorovém souèinu v¾dy musíme pomocí závorek vyznaèit, 
v~jakém poøadí budeme násobit.
\inl[zákon: asociativní, asociativní: zákon]

\priklad
%%%%%%%%
Spoèítáme $(2\vec u - 5\vec v)\times (\vec u + 3\vec v)$
s vyu¾itím vìty\cite[zv-vs]:
$$\eqalign {
  (2\vec u - 5\vec v)\times (\vec u + 3\vec v) &=
  (2\vec u - 5\vec v)\times \vec u +
  (2\vec u - 5\vec v)\times (3\vec v) =\cr &=
  (2\vec u)\times \vec u + (-5\vec v)\times \vec u +
  (2\vec u)\times (3\vec v) + (-5\vec v)\times (3\vec v) =\cr &=
  2\,(\vec u\times \vec u) - 5\,(\vec v \times \vec u)
  + 6\,(\vec u\times \vec v) -15\,(\vec v \times \vec v) =\cr &=
  2\,\vec o - 5\,(-(\vec u\times \vec v)) 
  + 6\,(\vec u\times \vec v) - 15\,\vec o = 11\,(\vec u\times \vec v).
}
$$

\veta (geometrický význam vektorového souèinu) [vs-geom]
%%%%%
Nech» vektory $\vec u, \vec v$ jsou lineárnì nezávislé.
Velikost vektorového souèinu $\vec u\times\vec v$ 
je rovna plo¹e rovnobì¾níka urèeného svými stranami 
$\vec u$ a $\vec v$.
\inl[obsah: rovnobì¾níka]

\dukaz
%%%%%%
Staèí si uvìdomit, ¾e èíslo $\|\vec v\|\,\sin\phi$ (kde $\phi$ je úhel mezi
vektory $\vec u$, $\vec v$) je rovno podle vlastnosti funkce sinus
vý¹ce zmínìného rovnobì¾níka a $\|\vec u\|$ je jeho základna. 
Na základní ¹kole jsme se
uèili, ¾e plocha rovnobì¾níka se poèítá jako základna krát vý¹ka, tedy
$\|\vec u\|\,\|\vec v\|\,\sin \phi$, co¾ je podle vlastnosti (2)
definice\cite[vs] rovno velikosti vektorového souèinu.

\okraj Smí¹ený\hb souèin | Smiseny soucin

\definice [smisenys]
%%%%%%%%%
Nech» $\vec u$, $\vec v$, $\vec w$ jsou vektory z lineárního prostoru
se skalárním a vektorovým souèinem. Pak èíslo 
$\vec u \cdot (\vec v \times \vec w)$ nazýváme 
{\em smí¹eným souèinem vektorù $\vec u$, $\vec v$, $\vec w$
(v tomto poøadí)}.
\inl[souèin: smí¹ený, smí¹ený: souèin]

\veta (smí¹ený souèin ze souøadnic vektorù) [sms-souradnice]
%%%%%
Nech» $(B)=(\vec i, \vec j, \vec k)$ je ortonormální kladnì 
orientovaná uspoøádaná báze lineárního prostoru se skalárním a
vektorovým souèinem, nech» vektory $\vec u$, $\vec v$ a $\vec w$ mají souøadnice:
$\c_B(\vec u) = (u_1, u_2, u_3)$, 
$\c_B(\vec v) = (v_1, v_2, v_3)$,
$\c_B(\vec w) = (w_1, w_2, w_3)$.
Pak je smí¹ený souèin $\vec u \cdot (\vec v \times \vec w)$ roven
determinantu:
$$
  \left| \matrix{u_1& u_2& u_3\cr
                 v_1& v_2& v_3\cr
                 w_1& w_2& w_3\cr} \right|.
$$

\dukaz
%%%%%%
Vìta plyne pøímo z definice smí¹eného souèinu a 
vìt\cite[vs-souradnice],\cite[soucin-dle-souradnic]. Rozvojem
determinantu podle prvního øádku dostáváme po¾adovaný výsledek.

\veta (geometrický význam smí¹eného souèinu) [sms-geom]
%%%%%
Absolutní hodnota smí¹eného souèinu lineárnì nezávislých vektorù 
$\vec u, \vec v, \vec w$
je rovna objemu rovnobì¾nostìnu urèeného svými stranami
$\vec u, \vec v, \vec w$.
\inl[objem: rovnobì¾nostìnu]

\dukaz
%%%%%%
Velikost vektorového souèinu $\vec v \times \vec w$ je podle 
vìty\cite[vs-geom] roven plo¹e základny rovnobì¾nostìnu.
Rozepí¹eme skalární souèin pomocí kosinu úhlu $\phi$ mezi vektorem
$\vec u$ a vektorem $\vec v\times \vec w$:
$$
  \|\vec u \cdot (\vec v \times \vec w)\| =
  \|\vec v\times \vec w\|\cdot\|\vec u\|\,|\cos\phi| =
  \hbox{základna}\cdot\hbox{vý¹ka} = \hbox{objem rovnobì¾nostìnu}.
$$
Èíslo $\|\vec u\|\,|\cos\phi|$ je rovno po¾adované vý¹ce, proto¾e se
jedná o velikost kolmého prùmìtu vektoru $\vec u$ na vektor $\vec v\times \vec w$
a vektor $\vec v\times \vec w$ je kolmý na základnu.

\poznamka
%%%%%%%%%
Je-li báze $(\vec u, \vec v, \vec w)$ kladnì orientovaná, vychází
smí¹ený souèin kladnì, proto¾e úhel~$\phi$ z~dùkazu pøedchozí vìty je
men¹í ne¾ $\pi/2$. Je-li ale tato báze zápornì orientovaná, vychází
smí¹ený souèin jako záporné èíslo, nebo» úhel $\phi$ je vìt¹í ne¾
$\pi/2$.

\poznamka
%%%%%%%%%
Dá se ukázat, ¾e absolutní hodnota determinantu matice typu 
$(n,n)$ urèuje objem rovnobì¾nostìnu, který je urèen svými
stranami, jejich¾ souøadnice jsou zapsány do øádkù této matice.
Rovnobì¾nostìn se \uv{rozprostírá} v~$n$-dimenzionálním prostoru.
Pomocí determinantù tedy mù¾eme mìøit $n$-dimenzionální
objemy. Vìty\cite[sms-souradnice] a\cite[sms-geom] ilustrují, ¾e
determinanty mìøí objemy rovnobì¾nostìnu aspoò pro dimenzi~3.
%Tato problematika ov¹em pøekraèuje rámec osnov, které nám
%pouze urèují seznámit se s objemy tøírozmìrných rovnobì¾nostìnù jako
%velikostmi determinantù matic typu $(3,3)$. Tento úkol jsme splnili
%tím, ¾e jsme se seznámili s~vìtami\cite[sms-souradnice] a\cite[sms-geom].


\okraj Prostor $V_3$ volných\hb vektorù | Prostor V3 volnych vektoru

\poznamka
%%%%%%%%%
Lineární prostor~$U_O$ 
z~pøíkladù\cite[UOznovu],\cite[ssnaUO] a\cite[baseUO]
má jednu nevýhodu. Obsahuje jen úseèky, které zaèínají v~pevnì
zvoleném bodì~$O$. Èasto ale pøi modelování fyzikálních situací
ztoto¾òujeme orientovanou úseèku s jinou, která zaèíná v~jiném bodì,
ale je s pùvodní úseèkou rovnobì¾ná, má stejnou velikost a stejnou
orientaci. 

Z tohoto dùvodu je výhodné zavést lineární prostor 
tzv.~{\em volných vektorù~$V_3$}, ve kterém budeme ztoto¾òovat dvì úseèky, 
pokud jsou rovnobì¾né, mají stejnou velikost a jsou stejnì orientované.
\inl[prostor: volných vektorù, V3]
\inl[volný: vektor, vektor: volný]

\definice [dV3]
%%%%%%%%%
Nech» $U_O$ je lineární prostor 
z~pøíkladù\cite[UOznovu] a\cite[ssnaUO].
Volme $\vec u_O\in U_O$. Mno¾inu v¹ech orientovaných úseèek, které jsou 
s~úseèkou $\vec u_O$ rovnobì¾né a mají stejnou velikost a orientaci
nazýváme {\em vektorem lineárního prostoru~$V_3$}.
\inl[prostor: volných vektorù, V3]

Nech» $\vec u$ je vektor lineárního prostoru~$V_3$ Jde
tedy o~mno¾inu vzájemnì rovnobì¾ných úseèek stejnì
velkých a stejnì orientovaných. Jakoukoli orientovanu úseèku 
z~této mno¾iny nazýváme {\em reprezentantem vektoru $\vec u$}.
\inl[reprezentant: vektoru]

Na lineárním prostoru~$V_3$ definujeme sèítání vektorù a skalární
násobek. Nech» $\vec u\in V_3$, $\vec v\in V_3$. Volme 
nìjaký bod~$O\in\E_3$. Existuje právì jeden reprezentant vektoru
$\vec u$, který zaèíná v~bodì~$O$. Oznaème jej $\vec u_O$.
Dále nech» $\vec v_O$ je reprezentant vektoru $\vec v$ zaèínající 
v~bodì~$O$. Pak je definován souèet $\vec w_O=\vec u_O+\vec v_O$ na
lineárním prostoru~$U_O$. Souèet $\vec u + \vec v$ je takový prvek
z~$V_3$, pro který je $\vec w_O$ jeho reprezentantem zaèínajícím 
v bodì~$O$. Je to tedy mno¾ina v¹ech orientovaných úseèek
rovnobì¾ných, stejnì velkých a stejnì orientovaných, jako 
úseèka~$\vec w_O$.

Skalární násobek definujeme podobnì. Nech» je $\vec u\in V_3$, 
$\alpha\in\R$. Pro $\vec u$ existuje reprezentant $\vec u_O$ zaèínající 
v~bodì~$O$. K nìmu existuje skalární násobek definovaný v $U_O$.
Oznaème jej $\vec w_O = \alpha\,\vec u_O$. Výsledný vektor
$\alpha\,\vec u$ je vektorem z~$V_3$ takovým, ¾e $\vec w_O$ je jeho
reprezentant. 

Skalární souèin vektorù $\vec u\in V_3$, $\vec v\in V_3$
definujeme jako skalární souèin jejich reprezentantù $\vec u_O$ a
$\vec v_O$ v~lineárním prostoru~$U_O$.

Vektorový souèin $\vec u \times \vec v$ definujeme tak, ¾e
reprezentanty $\vec u_O$ a $\vec v_O$  vektorù 
$\vec u$ a $\vec v$ vynásobíme v~lineárním
prostoru $U_O$. Výsledný souèin $\vec u\times \vec v$ je takový vektor,
pro který je $\vec u_O\times\vec v_O$ jeho reprezentantem zaèínajícím
v~bodì $O$.

\poznamka
%%%%%%%%%
Dá se snadno ukázat, ¾e vý¹e definovaný souèet, skalární násobek, skalární
souèin a vektorový souèin vektorù z~$V_3$ nejsou závislé 
na volbì bodu $O\in\E_3$.

\poznamka
%%%%%%%%%
Volme pevnì bod $O\in\E_3$.
Uva¾ujme zobrazení, které ka¾dému vektoru $\vec u_O\in U_O$
pøiøadí $\vec u\in V_3$ tak, ¾e $\vec u_O$ je reprezentantem vektoru
$\vec u$ zaèínajícím v bodì $O$. Toto zobrazení je prosté a na. Navíc
je lineární. Jedná se tedy o~izomorfismus. V¹echny pojmy, které
jsme definovali na $U_O$ lze prostøednictvím tohoto izomorfismu
definovat i na lineárním prostoru~$V_3$. Napøíklad:

\definice [baseV3]
%%%%%%%%%
{\em Ortonormální báze na $V_3$} je taková báze, její¾ reprezentanti
zaèínající v nìjakém bodì~\hbox{$O\in\E_3$} tvoøí ortonormální bázi v~$U_O$.
Viz pøíklad\cite[baseUO].

{\em Kladnì orientovaná báze na~$V_3$} ja taková báze, její¾ reprezentanti
zaèínající v~nìjakém bodì~$O\in\E_3$ tvoøí kladnì orientovanou bázi v~$U_O$.
Viz definici\cite[kladneUO].
\inl[báze: ortonormální, ortonormální: báze] 
\inl[báze: kladnì orientovaná, kladnì orientovaná: báze]

\okraj Souèet bodu s~vektorem | Soucet bodu s vektorem

\poznamka
%%%%%%%%%
Pro potøeby popisù geometrických objektù se kromì souètu volných
vektorù mezi sebou hodí definovat souèet bodu 
s volným vektorem a rozdíl bodù. 

\definice [bod+vektor]
%%%%%%%%%
Pro ka¾dý bod $A\in\E_3$ a volný vektor $\vec v\in V_3$ existuje právì
jeden reprezentant vektoru~$\vec v$, který zaèíná v bodì $A$. Koncový
bod $B\in\E_3$ tohoto reprezentanta nazýváme {\em souètem bodu $A$ 
s~vektorem~$\vec v$} a znaèíme $B=A+\vec v$.
\inl[souèet: bodu s vektorem]

Pro ka¾dé dva body $A\in\E_3$, $B\in\E_3$ existuje $\vec v\in V_3$
takový, ¾e orientovaná úseèka s poèátkem v~bodì~$A$ a koncem 
v bodì~$B$ je reprezentantem tohoto vektoru. Vektor $\vec v$ nazýváme
{\em rozdílem $B-A$}, pí¹eme $\vec v = B-A$. Vektor $B-A$ se èasto
znaèí symbolem $\overrightarrow {AB}$.
\inl[rozdíl: bodù]

\poznamka
%%%%%%%%%
Shrneme si, co s èím mù¾eme sèítat a s jakým výsledkem:
$$\eqalign{
  \hbox{volný vektor $\pm$ volný vektor} &= \hbox{volný vektor}, \cr
  \hbox{bod $\pm$ volný vektor} &= \hbox{bod}, \cr
  \hbox{bod + bod} &\dots{} \hbox{\it nemá smysl}, \cr
  \hbox{bod $-$ bod} &= \hbox{volný vektor}.}
$$
Definice sèítání bodu s vektorem a odèítání bodù se vzájemnì doplòují,
tj.~platí $A + (B-A) = B$.

\okraj Pøímka a rovina | Primka a rovina

\priklad [popisprimky]
%%%%%%%%
V návaznosti na pøíklad\cite[UOznovu] a definici\cite[bod+vektor]
dostáváme následující popisy pøímek a rovin v~bodovém prostoru $\E_3$.

Nech» $\vec u\in V_3$ je nenulový vektor, $A\in\E_3$. Pak
$$
  p = A + \lob<\vec u> =
     \{X\in\E_3;\, X = A + t\,\vec u,\, t\in\R \}
$$
je pøímka v bodovém prostoru $\E_3$, která prochází bodem $A$
a je rovnobì¾ná se v¹emi reprezentanty vektoru $\vec u$.
Vektor~$\vec u$ se nazývá {\em smìrovým vektorem\/} pøímky~$p$.

Nech» dále $\{\vec u, \vec v\}\subset V_3$ jsou lineárnì nezávislé
vektory. Pak 
$$
  \varrho = A + \lob<\vec u, \vec v> =
     \{X\in\E_3;\, X = A + r\,\vec u + s\,\vec v, \, r\in\R,\, s\in\R \}
$$
je rovina v bodovém prostoru $\E_3$, která prochází bodem $A$. Navíc
reprezentanti vektorù $\vec u$ a $\vec v$ s~poèátkem 
v bodì~$A$ le¾í uvnitø této roviny. 
Vektorùm $\vec u$, $\vec v$ øíkáme {\em smìrové vektory roviny}.
\inl[pøímka, rovina]
\inl[smìrový: vektor: pøímky]
\inl[smìrový: vektor: roviny]

Existuje nekoneènì mnoho bodù a nekoneènì mnoho smìrových vektorù,
pomocí kterých je urèena stejná pøímka resp. stejná rovina. S touto
nejednoznaèností jsme se u¾ setkali pøi øe¹ení soustav lineárních
rovnic v~poznámkách\cite[popis-reseni] a\cite[ruznareseni].

\okraj Souøadnicový systém v $\E_3$ | Souradnicovy system v E3

\definice [soursystem]
%%%%%%%%%
Libovolný bod $O\in \E_3$ spoleènì s uspoøádanou bází 
$(B)=(\vec b_1, \vec b_2, \vec b_3)$ 
vektorù z~$V_3$ tvoøí
{\em souøadnicový systém bodového prostoru $\E_3$}. 

{\em Souøadnice vektoru $\vec u\in V_3$ v tomto souøadnicovém systému} 
definujeme jako souøadnice vektoru $\vec u$ vzhledem 
k uspoøádané bázi~$(B)$.

{\em Souøadnice bodu $A\in \E_3$ v tomto souøadnicovém systému}
definujeme jako souøadnice vektoru $A-O$. Vektor $A-O$ nazýváme 
v tomto kontextu {\em radiusvektorem bodu $A$}.
\inl[souøadnice: bodu, souøadnice: vektoru, souøadnicový systém]
\inl[radiusvektor]

Pøímky $O+\lob<\vec b_1>$, $O+\lob<\vec b_2>$, $O+\lob<\vec b_3>$
jsou {\em osy souøadnicového systému}. 
\inl[osa: souøadnic]

Je-li báze $(B)$ ortogonální, nazýváme odpovídající souøadnicový
systém {\em pravoúhlý}. Je-li báze $(B)$ ortonormální, nazýváme
odpovídající souøadnicový systém {\em kartézský}. Je-li báze $(B)$
kladnì orientovaná, mluvíme té¾ o~{\em kladnì orientovaném souøadnicovém
systému}.
\inl[pravoúhlý: souøadnicový systém, souøadnicový: systém: pravoúhlý]
\inl[kartézský: souøadnicový systém, souøadnicový: systém: kartézský]
\inl[kladnì orientovaný: souøadnicový systém, souøadnicový: systém: kladnì orientovaný]

\poznamka
%%%%%%%%%
Uvìdomíme si podrobnì, co to znamená, ¾e bod $A$ má souøadnice
$(a_1,a_2,a_3)$ vzhledem k~nìjakému souøadnicovému systému
$(O,(\vec b_1, \vec b_2, \vec b_3))$.
Podle vý¹e uvedené definice to znamená,
¾e vektor $A-O$ má souøadnice $(a_1,a_2,a_3)$,
co¾ podle definice souøadnic vektoru vzhledem k bázi znamená, ¾e
$$
  (A-O) = a_1\vec b_1 + a_2\vec b_2 + a_3\vec b_3.
$$ 

\veta [sourbodu]
%%%%%
Zvolme pevnì souøadnicový systém bodového prostoru $\E_3$, vzhledem ke
kterému budeme udávat souøadnice bodù a vektorù. Tento souøadnicový
systém nemusí být nutnì kartézský.
Nech» $A\in\E_3$ má souøadnice $(a_1,a_2,a_3)$, 
$B\in\E_3$ má souøadnice $(b_1,b_2,b_3)$,
$\vec u\in V_3$ má souøadnice $(u_1,u_2,u_3)$,
$\vec v\in V_3$ má souøadnice $(v_1,v_2,v_3)$,
$\alpha\in\R$, $\beta\in\R$.
Potom platí:

(1) Vektor $\alpha\,\vec u + \beta\,\vec v$ má souøadnice
    $\alpha\,(u_1,u_2,u_3) + \beta\,(v_1,v_2,v_3)$.

(2) Bod $A+\vec u$ má souøadnice $(a_1,a_2,a_3)+(u_1,u_2,u_3)$.

(3) Vektor $\overrightarrow{AB}=B-A$ má souøadnice 
    $(b_1,b_2,b_3)-(a_1,a_2,a_3)$.

\dukaz
%%%%%%
Ad (1). Zobrazení, které pøiøadí vektorùm jejich souøadnice, je podle
vìty\cite[sour-lin] lineární.

Ad (2). $(A-O)+\vec u$ je radiusvektor bodu $A+\vec u$. Dále se
pou¾ije vlastnost~(1).

Ad (3). Vyu¾ijeme napøíklad toho, ¾e $A+(B-A)=B$.

\poznamka
%%%%%%%%%
Proto¾e podle pøedchozí vìty se operace sèítání bodù s vektory dají
pøevést na operace sèítání uspoøádaných trojic jejich souøadnic, bývá
èasto zvykem ztoto¾nit body z $\E_3$ a vektory z~$V_3$ 
s~uspoøádanými trojicemi jejich souøadnic.
Pí¹eme tedy napøíklad $A=(1,2,-5)$ a èteme, ¾e bod 
$A$ má souøadnice $(1,2,-5)$. 

V jiné literatuøe (napø.\bcite[demlova]) se skuteènost, ¾e bod
$A$ má dány souøadnice, zapisuje bez rovnítka a do hranatých
závorek. Ná¹ pøíklad se souøadnicemi $(1,2,-5)$ by vypadal takto:
$A[1,2,-5]$. Osobnì toto znaèení nemám v oblibì, proto¾e mezi
oznaèením bodu $A$ a jeho souøadnicemi $[1,2,-5]$ chybí symbol pro
sloveso. 

\priklad
%%%%%%%%
Vypoèteme vzdálenost dvou bodù $A\in\E_3$ a $B\in\E_3$, pokud známe
jejich souøadnice v~kartézském souøadnicovém systému.

Vzdálenost bodù $A$ a $B$ je rovna velikosti vektoru $B-A$ a tu
spoèítáme podle definice velikosti jako
$\sqrt{(B-A)\cdot(B-A)}$. Pøitom skalární souèin spoèítáme podle
vìty\cite[soucin-dle-souradnic]. 

Uvedeme konkrétní pøíklad. Nech» $A=(1,2,-5)$, $B=(3,2,1)$. Vzdálenost
tìchto bodù je rovna velikosti vektoru $B-A$, který má podle 
vìty\cite[sourbodu] souøadnice $(2,0,6)$. Poèítáme velikost:
$$
  \|(2,0,6)\| = \sqrt{(2,0,6)\cdot(2,0,6)} = \sqrt{2^2+0^2+6^2} =
  \sqrt{40}.
$$
Uvedený postup s~pou¾itím vìty\cite[soucin-dle-souradnic] lze pou¾ít
jen pro souøadnice v~kartézském souøadnicovém systému, proto¾e tato
vìta pøedpokládá souøadnice vektoru vzhledem k~ortonormální bázi.
\inl[vzdálenost: bodù]

\priklad
%%%%%%%%
Vypoèteme obsah trojúhelníka v bodovém prostoru $\E_3$, pokud jsou dány
kartézské souøadnice jeho vrcholù $A, B, C$.

Podle vìty\cite[vs-geom] je obsah rovnobì¾níka roven velikosti
vektorového souèinu jeho stran. Trojúhelník pak bude mít obsah
polovièní. Obsah trojúhelníka tedy mù¾eme poèítat takto:
$$
  P = {\|(B-A)\times (C-A)\| \over 2}.
$$
\par\inl[obsah: trojúhelníka]

Jsou-li dány kartézské souøadnice vrcholù tøeba takto:
$A=(1,2,2)$, $B=(2,-3,3)$, $C=(1,4,5)$, pak staèí dosadit do právì
odvozeného vzorce:
$$\eqalign{
  P &= {\bigl\|\bigl((2,-3,3)-(1,2,2)\bigr)\times 
       \bigl((1,4,5)-(1,2,2)\bigr)\bigr\| \over 2} =
      {\|(1,-5,1)\times (0,2,3)\| \over 2} =\cr &= 
      {\|(-17, -3, 2)\| \over 2} =
      {\sqrt{17^2 + 3^2 + 2^2} \over 2} = {\sqrt{302}\over 2}.
}
$$
Pøi výpoètu jsme pou¾ili nejen vìty\cite[sourbodu], ale té¾
vìty\cite[vs-souradnice] pro výpoèet vektorového souèinu ze souøadnic a
vìty\cite[soucin-dle-souradnic] pro výpoèet skalárního souèinu, který
jsme potøebovali na výpoèet velikosti vektoru. Poslednì zmínìné vìty
pøedpokládají souøadnice vzhledem k ortonormální bázi, a proto bylo
nutné mít souøadnice bodù zadány v~{\it kartézském\/} systému
souøadnic.

\priklad
%%%%%%%%
Vypoèteme objem ètyøstìnu, urèeného vrcholy $A, B, C, D$. Tyto vrcholy
jsou dány v~kartézských souøadnicích.

Podle vìt\cite[sms-souradnice] a\cite[sms-geom] 
je objem rovnobì¾nostìnu roven absolutní
hodnotì z~determinantu, ve kterém jsou v~øádcích napsány
souøadnice jeho stran. Ètyøstìn bude mít objem ¹estinový,
proto¾e do rovnobì¾nostìnu se vejde právì ¹est ètyøstìnù se shodným
objemem. Kdo o tom pochybuje, rozkrájí si za domácí cvièení kostku
tvrdého sýra na ¹est ètyøstìnù se stejným objemem.

Nech» $\A$ je matice, která má v prvním øádku souøadnice vektoru
$B-A$, ve druhém øádku souøadnice $C-A$ a ve tøetím øádku souøadnice $D-A$.
Pak objem ètyøstìnu $V$ je roven $|\det\A|/6$.

Vìta\cite[sms-souradnice] pøedpokládá ortonormální bázi, proto je potøeba
pracovat se souøadnicemi bodù v~{\it kartézském\/} systému
souøadnic. 
\inl[objem: ètyøstìnu]

\okraj Rovnice pøímky | 
       Rovnice primky

\priklad
%%%%%%%%
Uká¾eme si, jak popí¹eme pøímku v~souøadnicovém systému.
Podle pøíkladu\cite[popisprimky] a vìty\cite[sourbodu] je pøímka~$p$
procházející bodem $A=(a_1,a_2,a_3)$ se smìrovým vektorem
$\vec u=(u_1,u_2,u_3)$ mno¾inou takových bodù $X=(x,y,z)$, pro které
platí:
$$
  X = A + t\,\vec u,\, t\in\R \quad \hbox{tj.}\quad
  (x,y,z) = (a_1, a_2, a_3) + t\,(u_1,u_2,u_3), t\in\R.
$$
Po rozepsání této rovnosti do jednotlivých souøadnic dostáváme
{\em parametrické rovnice pøímky\/}:
$$
  \eqalign{
  x &= a_1 + t\,u_1, \cr
  y &= a_2 + t\,u_2, \cr
  z &= a_3 + t\,u_3. \cr
}
$$
Pokud vypoèítáme z ka¾dé rovnice parametr $t$ a výsledky polo¾íme
sobì rovny, dostáváme tzv.~{\em kanonickou rovnici pøímky\/}:
$$
  {x-a_1 \over u_1} = {y-a_2 \over u_2} = {z-a_3 \over u_3}.
$$
\par\inl[rovnice: pøímky: parametrické, parametrické: rovnice: pøímky]
\inl[rovnice: pøímky: kanonická, kanonická: rovnice: pøímky]

\priklad
%%%%%%%%
Popí¹eme pøímku, která prochází body $A=(1,2,3)$ a $B=(2,2,0)$.

Smìrovým vektorem pøímky je napøíklad vektor $B-A=(1,0,-3)$ a pøímka
má tvar:
$$
  p = A + \lob<B{-}A>  = (1,2,3) + \lob<(1,0,-3)> =
      \bigl\{(x,y,z);\, (x,y,z) = (1,2,3) + t\,(1,0,-3),\,t\in\R\bigr\}.
$$
Odtud dostáváme parametrické rovnice pøímky:
$$
  \eqalign {
  x &= 1 + t, \cr
  y &= 2, \cr
  z &= 3 - 3t.
}
$$
a kanonický tvar:
$$
  {x-1 \over 1} = {y-2\over 0} = {z-3\over -3}.
$$
Na zlomky v kanonickém tvaru pohlí¾íme jako na formální zápisy a
nepozastavujeme se nad tím, ¾e se tam mù¾e vyskytnout dìlení
nulou. Kanonický tvar nám poskytuje informaci o souøadnicích smìrového
vektoru ve jmenovatelích zlomkù a souøadnice bodu $A\in p$ pøeèteme 
v~èitatelích zlomkù.

\priklad [vzdalenost-primka-bod]
%%%%%%%%
Uká¾eme, jak spoèítáme vzdálenost bodu $Q\in\E_3$ od pøímky
$p=A+\lob<\vec u>$.

Tato vzdálenost je rovna vý¹ce rovnobì¾níka urèeného stranami
$Q-A$ a $\vec u$. Základna tohoto rovnobì¾níka má 
velikost~$\|\vec u\|$. Platí tedy:
$$
  \hbox{vzdálenost bodu $Q$ od pøímky $p$} = 
  \hbox{vý¹ka rovnobì¾níka} =
  {\hbox{obsah rovnobì¾níka} \over \hbox{velikost základny}} =
  {\|(Q-A)\times \vec u\| \over \|\vec u\|}.
$$
\par\inl[vzdálenost: bodu od pøímky]

\okraj Vzájemná poloha\hb dvou pøímek | Vzajemna poloha dvou primek

\priklad [dveprimky]
%%%%%%%%
Vy¹etøíme vzájemnou polohu dvou pøímek
$p=A+\lob<\vec u>$ a $q=B+\lob<\vec v>$.

Jsou-li vektory $\vec u, \vec v, B{-}A$ lineárnì nezávislé, pak pøímky
nele¾í ve spoleèné rovinì a jsou tedy {\em mimobì¾né}. Ní¾e uká¾eme,
jak vypoèítáme vzdálenost tìchto pøímek.
\inl[mimobì¾ky]

Jsou-li vektory $\vec u, \vec v, B{-}A$ lineárnì závislé, pak pøímky
le¾í ve spoleèné rovinì a mohou být rùznobì¾né, rovnobì¾né
nebo toto¾né. Jsou-li v takovém pøípadì vektory $\vec u, \vec v$ lineárnì
nezávislé, jsou pøímky {\em rùznobì¾né}. Ní¾e uká¾eme, jak vypoèítáme
prùseèík a úhel mezi rùznobì¾kami. Jsou-li koneènì vektory 
$\vec u, \vec v$ lineárnì závislé, jedná se o {\em rovnobì¾ky} a v pøípadì,
¾e bod $B\in p$, pak tyto rovnobì¾ky splývají v~pøímku jedinou.
Ní¾e uká¾eme, jak vypoèítáme vzdálenost rovnobì¾ek.
\inl[rùznobì¾ky]

{\bf Vzdálenost dvou mimobì¾ek} poèítáme z objemu rovnobì¾nostìnu, urèeného
svými stranami $\vec u, \vec v, B{-}A$, který z jedné strany lze poèítat jako
absolutní hodnotu smí¹eného souèinu a z druhé strany je tento objem
roven obsahu rovnobì¾níka základny krát vý¹ka.
Tato vý¹ka je pøitom hledaná vzdálenost. Platí tedy:
$$
  \hbox{vzdálenost mimobì¾ek} = 
  {\hbox{objem rovnobì¾nostìnu} \over \hbox{obsah základny}} =
  {|(B-A)\cdot(\vec u\times\vec v)| \over \|\vec u\times\vec v\|} =
  {|\det\A| \over \|\vec u\times\vec v\|},
  \rce(vzdalenostmimo)
$$
kde matice $\A$ obsahuje postupnì øádky se souøadnicemi vektorù
$B-A$, $\vec u$, $\vec v$.

{\bf Vzdálenost rovnobì¾ek} vypoèítáme jako vzdálenost bodu na jedné
rovnobì¾ce od rovnobì¾ky druhé. To jsme dìlali 
v~pøíkladu\cite[vzdalenost-primka-bod]. Máme tedy u¾ odvozený vzorec:
$$
  \hbox{vzdálenost rovnobì¾ek} = {\|(B-A)\times \vec u\|\over \|\vec u\|}.
$$

{\bf Úhel mezi rùznobì¾kami} je roven úhlu $\phi$ mezi vektory
$\vec u$, $\vec v$, který spoèítáme podle definice\cite[uhel]. 
Mù¾e se ale stát, ¾e tento úhel vychází vìt¹í ne¾ $\pi/2$.
V takovém pøípadì je úhel mezi pøímkami roven $\pi-\phi$. Tento
vzorec vyplývá z~toho, ¾e mezi rùznobì¾kami mù¾eme mìøit dva úhly
a za \uv{oficiální} úhel mezi nimi pova¾ujeme ten men¹í z nich.
Proto¾e platí $|\cos\phi| = \cos\phi$ pro $0\le\phi\le\pi/2$ a
$|\cos\phi| = \cos(\pi-\phi)$ pro $\pi/2<\phi\le\pi$, mù¾eme oba
pøípady zahrnout do jediného vzorce, ve kterém pí¹eme
absolutní hodnotu skalárního souèinu:
$$
  \cos\phi = {|\vec u\cdot\vec v| \over \|\vec u\|\, \|\vec v\|}.
  \rce(uhelmimobezek)
$$

{\bf Souøadnice prùseèíku rùznobì¾ek} spoèítáme jako spoleèné øe¹ení
parametrických rovnic jednak pro pøímku $p$ a jednak pro pøímku $q$.
\inl[vzdálenost: mimobì¾ek]
\inl[úhel: pøímek]
\inl[vzdálenost: rovnobì¾ek]
\inl[prùseèík: rùznobì¾ek]

\priklad
%%%%%%%%
Vy¹etøíme vzájemnou polohu pøímek $p$ a $q$, které jsou dány svými
parametrickými rovnicemi v kartézském souøadnicovém systému:
$$
  \let\quad=\relax
  p: ~~\matrix{x &{}= 1 + t\cr
             y &{}= \hfill 2t \cr
             z &{}= 2\hfill} \qquad
  q: ~~\matrix{x &{}= 3 + t\cr
             y &{}= 2 \hfill\cr
             z &{}= 1 - t}~~.
$$

Z rovnic okam¾itì vidíme souøadnice bodu, kterým pøímka prochází a
souøadnice smìrového vektoru:
$$
  p = (1,0,2) + \lob<(1,2,0)>, \qquad
  q = (3,2,1) + \lob<(1,0,-1)>.
$$
Pøi oznaèení $A=(1,0,2)$, $B=(3,2,1)$ je $B-A=(2,2,-1)$. Zjistíme
lineární závislost vektoru $B-A$ a smìrových vektorù tak, ¾e zapí¹eme
souøadnice tìchto vektorù do matice a poèítáme determinant:
$$
  \left| \matrix{2 & 2 &-1 \cr 1 & 2 & \phantom{+}0 
         \cr 1 & 0 & -1} \right| = 0.
  \rce (detprimek)
$$
Zkoumané vektory jsou lineárnì závislé, pøímky tedy le¾í ve spoleèné
rovinì. Proto¾e smìrové vektory $(1,2,0)$, $(1,0,-1)$ jsou lineárnì
nezávislé, $p$, $q$ jsou {\em rùznobì¾ky}.

Úhel mezi rùznobì¾kami poèítáme podle vzorce\cite(uhelmimobezek):
$$
  \cos \phi = {|(1,2,0)\cdot(1,0,-1)| \over \|(1,2,0)\|\,\, \|(1,0,-1)\|} =
              {|1+0+0| \over \sqrt{1^2+2^2+0^2}\sqrt{1^1+0^2+1^2} } =
              {1\over \sqrt{10}}, \quad \hbox{tj.} \quad
  \phi = \arccos {1\over \sqrt{10}}.
$$
Prùseèík vychází z rovnic $x=x$, $y=y$, $z=z$, kde za souøadnice 
$x, y, z$ dosadíme pravé strany odpovídajících parametrických rovnic a
u~pøímky $q$ zvolíme pro parametr jiné oznaèení:
$$
  \eqalign{
  1 + t &= 3 + s \cr
  2t    &= 2 \cr
  2     &= 1 - s
}
$$
Soustava je sice \uv{pøeurèena} (je zde více rovnic ne¾ neznámých),
ale proto¾e nám vy¹el determinant\cite(detprimek) nulový, má tato
soustava urèitì øe¹ení. Øe¹ením je v tomto pøípadì $t = 1$, $s = -1$.
Dosazením tøeba $t=1$ do parametrických rovnic pøímky $p$ dostáváme
souøadnice prùseèíku: $P=(1,0,2) + 1\cdot(1,2,0) = (2,2,2)$.

\priklad
%%%%%%%%
Vy¹etøíme vzájemnou polohu pøímky $p$ procházející body $A$, $B$ 
s pøímkou $q$ procházející body $C$, $D$. Body jsou dány v~kartézských
souøadnicích takto: $A=(1,2,3)$, $B=(3,2,1)$, $C=(1,0,2)$,
$D=(4,2,3)$.

Smìrový vektor pøímky $p$ je tøeba $B-A=(2,0,-2)\sim(1,0,-1)$. Za
vlnkou jsme napsali sice jiný smìrový vektor, ale je to rovnì¾ smìrový
vektor pøímky $p$ a navíc má souøadnice, se kterými se nám bude
pohodlnìji pracovat. Smìrový vektor pøímky $q$ je tøeba 
$D-C=(3,2,1)$. Máme tedy:
$$
  p = (1,2,3) + \lob<(1,0,-1)>, \qquad
  q = (1,0,2) + \lob<(3,2,1)>.
$$
Snadno ovìøíme, ¾e vektory $A-C, (1,0,-1), (3,2,1)$ jsou lineárnì
nezávislé, tak¾e pøímky jsou {\em mimobì¾né}. Determinant matice, obsahující
souøadnice tìchto vektorù, je roven~$-6$.
Vzdálenost mimobì¾ek poèítáme podle vzorce\cite(vzdalenostmimo):
$$
  { |\det\A|\over \|(1,0,-1)\times(3,2,1)\| } = 
  { | -6 | \over \|(2,-4,2)\| } =
  { 6 \over \sqrt{2^2 + 4^2 + 2^2} } = {6\over \sqrt{24}}.
$$

\okraj Rovnice\hb roviny | Rovnice roviny

\priklad
%%%%%%%%
Uká¾eme si, jak mù¾eme popsat rovinu $\varrho$ v souøadnicovém systému.

Nech» je rovina~$\varrho$ urèena bodem $A=(a_1,a_2,a_3)$, 
kterým prochází, a dvìma lineárnì nezávislými smìrovými vektory
\hbox{$\vec u=(u_1,u_2,u_3)$}, $\vec v=(v_1,v_2,v_3)$.
Podle pøíkladu\cite[popisprimky] je rovina~$\varrho$ mno¾inou takových
bodù $X=(x,y,z)$, pro které platí:
$$
  X = A + t\,\vec u + s\,\vec v, t\in\R, s\in\R, \quad \hbox{tj.}\quad
  (x,y,z) = (a_1,a_2,a_3) + t\,(u_1,u_2,u_3) + s\,(v_1,v_2,v_3), 
  t\in\R, s\in\R.
$$
Rozepsáním do jednotlivých souøadnic nám vycházejí 
{\em parametrické rovnice roviny\/}:
$$
   \eqalign{
  x &= a_1 + t\,u_1 + s\,v_1 \cr
  y &= a_2 + t\,u_2 + s\,v_2 \cr
  z &= a_3 + t\,u_3 + s\,v_3 \cr
}
$$
Na rozdíl od parametrických rovnic pøímky se s parametrickými rovnicemi
roviny moc èasto nesetkáme. Místo toho se pracuje s~{\em normálovým
vektorem roviny}, co¾ je libovolný nenulový vektor $\vec n$, 
který je kolmý na rovinu~$\varrho$. Rovina je urèena jedním bodem
$A=(a_1,a_2,a_3)$, kterým prochází, a normálovým vektorem $\vec n=(a,b,c)$.
Rovina je pak mno¾inou takových bodù $X=(x,y,z)$, pro které platí:
$$
 (X-A)\kolmy \vec n, \quad \hbox{tj.}\quad
 (X-A)\cdot\vec n = 0, \quad \hbox{tj.}\quad
 (x-a_1, y-a_2, z-a_3)\cdot (a,b,c) = 0. 
$$
V kartézském souøadnicovém systému mù¾eme pro výpoèet skalárního
souèinu pou¾ít vìtu\cite[soucin-dle-souradnic] a dostáváme
{\em normálovou rovnici roviny}, nebo prostì jen {\em rovnici roviny\/}:
$$
  ax + by + cz + d = 0, \quad \hbox{kde}\quad
  d = - a a_1 - b a_2 - c a_3.
$$
Uvìdomíme si, ¾e v rovnici roviny jsou pøímo èitelné souøadnice
normálového vektoru roviny $\vec n=(a,b,c)$, co¾ je velmi u¾iteèná informace.
\inl[rovnice: roviny: parametrické, parametrické: rovnice: roviny]
\inl[rovnice: roviny: normálová, normálová: rovnice: roviny, rovnice: roviny]
\inl[normálový: vektor, vektor: normálový]

\priklad
%%%%%%%%
Uká¾eme si, jak je mo¾né pøejít od smìrových vektorù $\vec u$, $\vec v$ 
roviny $\varrho$ k~normálové rovnici roviny. 

Proto¾e smìrové vektory $\vec u$ a $\vec v$
jsou lineárnì nezávislé, je $\vec n=\vec u\times \vec v$ normálovým
vektorem roviny. Je toti¾ podle definice vektorového souèinu kolmý na
oba vektory $\vec u$ a $\vec v$ a tedy je kolmý na celou
rovinu~$\varrho$. Abychom na¹li konstanty $a,b,c$ pou¾ité v~normálové rovnici
roviny, staèí tedy vypoèítat vektorový souèin $\vec u\times \vec v$. 
Konstantu $d$ dopoèítáme buï ze skuteènosti, ¾e je dán bod $A\in\E_3$, který 
v~rovinì le¾í, nebo vyhodnocením skalárního souèinu jako v~pøedchozím
pøíkladu.

Existuje je¹tì jeden zpùsob sestavení normálové rovnice ze smìrových
vektorù $\vec u$, $\vec v$. Rovina $\varrho$, která prochází bodem
$A\in\E_3$, je toti¾ také mno¾inou bodù $X\in\E_3$, pro které 
je trojice vektorù $(X-A), \vec u, \vec v$ lineárnì závislá. Jinými
slovy pro matici, která obsahuje v øádcích souøadnice tìchto vektorù,
musí platit, ¾e má nulový determinant. Pøi $A=(a_1,a_2,a_3)$,
$\vec u=(u_1,u_2,u_3)$, $\vec v=(v_1,v_2,v_3)$, $X=(x,y,z)$ nám
vychází:
$$
  \left| \matrix {x-a_1 & y-a_2 & z-a_3 \cr
                  u_1 & u_2 & u_3 \cr
                  v_1 & v_2 & v_3} \right| = 0.
$$
Výpoètem tohoto determinantu dostáváme normálovou rovnici roviny.

\priklad
%%%%%%%%
Najdeme rovnici roviny, která prochází body $A=(1,2,3)$, 
$B=(1,1,1)$, $C=(2,0,2)$.

Jedná se o rovinu, která prochází napøíklad bodem $A$ a je urèena
smìrovými vektory $B-A$, $C-A$. Jinými slovy
$$
  \varrho = A + \lob< B-A, C-A > = 
  (1,2,3) + \lob<(0, -1, -2), (1, -2, -1)>.
$$
Je tedy $\varrho$ mno¾ina takových bodù $X=(x,y,z)$, pro které platí
$$
  (x,y,z) = (1,2,3) + t\,(0, -1, -2) + s\,(1, -2, -1),\, t\in\R,\, s\in\R.
$$
Odtud dostáváme parametrické rovnice roviny $\varrho$:
$$
  \eqalign{
     x &= 1 + s \cr
     y &= 2 - t - 2s \cr
     z &= 3 - 2t - s
}
$$
Normálový vektor roviny $\varrho$ spoèítáme jako vektorový 
souèin smìrových vektorù:
$$
  \vec n = (0, -1, -2) \times (1, -2, -1) = (-3, -2, 1).
$$
Rovnice roviny má tedy tvar $-3x -2y + z + d = 0$. Konstantu $d\in\R$
najdeme napøíklad na základì skuteènosti, ¾e $A\in\varrho$, tak¾e musí
platit
$$
  -3\cdot 1 -2\cdot 2 + 3 + d = 0, \quad \hbox{tj.} \quad
  d = 4 \quad\hbox{a rovnice roviny je:} \quad
  -3x -2y + z + 4 = 0.
$$
Druhý zpùsob sestavení rovnice roviny výpoètem determinantu vypadá takto:
$$
  \left| \matrix {x-1 & y-2 & z-3 \cr 
                   0& -1& -2 \cr 1& -2& -1} \right| = 0,
  \quad\hbox{tj.}\quad
  -3x -2y + z + 4 = 0.
$$

\priklad [bod-rovina]
%%%%%%%%
Najdeme vzdálenost bodu $Q\in\E_3$ od roviny~$\varrho$.

Nech» $A$ je libovolný bod roviny $\varrho$. Vzdálenost bodu
$Q$ od roviny $\varrho$ je rovna absolutní hodnotì kolmého prùmìtu
vektoru $Q-A$ do normálového vektoru~$\vec n$ roviny~$\varrho$. Na
výpoèet velikosti kolmého prùmìtu vektoru pou¾ijeme skalární
souèin podle definice\cite[kolmyprumet]. Dostáváme:
$$
  \hbox{vzdálenost bodu od roviny} = {|(Q-A)\cdot \vec n| \over \|\vec n\|}.
  \rce(bod-od-roviny)
$$
\par\inl[vzdálenost: bodu od roviny]

Nech» napøíklad $Q=(1,4,3)$ a rovina $\varrho$ má rovnici 
$3x - 2y + 4z + 6 = 0$ v~kartézských souøadnicích. Z~rovnice roviny
okam¾itì vidíme souøadnice normálového vektoru $\vec n=(3,-2,4)$.
Musíme je¹tì najít aspoò jedno øe¹ení rovnice roviny, abychom 
získali souøadnice bodu $A\in\varrho$. 
Pøi $x=0$ a $z=0$ vychází $y=3$, tak¾e pou¾ijeme
bod $A=(0,3,0)$, $Q-A=(1,1,3)$. Hledaná vzdálenost je:
$$
  v = {|(1,1,3)\cdot (3,-2,4)| \over \|(3,-2,4)\| } =
      {| 1\cdot3 + 1\cdot(-2) + 3\cdot4 | \over \sqrt{3^2 + 2^2 + 4^2}} 
      = {13\over \sqrt{29}}.
$$

\okraj Vzájemná poloha\hb pøímky a roviny | Vzajemna poloha primky a roviny

\priklad
%%%%%%%%
Vy¹etøíme vzájemnou polohu pøímky $p=A+\lob<\vec u>$ a
roviny~$\varrho$, která prochází daným bodem $B$ a má normálový
vektor~$\vec n$.

Je-li $\vec u\kolmy\vec n$, neboli $\vec u\cdot\vec n=0$, pak je pøímka
rovnobì¾ná s rovinou. V takovém pøípadì je¹tì mù¾e nastat situace, kdy
celá pøímka le¾í v rovinì, co¾ zjistíme napøíklad podle toho, ¾e 
$(B-A)\kolmy\vec n$, neboli $(B-A)\cdot\vec n=0$. Pokud je pøímka
rovnobì¾ná s rovinou, urèíme vzdálenost pøímky~$p$ od roviny~$\varrho$
stejnì jako vzdálenost bodu~$A\in p$ od roviny~$\varrho$. To jsme se
nauèili v~pøedchozím pøíkladì\cite[bod-rovina].

Je-li $\vec u\cdot\vec n\ne 0$, pak pøímka $p$ protíná rovinu $\varrho$
v~jediném bodì. Prùseèík najdeme tak, ¾e dosadíme hodnoty $x, y, z$ 
z~parametrických rovnic pøímky do rovnice roviny. Tím dostaneme
hodnotu parametru, který nám dá po dosazení do parametrických rovnic
souøadnice hledaného prùseèíku. Tento postup ilustrujeme
v~následujícím pøíkladì.

Úhel mezi pøímkou $p$ protínající rovinu $\varrho$ a 
touto rovinou je roven $\alpha=\pi/2-\phi$,
kde $\phi$ je úhel mezi smìrovým vektorem pøímky $\vec u$ a
normálovým vektorem roviny $\vec n$. Pokud $\phi$ vychází vìt¹í
ne¾ $\pi/2$, vezmeme místo nìj úhel $\pi-\phi$ stejnì, jako jsme to
dìlali pøi zji¹»ování úhlu mezi pøímkami. Platí:
$$
  \sin\alpha = \cos(\pi/2 - \alpha) = \cos\phi =
  {|\vec u\cdot\vec n|\over \|\vec u\|\,\,\|\vec n\|}, \quad\hbox{tj.}\quad
  \alpha = \arcsin {|\vec u\cdot\vec n|\over \|\vec u\|\,\,\|\vec n\|}\,.
  \rce(uhelprimky+roviny)
\inl[úhel: pøímky a roviny, vzdálenost: pøímky od roviny, prùseèík: pøímky s rovinou] 
$$

\priklad
%%%%%%%%
Vy¹etøíme vzájemnou polohu pøímky $p=(1,2,3) + \lob<(1,0,2)>$ a
roviny~$\varrho$, která prochází bodem $B=(3,3,1)$ a má normálový vektor
$\vec n=(2,1,0)$. Souøadnice jsou dány v~kartézském souøadnicovém
systému.

Na základì skuteènosti, ¾e $B\in\varrho$, mù¾eme doplnit
konstantu~$d$ do rovnice roviny, kterou zatím máme ve tvaru 
$2x + y + 0z + d = 0$. Dosazením souøadnic bodu $B$ máme 
$2\cdot3 + 3 + d = 0$, tak¾e $d=-9$ a rovnice roviny~$\varrho$
je ve tvaru $2x + y - 9 = 0$. 

Smìrový vektor pøímky $(1,0,2)$ není kolmý na normálový vektor roviny
$(2,1,0)$, proto¾e skalární souèin $(1,0,2)\cdot(2,1,0)=2$. Pøímka
tedy protíná rovinu. Spoèítáme úhel mezi pøímkou a rovinou podle
vzorce\cite(uhelprimky+roviny):
$$
  \alpha = \arcsin {|(1,0,2)\cdot(2,1,0)| \over 
                    \|(1,0,2)\|\,\,\|(2,1,0)\| } = 
           \arcsin {2\over \sqrt{5}\sqrt{5}} = \arcsin {2\over 5}\,.
$$

Nyní spoèítáme prùseèík pøímky~$p$ s rovinou $\varrho$. Do rovnice
roviny dosadíme parametrické rovnice pøímky $x=1+t$, $y=2$, $z=3+2t$:
$$
  2\cdot(1+t) + 2 - 9 = 0, \quad\hbox{tj.}\quad
  2t - 5 = 0, \quad\hbox{tj.}\quad  t = {5\over 2}\,.
$$
Prùseèík má souøadnice $P=(1,2,3) + {5\over 2}\,(1,0,2) =
({7\over2},2,8)$.

\okraj Vzájemná poloha\hb dvou rovin | Vzajemna poloha dvou rovin

\priklad [dveroviny]
%%%%%%%%
Vy¹etøíme vzájemnou polohu dvou rovin. Nech» rovina $\varrho$ prochází
bodem $A$ a má normálový vektor $\vec m$ a rovina $\sigma$ prochází
bodem $B$ a má normálový vektor $\vec n$.

Pokud jsou vektory $\vec m$ a $\vec n$ lineárnì nezávislé, roviny se
protínají v pøímce $p$. Tuto prùseènici najdeme jako mno¾inu v¹ech
øe¹ení soustavy dvou lineárních rovnic rovin~$\varrho$ a $\sigma$ 
o tøech neznámých $x, y, z$. 
Nebo mù¾eme vypoèítat smìrový vektor prùseènice jako
vektorový souèin $\vec u=\vec m\times\vec n$, proto¾e prùseènice musí být
kolmá k~obìma normálovým vektorùm. I v tomto pøípadì ale musíme najít
je¹tì aspoò partikulární øe¹ení zmínìné soustavy dvou lineárních
rovnic, abychom mohli prùseènici popsat ve tvaru \hbox{$p=P+\lob<\vec u>$}.

Pokud jsou vektory $\vec m$ a $\vec n$ lineárnì závislé, roviny jsou
rovnobì¾né nebo splývají. Druhý pøípad poznáme tak, ¾e je $B\in\varrho$.
Vzdálenost rovnobì¾ných rovin $\varrho$ a $\sigma$ vypoèítáme jako
vzdálenost bodu $B\in\sigma$ od roviny $\varrho$, viz
pøíklad\cite[bod-rovina]. 

Úhel mezi dvìma rùznobì¾nými rovinami $\varrho$ a $\sigma$ je shodný 
s úhlem $\phi$ mezi vektory $\vec m$ a $\vec n$ a¾ na to, ¾e pokud
vychází tento úhel vìt¹í ne¾ $\pi/2$, bereme místo nìj hodnotu
$\pi-\phi$ (podobnì jako pøi mìøení úhlu mezi pøímkami). Dostáváme
tedy vzorec:
$$
  \phi = \arccos {|\vec m\cdot\vec n| \over \|\vec m\|\, \|\vec n\|}\,.
  \rce(uhelrovin)
$$
\par\inl[úhel: rovin, vzdálenost: rovin, prùseènice: rovin]

\priklad
%%%%%%%%
Jsou dány roviny $\varrho$ a $\sigma$ svými rovnicemi v kartézských
souøadnicích:
$$
  \eqalign{
   \varrho: \qquad &  x + y + 2z - 1 = 0, \cr
   \sigma:  \qquad &  x - y \phantom{{}+ 2z} + 1 = 0. 
}
\rce(soustavarovin)
$$
Vy¹etøíme jejich vzájemnou polohu.

Normálový vektor roviny~$\varrho$ je $(1,1,2)$ a normálový vektor
roviny~$\sigma$ je $(1,-1,0)$. Tyto dva vektory jsou lineárnì
nezávislé, tak¾e se roviny protínají. Mno¾ina v¹ech øe¹ení 
soustavy\cite(soustavarovin) je 
$$
  p=(0,1,0) + \lob<(-1,-1,1)>, 
$$
co¾ je prùseènice rovin~$\varrho$ a $\sigma$. Úhel mezi rovinami je
$$
  \phi = \arccos {|(1,1,2)\cdot(1,-1,0)| \over 
                  \|(1,1,2)\|\,\,\|(1,-1,0)\|} =
         \arccos 0 = {\pi\over2}, 
$$
tak¾e roviny jsou na sebe kolmé.

\priklad
%%%%%%%%
Jsou dány roviny $\varrho$ a $\sigma$ svými rovnicemi v kartézských
souøadnicích:
$$
  \eqalign{
   \varrho: \qquad & \mathbin{\phantom{-}}x + y - 2z - 1 = 0 \cr
   \sigma:  \qquad &  -x - y + 2z  + 3 = 0 
}
\rce(soustavarovin2)
$$
Vy¹etøíme jejich vzájemnou polohu.

Normálový vektor roviny~$\varrho$ je $(1,1,-2)$ a normálový
vektor roviny~$\sigma$ je $(-1,-1,2)$. Tyto dva vektory jsou lineárnì
závislé, tak¾e roviny~$\varrho$ a $\sigma$ jsou rovnobì¾né. Proto¾e
soustava\cite(soustavarovin2) nemá ¾ádné øe¹ení, roviny nesplývají.

Najdeme si nìjaké body $A\in\varrho$, $B\in\sigma$. Pøi $y=0$, $z=0$
vychází pro rovinu~$\varrho$ souøadnice $x=1$ a pro rovinu $\sigma$
vychází $x=3$. Máme tedy $A=(1,0,0)$, $B=(3,0,0)$.
Vzdálenost dvou rovnobì¾ných rovin spoèítáme jako vzdálenost bodu $B$
od roviny $\varrho$ podle vzorce\cite(bod-od-roviny):
$$
  v = {|(B-A)\cdot \vec n| \over \|\vec n\|} =
      {|(2,0,0)\cdot (1,1,-2)| \over \|(1,1,-2)\|} =
      {2\over \sqrt{1^2+1^2+2^2} } = {2\over \sqrt{6}}\,.
$$

\okraj Soumìrné body | Soumerne body

\priklad
%%%%%%%%
Najdeme bod $Q'$, který je soumìrný s~bodem $Q$ podle
roviny~$\varrho$. Nech» má tato rovina v~kartézských souøadnicích
rovnici $x-2y+z-1=0$ a nech» je $Q=(-1,5,0)$.

Body $Q$ a $Q'$ le¾í na spoleèné kolmici~$k$ k rovinì~$\varrho$, jsou
stejnì vzdáleny od roviny a le¾í v~opaèných èástech prostoru $\E_3$, 
které rovina~$\varrho$ ohranièuje. 

Smìrový vektor kolmice $k$ je roven normálovému vektoru
roviny~$\varrho$, tak¾e je 
$$
k=(-1,5,0)+\lob<(1,-2,1)>.
$$
Dosadíme
hodnoty $x,y,z$ z~parametrických rovnic kolmice do rovnice roviny:
$$
  x=-1+t, \quad y=5-2t, \quad z=t, \quad 
  (-1+t) -2\,(5-2t) + t -1 = -12 + 6t = 0, \quad\hbox{tj.}\quad
  t = 2.
$$
Pokud pro $t=2$ získáme prùseèík kolmice s rovinou, pak pro
dvojnásobnou hodnotu parametru $t=4$ dostaneme hledaný bod $Q'$. Je
tedy $Q'=(-1,5,0) + 4\,(1,-2,1) = (3,-3,4)$.
\inl[bod: soumìrný: podle roviny]

\priklad
%%%%%%%%
Najdeme bod $Q'$, který je soumìrnì sdru¾ený podle pøímky 
$p=A+\lob<\vec u>$ s~bodem~$Q$. 

Body $Q$ a $Q'$ le¾í na spoleèné pøímce $k$, která je kolmá
na pøímku~$p$ a protíná ji. Mají stejnou vzdálenost od prùseèíku $P$ a le¾í na
opaèných polopøímkách pøímky $k$, které mají poèátek v~bodì~$P$. 
Pøímka~$k$ le¾í v~rovinì~$\sigma$, která je kolmá na vektor 
$\vec u$, tak¾e $\vec u$ je normálovým vektorem této roviny. Prùseèík~$P$
spoèítáme jako prùseèík roviny $\sigma$ s~pøímkou $p$ a pro hledaný 
bod $Q'$ platí $Q' = P + (P-Q)$.

Nech» jsou napøíklad dány kartézské souøadnice 
$Q=(-4,5,8)$, $A=(-6,1,1)$, $\vec u=(5,1,3)$. Rovnice roviny $\sigma$
je $5x+y+3z+d=0$. Proto¾e $Q\in\sigma$, dostáváme $d=-9$, tak¾e rovina
$\sigma$ je urèena rovnicí $5x+y+3z-9=0$. Spoèítáme dále prùseèík
pøímky~$p$ s rovinou~$\sigma$:
$$
  5\,(-6+5t) + (1+t) + 3\,(1+3t) - 9 = -35 + 35t = 0, 
  \quad\hbox{tj.}\quad t = 1.
$$
Prùseèík pøímky $p$ s rovinou $\sigma$ tedy je 
$P=(-6,1,1) + 1\,(5,1,3) = (-1,2,4)$. Nyní spoèítáme souøadnice
hledaného bodu:
$$
  Q' = (-1,2,4) + (P-Q) = (-1,2,4) + (3,-3,-4) = (2,-1,0).
$$
\par\inl[bod: soumìrný: podle pøímky]

\okraj Tøi roviny | Tri roviny

\priklad
%%%%%%%%
Uká¾eme geometrickou interpretaci mno¾iny øe¹ení soustavy tøí
lineárních rovnic o tøech neznámých.

Ztoto¾níme-li uspoøádanou trojici $(x,y,z)$ s bodem v $\E_3$, pro
který jsou $(x,y,z)$ jeho souøadnice vzhledem k nìjakému pevnì
zvolenému souøadnicovému systému, mù¾eme mluvit o mno¾inách øe¹ení
soustavy jako o bodech, pøímkách a rovinách. Pak jsou jednotlivé
rovnice soustavy té¾ rovnicemi rovin. Tøi rovnice v soustavì znamenají, ¾e
pracujeme se tøemi rovinami. Mno¾ina v¹ech øe¹ení takové soustavy je pak
spoleèným prùnikem v¹ech tøí rovin.

Dvì rovnice jsou rovnicemi stejné roviny právì tehdy, kdy¾ jedna
rovnice je násobkem druhé. Pro dal¹í rozbor tento pøípad vylouèíme a
budeme tedy pracovat se tøemi rovinami, z~nich¾ ¾ádné dvì nejsou
toto¾né. Oznaèíme je¹tì symbolem $M_0$ lineární prostor øe¹ení pøidru¾ené
homogenní soustavy.

Pøípad $\dim M_0 = 3$ mù¾eme vylouèit, proto¾e rovnice roviny nemohou
mít v¹echny koeficienty nulové. 

Má-li soustava øe¹ení, pak nemù¾e $\dim M_0 = 2$, proto¾e to by
znamenalo, ¾e v¹echny tøi roviny jsou toto¾né. Takový pøípad 
jsme pøed chvílí rovnì¾ vylouèili.

Má-li soustava øe¹ení a je-li $\dim M_0 = 1$ 
(tj. hodnost matice soustavy je rovna~2), pak
mno¾ina v¹ech øe¹ení tvoøí pøímku, která je spoleènou prùseènicí v¹ech
tøí rovin.

Má-li soustava jediné øe¹ení (tj. hodnost matice soustavy je rovna~3), pak
toto øe¹ení tvoøí bod~$P$, který je spoleèným
prùseèíkem v¹ech tøí rovin. Ka¾dé dvì roviny mají spoleènou prùseènici
a tyto tøi prùseènice se rovnì¾ protínají v~bodì~$P$.

Je-li mno¾ina øe¹ení prázdná (tj. hodnost matice soustavy je 2 a
roz¹íøené matice soustavy je~3), pak roviny jsou buï v¹echny tøi vzájemnì
rovnobì¾né, nebo jsou dvì roviny rovnobì¾né a tøetí je protíná nebo se
tyto tøi roviny protínají ka¾dá s ka¾dou v nìjaké prùseènici a tyto
tøi prùseènice jsou rovnobì¾né. K rozli¹ení tìchto pøípadù mù¾eme
pou¾ít testy na lineární závislost a nezávislost normálových vektorù
odpovídajících rovin podobnì, jako v pøíkladì\cite[dveroviny].

\icviceni 9

\fi

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\kapitola Polynomy | Polynomy
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\poznamka
%%%%%%%%%
S polynomy jsme se v tomto textu u¾ na mnoha místech
setkali. Pracovali jsme s~nimi jako s funkcemi danými jistým vzorcem
a shledali jsme, ¾e mno¾ina polynomù tvoøí lineární prostor.
V~této kapitole se na polynomy podíváme ponìkud dùkladnìji a budeme
vy¹etøovat zejména vlastnosti jejich koøenù.

\okraj Definice\hb polynomu | Definice polynomu

\poznamka
%%%%%%%%%
Na polynom se mù¾eme dívat dvìma pohledy. Buï jako na funkci danou
jistým vzorcem (definice\cite[dpolf]) nebo polynom ztoto¾níme s tím 
vzoreèkem samotným (definice\cite[dpolv]).
Ka¾dý pøístup vede k jinému zpùsobu porovnávání dvou polynomù, sèítání
polynomù a násobení polynomu konstantou nebo polynomem.

Zavedeme tedy lineární prostor polynomù jednak jako podprostor funkcí 
se sèítáním a násobením obvyklým pro funkce. Dále zavedeme 
jiný lineární prostor polynomù jako vzoreèkù se sèítáním 
a násobením tìch vzoreèkù. Nakonec uká¾eme, ¾e tyto dva lineární 
prostory jsou izomorfní, tedy, ¾e mezi polynomy
jako funkcemi a polynomy jako vzoreèky existuje vzájemnì jednoznaèný 
vztah.

Pokud se ètenáø nechce zatì¾ovat intuitivnì samozøejmými úvahami o
tom, ¾e polymom vnímaný jako vzoreèek podle definice\cite[dpolv] 
je víceménì toté¾, co polynom vnímaný jako funkce 
podle definice\cite[dpolf], mù¾e následující text
pøeskoèit a pokraèovat a¾ definicí\cite[defstup].

\definice [dpolf]
%%%%%%%%%
{\em Polynom\/} je reálná funkce reálné promìnné, tedy
$p:\R\to\R$, která má pro v¹echna $x\in\R$ funkèní hodnotu $p(x)$ 
danou vzorcem
$$
  p(x) = a_0 + a_1 x + a_2 x^2 + \cdots + a_n x^n,
  \rce(defpol)
$$
kde $a_0, \ldots, a_n$ jsou nìjaká reálná èísla, která
nazýváme {\em koeficienty\/} polynomu. Jinými slovy: 
je-li funkce $p$ polynomem, existuje pøirozené èíslo $n$ a 
konstanty $a_0, \ldots, a_n$ tak, ¾e pro funkèní hodnoty $p(x)$ platí
uvedený vzorec pro v¹echna $x\in\R$.
\inl[polynom, koeficienty: polynomu]

\poznamka [polfplus]
%%%%%%%%%
Dva polynomy $p$ a $q$ podle této definice se rovnají, pokud se rovnají jako
funkce, tedy pokud $p(x)=q(x)$ pro v¹echna $x\in\R$. Souèet dvou
polynomù $p$ a $q$ je funkce $p+q$, pro kterou je
$(p+q)(x) = p(x)+q(x)$ pro v¹echna $x\in\R$. Koneènì pro $\alpha\in\R$
je $\alpha$-násobek polynomu $p$ taková funkce $\alpha p$, pro kterou platí
$(\alpha p)(x) = \alpha\cdot p(x)$ pro v¹echna $x\in\R$.

\priklad
%%%%%%%%
Funkce, její¾ hodnota v bodì $x\in\R$ je daná vzorcem $x^3-2x^2-4$,
je polynom. Jeho koeficienty jsou $a_0=-4$, $a_1=0$, $a_2=-2$ a $a_3=1$.
Pov¹imnìme si, ¾e je zde pou¾it vzorec\cite(defpol) v~opaèném
poøadí \uv{od nejvy¹¹í mocniny promìnné k mocninám ni¾¹ím}. 
Toto je dost èastý zápis vzorcù pro polynomy. Vzhledem 
k tomu, ¾e sèítání reálných èísel je komutativní, na poøadí sèítancù
nezále¾í.

\priklad
%%%%%%%%
Funkce $\exp$, její¾ hodnota v bodì $x\in\R$ je daná vzorcem
$\exp(x)=e^x$, není polynom. To znamená, ¾e neexistuje koneèné mno¾ství
konstant $a_0,a_1,\ldots,a_n$ takové, ¾e $e^x$ lze vypoèítat podle
vzorce\cite(defpol) pro v¹echny $x\in\R$.
Abychom to dokázali, vypùjèíme si znalosti
z analýzy. Je zøejmé, ¾e pokud opakovanì derivujeme
vzorec\cite(defpol) podle promìnné~$x$ více ne¾
$n$~krát, dostáváme nulovou funkci. Tak¾e ka¾dý polynom $p$ má tu
vlastnost, ¾e pro nìj existuje pøirozené èíslo $k$ takové, ¾e $k$-tá derivace
polynomu~$p$ je nulová funkce.
Je známo, ¾e funkce $\exp$ je odolná vùèi libovolnému mno¾ství
derivování: dostáváme zase funkci $\exp$, která je nenulová. 
Tak¾e tato funkce nemù¾e být polynom. Z analogických dùvodù napøíklad
funkce sinus a kosinus nejsou polynomy.
Poznamenejme je¹tì, ¾e hodnoty uvedených funkcí se dají pøibli¾nì poèítat 
pomocí polynomù (tzv. {\em Taylorovy polynomy\/}). Toto téma ov¹em
pøekraèuje rámec tohoto textu.
\inl[polynom: Taylorùv, Taylorùv: polynom]

\poznamka
%%%%%%%%%
Následuje alternativní definice polynomu, v algebøe mo¾ná obvyklej¹í:

\definice [dpolv]
%%%%%%%%%
{\em Polynom\/} je vzoreèek
$$
  a_0 + a_1 x + a_2 x^2 + \cdots + a_n x^n,
  \rce(defpolv)
$$
kde $a_0, \ldots, a_n$ jsou nìjaká reálná èísla, která
nazýváme {\em koeficienty\/} polynomu a $x$ je formální promìnná
(která samozøejmì mù¾e být oznaèena jiným písmenem). 

Polynom v tomto pojetí je urèen jednoznaènì koneènì mnoha koeficienty
$a_0, \ldots, a_n$, pomocí kterých lze uvedený vzoreèek sestavit.

{\em Hodnota polynomu s koeficienty $a_0, \ldots, a_n$ v bodì $\alpha$}
je èíslo $a_0 + a_1 \alpha + a_2 \alpha^2 + \cdots + a_n \alpha^n$.

\definice [polvplus]
%%%%%%%%%
Pøedpokládejme definici polynomù\cite[dpolv]. Nech» polynom $p$
má koeficienty $a_0, \ldots, a_m$ a polynom $q$ má koeficienty
$b_0, \ldots, b_n$. Bez újmy na obecnosti pøedpokládejme, ¾e $m\le n$.
Definujeme:

{\em Rovnost polynomù\/}: Øíkáme, ¾e $p=q$ (tj. polynomy se rovnají), pokud
$a_i=b_i$ pro $i\in\{0,\ldots,m\}$ a pøi $m<n$ je navíc 
$b_i=0$ pro $i\in\{m+1,\ldots,n\}$.

{\em Souèet polynomù\/}: Polynom $p+q$ má koeficienty
$a_0+b_0, \ldots, a_m+b_m, b_{m+1}, \ldots, b_n$.

{\em Násobek polynomu $p$ èíslem $\alpha$} je polynom s koeficienty
$\alpha a_0, \alpha a_1, \ldots, \alpha a_m$.

\poznamka
%%%%%%%%%
Tato definice vymezuje algoritmy, které poznají rovnost
polynomù a provedou souèet a $\alpha$-násobek polynomu. V¹imnìte si, 
¾e tìmto algoritmùm staèí pracovat s polynomy jen pomocí jejich koeficientù.
Nemusejí implementovat kompletnì celý vzoreèek\cite(defpolv). 

\priklad
%%%%%%%%
Dva polynomy $0x^3+0x^2-2x+3$ a $-2x+3$ se rovnají, aèkoli ten první
má ètyøi koeficienty a ten druhý jen dva. Koeficienty $a_0$ a $a_1$
mají ale oba polynomy stejné. 

Souètem polynomù $x^3+3x^2-2x$ a $5x+7$
je polynom  $x^3+3x^2+3x+7$, proto¾e má následující koeficienty 
(po øadì od koeficientu s indexem nula): $0+7$, $-2+5$, $3$, $1$. 

\veta [PX]
%%%%%
Mno¾ina vzoreèkù tvaru\cite(defpolv), ve které dva vzoreèky pova¾ujeme
za toto¾né podle pravidla v definici\cite[polvplus] a na které je
definováno sèítání a násobení konstantou podle stejné definice\cite[polvplus],
tvoøí lineární prostor. Tuto mno¾inu oznaèíme symbolem ${\cal P}_X$.

\dukaz
Souèet dvou prvkù z ${\cal P}_X$ je prvek v ${\cal P}_X$,
$\alpha$-násobek prvku z ${\cal P}_X$ je prvek v ${\cal P}_X$.
Dále je tøeba ovìøit platnost axiomù (1) a¾ (7) z definice\cite[dlp].
To pøenecháme peèlivému ètenáøi.

\poznamka
%%%%%%%%%
Definice\cite[polvplus] rovnosti, souètu a násobku vychází pøirozenì z toho,
jak bychom porovnávali, sèítali a násobili vzoreèky
tvaru\cite(defpolv). Je to ov¹em jiná definice, ne¾ vyplývá 
z~poznámky\cite[polfplus]. Urèitou práci nám dá uvést oba tyto svìty do 
souvislosti.

V definici\cite[dpolv] mluvíme o {\em hodnotì polynomu}. Tím je
ka¾dému reálnému èíslu $\alpha$ pøiøazena funkèní hodnota polynomu,
tedy polynom daný vzoreèkem se stává funkcí. 
To popisuje jednoznaèný pøechod od polynomu v
podobì vzoreèku k polynomu jako funkci. Ukazuje se, ¾e obrácenì (od
funkce ke vzoreèku) to je malinko slo¾itìj¹í:

\veta [poljeden]
%%%%%
Ka¾dá funkce $p: \R\to\R$, která je polynomem podle
definice\cite[dpolf], má své koeficienty urèeny jednoznaènì.
Pøesnìji: pokud funkce $p$ je polynomem jednak s koeficienty
$a_0,\ldots,a_m$ a také s~koeficienty $b_0,\ldots,b_n$,
pak pro tyto koeficienty platí rovnost podle definice\cite[polvplus].

\dukaz
K dùkazu vìty potøebujeme nejprve ovìøit následující tvrzení:

\veta [pnulovy]
%%%%%
Nulová funkce $\R\to\R$ je polynom, který musí mít v¹echny 
koeficienty nulové.

\dukaz
Uva¾ujme nulovou funkci $p$, která je dána vzorcem\cite(defpol). 
Máme dokázat, ¾e v¹echny koeficienty $a_0,a_1,\ldots,a_n$ jsou nulové.
Pøedev¹ím je $p(0)=a_0$ (staèí do vzorce dosadit $x=0$).
Proto¾e $p(0)=0$, je nutnì $a_0=0$. 
Hodnotu funkce $p$ v bodì $x$ mù¾eme tedy 
zapsat ve tvaru:
$$
  0 = p(x) = x\,(a_1 + a_2 x + \ldots + a_n x^{n-1}) = x\cdot q(x).
$$
Polynom $q$ musí mít nulové hodnoty pro v¹echna $x\not=0$. 
Proto¾e $q$ je spojitá funkce, je také $q(0)=0$. Po dosazení $x=0$
do vzorce pro $q(x)$ dostáváme $a_1=0$. Nyní mù¾eme psát
$$
  0 = p(x) = x^2(a_2 + a_3 x + \ldots + a_n x^{n-1}) = x^2\cdot q_2(x)
$$
a úvahu mù¾eme zopakovat. Dostáváme $a_2=0$. Matematickou indukcí lze
ukázat, ¾e $a_k=0$ pro v¹echna $k\in\{0,1,\ldots,n\}$.

\bigskip\noindent {\bf Pokraèování dùkazu vìty\cite[poljeden].}
Nech»
$p(x)=a_0+a_1x+\cdots+a_mx^m=b_0+b_1x+\cdots+b_nx^n$
pro v¹echna $x\in\R$. Bez újmy na obecnosti lze pøedpokládat
$m\le n$.
Odeètením dostaneme
$$
  p(x)-p(x) = (b_0-a_0) + (b_1-a_1)\, x + \ldots + (b_m-a_m)\, x^m
  + b_{m+1} x^{m+1} + \dots + b_n x^n
  \quad\forall x\in\R,
$$
co¾ je nulová funkce. Podle vìty\cite[pnulovy] má tento nulový polynom
v¹echny koeficienty nulové, tedy musí $a_k=b_k$ 
pro v¹echna $k\in\{0,1,\ldots,m\}$ a musí $b_k=0$ pro
v¹echna  $k\in\{m+1,\ldots,n\}$.

\veta [pollin]
%%%%%
Zobrazení z lineárního prostoru ${\cal P}_X$ (viz vìtu\cite[PX]) do
lineárního prostoru funkcí, které vzoreèku\cite(defpolv) pøiøadí funkci
$p: \R\to\R$ pøedpisem\cite(defpol), je lineární.

\dukaz
%%%%%%
Je tøeba dokázat, ¾e souètem polynomù $p$ a $q$ 
podle definice\cite[polvplus] dostáváme polynom 
$p+q$, pro který platí $(p+q)(x) = p(x)+q(x)$
pro v¹echna $x\in\R$. Nech» polynom $p$ má koeficienty
$a_0,\ldots,a_m$ a polynom $q$ má koeficienty $b_0,\ldots,b_n$.
Bez újmy na obecnosti lze pøedpokládat $m\le n$.
Je
$$
  \eqalign{
  &(a_0 + a_1 x + a_2 x^2 + \cdots + a_m x^m) +
  (b_0 + b_1 x + b_2 x^2 + \cdots + b_n x^n) =\cr &\quad =
  (a_0+b_0) + (a_1+b_1)\,x + (a_2+b_2)\,x^2 + \cdots + (a_m+b_m)\, x^m +
  b_{m+1}x^{m+1} + \dots + b_n x^n,
}
$$
pro v¹echna $x\in\R$, tak¾e po¾adovaná rovnost platí.
Také je
$$
  \alpha\,(a_0 + a_1 x + a_2 x^2 + \cdots + a_m x^m)
  = \alpha\,a_0 + \alpha\,a_1 x + \alpha\,a_2 x^2 + \cdots + \alpha\,a_m x^m,
$$
pro v¹echna $x\in\R$, jinými slovy $\alpha\,p(x) = (\alpha p)(x)$
pro v¹echna $x\in\R$. Zobrazení je tedy lineární.

\veta [polyniso]
%%%%%
Zobrazení z lineárního prostoru ${\cal P}_X$ (viz vìtu\cite[PX])
do lineárního prostoru polynomù jako funkcí, které vzoreèku pøiøadí funkci
pøedpisem\cite(defpol), je izomorfismus.

\dukaz
Zmínìné zobrazení je prosté (vìta\cite[poljeden]), je na (proto¾e
ka¾dý polynom jako funkce má svùj vzoreèek) a je lineární
(vìta\cite[pollin]). 

\poznamka
%%%%%%%%%
Dùsledkem této vìty je tvrzení, ¾e souèet polynomù (jako funkce) je
polynom a také $\alpha$-násobek polynomu je polynom. Staèí od funkcí
pøejít pomocí inverzního izomorfismu ke vzoreèkùm, tam provést 
souèet (nebo $\alpha$-násobek) a výsledek pøenést zpìt do 
prostoru polynomù jako funkcí.

\okraj Stupeò\hb polynomu | Stupen polynomu

\definice [defstup]
%%%%%%%%%
Nech» polynom $p$ má koeficienty $a_0,a_1,\ldots,a_n$.
{\em Stupeò polynomu\/} je nejvìt¹í index $k$ takový, ¾e
$a_k\not=0$. Má-li polynom v¹echny koeficienty nulové 
(tzv. {\em nulový polynom\/}), prohlásíme, ¾e jeho stupeò 
je roven $-1$.
\inl[stupeò: polynomu]

\priklad
%%%%%%%%
Polynom $0x^5+0x^4 + 5x^3-4x^2+2x+7$ má koeficienty
$a_0=7$, $a_1=2$, $a_2=-4$, $a_3=5$, $a_4=0$, $a_5=0$.
Tak¾e nejvìt¹í index nenulového koeficientu je~$3$. 
Polynom má stupeò tøi.

\okraj Souèin\hb polynomù | Soucin polynomu

\definice
%%%%%%%%%
{\em Souèin polynomù\/} $p$ a $q$ je funkce $u$ daná pøedpisem
$u(x)=p(x)\,q(x)$ pro v¹echna $x\in\R$. Souèin polynomù $p$ a $q$
znaèíme $pq$.
\inl[souèin: polynomù]

\veta [psoucin]
%%%%%
Nech» $p$ má koeficienty $a_0,a_1,\ldots,a_m$ a $q$ má koeeficienty
$b_0,b_1,\ldots,b_n$. Pak souèin polynomù $pq$ je polynom 
s koeficienty $c_k$ pro $k\in\{0,1,\ldots,m+n\}$ takovými, ¾e 
$$
  c_k = a_0 b_k + a_1 b_{k-1} + \cdots + a_k b_0,
$$
pøièem¾ v tomto vzorci klademe $a_i=0$ pro $i>m$ a $b_i=0$ pro $i>n$.

\dukaz 
Je $p(x)=a_0 + a_1 x + \cdots + a_m x^m$ a $q(x) = b_0 + b_1 x + \cdots + b_n x^n$.
Pro v¹echna $x\in\R$ spoèítáme $p(x)\,q(x)$. Pro vìt¹í pohodlí
pøitom znaèíme $a_i=0$ pro $i>m$ a $b_i=0$ pro $i>n$.
$$
\eqalign{
p(x)\,q(x) &= (a_0 + a_1 x + \cdots+ a_m x^m) \cdot (b_0 + b_1 x + \cdots+ b_n+ x^n) =
(a_0 b_0) + (a_0 b_1 + a_1 b_0)\, x + {}\cr &+ (a_0 b_2 + a_1 b_1 + a_2 b_0)\, x^2 +
\cdots + (a_0 b_{m+n} + a_1 b_{m+n-1} +\cdots+ a_{m+n} b_0)\, x^{m+n}.
}$$

\okraj Stupeò\hb souètu,\hb násobku a souèinu | Stupen souctu, nasobku a soucinu

\veta [pstupen]
%%%%%
Nech» $p$ je polynom stupnì $m$ a $q$ je polynom stupnì $n$. Pak
$p+q$ je polynom stupnì nejvý¹e $\max(m,n)$, $\alpha\,p$ je polynom
stupnì $m$ pro $\alpha\not=0$ a je to polynom stupnì $-1$ pro
$\alpha=0$. Koneènì pro nenulové polynomy $p$ a $q$ je $pq$
polynom stupnì $m+n$. Je-li $p$ nebo $q$ nulový, pak $pq$ je polynom
stupnì~$-1$.

\dukaz
Tvrzení plyne pøímo z vìt o poèítání koeficientù souètu a souèinu
polynomù a z definice stupnì polynomu.

\poznamka
%%%%%%%%%
Je potøeba si uvìdomit, ¾e stupeò souètu polynomù nemusí dosahovat
maximum stupòù jednotlivých polynomù, které sèítáme. Kupøíkladu
$$
  (x^3 + 2x^2 - x + 1) + (-x^3 -2x^2 + 2x +3) = x + 4.
$$
Souèet tìchto polynomù stupnì 3 je polynom stupnì 1.
Je dobré si také uvìdomit, ¾e stupeò souètu urèitì nabývá maxima
stupòù jednotlivých polynomù, které sèítáme, pokud 
stupnì sèítaných polynomù jsou rùzné.
 
\okraj Èásteèný podíl polynomù | Castecny podil polynomu

\poznamka [castecnypodilp]
%%%%%%%%%
Podíl dvou polynomù (definovaný jako podíl funkcí) nemusí být polynom.
Nech» jsou dány polynomy $p$ a $q$, pøitom $q$ je nenulový.
Je mo¾né provést aspoò èásteèný podíl tìchto polynomù se zbytkem, tedy najít
takové polynomy $r$ a $z$, aby polynom $z$ mìl men¹í stupeò ne¾
$q$ a aby platilo
$$
  {p(x)\over q(x)} = r(x) + {z(x) \over q(x)}
$$
pro v¹echna $x\in\R$ taková, ¾e $q(x)\not=0$. V tomto kontextu øíkáme
polynomu $r$ {\em èásteèný podíl\/} polynomù $p$ a $q$. Polynomu $z$
øíkáme {\em zbytek\/} po dìlení polynomu $p$ polynomem $q$.
Následující vìta ukazuje, ¾e pro ka¾dé polynomy $p$ a $q$ ($q$
nenulový) existuje jejich èásteèný podíl a zbytek po jejich dìlení. 
Pøitom jsou polynomy $r$ a $z$ urèeny jednoznaènì.
\inl[podíl: polynomù, èásteèný podíl: polynomù, zbytek pøi dìlení polynomù]

\veta [delenip]
%%%%%
Nech» $p$, $q$ jsou polynomy, $q$ nenulový. Pak existuje právì jeden
polynom $r$ a právì jeden polynom $z$ tak, ¾e
(i) $p=rq+z$, (ii) stupeò $z$ je men¹í ne¾ stupeò $q$.

\dukaz
Existence polynomù $r$ a $z$ vyplývá z následujícího algoritmu, pomocí
kterého je mo¾né tyto polynomy na základì daných polynomù $p$ a $q$
najít.
\inl[metoda: poèítání: èásteèného podílu polynomù]

\medskip
\def\bodik(#1) {\par\indent\llap{(#1) }\hangindent=\parindent\hangafter=1\relax}

\bodik (1) Polo¾me $r=0$ (nulový polynom) a $z=p$. 
    Dále oznaème písmenem $n$ stupeò polynomu $q$ a 
    písmenem~$c$ jeho koeficient s~indexem $n$ (tj. nenulový koeficient u
    nejvy¹¹í mocniny polynomu $q$).

\bodik (2) Je-li stupeò $z$ men¹í ne¾ $n$, algoritmus konèí.

\bodik (3) Nech» $m$ je stupeò polynomu $z$ a nech» $d$ je jeho koeficient s indexem
    $m$ (koeficient u nejvy¹¹í mocniny).
    Platí $m\ge n$, proto¾e není splnìna podmínka z kroku~(2).
    K polynomu $r$ pøièteme polynom daný vzorcem $(d/c)\,x^{m-n}$ 
    a od polynomu $z$ odeèteme polynom daný vzorcem 
    $(d/c)\,x^{m-n}\, q(x)$. Vznikají nové polynomy $r_1$ a $z_1$, které
    dále oznaèíme $r$ a $z$ a vracíme se ke kroku~(2).

\medskip
\noindent
V kroku~(3) se sni¾uje stupeò polynomu $z$,
proto¾e se od tohoto polynomu odeèítá sèítanec s nejvy¹¹í
mocninou. Tím je zaruèeno, ¾e stupeò polynomu $z$ postupnì klesá a
algoritmus urèitì skonèí. Krok~(2) navíc zaruèuje, ¾e je splnìno~(ii)
z~tvrzení vìty. Dal¹í vlastností algoritmu je skuteènost, ¾e v ka¾dém
okam¾iku platí pro polynomy $r$ a $z$ podmínka~(i), tak¾e tato
podmínka je splnìna i po ukonèení algoritmu. Pøedev¹ím v kroku~(1)
je $r=0$ a $z=p$, tak¾e $rq+z=0q+p=p$ a podmínka~(i) je splnìna.
Dále v~kroku~(3) máme zaruèeno, ¾e $p=rq+z$ a uká¾eme, ¾e platí také
$p=r_1q + z_1$. Pro v¹echna $x\in\R$ je
$$
  \eqalign{
  r_1(x)\,q(x) + z_1(x) &= 
  \left(r(x)+{d\over c}\,x^{m-n}\right)\,q(x) + \left(z(x)-{d\over c}\,x^{m-n}\,q(x)\right) =\cr 
  &= r(x)\,q(x) + {d\over c}\,x^{m-n}\,q(x) + z(x) - {d\over c}\,x^{m-n}\,q(x) =
  r(x)\,q(x) + z(x) = p(x).
}$$

Jednoznaènost polynomù $r$ a $z$ je jednoduchým dùsledkem vìty o
stupni souètu a souèinu polynomù. Kdyby existovaly polynomy $r_2$ a
$z_2$, které rovnì¾ splòují~(i) a~(ii), pak je
$p=rq+z = r_2q+z_2$, tak¾e $(r-r_2)\,q = z_2-z$. Kdyby
$r-r_2$ nebyl nulový polynom, pak stupeò polynomu $(r-r_2)q$ by byl
vìt¹í nebo roven stupni $q$, zatímco polynom $z_2-z$ má stupeò
men¹í ne¾ $q$. To je ov¹em spor. Tak¾e musí $r-r_2$ být nulový polynom a
pak nutnì té¾ $z_2-z$ je nulový polynom. Jinými slovy $r=r_2$ a
$z=z_2$, tak¾e polynomy $r$, $z$ jsou urèeny podmínkami~(i) a~(ii) 
jednoznaènì.

\priklad
%%%%%%%%
Najdeme èásteèný podíl a zbytek pøi dìlení polynomu
$2x^5-3x^4+3x^3-x^2-6x+8$ polynomem $x^2-2x+4$. 

Algoritmus popsaný v dùkazu vìty\cite[delenip] se zapisuje vìt¹inou do
následujícího schématu:
$$
  \def\0{\phantom0}
  \setbox0=\hbox{$(2x^5-3x^4+3x^3-\0x^2-\06x+\08\rlap)$}
  \def\r#1{\setbox2=\hbox{$#1$}\hbox to\wd0{\hss\copy2}}
  \def\l#1{\hbox to\wd0{$#1$\hss}}
  \def\rule{\vskip-5pt\hbox to\wd0{\hss\hbox to\wd2{\hrulefill}}}
  \def\-{\llap{$-$}}
  \hbox{\vtop{
    \hbox{\copy0}
    \l{\llap{$-$}(2x^5-4x^4+8x^3)}
    \smallskip\hrule\smallskip
    \r{x^4-5x^3-\0x^2-\06x+\08}
    \r{\-(x^4-2x^3+4x^2\rlap)\phantom{{}-06x+08}}
    \rule
    \r{-3x^3-5x^2-\06x+\08}
    \r{\-(-3x^3+6x^2-12x\rlap)\phantom{{}+08}}
    \rule
    \r{-11x^2+\06x+\08}
    \r{\-(-11x^2+22x-44\rlap)}
    \rule
    \r{-16x+52}
  }$\hskip8pt\hbox{:}\hskip4pt(x^2-2x+4) = 2x^3+x^2-3x-11$}
$$
V prvním øádku (pøed symbolem \uv{:}) je výchozí hodnota polynomu $z$
podle kroku~(1). Sèítanec s nejvy¹¹í mocninou polynomu $z$ je $2x^5$ a
ten podìlíme prvním sèítancem polynomu $q$, tj. $x^2$. Výsledek
zapí¹eme vedle rovnítka: $2x^3$. Tímto výsledkem násobíme celý polynom
$q$ a pí¹eme pod výchozí polynom $z$ do druhého øádku. Tyto dva
polynomy odèítáme a výsledek pí¹eme pod èáru. Vzniká nová hodnota polynomu~$z$.
Sèítanec s nejvy¹¹í mocninou je nyní $x^4$ a ten znovu dìlíme $x^2$ a
výsledek $+x^2$ pøipisujeme vedle rovnítka. Tímto výsledkem znovu
násobíme celý polynom $q$ a pí¹eme do ètvrtého øádku. Pod èáru
zapí¹eme do pátého øádku rozdíl, tedy novou hodnotu polynomu $z$.
Postupujeme tak dlouho, dokud polynom $z$ má stupeò vìt¹í nebo roven
stupni polynomu $q$. Teprve na devátém øádku jsme dosáhli skuteèného
zbytku, nebo» nyní tento polynom má stupeò men¹í ne¾ stupeò
polynomu~$q$. Výsledek èásteèného podílu mù¾eme zapsat takto:
$$
  {2x^5-3x^4+3x^3-x^2-6x+8 \over x^2-2x+4} =
  2x^3+x^2-3x-11 + {-16x+52 \over x^2-2x+4}.
$$

\definice [podilp]
%%%%%%%%%
Nech» zbytek po dìlení polynomu $p$ polynomem $q$ je nulový polynom.
Pak øíkáme, ¾e {\em $q$~dìlí $p$} nebo ¾e {\em $p$ je dìlitelný polynomem $q$}.
Èásteèný podíl $r$ v takovém pøípadì nazýváme {\em podíl polynomù $p$
a $q$} a znaèíme $p/q$.
\inl[dìlitenost: polynomù, podíl: polynomù]

\poznamka
%%%%%%%%%
Podíl polynomù $p$ a $q$ (pokud existuje) podle pøedchozí definice je
polynom. Pokud bychom ov¹em definovali podíl polynomù jako podíl
funkcí, tj. takovou funkci $f$, její¾ hodnoty $f(x)$ jsou rovny podílu
$p(x)/q(x)$ v¹ude tam, kde $q(x)\not=0$, pak bychom nemuseli dostat
polynom, proto¾e definièní obor takové funkce $f$ nemusí obsahovat
v¹echna reálná èísla $\R$. Pravda, pokud je polynom $p$ dìlitelný polynomem
$q$, pak funkci $f$ lze spojitì dodefinovat v bodech $x$, pro které je
$q(x)=0$. Takto roz¹íøená funkce $f$ je pak toto¾ná s podílem
polynomù podle pøedchozí definice\cite[podilp]. To plyne z~následující
vìty.

\veta
%%%%%
Nech» polynom $p$ je dìlitelný polynomem $q$. Pak $(p/q)\,q=p$.

\dukaz
Polynom $(p/q)=r$ a $z=0$ pøi znaèení podle vìty\cite[delenip].
Pak dokazované tvrzení je vlastnost~(i) uvedené vìty.

\okraj {}Hornerovo schéma | Hornerovo schema

\poznamka
%%%%%%%%%
Nech» je dán polynom $p$ svými koeficienty $a_0,a_1,\ldots,a_n$. 
K nalezení hodnoty $p(\alpha)$ mù¾eme pou¾ít jednak vzorec\cite(defpol)
$$
  p(\alpha) = a_n\alpha^n + a_{n-1}\alpha^{n-1} + 
  a_{n-2}\alpha^{n-2} + \cdots + a_2\alpha^2 + a_1 \alpha + a_0
  \rce(amaterp)  
$$
nebo mù¾eme tento vzorec pøezávorkovat do tvaru
$$
  p(\alpha) = ((\cdots((a_n\alpha + a_{n-1})\,\alpha + a_{n-2})\,\alpha + 
  \cdots + a_2)\,\alpha + a_1)\,\alpha + a_0
  \rce(opravdovyp)
$$
a hodnotu $p(\alpha)$ poèítat postupnì vyhodnocováním závorek od
vnitøní k vnìj¹í. Snadno zjistíme (roznásobením závorek), ¾e oba
vzorce dávají skuteènì tuté¾ hodnotu $p(\alpha)$, ov¹em
vzorec\cite(opravdovyp) je daleko ménì numericky nároèný. Pøedstavme
si, ¾e stupeò polynomu je 1524. Podle vzorce\cite(amaterp) bychom
museli poèítat nejprve mocninu $\alpha^{1524}$, zatímco 
vzorec\cite(opravdovyp) nás do nièeho takového nenutí.

Programátor¹tí amatéøi (kteøí bohu¾el èasto fu¹ují programátorùm do
øemesla) se poznají napøíklad podle toho, ¾e pro vyhodnocení polynomu
v bodì $\alpha$ pou¾ijí vzorec\cite(amaterp) a hloupì argumentují tím,
¾e poèítaè je rychlý. Ano, je rychlý, ale jakmile bude potøeba
vyhodnocovat tisíce polynomù v tisících rùzných bodech, a pøitom ty
polynomy budou mít stupeò kolem tisíce a bude potøeba tento postup
opakovat, tak se pøístup k programování hodnì pozná. 
Na druhé stranì opravdový programátor vyhodnotí polynom v bodì
$\alpha$ podle vzorce\cite(opravdovyp) a vyu¾ije k tomu je¹tì
mo¾nosti procesoru. Napøíklad do registru A ulo¾í hodnotu $\alpha$ a
registr B pronuluje a vyhradí pro mezivýpoèty. Pak vyzvedne z pamìti
hodnotu $a_n$ a pøiète ji k B. Dále násobí A s B a výsledek ulo¾í do
B, dále vyzvedne z pamìti $a_{n-1}$ a pøiète k B, pak opìt násobí A 
s B a výsledek ulo¾í do B, atd. K vyhodnocení polynomu stupnì~$n$ 
v bodì $\alpha$ staèí provést $n$ násobení a $n$ sèítání.

Bohu¾el opravdových programátorù je málo, a proto software mnohdy
vypadá jak vypadá. U¾ivatel pak ne¹»astnì èeká u svého kompu a nemù¾e
se doèkat výsledku. Hledí do blba, proto¾e na blba, který to
naprogramoval, nemá mo¾nost se podívat. Èasto se mu také draze koupený
software zhroutí, proto¾e napøíklad postup podle vzorce\cite(amaterp) není
numericky stabilní.

\poznamka
%%%%%%%%%
Budeme si hrát na pana Hornera, který
pou¾íval vzorec\cite(opravdovyp) dávno pøed tím, ne¾ se objevily první
poèítaèe a který si zapisoval mezivýsledky do pøehledného schématu.
Záhy uvidíme, ¾e ty mezivýsledky i ono pøehledné schéma se budou hodit.

Oznaème obsah nejvíce vnitøní závorky ve vzorci\cite(opravdovyp) symbolem
$b_{n-2}$, obsah dal¹í závorky oznaème $b_{n-3}$ a tak dále a¾ koneènì
poslední závorka (vnìj¹í) obklopuje výraz oznaèený $b_0$. 
K tomu dopi¹me $b_{n-1}=a_n$.
Pro mezivýsledky $b_k$ tedy platí: $b_{n-1}=a_n$, $b_{k-1}=a_k+\alpha b_k$
pro $k=n-1, n-2, \ldots, 3, 2, 1$. Celý výpoèet hodnoty $p(\alpha)$
zapí¹eme do tøíøádkového tzv.~{\em Hornerova schématu\/}. V prvním
øádku jsou koeficienty polynomu $p$ a ve tøetím øádku zmínìné
mezivýpoèty $b_i$.
$$
  \vbox{\halign{&\ \hfil$#$\hfil\ \cr
           & a_n & a_{n-1} & a_{n-2} & \ldots & a_2 & a_1 & a_0 \cr
   \alpha: &     & \alpha b_{n-1} & \alpha b_{n-2} & \ldots & 
                                      \alpha b_2 & \alpha b_1 & \alpha b_0 \cr
   \noalign{\smallskip\hrule\smallskip}
           & b_{n-1} & b_{n-2} & b_{n-3} & \ldots & b_1 & b_0 & p(\alpha) \cr
   }}
$$
Schéma v druhém a tøetím øádku plníme postupnì zleva doprava tak, ¾e
do druhého øádku ¹ikmo pøepisujeme hodnotu tøetího øádku násobenou
$\alpha$ a následnì smìrem dolù sèítáme.
\inl[Hornerovo: schéma, schéma: Hornerovo]

\priklad [horner1]
%%%%%%%%
Najdeme hodnotu polynomu $2x^8-3x^7-11x^6+5x^5+11x^3-2x^2-9x-2$
v bodì $3$ za pou¾ití Hornerova schématu.
$$
  \def\0{\phantom{-0}}\def\={\phantom-}
  \vbox{\halign{&\ \hfil$#$\ \cr
       & 2 &  -3 & -11 & \05 & \00 & \=11 & -2  &   -9 &  -2 \cr
  x=3: &   & \06 &   9 &  -6 & -3  &   -9 & \06 & \=12 & \09 \cr
  \noalign{\smallskip\hrule\smallskip}
       & 2 &  3 &  -2 & -1 & -3 &  2 &  4 &  3 &  7\rlap{${}=p(3)$} \cr
  }}
$$
Do prvního øádku jsme nejdøíve zapsali v¹echny koeficienty daného
polynomu a nedopustili jsme se ¹kolácké chyby, ¾e bychom zapomnìli na
koeficient $a_4=0$. Druhý øádek jsme nechali prázdný a udìlali jsme
sèítací èáru. Pod ní jsme pøepsali èíslo 2 ($b_7=a_8$). Pak tuto
dvojku násobíme trojkou (hodnotou~$x$) a pí¹eme do druhého 
øádku následujícího sloupce:~6. Ve sloupci sèítáme. 
Dostáváme 3. Tuto trojku násobíme 
znovu hodnotou $x=3$ a výsledek 9 pí¹eme do druhého øádku
následujícího sloupce.
Sèítáme, násobíme, sèítáme, násobíme atd. a¾ nakonec dospíváme 
k~èíslu 7, co¾ je hodnota daného polynomu v~bodì $x=3$.

\veta [horner3]
%%%%%
Mezivýsledky $b_i$ z Hornerova schématu jsou koeficienty èásteèného
podílu polynomu $p$ pøi dìlení polynomem daným vzorcem $x-\alpha$.
Zbytek tohoto dìlení je konstantní polynom $p(\alpha)$.

\dukaz
Je $b_{n-1}=a_n$ a platí $b_{k-1}=a_k+\alpha b_k$ 
(neboli $a_k=b_{k-1}-\alpha b_k$) pro $k=n-1, n-2, \ldots, 3, 2, 1$. 
Podle posledního sloupce Hornerova schématu je 
$a_0+\alpha b_0=p(\alpha)$, neboli $a_0= p(\alpha) - \alpha b_0$.
Tyto skuteènosti dosadíme do vzorce
pro výpoèet hodnoty polynomu $p$ v bodì $x\in\R$:
$$
  \eqalign{
  p(x) &= a_n x^n + a_{n-1} x^{n-1} + \cdots + a_2 x^2 + a_1 x + a_0 = \cr &=
  b_{n-1} x^n + (b_{n-2} - \alpha b_{n-1})\, x^{n-1} + \cdots
  + (b_1 - \alpha b_2) x^2 + (b_0 - \alpha b_1)\,x + p(\alpha) - \alpha b_0 = \cr &=
  x\,(b_{n-1} x^{n-1} + b_{n-2} x^{n-2} + \cdots + b_1 x + b_0) - 
  \alpha\,(b_{n-1} x^{n-1} + \cdots + b_2 x^2 + b_1 x + b_0) +
  p(\alpha) = \cr &=
  (b_{n-1} x^{n-1} + b_{n-2} x^{n-2} + \cdots + b_2 x^2 + b_1 x +
  b_0)\,(x-\alpha) + p(\alpha).
}$$

\priklad
%%%%%%%%
Najdeme èásteèný podíl a zbytek pøi dìlení polynomu z
pøíkladu\cite[horner1] polynomem $x-3$.
Podle pøedchozí vìty je 
$$
  {2x^8-3x^7-11x^6+5x^5+11x^3-2x^2-9x-2 \over x-3} = 
   2x^7+3x^6-2x^5-x^4-3x^3+2x^2+4x+3 + {7\over x-3}.
$$
Koeficienty èásteèného podílu jsme opsali z tøetího øádku Hornerova
schématu v pøíkladu\cite[horner1]. Toto je zøejmì ménì pracná metoda
hledání èásteèného podílu, ne¾ metoda popsaná v dùkazu
vìty\cite[delenip]. Bohu¾el se tato metoda dá pou¾ít jen pøi dìlení
polynomu lineárním polynomem tvaru $x-\alpha$. Ov¹em s~dìlením takovým
lineárním polynomem se èasto setkáme napøíklad pøi rozkladu na koøenové
èinitele polynomu.

\okraj Polynomy nad $\R$ a\hb nad $\C$ | Polynomy nad R a nad C

\poznamka
%%%%%%%%%
A¾ dosud jsme s polynomy pracovali jako s reálnými funkcemi reálné
promìné pøípadnì jako se vzoreèky, které mají reálné koeficienty a do
kterých dosazujeme za formální promìnnou reálná èísla. 
Tìmto polynomùm øíkáme {\em polynomy nad $\R$}, neboli 
polynomy nad reálnými èísly.

Místo reálných èísel ale mù¾eme
pou¾ívat jakýkoli èíselný obor, ve kterém umíme èísla mezi sebou
sèítat, odèítat, násobit a dìlit (podle jistých vlastností, podrobnìji
si o tom povíme v kapitole\kcite\ktere[grupy]). Pokud budeme za
polynom pova¾ovat komplexní funkci komplexní promìnné danou 
vzoreèkem\cite(defpolv), ve kterém jsou koeficienty
$a_0,a_1,\ldots,a_n$ komplexní èísla a za promìnou $x$ dosazujeme
komplexní èísla, mluvíme o {\em polynomu nad \C}. 

Pokud zamìníme slovo \uv{reálný} slovem \uv{komplexní} a symbol $\R$
symbolem $\C$ v celém pøedchozím textu v této kapitole, v¹echna
tvrzení zùstávají v platnosti. Budeme-li v následujícím textu v této
kapitole mluvit o polynomech a nespecifikujeme èíselný obor, budeme
pøedpokládat polynomy nad $\C$. Je to z~toho dùvodu, ¾e
budeme vy¹etøovat vlastnosti koøenù polynomù. Reálné koøeny polynomù 
nad $\R$ pøitom nemusejí existovat.


\okraj Koøen polynomu | Koren polynomu

\definice [dkoren]
%%%%%%%%%
{\em Koøen polynomu\/} $p$ je takové èíslo $\alpha\in\C$, pro které je
$p(\alpha) = 0$. Pokud $\alpha$ je koøen polynomu $p$, pak polynom
daný vzorcem $x-\alpha$ pro v¹echna $x\in\C$ nazýváme {\em koøenový
èinitel polynomu\/}~$p$.
\inl[koøen: polynomu, koøenový èinitel]

\veta [korencdeli]
%%%%%
Polynom $p$ je dìlitelný svým koøenovým èinitelem.

\dukaz
Zbytek po dìlení polynomu $p$ polynomem $x-\alpha$ má podle
vìty\cite[delenip] stupeò men¹í ne¾~1, tedy
jedná se o konstantu. Oznaème ji $c$. Pro v¹echna $x\in\C$ platí:
$p(x) = r(x)\,(x-\alpha) + c$. Po dosazení $x=\alpha$ máme 
$p(\alpha) = r(\alpha)\cdot 0 + c = c$. Proto¾e $\alpha$ je koøen, je
$p(\alpha)=0$, tak¾e $c=0$. Skuteènì tedy polynom $x-\alpha$ dìlí
polynom $p$ beze zbytku.

%\poznamka
%%%%%%%%%%
%Obrácené tvrzení {\it polynom dìlitelný èinitelem $x-\alpha$ má koøen
%$\alpha$} se doká¾e snadno: existuje polynom $q$ tak, ¾e
%$p(x)=(x-\alpha)\,q(x)$ pro v¹echna $x\in\C$. Staèí nyní volit
%$\alpha=0$ a máme $p(0)= 0\,q(\alpha) = 0$.

\poznamka [prozklad]
%%%%%%%%%
Nech» $\alpha_1$ je koøen nenulového polynomu $p$. 
Zatím ponecháme stranou problém hledání koøene a spokojíme se s tím,
¾e koøen polynomu $p$ existuje a oznaèíme jej $\alpha_1$.
Podle pøedchozí vìty je
mo¾né dìlit koøenovým èinitelem, neboli 
$p(x) = r_1(x) \, (x-\alpha_1)$. Z této rovnosti plyne, ¾e v¹echny koøeny
polynomu~$r_1$ jsou zároveò koøeny polynomu $p$. Polynom $p$ má
kromì koøenù polynomu $r_1$ navíc jen koøen $\alpha_1$. 
Je tedy mo¾né hledat dal¹í koøeny polynomu
$p$ tak, ¾e najdeme koøeny polynomu $r_1$.
Pøitom tento polynom má
podle vìty\cite[pstupen] o~jednièku men¹í stupeò, ne¾ má polynom~$p$.

Nech» $\alpha_2$ je koøen polynomu $r_1$. Máme tedy 
$p(x) = r_2(x)\,(x-\alpha_1)\,(x-\alpha_2)$. Dal¹í koøeny polynomu~$p$
mù¾eme hledat tak, ¾e najdeme koøeny polynomu $r_2$. Úvahu opakujeme
tak dlouho, a¾ se polynom $r_i$ stane konstantním polynomem nebo a¾
nastane situace, ¾e polynom $r_i$ nebude mít koøeny. Postup skonèí
urèitì po koneènì mnoha krocích, nebo» stupnì polynomu $r_i$ se
sni¾ují. V závìru tedy máme
$$
  p(x) = r_m(x)\,(x-\alpha_1)\,(x-\alpha_2)\,\cdots\,(x-\alpha_m),
  \rce(rozkladp)
$$
kde $r_m$ je polynom bez koøenù (vìta\cite[fund] uká¾e, ¾e takový
pøípad nastává jen pro konstatní polynom) a $\alpha_i$ jsou v¹echny
koøeny polynomu $p$. V zápise\cite(rozkladp) se mohou nìkteré koøeny
$\alpha_i$ vyskytovat vícekrát. Takovým koøenùm øíkáme vícenásobné,
viz následující definice.

\definice [dnasobnost]
%%%%%%%%%
Koøen $\alpha$ nenulového polynomu $p$ nazýváme $k$-násobný, pokud polynom
$(x-\alpha)^k$ dìlí polynom $p$, a pøitom polynom $(x-\alpha)^{k+1}$
nedìlí polynom~$p$. Obèas je u¾iteèné mluvit také o èíslu $\alpha$
jako o~0-násobném koøenu polynomu $p$ tehdy, kdy¾ èíslo $\alpha$ není 
koøenem polynomu~$p$.
\inl[násobnost: koøenu, koøen: násobnost]

\veta [nasobnostk]
%%%%%
Nenulový polynom $p$ má koøen $\alpha$ násobnosti~$k$ právì tehdy,
kdy¾ existuje polynom $q$ tak, ¾e $p(x)=(x-\alpha)^kq(x)$ 
a souèasnì $q(\alpha)\not=0$.

\dukaz
Proto¾e $(x-\alpha)^k$ dìlí polynom $p$ právì tehdy, kdy¾
existuje polynom $q$ tak, ¾e $p(x)=(x-\alpha)^kq(x)$ pro v¹echna 
$x\in\C$, staèí 
podle definice\cite[dnasobnost] dokázat, ¾e
$(x-\alpha)^{k+1}$ nedìlí $p$ právì kdy¾ $q(\alpha)\not=0$, neboli
$(x-\alpha)^{k+1}$ dìlí $p$ právì kdy¾ $q(\alpha)=0$.
Nech» $(x-\alpha)^{k+1}$ dìlí $p$, tedy
existuje polynom $r$ tak, ¾e $p(x)=(x-\alpha)^k(x-\alpha)\,r(x)$.
Z jednoznaènosti podílu je zøejmé, ¾e musí 
$q(x)=(x-\alpha)\,r(x)$, tak¾e $q(\alpha)=0$.
Obrácenì, pokud $q(\alpha)=0$, pak podle vìty\cite[korencdeli]
existuje polynom $r$ tak, ¾e $q(x)=(x-\alpha)\,r(x)$. Z~toho plyne, ¾e
$p(x)=(x-\alpha)^k(x-\alpha)\,r(x)$, neboli $(x-\alpha)^{k+1}$ dìlí~$p$.


\priklad [nasobnost2]
%%%%%%%%
Dejme tomu, ¾e víme, ¾e polynom 
$x^6-5x^5-15x^4+85x^3+10x^2-372x+360$
má koøen~2. Urèíme násobnost tohoto koøene.

Oznaème zkoumaný polynom písmenem~$p$.
Výpoètem hodnoty $p(2)$ za pou¾ití Hornerova schématu musí vyjít~0.
Navíc tøetí øádek schématu obsahuje podle vìty\cite[horner3]
koeficienty polynomu $r_1$, pro který platí $p(x)=r_1(x)\,(x-2)$.
Mù¾eme tedy tento øádek ztoto¾nit s prvním øádkem navazujícího 
Hornerova schématu, ve kterém ovìøujeme, zda dvojka je koøenem 
polynomu $r_1$. Pokud zjistíme, ¾e ano, pak u¾ víme, ¾e dvojka 
je aspoò dvojnásobným koøenem. 
V takovém pøípadì mù¾eme pokraèovat dal¹ím navazujícím
Hornerovým schématem a¾ do doby, ne¾ polynom $r_i$ nebude mít koøen dvojku.
$$
  \def\rule#1{\noalign{\vskip-5pt}\multispan#1 \hrulefill \cr}
  \vbox{\halign{&\quad \hfil$#$\cr
             & 1 & -5 & -15 &  85 & 10 & -372 &  360 \cr
   \llap{2}: &   &  2 &  -6 & -42 & 86 &  192 & -360 \cr \rule 8
             & 1 & -3 & -21 &  43 & 96 & -180 &    0 \cr
   \llap{2}: &   &  2 &  -2 & -46 & -6 &  180        \cr \rule 7
             & 1 & -1 & -23 &  -3 & 90 &    0        \cr
   \llap{2}: &   &  2 &   2 & -42 & -90              \cr \rule 6
             & 1 &  1 & -21 & -45 &  0               \cr
   \llap{2}: &   &  2 &   6 & -30                    \cr \rule 5
             & 1 &  3 & -15 & -75                    \cr
   }}         
$$
Vidíme tedy, ¾e $p(x)=(x^3+x^2-21x-45)(x-2)^3$. Pøitom 
hodnota polynomu $x^3+x^2-21x-45$ pro $x=2$ je~$-75$, tak¾e dvojka
není koøenem tohoto polynomu. Èíslo~2 je tedy trojnásobný koøen
polynomu~$p$.

Násobnost koøene tedy mù¾eme zjistit opakovaným pou¾itím navazujícího
Hornerova schématu, pøièem¾ násobnost je poèet výsledných øádkù
konèících nulou s tím, ¾e dal¹í øádek u¾ nulou nekonèí.  

\okraj Hledáme koøeny polynomu | Hledame koreny polynomu

\poznamka [hledanikorenu]
%%%%%%%%%
Hledat koøeny polynomu, neboli øe¹it algebraickou rovnici~$p(x)=0$, je
úloha dùle¾itá a v praxi èasto potøebná. Bohu¾el neexistuje obecný
postup, jak na základì znalostí koeficientù polynomu
$a_0,a_1,\ldots,a_n$ zjistit pøesnì koøeny tohoto polynomu.
Postupy existují pro velmi speciální typy polynomù, napøíklad pro
polynomy nízkých stupòù. V této poznámce pøipomeneme, jak je mo¾né
hledat koøeny polynomù nízkých stupòù.

\medskip
\def\bodik(#1) {\par\indent\llap{$#1$) }\hangindent=\parindent\hangafter=1\relax}

\bodik (-1) Koøeny polynomu stupnì $-1$ (tedy nulového polynomu) jsou v¹echna
   komplexní èísla. 

\bodik (0) Polynom nultého stupnì (tedy nenulová konstanta) nemá koøen.

\bodik (1) Polynom prvního stupnì $ax+b$ ($a\not=0$, tzv. lineární
   polynom) 
   má jeden koøen $-b/a$.
   \inl[polynom: lineární, lineární: polynom]

\bodik (2) Polynom druhého stupnì $ax^2+bx+c$ ($a\not=0$, nazývaný 
   té¾ kvadratický polynom)
   má dva koøeny \hbox{$(-b+\sqrt{b^2-4ac})/2a, (-b-\sqrt{b^2-4ac})/2a$}.
   Je-li $b^2-4ac=0$, jedná se o jeden dvojnásobný koøen.
   \inl[polynom: kvadratický, kvadratický: polynom]

\bodik (3) Polynom tøetího stupnì (tzv. kubický polynom) má tøi koøeny, které lze z
   koeficientù polynomu spoèítat pomocí tzv. Cardanových vzorcù. Tyto
   vzorce je mo¾né dohledat v matematických tabulkách (napøíklad\bcite[bartsch]
   nebo\bcite[rektorys]), ov¹em pro jejich pøíli¹nou
   komplikovanost se s nimi èlovìk èasto nesetká. Pou¾ívají se jen 
   v~nìkterých poèítaèových programech èasto bez vìdomí u¾ivatele.
   \inl[polynom: kubický, kubický: polynom]
   \inl[vzorce: Cardanovy, Cardanovy: vzorce]

\bodik (4) Polynom ètvrtého stupnì má ètyøi koøeny, které lze spoèítat
   z koeficientù polynomu pomocí vzorcù, je¾ je mo¾né dohledat v
   tabulkách. Ani v tomto pøípadì se s tìmito vzorci
   èasto nesetkáváme.

\bodik (5) Pro polynomy pátého a vy¹¹ího stupnì neexistují obecné
   vzorce pro výpoèet koøenù z koeficientù polynomu. Není pravda, ¾e
   by v budoucnu nìkdo tyto vzorce mohl objevit. Niels Abel toti¾ 
   dokázal, ¾e je to nemo¾né.

\medskip

Pøíroda nám prostøednictvím Abela u¹tìdøila dal¹í lekci: poodhalila
nám své tajemství, které v~tomto pøípadì zní: 
v urèitých partiích jsem neodhalitelná.
\inl[pøíroda, Abel: Niels Henrik]

Je potøeba si uvìdomit, ¾e neexistence vzorcù pro výpoèet koøenù polynomù
stupnì pátého a vy¹¹ího nemá co dìlat s existencí nebo neexistencí
tìch koøenù samotných. Matematik obèas pracuje s faktem, ¾e doká¾e
nìèeho existenci a souèasnì doká¾e, ¾e to co existuje, neumí spoèítat.
Tak je tomu i v tomto pøípadì, jak za chvíli uká¾e fundamentální 
vìta algebry\cite[fund].

\priklad [binomp]
%%%%%%%%
Uva¾ujme tzv.~{\em binomickou rovnici}, tj. rovnici tvaru $x^n-a=0$,
kde $n>0$ je pøirozené èíslo a $a\in\C$.
Øe¹ení této rovnice jsou v¹echny koøeny polynomu $x^n-a$. To je 
dal¹í speciální typ polynomu, u~kterého umíme najít v¹echny koøeny,
dokonce pro libovolný stupeò takového polynomu.
\inl[rovnice: binomická, binomická: rovnice]

Binomickou rovnici $x^n-a=0$ pøepí¹eme do tvaru $x^n=a$ a odmocníme, tj.~formálnì
dostáváme \hbox{$x=\root n\,\of a$}. Úkolem je najít v¹echny $n$-té
odmocniny z komplexního èísla 
$a$. Toto èíslo zapí¹eme ve tvaru $a=|a|\,(\cos\alpha+i\sin\alpha)$, 
kde $|a|$ je velikost èísla $a$ a $\alpha$ je úhel v rovinì 
komplexních èísel mezi kladnou 
reálnou osou a polopøímkou s poèátkem v bodì~$0$ 
procházející bodem~$a$ (tzv.~{\em argument\/} komplexního èísla~$a$).
S~vyu¾itím Moivreovy vìty 
\ifbook (viz cvièení\cite[cv-indukce], pøípad~k) \fi 
dostáváme 
$$
  \left(\root n\,\of {|a|}\left(\cos{\alpha+2k\pi\over n} + 
                         i\sin{\alpha+2k\pi\over n}\right)\right)^n =
  |a|\left(\cos(\alpha+2k\pi) + i\sin(\alpha+2k\pi)\right) = a 
$$
pro v¹echna $k\in\{0,1,2,\ldots,n-1\}$. Tak¾e komplexní èísla 
$$
  \root n\,\of {|a|}\left(\cos{\alpha+2k\pi\over n} + 
                         i\sin{\alpha+2k\pi\over n}\right)
$$
jsou pro $k\in\{0,1,2,\ldots,n-1\}$ rùzné $n$-té odmocniny 
z èísla~$a$. V¹echna tato èísla øe¹í danou binomickou rovnici.
Ze vzorce\cite(rozkladp) plyne, ¾e polynom stupnì $n$ má nejvý¹e $n$
koøenù, tak¾e uvedené $n$-té odmocniny z èísla $a$ jsou 
{\it v¹echny} koøeny polynomu $x^n-a$.
%Dosadíme-li za $k$ postupnì $0,1,2,\ldots,n-1$, dostáváme $n$ rùzných
%komplexních èísel, která v¹echna nazýváme $n$-tými odmocninami z èísla $a$,
%proto¾e jejich $n$-tá mocnina se skuteènì rovná èíslu~$a$. Jedná se o
%v¹echny koøeny polynomu $x^n-a$.
\inl[argument: komplexního èísla]
\inl[odmocnina: komplexního èísla]
\inl[vìta: Moivreova, Moivreova: vìta]

%Poznamenávám je¹tì, ¾e identitì $e^{i\alpha}=\cos\alpha+i\sin\alpha$
%se obvykle øíká Moivreova vìta. Funkci $e^x$ pro \hbox{$x\in\C$} vìt¹inou
%definujeme jako øadu $\sum_{k=0}^\infty x^k/k!$. Pokud kosinus a
%sinus definujeme jako reálnou a imaginární èást èísla $e^{i\alpha}$,
%je Moivreova vìta triviálním dùsledkem definice.  Pokud ale definujeme
%goniometrické funkce jinak, pak je potøeba Moivreovu vìtu dokázat.



\veta (fundamentální vìta algebry) [fund]
%%%%%
Ka¾dý polynom stupnì aspoò prvého má v $\C$ koøen.
\inl[vìta: fundamentální, fundamentální vìta algebry]
\inl[vìta: algebry: základní, základní vìta algebry]

\dukaz
Tato vìta je jednoduchým dùsledkem slo¾itìj¹ích výsledkù z komplexní
analýzy. Vìt¹inou se tedy dùkaz vìty v prvních semestrech vysoko¹kolského 
studia neuvádí s poukazem na to, ¾e vìta bude dokázána pozdìji.
Z tohoto pohledu se mi líbí dùkaz uvedený
v\bcite[ptak], který se opírá o~relativnì jednoduchou
matematiku. Dùkaz zde skoro doslova pøepisuji
vèetnì nìkterého znaèení (písmeno $\xi$ èteme~ksí).
Pøipou¹tím, ¾e ke ètení potøebuje být ètenáø v pohodì a bez spìchu. 
Chci proto naléhavì upozornit, ¾e následující pasá¾ textu
je urèena jen pro hloubavého ètenáøe. Ostatní ètenáøi pøejdou
rovnou k poznámce\cite[poznrozklad].

V dùkazu vìty budeme na mnoha místech pou¾ívat $|xy|=|x|\,|y|$ pro
$x,y\in\C$. Tuto vlastnost mù¾eme ovìøit pøevedením komplexních èísel
na tvar $x=|x|\,e^{i\alpha}, y=|y|\,e^{i\beta}$ a vyu¾itím faktu, ¾e
$\left|e^{i(\alpha+\beta)}\right|=1$ (co¾ plyne z~Moivreovy vìty,
viz\cite[binomp]).  

Dále èasto pou¾ijeme trojúhelníkovou nerovnost, tedy
$|x+y|\le|x|+|y|$ pro $x,y\in\C$. Ovìøíme napø. pøi znaèení
$x=a+ib, y=c+id$. $|x+y|^2=(a+c)^2+(b+d)^2=a^2+b^2+c^2+d^2+2ac+2bd$, 
$(|x|+|y|)^2=a^2+b^2+2\sqrt{(a^2+b^2)(c^2+d^2)}+c^2+d^2$. Po odeètení
a druhém umocnìní máme dokázat $(ac+bd)^2\le(a^2+b^2)(c^2+d^2)$, co¾ plyne 
z~nerovnosti $0\le(ad-bc)^2$.

K dùkazu fundamentální vìty algebry pou¾ijeme tøi pomocné vìty (lemmata):
\inl[vìta: pomocná, pomocná vìta, lemma]

\veta [flemm1]
%%%%%
Nech» $p$ je polynom stupnì aspoò prvého. Pak
$\lim |p(x)| = +\infty$ pro $|x|\to+\infty$, neboli
$\forall K\ge0\,\,\exists r>0$ tak, ¾e pro v¹echna $x\in\C$, pro nì¾
$|x|>r$, platí $|p(x)|>K$.

\goodbreak
\dukaz
Nech» $p$ má koeficienty $a_0,a_1,\ldots,a_n$, $n\ge0$, $a_n\not=0$. 
Pro $x\in\C$ je
$$|a_nx^n| = \bigl|p(x)-(a_{n-1}x^{n-1}+\cdots+a_1x+a_0)\bigr| \le
|p(x)|+|a_{n-1}x^{n-1}|+\cdots+|a_1x|+|a_0|,
$$
tak¾e pro $x\not=0$ je
$$|p(x)| \ge 
        |a_n| |x|^n - \cdots - |a_1|\,|x| - |a_0| =
        |x|^n \left(|a_n| - {|a_{n-1}| \over |x|} - \cdots
     - {|a_1|\over|x|^{n-1}} - {|a_0|\over |x|^n} \right).
$$
Pokud $|x|\to+\infty$, pak $|p(x)|\to+\infty$, proto¾e závorka v
posledním výrazu má limitu $|a_n|\not=0$.

\veta [flemm2]
%%%%%
Nech» $p$ je polynom stupnì aspoò prvého. Pak funkce
$|p|:\C\to\R$ definovaná vztahem $|p|(x)=|p(x)|$ má
lokální minimum na $\C$.

\dukaz
Oznaème $K=|p(0)|+1$. Podle pøedchozí vìty existuje
$r>0$ tak, ¾e $|p(x)|>K$ pro v¹echna $x\in\C, |x|> r$.
Oznaème $S_r=\{x\in\C;\, |x|\le r\}$, tj. krou¾ek komplexních èísel o
polomìru $r$ se støedem~0. Na okraji krou¾ku $S_r$ 
je $|p(x)|\ge K$, proto¾e
$|p|$ je spojitá a vnì krou¾ku má hodnoty vìt¹í ne¾ $K$.
Proto¾e $S_r$ je omezený a kompaktní,
dosahuje spojitá funkce $|p|$ na $S_r$ svého minima. Toto minimum je
men¹í ne¾ $K$, proto¾e $0\in S_r$ a $|p(0)|=K-1$. Tak¾e minimum
le¾í uvnitø krou¾ku $S_r$ a jde o lokální minimum 
funkce $|p|$ na $\C$.

\veta [flemm3]
%%%%%
Nech» $p$ je polynom stupnì aspoò prvého. Nech» èíslo $x_0\in\C$ 
je zvoleno
tak, ¾e $|p(x_0)|>0$. Potom funkce $|p|:\C\to\R$
nemá lokální minimum v~$x_0$.

Jinými slovy, existuje $\xi\in\C$ (komplexní èíslo urèující smìr, ve
kterém $|p|$ klesá) tak, ¾e pro dostateènì malé $t>0$ je 
$|p(x_0+t\xi)| < |p(x_0)|$.

\dukaz
Oznaème $c=p(x_0)\not=0$. Polynom
daný vzorcem $p(x)-c$ je z pøedpokladu o stupni $p$ nenulový.
Èíslo $x_0$ je koøenem polynomu $p-c$ a nech» $m$ je 
násobnost~$x_0$. Je $m\ge1$
a podle vìty\cite[nasobnostk] polynom $(x-x_0)^m$ dìlí polynom $p-c$, neboli
existuje nenulový polynom $q$ tak, ¾e $p(x)-c = (x-x_0)^mq(x)$ pro
v¹echna $x\in\C$. Oznaème $d = q(x_0) \not=0$.

Volme $\xi\in\C$ tak, aby $\xi^m=-{c\over d}$. To je mo¾né,
staèí najít nìjakou $m$-tou odmocninu z~komplexního 
èísla~$-{c\over d}$, viz pøíklad\cite[binomp]. Je tedy $\xi^m\,{d\over c}=-1$.

Pro $t\in\R$ poèítejme $p(x_0+t\xi)$:
$$
  p(x_0+t\xi) = c + (t\xi)^m q(x_0+t\xi) = 
   c + (t\xi)^m \bigl(q(x_0+t\xi)-d+d\bigr) =
   c + t^m\xi^m d +  t^m\xi^m \bigl(q(x_0+t\xi)-d\bigr).
$$
Poslední závorku oznaèíme $r(t)=q(x_0+t\xi)-d$, tj.
$r:\R\to\C$ je polynom. Nech» $b_0,b_1,\ldots,b_s$
jsou jeho koeficienty.
Proto¾e $r(0)=0$ (viz $d=q(x_0)$), je $b_0=0$, tak¾e
$r(t) = t(b_1+b_2t+\cdots+b_st^{s-1})$. 

Najdeme $K\ge0$ takové, ¾e $|r(t)|\le Kt$ pro v¹echna
$t\in\langle0,1\rangle$. To se podaøí, proto¾e
pro $t\in\langle0,1\rangle$ je
$|r(t)|=|t|\,|b_1+\cdots+b_st^{s-1}| \le 
|t|(|b_1|+\cdots+|b_st^{s-1}|) =
|t|(|b_1|+\cdots+|b_s|\,t^{s-1}) \le
|t|(|b_1|+\cdots+|b_s|)$, tak¾e staèí volit 
$K=|b_1|+\cdots+|b_s|$. 
Vra»me se k poèítání $p(x_0+t\xi)$. Vyu¾ijeme rovnost $\xi^m\,{d\over c}=-1$.
$$
   p(x_0+t\xi) = c + t^m\xi^m d +  t^m\xi^m r(t) =
   c \left(1+t^m\xi^m {d\over c} + t^m\xi^m {r(t)\over c}\right)
   = c \left(1-t^m+t^m\xi^m {r(t)\over c}\right),
$$
tak¾e $|p(x_0+t\xi)| = 
|c| \,\left|1-t^m + t^m\xi^m {r(t)\over c}\right|$.
Cílem je ukázat, ¾e poslednì jmenovaná absolutní hodnota je men¹í
ne¾~1 pro malá kladná~$t$. Vyu¾ijeme odhad $|r(t)|\le Kt$:
$$
  \left|1-t^m + t^m\xi^m {r(t)\over c}\right|
  \le \left|1-t^m\right| + 
      \left|t^m\xi^m {Kt\over c}\right|
  =   1-t^m + 
      t^{m+1} K\left|{\xi^m \over c}\right| =
      1+t^m\left(t K\left|{\xi^m \over c}\right| - 1\right).
$$
Pro dostateènì malá $t>0$ je poslední závorka blízká èíslu $-1$, tedy
záporná, tak¾e uvedený výraz jako celek je men¹í ne¾~$1$.

\bigskip\noindent{\bf Dùkaz fundamentální vìty algebry\cite[fund].}
%%%%%%%
Podle vìty\cite[flemm2] funkce $|p|:\C\to\R$ nabývá svého 
lokálního minima. Podle vìty\cite[flemm3] toto minimum 
není v bodì, ve kterém $|p(x)|>0$.
Proto¾e $|p(x)|\ge0$, musí být hledané minimum v bodì $x\in\C$, pro
které je $|p(x)|=0$, tj.~$p(x)=0$. Existence koøenu je
dokázána.


\okraj Rozklad na koøenové èinitele | Rozklad na korenove cinitele

\poznamka [poznrozklad]
%%%%%%%%%
Dùsledkem vìty\cite[fund] 
je skuteènost, ¾e polynom $r_m$ ve
vzorci\cite(rozkladp) je konstantní. Z~toho a z vìty\cite[pstupen] 
také plyne, ¾e polynom $p$
má ve vzorci\cite(rozkladp) tolik koøenových èinitelù, kolik je jeho
stupeò. Poèítáme-li tedy ka¾dý koøen tolikrát, kolik je jeho
násobnost, mù¾eme øíci, ¾e polynom má stejný poèet koøenù, jako je jeho
stupeò. Koneènì, proto¾e 
$(x-\alpha_1)(x-\alpha_2)\cdots(x-\alpha_m)=1x^m + \cdots$, musí být
konstantní polynom $r_m$ roven koeficientu $a_m$, co¾ je nenulový 
koeficient u nejvy¹¹í mocniny polynomu $p$. V¹echny tyto poznatky
zformulujeme do následující vìty.

\veta [komplrozklad]
%%%%%
Nech» $p$ je nenulový polynom stupnì~$n$ s koeficienty
$a_0,a_1,\ldots,a_n$ a nech» 
$\alpha_1,\alpha_2,\ldots,\alpha_s\in\C$ jsou v¹echny jeho navzájem rùzné
koøeny. Nech» $k_i$ je násobnost koøenu $\alpha_i$ pro
$i\in\{1,2,\ldots,s\}$. Pak platí
$k_1+k_2+\cdots+k_s=n$ a dále pro v¹echna $x\in\C$ je
$$
  p(x) = a_n\,(x-\alpha_1)^{k_1}(x-\alpha_2)^{k_2}\cdots(x-\alpha_s)^{k_s}.
$$
Tomuto zápisu øíkáme {\em rozklad polynomu na koøenové èinitele}.
\inl[rozklad: na koøenové èinitele]

\dukaz
Viz poznámku\cite[poznrozklad].

\veta [maxkorenup]
%%%%%
Nenulový polynom stupnì $n$ má nejvý¹e $n$ rùzných komplexních koøenù.

\dukaz
Vìta je pøímým dùsledkem vìty\cite[komplrozklad].

\veta
%%%%%
Pokud se dva polynomy stupnì nejvý¹e~$n$ shodují v $n+1$ rùzných bodech, pak
jsou toto¾né. Jinými slovy, polynom stupnì $n$ je jednoznaènì urèen 
svými hodnotami v $n+1$ bodech.

\dukaz
Pøedpokládáme, ¾e pro polynomy $p$ a $q$
existují vzájemnì rùzná èísla $\alpha_1,\alpha_2,\ldots,\alpha_n,\alpha_{n+1}$
taková, ¾e $p(\alpha_i)=q(\alpha_i)$ pro $i\in\{1,2,\ldots,n,n+1\}$.
Proto¾e polynomy $p$ a $q$ mají stupeò nejvý¹e~$n$, je
podle vìty\cite[pstupen] rozdíl $p-q$ polynom stupnì nejvý¹e~$n$,
který má koøeny $\alpha_1,\alpha_2,\ldots,\alpha_n,\alpha_{n+1}$.
Tìch koøenù je více, ne¾ je jeho stupeò. To podle vìty\cite[maxkorenup] 
není mo¾né jinak, ne¾ ¾e je polynom
$p-q$ nulový. Tak¾e $p=q$ a dùkaz je hotov.

\poznamka
%%%%%%%%%
Bude následovat nìkolik modelových pøíkladù na rozklad polynomu na
koøenové èinitele. Je potøeba si uvìdomit, ¾e tyto pøíklady jsou
schválnì voleny tak, aby se povedlo koøeny
uhádnout. Poznámka\cite[hledanikorenu] ale mluví jasnì: moc mo¾ností
pøi hledání koøenù nemáme. Modelové pøíklady na hledání koøenù
jsou èasto typické tím, ¾e se dá uhádnout koøen jako
malé celé èíslo nebo jednoduchý zlomek. 
Abychom mohli hádat jen z~koneènì mnoha mo¾ností,
vyu¾ijeme následující dvì vìty.
\inl[pøíklad: modelový, modelový pøíklad]

\veta [delia0]
%%%%%
Nech» polynom $p$ má celoèíselné koeficienty $a_0,a_1,\ldots,a_n$.
Je-li $\alpha$ celoèíselným koøenem polynomu $p$, pak $\alpha$ dìlí
koeficient~$a_0$.

\dukaz
Vìta je speciálním pøípadem následující vìty pro $d=1$.

\veta [delirac]
%%%%%
Nech» polynom $p$ stupnì $n$ má celoèíselné koeficienty 
$a_0,a_1,\ldots,a_n$.
Je-li $\alpha={c\over d}$ racionálním koøenem polynomu $p$ a èísla
$c,d$ jsou celá nesoudìlná, pak $c$ dìlí~$a_0$ a $d$ dìlí~$a_n$. 

\dukaz
Proto¾e $c\over d$ je koøen, platí
$$
  a_0 + a_1\,{c\over d} + a_2\,\left({c\over d}\right)^2 + 
  \cdots + a_n\,\left({c\over d}\right)^n 
  = 0.
$$
Po pøevedení $a_0$ na druhou stranu rovnosti, vynásobení
rovnosti èíslem $d^n$ a vytknutí èísla $c$ dostáváme
$$
  c\,(a_1 d^{n-1} + a_2 cd^{n-2} + a_3 c^2d^{n-3} + \cdots + a_n c^{n-1}) 
  = -a_0 d^n.
$$
Èíslo $e=-d^n$ je nesoudìlné s $c$ a uvedená závorka obsahuje celé èíslo,
které oznaèíme~$k$. Vý¹e uvedená rovnost má tvar $c\cdot k = a_0\cdot e$. 
Èíslo $c$ tedy musí dìlit $a_0$.
Nyní vyjádøíme z pùvodní rovnosti $a_n$:
$$
  d\,(a_0 d^{n-1} + a_1 cd^{n-2} + a_2 c^2d^{n-3} + \cdots + a_{n-1} c^{n-1}) 
  = -a_n c^n.
$$
Podobnou úvahou jako pøed chvílí dospíváme k závìru, ¾e $d$ musí dìlit
$a_n$.

\priklad [polyn360]
%%%%%%%%
Najdeme rozklad na koøenové èinitele polynomu 
z pøíkladu\cite[nasobnost2], který je dán vzorcem 
$$
  p(x) = x^6-5x^5-15x^4+85x^3+10x^2-372x+360.
$$
Podle vìty\cite[delia0] je mo¾no celoèíselné koøeny hledat jen mezi
dìliteli èísla~360. 
Bohu¾el dìlitelù èísla 360 je mnoho. Ètenáø si za domácí cvièení zkusí
v¹echny dìlitele vypsat. Shledá, ¾e jich je 48, pokud ov¹em nezapomene
zapsat i záporné dìlitele. Obvykle zaèínáme dosazovat takové dìlitele,
které jsou v~absolutní hodnotì co nejmen¹í. Tedy $p(1)=64$ (není
koøen), $p(-1)=648$ (není koøen), 
$p(2)=0$ (ejhle, je to koøen)! Navíc, jak ukazuje
pøíklad\cite[nasobnost2], je tento koøen dokonce trojnásobný, tak¾e
s~vyu¾itím výsledku toho pøíkladu máme $p(x) = (x^3+x^2-21x-45)(x-2)^3$.

Dal¹í koøeny polynomu $p$ jsou urèitì i koøeny polynomu
$x^3+x^2-21x-45$. Dále tedy hledáme koøeny jen tohoto kubického
polynomu~$r$. Hádáme dále celá èísla (proto¾e v modelových pøíkladech
nás nikdo nebude nutit pou¾ít Cardanovy vzorce). Staèí se omezit na dìlitele
èísla~45, tedy na èísla z~mno¾iny 
$\{-45, -15, -9, -5, -3, -1, 1, 3, 5, 9, 15, 45\}$.
Jednièku a mínus jednièku u¾ jsme testovali s~negativím výsledkem
v~pøípadì polynomu~$p$,
nemusíme ji tedy zkou¹et znovu. Vyzkou¹íme $r(3)=-72$ (není koøen), 
$r(-3)=0$ (ejhle koøen)! Hornerovo schéma pro $-3$ vypadá takto:
$$
  \def\rule#1{\noalign{\vskip-5pt}\multispan#1 \hrulefill \cr}
  \vbox{\halign{&\quad \hfil$#$\cr
               & 1 &  1 & -21 & -45 \cr
  \llap{$-3$}: &   & -3 &   6 &  45 \cr \rule 5
               & 1 & -2 & -15 &  0  \cr
  \llap{$-3$}: &   & -3 &  15       \cr  \rule 4
               & 1 & -5 &   0       \cr
   }}         
$$
Vidíme, ¾e èíslo $-3$ je dvojnásobný koøen a ¾e je
$x^3+x^2-21x-45=(x+3)^2(x-5)$, tak¾e~5 je poslední koøen vy¹etøovaného
polynomu. Máme rozklad:
$$
   x^6-5x^5-15x^4+85x^3+10x^2-372x+360 = (x-2)^3(x+3)^2(x-5).
$$
Polynom $p$ má tedy následující koøeny: 2 (trojnásobný koøen), 
$-3$ (dvojnásobný koøen) a~$5$ (jednonásobný koøen).

\priklad [polyn26]
%%%%%%%%
Najdeme rozklad polynomu
$3x^6-8x^5+22x^4+54x^3-5x^2-26x$ na koøenové èinitele.

Oznaème vy¹etøovaný polynom písmenem~$p$.
Pøedev¹ím, tento polynom má koeficient $a_0=0$, tak¾e nula je koøenem
polynomu. Koøenový èinitel $x-0$ pí¹eme struènì jako $x$ a vznikne
jednodu¹e vytknutím promìnné $x$ ze zadaného výrazu:
$$
  p(x) = x\,(3x^5-8x^4+22x^3+54x^2-5x-26).
$$
Dále staèí najít rozklad polynomu $3x^5-8x^4+22x^3+54x^2-5x-26$, který
oznaèíme~$q$. Nejprve hádáme celoèíselné koøeny mezi dìliteli èísla
26: $q(1)=40$ (není koøen), $q(-1)=0$ (ejhle, koøen)! Navazujícím
Hornerovým schématem vyzkoumáme jeho násobnost:
$$
  \def\rule#1{\noalign{\vskip-5pt}\multispan#1 \hrulefill \cr}
  \vbox{\halign{&\quad \hfil$#$\cr
               & 3 &  -8 &  22 &  54 &  -5 & -26 \cr
  \llap{$-1$}: &   &  -3 &  11 & -33 & -21 &  26 \cr \rule 7
               & 3 & -11 &  33 &  21 & -26 &   0 \cr
  \llap{$-1$}: &   &  -3 &  14 & -47 &  26       \cr \rule 6
               & 3 & -14 &  47 & -26 &   0       \cr
  \llap{$-1$}: &   &  -3 &  17 & -64             \cr \rule 5
               & 3 & -17 &  64 & -90             \cr
   }}         
$$
Èíslo $-1$ je tedy dvojnásobným koøenem a máme 
$q(x)=(x+1)^2(3x^3-14x^2+47x-26)$ Dále budeme rozkládat uvedený
kubický polynom, který oznaèíme $r$. Pokraèujeme ve zkoumání dìlitelù
èísla 26: \hbox{$r(2)=36$} (není koøen), $r(-2)=-200$ (není koøen),
$r(13)=4810$ (není koøen), $r(-13)=-9594$ (není koøen),
$r(26)=44460$ (není koøen), $r(-26)=-63440$ (není koøen).
Z vìty\cite[delia0] plyne, ¾e polynom $r$ nemá ¾ádný celoèíselný
koøen. Proto¾e koeficient u nejvy¹¹í mocniny je $a_3=3\not=1$, podle
vìty\cite[delirac] je mo¾né, ¾e koøenem bude zlomek, jeho¾ èitatel 
dìlí 26 a jmenovatel dìlí~3. Vyzkou¹íme $r(1/3)\doteq -11{,}777$ (není
koøen), $r(-1/3)\doteq -43{,}333$ (není koøen), $r(2/3)=0$ (ejhle koøen)!
Pomocí Hornerova schématu mù¾eme najít rozklad:
$$
  \def\rule#1{\noalign{\vskip-5pt}\multispan#1 \hrulefill \cr}
  \vbox{\halign{&\quad \hfil$#$\cr
                & 3 & -14 & 47 & -26 \cr
  \llap{$2/3$}: &   &   2 & -8 &  26 \cr \rule 5
                & 3 & -12 & 39 &   0 \cr
   }}         
$$
Tak¾e $r(x)=(x-{2\over3})(3x^2-12x+39)$. Koøeny kvadratického polynomu
umíme najít:
$$
  {12\pm\sqrt{144-468}\over 6} = {12\pm i\sqrt{324}\over 6} =
  {12\pm 18i\over 6} = 2\pm 3i.
$$
Hledaný rozklad tedy je
$$
  \textstyle
  p(x) = 3x\,(x+1)^2(x-{2\over3})(x-2+3i)(x-2-3i).
$$
Pov¹imnìte si, ¾e v rozkladu je kromì koøenových èinitelù uveden 
koeficient u nejvy¹¹í mocniny $a_6$ polynomu $p$. Na nìj nesmíme
zapomenout. Polynom~$p$ 
má nulu jako jednonásobný koøen, $-1$ je dvojnásobný koøen,
$2\over3$ je jednonásobný koøen a koneènì èísla
$2+3i$ a $2-3i$ jsou vzájemnì komplexnì sdru¾ené 
jednonásobné koøeny.

\priklad [nenajdukoreny]
%%%%%%%%
Pokusíme se najít rozklad na koøenové èinitele polynomu z pøíkladu\cite[horner1], tedy
$$
  p(x) = 2x^8-3x^7-11x^6+5x^5+11x^3-2x^2-9x-2.
$$
Pokud má tento polynom racionální koøeny, pak podle vìty\cite[delirac]
jejich èitatel musí dìlit dvojku a jmenovatel musí také dìlit dvojku.
Koøeny budeme tedy hádat z mno¾iny
$\{-2,-1,-{1\over2},{1\over2},1,2\}$.
Pus»me se do toho: $p(1)=-9$ (není koøen), $p(-1)=-17$ (není koøen),
$p(2)=-356$ (není koøen), $p(-2)=-48$ (není koøen), 
$p(1/2)\doteq -5{,}656$ (není koøen), $p(-1/2)\doteq 0{,}328$ (není koøen).
Zjistili jsme, ¾e tento polynom nemá racionální koøeny. Podle
fundamentální vìty algebry\cite[fund] tento polynom koøen má, podle
jednoduchých dùsledkù této vìty tento polynom dokonce má osm koøenù,
pokud ka¾dý poèítáme tolikrát, kolik je jeho násobnost. 
Tyto koøeny jsou zøejmì iracionální èísla nebo se jedná o
komplexní koøeny s nenulovou imaginární èástí. 
Bohu¾el, ani jeden takový koøen neumíme najít, 
aèkoli koeficienty toho polynomu vypadají
celkem nevinnì (jsou to malá celá èísla). Mù¾eme tedy pouze prohlásit,
¾e rozklad na koøenové èinitele tohoto polynomu existuje, ale nevíme,
jak tento rozklad vypadá.

Chtìl bych velmi upozornit, ¾e toto je obvyklý jev. Pokud náhodnì
vybereme z osudí, ve kterém jsou v¹echny polynomy, jeden, pak skoro 
jistì neumíme najít jeho koøeny.
Desítky, mo¾ná stovky, pøíkladù, které se 
vyskytují v uèebnicích základního kurzu o polynomech, jsou
vyumìlkované a voleny tak, aby bylo mo¾né nìjak koøeny najít. Daleko
typiètìj¹í je ov¹em pøíklad tento: koøeny najít neumíme.

V praxi se mù¾eme setkat navíc s polynomy vysokých stupòù, 
jejich¾ koeficienty ani nejsou
celá èísla. Pak si mù¾eme být skoro jisti, ¾e koøeny najít
nelze. Proto¾e ale úloha rozkladu na koøenové èinitele a hledání koøenù
je pro dal¹í výpoèty vìt¹inou potøebná, je nutné pøistoupit k hledání
koøenù alespoò pøibli¾nì numerickými metodami. Tato problematika ale
nespadá do náplnì tohoto textu.

Pro ilustraci jsem pou¾il øe¹ítko v~Maple, které má v sobì zabudovány
numerické metody hledání koøenù. Pro daný polynom vy¹el tento
pøibli¾ný výsledek:
$$
  \eqalign{
  &x_1 \doteq -2{,}05376,\quad
  x_2 \doteq -0{,}55262,\quad
  x_3 \doteq -0{,}25957,\quad
  x_4 \doteq  2{,}99882, \cr
  &x_{5,6} \doteq -0{,}26936 \pm 1{,}00279\,i,\quad
  x_{7,8} \doteq   0{,}95292 \pm 0{,}37662\,i, \cr
  &p(x) = 2 \,(x-x_1)\,(x-x_2)\,(x-x_3)\,(x-x_4)\,(x-x_5)\,(x-x_6)\,(x-x_7)\,(x-x_8).
}
$$
\par\inl[Maple]


\priklad
%%%%%%%%
Najdeme rozklad polynomu $x^n-a$ na koøenové èinitele.

Vyu¾ijeme výsledku pøíkladu\cite[binomp]. Rozklad na koøenové èinitele je
$$
  x^n-a = \prod_{k=0}^{n-1} \left(x-\root n\,\of {|a|}\,\left(\cos{\alpha+2k\pi\over n} + 
                         i\sin{\alpha+2k\pi\over n}\right)\right),
  \rce(birozklad)
$$
kde symbol $\prod$ znaèí souèin výrazù, které následují, pro $k$ od
nuly do $n-1$.

\priklad [binom8]
%%%%%%%%
Najdeme rozklad polynomu $x^8-1$ na koøenové èinitele.

Je potøeba najít osmé odmocniny z jedné. Jednièku pi¹me jako $1=1\,e^{i(0+2k\pi)}$.
V¹echny koøeny jsou ve tvaru
$$
  \root 8\,\of 1 = e^{i{2k\pi\over8}} = \cos{k\pi\over4} + i\sin{k\pi\over4},
  \quad k\in\{0,1,2,3,4,5,6,7\}.
$$
Pro $k=0$ je $\root8\,\of1=1$, pro $k=1$ a $k=7$ je 
$\root8\,\of1={\sqrt2\over2}\pm i{\sqrt2\over2}$, pro
$k=2$ a $k=6$ je $\root8\,\of1=\pm i$, pro $k=3$ a $k=5$
je $\root8\,\of1=-{\sqrt2\over2}\pm i{\sqrt2\over2}$ a koneènì pro $k=4$
je $\root8\,\of1=-1$. Z tohoto hlediska je nutno tento pøíklad pova¾ovat
za modelový, nebo» potøebné hodnoty funkcí sinus a kosinus byly
tabulkové. Kdybychom poèítali napø.~$\root7\,\of1$, tabulkových hodnot
bychom nemohli vyu¾ít a museli bychom nechat výsledek ve
tvaru\cite(birozklad) nebo jej vyèíslit numericky.
Rozklad polynomu $x^8-1$ na koøenové èinitele je
$$
  \textstyle
  x^8-1 = \bigl(x-1\bigr) \,\bigl(x-{\sqrt2\over2}-i{\sqrt2\over2}\bigr) 
                \,\bigl(x-{\sqrt2\over2}+i{\sqrt2\over2}\bigr)
          \,\bigl(x-i\bigr)\,\bigl(x+i\bigr)
                \,\bigl(x+{\sqrt2\over2}-i{\sqrt2\over2}\bigr) 
                \,\bigl(x+{\sqrt2\over2}+i{\sqrt2\over2}\bigr)
          \,\bigl(x+1\bigr).
$$


\okraj Reálný rozklad | Realny rozklad

\poznamka
%%%%%%%%%
V pøíkladech\cite[polyn26],\cite[nenajdukoreny],\cite[binom8] vy¹ly
komplexní koøeny vzájemnì po dvou komplexnì sdru¾ené. Následující vìty
ukazují, ¾e se nejedná o náhodu, ale pro polynomy s reálnými koeficienty
je to zákonitá vlastnost.

\veta [alphaspruhem]
%%%%%
Je-li $\alpha$ koøen polynomu $p$ s reálnými koeficienty, pak
komplexnì sdru¾ené èíslo $\overline\alpha$ je také koøenem polynomu~$p$.

\dukaz
Pøipomenu, ¾e komplexnì sdru¾ené èíslo znaèíme pruhem nad èíslem a
definujeme jako èíslo s~opaènou imaginární èástí, tj.
$\overline{a+ib}=a-ib$. Dále je potøeba pøipomenout základní
vlastnosti:

\medskip

$x=\overline x$ právì kdy¾ $x\in\R$,  proto¾e $\overline{a+0i}=a-0i=a$.

$\overline x + \overline y = \overline {x+y}$, proto¾e
$\overline{a+ib}+\overline{c+id} = a+c-i(b+d) = \overline{a+ib+c+id}$.

$\overline x\,\overline y = \overline{xy}$, proto¾e
$(a-ib)(c-id)=ac-bd-i(bc+ad)=\overline{ac-bd+i(bc+ad)} =
\overline{(a+ib)(c+id)}$.

$\overline {x^n}= {\overline x}^n$, proto¾e 
$\overline {x \vphantom{X}}\cdot\overline {x^{n-1}} = \overline {x\,x^{n-1}} = \overline {x^n}$.

\medskip
\noindent
Jeliko¾ $\alpha$ je koøen, platí $p(\alpha)=0$. Máme dokázat, ¾e 
$p(\overline\alpha)=0$.
$$
  \eqalign{
  p(\overline\alpha) &= a_0 + a_1\overline\alpha + 
       a_2\overline\alpha^2 + \cdots + a_n\overline\alpha^n
  = \overline{a_0} + \overline{a_1}\,\,\overline\alpha + 
       \overline{a_2}\,\,\overline\alpha^2 + \cdots + \overline{a_n}\,\,\overline\alpha^n
  = \cr 
  &= \overline{a_0} + \overline{a_1}\,\,\overline\alpha + 
       \overline{a_2}\,\,\overline{\alpha^2} + \cdots + \overline{a_n}\,\,\overline{\alpha^n}
  = \overline{a_0} + \overline{a_1\,\alpha} + 
       \overline{a_2\,\alpha^2} + \cdots + \overline{a_n\,\alpha^n}
  = \cr 
  &= \overline{a_0 + a_1\alpha + 
       a_2\alpha^2 + \cdots + a_n\alpha^n}
  = \overline{p(\alpha)} = \overline 0 = 0.
}
$$
Nejprve jsme vyu¾ili toho, ¾e koeficienty $a_0,a_1,\ldots,a_n$ jsou
reálné. Dal¹í rovnosti plynou ze základních vlastností komplexnì 
sdru¾eného èísla.

Vìta nevyluèuje pøípad, ¾e $\alpha$ je reálný koøen. Pak ale
$\overline\alpha=\alpha$, co¾ je také (tentý¾) koøen.

\veta [nasobnostpruhu]
%%%%%
Nech» $\alpha$ je koøen nenulového polynomu $p$ s reálnými koeficienty. Pak koøeny
$\alpha$ a $\overline\alpha$ mají stejnou násobnost.

\dukaz
%%%%%%
Pøedpokládejme, ¾e násobnost koøene $\alpha$ je $k$ a násobnost
$\overline\alpha$ je $k'$. Bez újmy na obecnosti je mo¾no pøedpokládat
$k\le k'$.
V rozkladu na koøenové èinitele polynomu $p$ se vyskytuje kromì
$(x-\alpha)$ také èinitel $(x-\overline\alpha)$. Souèin tìchto dvou
èinitelù
$$
  (x-\alpha)(x-\overline\alpha) = (x-a-ib)(x-a+ib) = x^2 -2ax + a^2+b^2
$$
je polynom s reálnými koeficienty. Oznaème jej $q$. Polynom $q^k$ má
také reálné koeficienty a navíc dìlí polynom $p$ beze zbytku. 
Oznaème $p/q=r$. Polynom $r$ má (díky algoritmu 
pro dìlení polynomu polynomem) reálné
koeficienty. Nemù¾e se tedy stát, aby $r$ mìl jen koøen
$\overline\alpha$, a pøitom nemìl koøen $\alpha$. Násobnosti tedy
musejí být stejné.

\poznamka [realrozklad]
%%%%%%%%%
Pokud je dán polynom s reálnými koeficienty, pak podle pøedchozí vìty
má stejný poèet koøenových èinitelù tvaru $x-\alpha$ jako èinitelù
tvaru $x-\overline\alpha$. Tyto èinitele mù¾eme po dvou roznásobit a
vytvoøit tak kvadratické polynomy s reálnými koeficienty
$$
  (x-\alpha)\,(x-\overline\alpha) = (x-a-ib)\,(x-a+ib) 
  = x^2 -2ax + a^2+b^2 = x^2 + cx + d.
$$
Tím se v rozkladu na souèin polynomù vyhneme práci s komplexními
èísly. To mù¾e být pro u¾ivatele, který pracuje s reálnými polynomy a
oèekává tedy reálné rozklady, dùle¾ité. Zformulujeme proto vìtu 
o~reálném rozkladu na souèin polynomù.

\veta [rrozkladp]
%%%%%
Nech» nenulový polynom $p$ stupnì $n$ má reálné koeficienty. Nech»
$\alpha_1,\alpha_2,\ldots,\alpha_s$ jsou v¹echny jeho vzájemnì rùzné reálné
koøeny s násobnostmi po øadì $k_1,k_2,\ldots,k_s$. Nech»
$\beta_1,\overline{\beta_1}, \ldots, \beta_t, \overline{\beta_t}$
jsou v¹echny vzájemnì rùzné komplexní koøeny polynomu $p$
s nenulovou imaginární èástí, které mají v~souladu 
s~vìtou\cite[nasobnostpruhu] 
násobnosti po øadì $r_1,r_1,r_2,r_2,\ldots,r_t,r_t$.
Pak je
$$
  n = k_1 + k_2 + \cdots + k_s + 2\,(r_1 + r_2 + \cdots + r_t)
$$
a existují reálná èísla
$c_i, d_i$, pro $i\in\{1,\ldots,t\}$ tak, ¾e pro v¹echna $x\in\R$ 
je
$$
  p(x) = a_n\,(x-\alpha_1)^{k_1} (x-\alpha_2)^{k_2} \cdots
              (x-\alpha_s)^{k_s}
              (x^2 + c_1 x + d_1)^{r_1}
              (x^2 + c_2 x + d_2)^{r_2} \cdots
              (x^2 + c_u x + d_t)^{r_t}.
$$
Uvedený vzorec se nazývá {\em reálný rozklad polynomu $p$}.
\inl[rozklad: reálný, reálný: rozklad]

\dukaz
Je $(x-\beta_i)(x-\overline{\beta_i}) = x^2 + c_i x + d_i$, viz
poznámku\cite[realrozklad]. V¹e ostatní plyne z vìty\cite[komplrozklad].

\priklad
%%%%%%%%
Rozklad na koøenové èinitele v pøíkladu\cite[polyn360] je souèasnì
reálným rozkladem, proto¾e polynom nemá komplexní koøeny s nenulovou
imaginární èástí.

Polynom z pøíkladu\cite[polyn26] má reálný rozklad
$p(x)=3x\,(x+1)^2(x-{2\over3})\,(x^2-4x+13)$.

Polynom z pøíkladu\cite[binom8] má reálný rozklad
$ p(x) = (x-1)\, (x+1)\, (x^2+1)\, (x^2+\sqrt2\,x+1)\, (x^2-\sqrt2\,x+1)$.

Koneènì polynom z pøíkladu\cite[nenajdukoreny] má reálný rozklad pøibli¾nì:

$
  p(x)\doteq 2 \,(x-x_1)\,(x-x_2)\,(x-x_3)\,(x-x_4)\,
  (x^2+0{,}53872\,x + 1{,}07814)\, (x^2-1{,}90584\,x + 1{,}0499).
$

\priklad
%%%%%%%%
Rozlo¾íme polynom $x^5-10x^4+32x^3-8x^2-140x+200$ na reálné 
koøenové èinitele. Vyu¾ijeme pøitom nápovìdy, ¾e èíslo $3+i$ je
koøenem tohoto polynomu.

Pøedev¹ím je zøejmé, ¾e se jedná o modelový pøíklad. 
Je toti¾ nereálné, aby nám v~reálném ¾ivotì
nìkdo napovídal nereálný koøen reálného polynomu.

Proto¾e má polynom reálné koeficienty, je podle 
vìty\cite[alphaspruhem] také èíslo $3-i$ koøenem. 
Známe tedy dva koøeny.
Nyní máme dvì mo¾nosti, jak dále postupovat. 
Mù¾eme napøíklad pomocí Hornerova schématu dosadit jednak
$3+i$ a následnì $3-i$ do polynomu. Druhou mo¾ností je roznásobit
koøenové èinitele pøíslu¹ející známým koøenùm a podìlit výsledným
kvadratickým polynomem daný polynom. Vyzkou¹íme si obì metody.

Nejprve zkusíme dosazovat koøeny do Hornerova schématu. Zpoèátku
to pùjde ztuha, proto¾e èlovìk nenásobí dvì komplexní èísla mezi sebou
dennì.
$$
  \def\p{\phantom{{}-2i}}\def\pp{\phantom{{}+20i}}
  \def\i{\phantom{{}-i}}
  \def\rule#1{\noalign{\vskip-5pt}\multispan#1 \hrulefill \cr}
  \vbox{\halign{&\qquad \hfil$#$\cr
                & 1 & -10\i &  32\p  &  -8\p & -140\pp &  200 \cr
  \llap{$3+i$}: &   &  3+i  & -22-4i & 34-2i &  80+20i & -200 \cr \rule 7
                & 1 & -7+i  &  10-4i & 26-2i & -60+20i &   0 \cr
  \llap{$3-i$}: &   &  3-i  & -12+4i & -6+2i &  60-20i       \cr \rule 6
                & 1 & -4\i  &  -2\p  & 20\p  &   0\pp        \cr
   }}         
$$
Ne náhodou máme na posledním øádku schématu reálná èísla. 
Tento øádek toti¾
obsahuje koeficienty polynomu $r$, pro který je
$p(x) = (x-3-i)\,(x-3+i)\, r(x)$. Jak jsme ukázali v dùkazu 
vìty\cite[nasobnostpruhu], polynom~$r$ má reálné koeficienty.
Je tedy $p(x)=(x-3-i)\,(x-3+i)\,(x^3-4x^2-2x+20)$. 

Ne¾ zaèneme rozkládat polynom $r$, zkusíme se ke stejnému mezivýsledku
dostat druhou metodou. Roznásobíme nejdøíve koøenové èinitele
$(x-3-i)\,(x-3+i) = x^2-6x+10$. Tím jsme se hned na zaèátku zbavili
malého mìkkého~$i$. Abychom získali polynom $r$, musíme bohu¾el dìlit
polynom $p$ polynomem $x^2-6x+10$.
$$
  \def\0{\phantom0}
  \setbox0=\hbox{$(x^5-10x^4+32x^3-\08x^2-140x+200\rlap)$}
  \def\r#1{\setbox2=\hbox{$#1$}\hbox to\wd0{\hss\copy2}}
  \def\l#1{\hbox to\wd0{$#1$\hss}}
  \def\rule{\vskip-5pt\hbox to\wd0{\hss\hbox to\wd2{\hrulefill}}}
  \def\-{\llap{$-$}}
  \hbox{\vtop{
    \hbox{\copy0}
    \l{\llap{$-$}(x^5-\06x^4+10x^3)}
    \smallskip\hrule\smallskip
    \r{-4x^4+22x^3-\08x^2-140x+200}
    \r{\-(-4x^4+24x^3-40x^2\rlap)\phantom{{}-140x+200}}
    \rule
    \r{-2x^3+32x^2-140x+200}
    \r{\-(-2x^3+12x^2-\020x\rlap)\phantom{{}+200}}
    \rule
    \r{20x^2-120x+200}
    \r{\-(20x^2-120x+200\rlap)}
    \rule
    \r{0}
  }$\hskip8pt:(x^2-6x+10) = x^3-4x^2-2x+20$}
$$
Ne náhodou vy¹el zbytek po dìlení nula. Polynom $x^2-6x+10$ musí dìlit
polynom $p$, proto¾e se jedná o souèin koøenových èinitelù.

Nyní se nám obì metody setkávají. Potøebujeme rozlo¾it polynom
$r$ na koøenové èinitele. Hádáme mezi dìliteli èísla~$20$:
$r(1)=15$ (není koøen), $r(-1)=17$ (není koøen),
$r(2)=8$ (není koøen), $r(-2)=0$ (ejhle koøen)!
Po vydìlení koøenovým èinitelem $x+2$ (nebo pou¾itím Hornerova
schématu) dostáváme $r(x)=(x+2)\,(x^2-6+10)$. Proto¾e
polynom $x^2-6+10$ u¾ v rozkladu jednou máme, shledáváme, ¾e koøeny
$3\pm i$ jsou dvojnásobné. Reálný rozklad polynomu $p$ tedy je
$$
  p(x) = (x+2) \, (x^2-6+10)^2.
$$

\okraj Parciální zlomky | Parcialni zlomky

\poznamka
%%%%%%%%%
V kalkulu jedné promìnné se studenti vìt¹inou seznamují se
skuteèností, ¾e funkce dané podílem polynomù lze integrovat tak, ¾e se
tento podíl rozepí¹e na souèet polynomu a parciálních zlomkù. Pøitom
polynomy se integrují snadno a pro ka¾dý typ parciálního zlomku
existuje integraèní vzoreèek. 

Podlì vìty\cite[delenip] je mo¾né funkci danou podílem polynomù
èásteènì podìlit. Platí $p/q = r + z/q$, pøitom stupeò $z$ je men¹í
ne¾ stupeò $q$.
Zlomek $z/q$ je dále mo¾no rozepsat na souèet parciálních zlomkù, jak
uvidíme v následující vìtì\cite[parczl]. Nejprve ov¹em potøebujeme
dokázat pomocnou vìtu:

\veta [parczlpom]
%%%%%
Nech» stupeò polynomu $p$ je men¹í ne¾ stupeò polynomu $q$ 
a nech» $\alpha\in\C$ je
$k$-násobným koøenem polynomu $q$. Symbolem $q_1$ oznaème polynom,
který splòuje $q(x) = (x-\alpha)^k q_1(x)$ pro v¹echna $x\in\C$.
Pak existuje èíslo $a\in\C$ a polynom $p_1$ tak, ¾e platí
$$
  {p(x) \over q(x)} = {a\over (x-\alpha)^k} + 
  {p_1(x) \over (x-\alpha)^{k-1} q_1(x)}
$$
pro v¹echna $x\in\C$ s výjimkou koøenù polynomu $q$.
Pøitom stupeò $p_1$ je men¹í ne¾ stupeò $(x-\alpha)^{k-1} q_1(x)$.

\dukaz
Vynásobením dokazované rovnosti polynomem $q$ dostaneme 
ekvivalentní rovnost:
$$
  p(x) = a\,q_1(x) + p_1(x)\,(x-\alpha).
$$
Dosazením $x=\alpha$ dostáváme $p(\alpha) = a\,q_1(\alpha)$, tedy
$a = p(\alpha)/q_1(\alpha)$. Tento výpoèet lze provést, proto¾e
díky vìtì\cite[nasobnostk] je $q_1(\alpha)\not = 0$.

Polynom  $p(x) - a\,q_1(x)$ má koøen $\alpha\in\C$, proto¾e
$p(\alpha) - \bigl(p(\alpha)/q_1(\alpha)\bigr)\,q_1(\alpha) = 0$.
Existuje tedy podle vìty\cite[korencdeli] polynom $p_1$ tak, ¾e
$ p(x) - a\,q_1(x) = p_1(x)\,(x-\alpha)$. Pøiètením 
$a\,q_1(x)$ a vydìlením polynomem $q$ dostáváme dokazovanou rovnost.

Proto¾e ${\rm St}(p_1)+1 \le \max\bigl({\rm St}(p),{\rm St}(q_1)\bigr)
< {\rm St}(q)$, \ je $\ {\rm St}(p_1) < {\rm St}(q) - 1$. Tak¾e platí i
tvrzení o~stupni polynomu~$p_1$.

\veta [parczl2]
%%%%%
Nech» stupeò polynomu $p$ je men¹í ne¾ stupeò polynomu $q$ a nech» $\alpha$ je
$k$-násobným koøenem polynomu $q$. Symbolem $q_1$ oznaème polynom,
který splòuje $q(x) = (x-\alpha)^k q_1(x)$ pro v¹echna $x\in\C$.
Pak existují èísla $a_1,a_2,\ldots, a_k\in\C$ a polynom 
$p_2$ tak, ¾e platí:
$$
  {p(x) \over q(x)} = {a_k\over (x-\alpha)^k} +
  {a_{k-1}\over (x-\alpha)^{k-1}} + \cdots +
  {a_1\over (x-\alpha)} + 
  {p_2(x) \over q_1(x)}
$$
pro v¹echna $x\in\C$ s výjimkou koøenù polynomu $q$.
Pøitom stupeò $p_2$ je men¹í ne¾ stupeò $q_1$.

\dukaz
Opakovaným pou¾itím vìty\cite[parczlpom].  

\veta [parczl]
%%%%%
Podíl polynomù $p/q$, kde stupeò $p$ je men¹í ne¾ stupeò $q$, je roven
souètu koneènì mnoha tzv.~{\em parciálních zlomkù\/} tvaru:
$$
  {a\over (x-\alpha)^u}
$$
kde $a\in\C$ je konstanta, $\alpha\in\C$ je koøen 
$q$ násobnosti $k$ a $u\le k$, $u\in\N$.

\dukaz
Pou¾ijeme vìtu\cite[parczl2] postupnì na v¹echny koøeny polynomu $q$.

\poznamka
%%%%%%%%%
Dùkazy vìt\cite[parczlpom] a\cite[parczl2] jsou konstruktivní, 
tj. poskytují návod, jak
spoèítat konstanty, které se vyskytují v èitatelích v¹ech parciálních zlomkù.
Ètenáø by mìl umìt po peèlivém pøeètení tìchto dùkazù implementovat algoritmus,
který pro ka¾dé dva polynomy $p$ a $q$ (stupeò $p$ je men¹í ne¾
stupeò~$q$ a u polynomu $q$ jsou známy koøeny) sestaví souèet 
parciálních zlomkù.

V kurzech kalkulu jedné promìné se pøi integrování lomených funkcí
(tj. funkcí ve tvaru podílu polynomù) pracuje s~vybranými pøíklady, 
ve kterých se podaøí najít koøeny
jmenovatele. Je tøeba si ale uvìdomit, ¾e pokud se nepodaøí koøeny
jmenovatele pøesnì najít (co¾ je u polynomù stupnì páteho a vy¹¹ího
obvyklé), pak nelze pøesnì sestavit ani parciální zlomky a integrovat mù¾eme
jen \uv{teoreticky}.

\poznamka
%%%%%%%%%
Abychom se pøi integraci vyhnuli komplexním èíslùm, rozepisují se podíly
polynomù s~reálnými koeficienty na souèet parciálních zlomkù dvou
druhù. Vìta o souètu {\it reálných\/} parciálních zlomkù má tvar:

\veta [parczlrell]
%%%%%
Podíl polynomù $p/q$, kde stupeò $p$ je men¹í ne¾ stupeò $q$ a oba
mají reálné koeficienty, je roven souètu 
koneènì mnoha tzv.~{\em parciálních zlomkù\/} tvaru:
$$
  {a\over (x-\alpha)^u} \quad\hbox{nebo}\quad {bx+c \over (x^2+s x + t)^v},
$$
kde $a\in\R$ je konstanta, $\alpha\in\R$ je koøen polynomu $q$ násobnosti $k$ a 
$u\le k$, $u\in\N$. Dále $b,c\in\R$ jsou konstanty,
kvadratický polynom
$(x^2+s x + t)$ má reálné koeficienty a je souèinem 
$(x-\beta)\cdot(x-\overline\beta)$, kde $\beta\in\C$,
$\beta\not\in\R$ je koøen
polynomu $q$ násobnosti $r$ a platí $v\le r$, $v\in\N$.

\dukaz Ve vìtách\cite[parczlpom] a\cite[parczl2] nahradíme v¹ude
mno¾inu $\C$ mno¾inou $\R$. Vìty pak platí
za pøedpokladu, ¾e $p$ a $q$ jsou polynomy s reálnými koeficienty.
K tomu musíme pou¾ít je¹tì následující vìtu:

\veta [parczlrel]
%%%%%
Nech» $p$ a $q$ jsou polynomy s reálnými koeficienty a 
nech» stupeò $p$ je men¹í ne¾ stupeò $q$. Pøedpokládejme, ¾e 
$\beta\in\C$, $\beta\not\in\R$ je
$k$-násobným koøenem polynomu $q$. Symbolem $q_1$ oznaème polynom,
který splòuje $q(x) = (x-\beta)^k(x-\overline\beta)^k q_1(x)$ 
pro v¹echna $x\in\C$.
Pak existují èísla $b\in\R$, $c\in\R$ a polynom $p_1$ s reálnými
koeficienty tak, ¾e platí
$$
  {p(x) \over q(x)} = {bx+c\over (x-\beta)^k(x-\overline\beta)^k} + 
  {p_1(x) \over (x-\beta)^{k-1}(x-\overline\beta)^{k-1} q_1(x)}
$$
pro v¹echna $x\in\C$ s výjimkou koøenù polynomu $q$.
Pøitom stupeò polynomu $p_1$ je men¹í ne¾ stupeò 
$(x-\beta)^{k-1}(x-\overline\beta)^{k-1} q_1(x)$.

\dukaz
Vynásobením dokazované rovnosti polynomem $q$ dostaneme 
ekvivalentní rovnost:
$$
  p(x) = (bx+c)\,q_1(x) + p_1(x)\,(x-\beta)\,(x-\overline\beta).
$$
Dosazením $x=\beta$ dostáváme $p(\beta) = (b\,\beta+c)\,q_1(\beta)$.
Musí tedy platit $b\,\beta+c = p(\beta)/q_1(\beta)$.
Tento výpoèet lze provést, proto¾e díky vìtám\cite[nasobnostk] 
a\cite[nasobnostpruhu] je $q_1(\beta)\not = 0$.

Oznaème $\beta = u+iv$ a $p(\beta)/q_1(\beta) = t+is$,
kde $u,v,t,s\in\R$. Je $b\,(u+iv)+c = t+is$, tak¾e
$b=s/v$ a $c=t-(s/v)\,u$. Z výpoètu plyne, ¾e èísla $b, c$ existují a
jsou reálná.

Polynom  $p(x) - (bx+c)\,q_1(x)$ má koøen $\beta\in\C$, proto¾e
$p(\beta) - \bigl(p(\beta)/q_1(\beta)\bigr)\,q_1(\beta) = 0$.
Tento polynom má také koøen $\overline\beta$,
proto¾e má reálné koeficienty a platí vìta\cite[alphaspruhem].
Existuje tedy podle vìty\cite[korencdeli] polynom $p_1$ s reálnými
koeficienty tak, ¾e
$ p(x) - (bx+c)\,q_1(x) = p_1(x)\,(x-\beta)(x-\overline\beta)$. Pøiètením 
$(bx+c)\,q_1(x)$ a vydìlením polynomem $q$ dostáváme dokazovanou rovnost.

Proto¾e ${\rm St}(p_1)+2 \le \max\bigl({\rm St}(p),{\rm St}(q_1)+1\bigr)
< {\rm St}(q)$, \ je $\ {\rm St}(p_1) < {\rm St}(q) - 2$. Tak¾e platí i
tvrzení o~stupni polynomu~$p_1$.

\poznamka
%%%%%%%%%
Ukázkové pøíklady na pøevod lomené funkce na souèet parciálních zlomkù najde
ètenáø v~mnoha jiných uèebních textech ke kalkulu. Nebo mù¾e pou¾ít matematický
software, který zvládá rozpis na souèet parciálních zlomkù.
Nás zde hlavnì zajímalo zdùvodìní vyslovených vìt.


\okraj Ireducibilní polynomy | Ireducibilni polynomy

\definice [polireduc]
%%%%%%%%%
Nech» polynom $p$ má koeficienty z nìjakého tìlesa~$T$.
Pokud vyhodnocujeme polynom jen pro $x\in T$ a operace 
$+$, $\cdot$ ve vzorci pro hodnotu polynomu jsou operace 
definované v~tìlese $T$, pak øíkáme, ¾e polynom $p$ je
{\em nad tìlesem $T$}.

Nech» $p$ je polynom nad tìlesem $T$.
Øíkáme, ¾e {\em $p$ je reducibilní v~$T$}, pokud existují
polynomy $q$, $r$ stupnì aspoò prvního nad~$T$ tak, 
¾e $p=q\,r$. Polynom $p$ je {\em ireducibilní v~$T$}, 
jestli¾e není reducibilní v~$T$.
\inl[polynom: reducibilní, reducibilní: polynom]
\inl[polynom: ireducibilní, ireducibilní: polynom]

\poznamka
%%%%%%%%%
Slovo {\em ireducibilní\/} mù¾eme pøelo¾it jako 
{\em nerozlo¾itelný\/} na souèin polynomù ni¾¹ího stupnì 
v~èíselném oboru koeficientù, který 
je stanoven tìlesem~$T$. Napøíklad polynom $x^2+1$ je ireducibilní v~$\R$, ale
není ireducibilní v~$\C$, proto¾e $x^2+1=(x-i)(x+i)$.

Z definice je zøejmé, ¾e konstantní polynomy a polynomy stupnì prvního
jsou urèitì ireducibilní v~libovolném tìlese, proto¾e podle 
vìty\cite[pstupen] nemohou
existovat dva polynomy stupnì aspoò prvního, jejich¾ souèin je polynom
stupnì nejvý¹e prvního.

Z fundamentální vìty algebry plyne tento dùle¾itý poznatek:
{\it ireducibilní polynomy v~$\C$ jsou pouze polynomy stupnì nejvý¹e
prvního}, nebo jinak: {\it v¹echny polynomy stupnì aspoò druhého jsou
v~$\C$ reducibilní}, nebo je¹tì jinak: {\it pro ka¾dý nenulový polynom
existuje rozklad na koøenové èinitele, co¾ je
rozklad na souèin ireducibilních polynomù v~$\C$}.

Reálný rozklad popsaný ve vìtì\cite[rrozkladp] je rozkladem na 
souèin ireducibilních polynomù v~$\R$. Z~této vìty plyne, 
¾e {\it ireducibilní polynom v $\R$ má stupeò nejvý¹e~$2$}.
Ireducibilní polynom $ax^2+bx+c$ v~$\R$ stupnì 
druhého poznáme tak, ¾e má záporný diskriminant $D=b^2-4ac$.

Má-li polynom stupnì aspoò druhého nad tìlesem $T$ koøen 
v tìlese~$T$, pak je reducibilní v~$T$. Obrácené tvrzení 
\uv{nemá-li polynom v~tìlese $T$ koøen, pak je ireducibilní v~$T$\/}
neplatí. Napøíklad $(x^2+1)^2$ nemá v $\R$ koøen, ale lze jej rozlo¾it
na souèin polynomù $(x^2+1)\,(x^2+1)$ s~reálnými koeficienty.

\priklad
%%%%%%%%
Polynom $x^8-1$ z pøíkladu\cite[binom8] má rozklad na
souèin ireducibilních polynomù v $\C$:
$$
  \textstyle
  x^8-1 = \bigl(x-1\bigr) \,\bigl(x-{\sqrt2\over2}-i{\sqrt2\over2}\bigr) 
                \,\bigl(x-{\sqrt2\over2}+i{\sqrt2\over2}\bigr)
          \,\bigl(x-i\bigr)\,\bigl(x+i\bigr)
                \,\bigl(x+{\sqrt2\over2}-i{\sqrt2\over2}\bigr) 
                \,\bigl(x+{\sqrt2\over2}+i{\sqrt2\over2}\bigr)
          \,\bigl(x+1\bigr),
$$
zatímco rozklad tého¾ polynomu na souèin ireducibilních polynomù
v~$\R$ je
$$
  x^8-1 = (x-1)\, (x+1)\, (x^2+1)\, (x^2+\sqrt2\,x+1)\, (x^2-\sqrt2\,x+1)
$$
a koneènì rozklad na souèin ireducibilních polynomù v~$\Q$ (tìlese
racionálních èísel) vypadá následovnì:
$$
  x^8-1 = (x-1)\, (x+1)\, (x^2+1)\, (x^4+1).
$$

\shrnuti
%%%%%%%%
Polynom jsme zavedli jako funkci danou vzoreèkem\lcite[dpolf] nebo
jako vzoreèek samotný\lcite[dpolv]. Definovali jsme souèet a
skalární násobek tìchto vzoreèkù\lcite[polvplus] a ukázali, ¾e
tvoøí lineární prostor\lcite[PX], který je izomorfní s prostorem
polynomù jako funkcí\lcite[polyniso].

Kromì sèítání polynomù a násobení polynomu konstantou umíme polynomy
také násobit mezi sebou\lcite[psoucin] a hledat èásteèný podíl\lcite[delenip]. 

Uvedli jsme si\lcite[horner3], ¾e Hornerovo schéma umo¾ní nejen efektivnì
vyhodnocovat polynomy ve zvolených bodech $\alpha$, ale mezivýpoèty
navíc tvoøí koeficienty èásteèného podílu vyhodnocovaného polynomu
polynomem $(x-\alpha)$.

Definovali jsme koøen polynomu\lcite[dkoren] a dokázali, ¾e polynom
je dìlitelný svým koøenovým èinitelem beze zbytku\lcite[korencdeli].
Z toho vyplynul rozklad polynomu na souèin koøenových
èinitelù\lcite[prozklad]. Základní vìta algebry\lcite[fund]
zaruèuje, ¾e tento rozklad lze provést v oboru komplexních èísel. 
Pøitom si musíme být vìdomi, ¾e pro obecné polynomy stupnì pátého a
vy¹¹ího vzorce na pøesný výpoèet koøenù z koeficinetù 
neexistují\lcite[hledanikorenu],
tak¾e rozklad je mo¾né psát jen teoreticky.
 
Uvedli jsme si vìty~/\ncite[delia0], \ncite[delirac]/, které uvádìjí,
¾e v pøípadì celoèíselných koeficientù dìlí pøípadné celoèíselné 
koøeny koeficient $a_0$ resp. pøípadný racionální koøen má jistý
vztah ke koeficientùm $a_0$ a $a_n$. Ov¹em problém je v tom, ¾e polynom
s celoèíselnými koeficienty nemusí mít ¾ádný racionální koøen (co¾ je
navíc typická vlastnost). Pomù¾e nám to ke hledání koøenù jen
pro \uv{modelové pøíklady}.

Vìty~/\ncite[alphaspruhem], \ncite[nasobnostpruhu]/ øíkají, ¾e
polynomy s reálnými koeficienty mají své nereálné komplexní koøeny
v párech vzájemnì komplexnì sdru¾ené a stejné násobnosti.
To inspiruje k reálnému rozkladu polynomu na souèin: staèí snásobit
koøenové èinitele typu $(x-\alpha)(x-\overline\alpha)$, co¾ je
kvadratický polynom s reálnými koeficienty a se záporným
diskriminantem. 

Krátce jsme zmínili rozklad racionální lomené funkce na parciální
zlomky~/\ncite[parczl],\cite[parczl2]/ vèetnì reálné 
alternativy~/\ncite[parczlrell],\cite[parczlrel]/.

Definovali jsme pojem ireducibilní polynom\lcite[polireduc].



% LocalWords:  Polynomy polynomy




%% zarazeno nove od zari 2006

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\kapitola [grupy] Grupa, tìleso | Grupa, teleso
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\pozn [pteleso]
%%%%%
Následující text a¾ do konce kapitoly je ponìkud abstraknìj¹í povahy.
Pøitom se jeho znalost nepøedpokládá pro pochopení dal¹ích kapitol.
Pokud tedy ètenáø nechce být hned v~poèátku studia zahlcen
pojmy o algebraických strukturách, mù¾e tento text pøeskoèit.

\pozn
Reálná èísla jsou mno¾ina prvkù, které umíme vzájemnì sèítat a
vzájemnì násobit. Pøesnìji, je to mno¾ina $\R$, na které jsou definovány
obvyklé operace $+: \R\times\R\to\R$ a $\cdot:
\R\times\nobreak\R\to\nobreak\R$\penalty-500 \space s~jistými
vlastnostmi (asociativní zákon, distributivní zákon, atd.). 
Tìmito vlastnostmi se budeme inspirovat a pokusíme se
vybudovat abstraktní algebraickou strukturu, tzv. {\it tìleso}. Jedním
z mo¾ných konkrétních pøíkladù tìlesa pak samozøejmì budou reálná èísla.
Jenom¾e kromì nich budeme nacházet i jiné pøíklady tìles.
Zaèneme nejprve strukturou s~jedinou operací.

\okraj Grupa  | Grupa

\definice [dgrupa]
%%%%%%%%%
Mno¾inu $G$, na které je definována operace $\Circ: G\times G\to G$
nazýváme {\em grupou}, pokud pro tuto operaci platí:
$$\eqalign{
\bod (1) \forall x, y, z \in G: (x\Circ y)\Circ z = x\Circ (y\Circ z)
         \quad\hbox{ (asociativní zákon)}, \cr
\bod (2) \exists e\in G, \hbox{ pro které platí }\forall x\in G: e\Circ x = x\Circ e = x
         \quad\hbox{ (existence neutrálního/jednotkového prvku)}, \cr
\bod (3) \forall x\in G \ \exists y\in G: x\Circ y = y\Circ x = e
         \ \hbox{ (existence opaèného/inverzního prvku $y$ pro ka¾dý prvek $x$)}. \cr
\noalign{\medskip\hbox{\kern-5pt Pokud navíc platí}\medskip}
\bod (4)  \forall x, y \in G: x\Circ y = y\Circ x
         \quad\hbox{ (komutativní zákon)}, \cr}
$$
pak grupu $G$ nazýváme {\em komutativní grupou}. Z historických dùvodù
a z úcty k norskému matematikovi, který rozpracoval teorii grup a 
bohu¾el zemøel mlád na zákeønou nemoc ve vìku 26 let, 
se komutativní grupa nazývá té¾ {\em Abelova grupa}.
\inl[grupa, axiomy: grupy]
\inl[grupa: Abelova, Abelova grupa]
\inl[Abel: Niels Henrik]
\inl[grupa: komutativní, grupa: nekomutativní]
\inl[prvek: neutrální, prvek: jednotkový, prvek: inverzní, prvek: opaèný]
\inl[neutrální: prvek, jednotkový: prvek, inverzní: prvek, opaèný: prvek]
\inl[zákon: asociativní, zákon: komutativní, komutativní: zákon, asociativní: zákon]

\poznamka
%%%%%%%%%
Niels Abel mimo jiné pomocí teorie grup dokázal, ¾e nelze pro obecný polynom stupnì
vy¹¹ího ne¾~4 najít vzorec na výpoèet jeho koøenù z~jeho
koeficientù. Pro polynomy stupnì 1, 2, 3 a 4 pøitom takové vzorce
existují. Pro stupeò 2 se jej ¾áci uèí zpamìti: 
$x_{1,2}=(-b\pm\sqrt{b^2-4ac})/2a$.
\inl[Abel: Niels Henrik]
\inl[koøen: polynomu]

\priklad
%%%%%%%%
Jednoprvková mno¾ina $G=\{e\}$ s operací $e\Circ e=e$ je nejmen¹í
mo¾nou grupou.
\inl[grupa: jednoprvková]

\priklad
%%%%%%%%
Mno¾ina $\R$ s operací sèítání tvoøí grupu. Skuteènì platí
asociativní zákon pro sèítání reálných èísel: $(x+y)+z=x+(y+z)$,
dále existuje neutrální prvek 0, pro který $0+x=x+0=x$
a koneènì pro ka¾dé $x\in\R$ existuje $y= -x$ tak, ¾e $x + y = y + x = 0$.
Navíc se jedná o grupu komutativní, proto¾e sèítání reálných èísel je
komutativní. 
\inl[grupa: R]

Pokud operaci grupy znaèíme symbolem \uv{$+$} (jako v tomto pøíkladì),
pak obvykle o prvku $e$ z~vlastnosti~(2) mluvíme jako o neutrálním prvku 
a znaèíme ho symbolem \uv{0} (té¾ nula, nulový
prvek) a prvek $y$ z vlastnosti (3) nazývame {\em opaèný\/} a znaèíme
$-x$. Pøiètení opaèného prvku v komutativní grupì pak nazýváme {\em odeèítání\/}
a místo $a+(-b)$ pí¹eme $a-b$.
\inl[opaèný: prvek, prvek: opaèný, odeèítání]

\priklad
%%%%%%%%
Mno¾ina $\R\setminus\{0\}$ s operací násobení tvoøí grupu.
Skuteènì platí
asociativní zákon pro násobení reálných èísel: $(x\cdot y)\cdot
z=x\cdot (y\cdot z)$,
dále existuje jednotkový prvek 1, pro který $1\cdot x=x\cdot 1=x$
a koneènì pro ka¾dé $x\in\R\setminus\{0\}$ existuje 
$y= x^{-1}$ tak, ¾e $x\cdot y = y\cdot x = 1$.
Navíc se jedná o grupu komutativní, proto¾e násobení reálných èísel je
komutativní.
\inl[grupa: R]

Pokud operaci grupy znaèíme symbolem \uv{$\cdot$},
pak obvykle prvek $e$ z vlastnosti~(2) znaèíme symbolem~\uv{1} 
(jedna, jednotkový prvek). 
Prvek $y$ z vlastnosti (3) nazývame {\em inverzní\/} a znaèíme $x^{-1}$.
Násobení inverzním prvkem v komutativní grupì nazýváme {\em dìlení\/}
a místo $a\cdot b^{-1}$ pí¹eme $a/b$ nebo $a\over b$.
\inl[inverzní: prvek, prvek: inverzní]

\priklad
%%%%%%%%
Mno¾ina $\R$ s operací násobení netvoøí grupu, proto¾e 0 nemá inverzní
prvek.

\priklad
%%%%%%%%
Mno¾ina v¹ech reálných funkcí $F=\{f: \R\to\R,\,\hbox{$f$ je prostá a \uv{na}}\}$ 
s operací {\it skládání funkcí} $\circ:F\times F\to F$, definovanou pomocí 
$(g\circ f) (x)$ = $g\bigl(f(x)\bigr)$ $\forall x\in\R$, tvoøí
grupu. Skuteènì platí asociativní zákon $(f\circ g)\circ h = f\circ(g\circ h)$
a existuje jednotkový prvek: identické zobrazení $i$, pro které $i(x)=x$.
Ke ka¾dé prosté funkci $f$ lze setrojit funkci inverzní $f^{-1}$ tak, ¾e
$f\circ f^{-1} = f^{-1}\circ f = i$. Pøitom se nejedná o grupu
komutativní, proto¾e napøíklad pro $f(x)=x^3$, $g(x)=1+x$ je
$(f\circ g) (x) = (1+x)^3$, zatímco $(g\circ f) (x) = 1+x^3$.
\inl[grupa: funkcí, grupa: nekomutativní]

\priklad [gpermutaci]
%%%%%%%%
Kdybychom v pøedchozím pøíkladì místo funkcí $f$ z $\R$ na $\R$ uva¾ovali
prostá zobrazení $p$ z nìjaké mno¾iny $M$ na $M$, 
dostáváme znovu grupu, která nemusí být komutativní.
V pøípadì koneèné mno¾iny $M$ se jedná o grupu permutací.
\inl[grupa: permutací, grupa: nekomutativní, permutace]

\priklad
%%%%%%%%
Mno¾ina $M\subseteq\R^{n,n}$ v¹ech regulárních matic (viz\cite[dregul]) 
s~operací násobení matic tvoøí pøíklad nekomutativní grupy.
\inl[grupa: regulárních matic, grupa: nekomutativní]

\priklad [Gcyclic]
%%%%%%%%
Mno¾ina èísel $\{0,1,2,\ldots,k-1\}$ s operací $a\oplus b=a+b$ modulo $k$
tvoøí komutativní grupu. Pøipomínáme, ¾e \uv{$x$ modulo $y$} je zbytek pøi
dìlení èísla~$x$ èíslem~$y$. 
Neutrálním prvkem této grupy je 0 a opaèným prvkem 
k~prvku $a\not=0$ je prvek $k-a$. Samozøejmì, opaèným prvkem k prvku
neutrálnímu je prvek neutrální, co¾ ostatnì platí v~libovolné grupì.
\inl[grupa: komutativní]

\priklad
%%%%%%%%
Lineární prostor se svou operací sèítání vektorù (podle definice\cite[dlp])
tvoøí komutativní grupu. Skuteènì, asociativní zákon je postulován
vlastností (2) v~definici\cite[dlp], neutrálním prvkem je nulový
vektor (viz vlastnost (1) vìty\cite[nulprvek]) a opaèný vektor
k vektoru $\vec x$ je vektor $-\vec x = (-1)\cdot \vec x$, proto¾e
$$
(-1)\cdot\vec x + \vec x = (-1)\cdot\vec x + 1\cdot\vec x =
(-1+1) \cdot \vec x = 0\cdot \vec x = \vec o.
$$
Koneènì z vlastnosti (1) definice\cite[dlp] plyne, ¾e se jedná o grupu
komutativní.
\inl[grupa: komutativní]

\pozn [gdlp]
%%%%%
Obrácenì, pomocí pojmu grupa mù¾eme významnì zkrátit na¹í definici
lineárního prostoru\cite[dlp]:

{\em Lineárním prostorem} je mno¾ina $L$, která s operací $+:L\times L\to L$
tvoøí komutativní grupu. Dále musí být na mno¾inì $L$ definována
operace $\cdot:\R\times L\to L$, s vlastnostmi
$\forall \alpha, \beta\in\R, \forall \vec x, \vec y\in L$:
$$\eqalign{
\bod (A) \alpha\cdot(\beta\cdot\vec x) = (\alpha\beta)\cdot\vec x, \cr
\bod (B) \alpha\cdot(\vec x + \vec y) = \alpha\cdot\vec x + \alpha\cdot\vec y, \cr
\bod (C) (\alpha+\beta)\cdot\vec x = \alpha\cdot\vec x + \beta\cdot\vec x, \cr
\bod (D) 1\cdot \vec x = \vec x. \cr}
$$
\par\inl[prostor: lineární, lineární: prostor, axiomy: lineárního prostoru]

Vzhledem k tomu, ¾e vlastnosti (1), (2) definice\cite[dlp] pøímo
korespondují s vlastnostmi komutativní grupy, staèí ovìøit, ¾e nám z této nové
definice vyplyne vlastnost (7) definice\cite[dlp], která jediná zde
chybí. Existence nulového
vektoru je zaji¹tìna jako existence neutrálního prvku $\vec o$ v grupì.
Je potøeba ukázat, ¾e pro libovolný $\vec x\in L$ je 
vektor $0\cdot \vec x$ roven neutrálnímu prvku $\vec o$. 
K vektoru $0\cdot\vec x$ ov¹em existuje v grupì prvek opaèný
$-\,0\cdot\vec x$. Ten pøièteme k obìma stranám rovnice
$0\cdot\vec x=(0+0)\cdot\vec x = 0\cdot\vec x+0\cdot\vec x$. Na levé stranì
dostáváme $0\cdot\vec x + (-\,0\cdot\vec x) = \vec o$. Na pravé stranì
je $ 0\cdot\vec x+0\cdot\vec x + (-0\cdot\vec x) = 0\cdot\vec x + \vec o
= 0\cdot\vec x$. Porovnáním levé a pravé strany máme výsledek
$\vec o = 0\cdot\vec x$.
\inl[vektor: nulový, nulový: vektor]

\poznamka
%%%%%%%%%
Axiomy grupy v definici\cite[dgrupa] explicitnì 
neuvádìjí, ¾e v grupì existuje jen jediný neutrální prvek 
a ke ka¾dému prvku existuje jen jediný prvek opaèný. 
Následující vìta ukazuje, ¾e to nicménì platí jako jednoduchý dùsledek
axiomù.

\veta [jedinye]
%%%%%
{}(A) Ka¾dá grupa má jen jediný neutrální/jednotkový prvek. 
(B) Ke ka¾dému prvku grupy existuje jediný opaèný/inverzní prvek.
\inl[prvek: neutrální, neutrální: prvek, prvek: jednotkový, jednotkový: prvek]
\inl[prvek: opaèný, opaèný: prvek, prvek: inverzní, inverzní: prvek]

\dukaz
%%%%%%
(A) Pøedpokládáme dva neutrální prvky $e_1$, $e_2$. Musí platit
$e_1=e_1\Circ e_2$, proto¾e $e_2$ je neutrální. Musí také platit
$e_2=e_1\Circ e_2$, proto¾e $e_1$ je neutrální. Tak¾e $e_1=e_1\Circ
e_2=e_2$ a neutrální prvky se neli¹í.

(B) Nech» $x\in G$ má dva inverzní/opaèné prvky $y_1$ a $y_2$. Oznaème
$e$ neutrální prvek.
Pak platí: $y_1 = e\Circ y_1 = (y_2\Circ x)\Circ y_1 = y_2\Circ(x\Circ y_1) = 
y_2\Circ e = y_2$, tak¾e $y_1=y_2$.

\veta [gruparesirovnice]
%%%%%
Nech» na neprázdné mno¾inì $G$ je dána operace $\Circ:G\times G\to
G$, pro kterou platí asociativní zákon (1) z definice grupy\cite[dgrupa]. Pak
vlastnosti (2) a (3) z definice grupy jsou ekvivalentní s vlastností:
pro ka¾dé $a, b\in G$ existují $x, y\in G$, které øe¹í rovnice
$a\Circ x = b$ a $y\Circ a = b$.

\dukaz
Nech» nejprve platí vlastnosti (1), (2), (3) z definice grupy\cite[dgrupa].
Oznaème $a^{-1}$ inverzní prvek k~prv\-ku~$a$. Pak $x=a^{-1}\Circ b$
øe¹í rovnici $a\Circ x = b$, proto¾e $a\Circ(a^{-1}\Circ b) 
= (a\Circ a^{-1})\Circ b = e\Circ b = b$. Z~podobných dùvodù
$y=b\Circ a^{-1}$ øe¹í rovnici $y\Circ a = b$.

Nech» nyní platí asociativní zákon (1) a umíme øe¹it uvedené rovnice.
Volme $a\in G$. Oznaème $e_a$ øe¹ení rovnice $a\Circ x = a$, tj. platí
$a\Circ e_a=a$. Uká¾eme nejprve, ¾e pro libovolné $b\in G$ je 
$b\Circ e_a=b$. Nech» $y\in G$ øe¹í rovnici $y\Circ a=b$. Pak platí
$b\Circ e_a=(y\Circ a)\Circ e_a=y\Circ(a\Circ e_a)=y\Circ a=b$. Vidíme
tedy, ¾e øe¹ení $e_a$ rovnice $a\Circ x = a$ nezávisí na volbì 
prvku $a$, tak¾e staèí
prvek $e_a$ oznaèovat $e$. Podobnì lze ukázat, ¾e také øe¹ení rovnice
$y\Circ a=a$ nezávisí na volbì prvku $a$. Oznaème toto øe¹ení $f$.
Nyní podobnì jako v~dùkazu vìty\cite[jedinye] je $f\Circ e=f$,
proto¾e $e$ øe¹í $a\Circ e=a$ a platí $f\Circ e=e$, proto¾e $f$ øe¹í
$f\Circ a=a$. Tak¾e $e=f$ a toto je jednotkový prvek grupy.

Sestrojíme inverzní prvek k prvku $x\in G$. Nech» $u$ øe¹í rovnici 
$x\Circ u=e$ a $v$ øe¹í rovnici $v\Circ x=e$. Platí
$v=v\Circ e=v\Circ(x\Circ u)=(v\Circ x)\Circ u=e\Circ u=u$, tak¾e
$u=v$ je inverzní prvek k prvku $x$.

%a $e_b$ øe¹ení rovnice
%$y\Circ b = b$. Uká¾i nejprve, ¾e $e_a=e_b$.
%Oznaèím $u$ øe¹ení rovnice $u\Circ a=e_b$ a $v$ øe¹ení rovnice
%$b\Circ v=e_a$.
%Rovnost $a\Circ e_a = a$  vynásobím $u$ zleva a rovnost
%$e_b\Circ b = b$ vynásobím 
%$v$ zprava: $u\Circ a\Circ e_a = u\Circ a$, $e_b\Circ b \Circ v =
%b\Circ v$. Proto¾e $u$ øe¹í rovnici $u\Circ a=e_b$ a $v$ øe¹í rovnici $b\Circ
%v=e_a$, dostávám: $e_b\Circ e_a = e_b$ a $e_b\Circ e_a =
%e_a$. Tak¾e $e_b = e_b\Circ e_a = e_a$. Z~pøípadu $a=b$ vyplývá, ¾e
%øe¹ení rovnice $a\Circ x = a$ je stejné jako øe¹ení rovnice $x\Circ a = a$, tak¾e v
%tomto pøípadì nezále¾í na poøadí násobení. Pøi $a\not=b$ dostáváme, ¾e
%øe¹ení rovnic $a\Circ x = a$, $x\Circ a = a$ nezávisí na volbì prvku
%$a$. Toto øe¹ení je neutrální prvek $e$. Nyní sestrojím inverzní
%prvek k prvku $x$. Nech» $u$ øe¹í rovnici $x\Circ u=e$ a $v$ øe¹í
%rovnici $v\Circ x=e$. Vynásobením první rovnice prvkem $v$ zleva
%a druhé prvkem $u$ zprava dostáváme $v\Circ x\Circ u=v$, $v\Circ
%x\Circ u=u$. Tak¾e $u=v$ a toto je hledaný inverzní prvek k prvku $x$.

\okraj Pologrupa, grupoid | Pologrupa, grupoid

\pozn
%%%%%
Vzhledem k pøedchozí vìtì se v nìkteré literatuøe definuje grupa jen
pomocí asociativního zákona a øe¹itelnosti rovnic (jen dvì
vlastnosti). Pokud platí jen asociativní zákon a øe¹itelnost rovnic
není po¾adována, mluví se o {\em pologrupì}. 
Pokud je pouze dána operace $\Circ:G\times G\to G$ bez dal¹ích
vlastností, mluví se v nìkteré literatuøe o {\em grupoidu}.
Tak¾e mno¾ina s operací je grupoid. Grupoid s~asociativním zákonem je
pologrupa. Pologrupa s øe¹itelností rovnic je grupa. 
\inl[pologrupa, grupoid, grupa]

\okraj Podgrupa | Podgrupa

\definice
%%%%%%%%%
Nech» $G$ je grupa s operací $\Circ$. Pokud $G_1\subset G$ je sama o sobì 
grupou se stejnou operací (tj. speciálnì $\Circ:G_1\times G_1\to G_1$
a platí vlastnosti (1)--(3) definice grupy\cite[dgrupa]), nazýváme $G_1$ 
{\em podgrupou} grupy~$G$.
\inl[podgrupa]

\pozn [podstruktura]
%%%%%
Vý¹e uvedenou definici uvádím hlavnì proto, aby mìl ètenáø mo¾nost ji porovnat 
s~definicí podprostoru\cite[dlpp] a shledal, ¾e základní my¹lenka definice
podstruktury je poøád stejná. V~pøípadì ovìøování podgrupy je kontrola
asociativního zákona (1) zbyteèná (je zaruèen u¾ ve vnìj¹í grupì), ale
vlastnosti $x\Circ y\in G_1$, $e\in G_1$ a existence inverzního prvku
v $G_1$ jsou podstatné.

\priklad
%%%%%%%%
Mno¾ina $\bf Z$ celých èísel s operací sèítání \uv{$+$} je podgrupou grupy $\R$
reálných èísel se stejnou operací.

\priklad
%%%%%%%%
Mno¾ina ${\bf Z}\setminus\{0\}$ celých nenulových èísel s operací násobení 
\uv{$\cdot$} není podgrupou grupy $\R\setminus\{0\}$
reálných èísel se stejnou operací, proto¾e k èíslùm rùzným od $-1$ a
$1$ neexistuje na mno¾inì ${\bf Z}\setminus\{0\}$ inverzní prvek.
Na druhé stranì se jedná o pologrupu, proto¾e násobení je uzavøeno na
nenulová celá èísla a je samozøejmì asociativní.

\okraj Tìleso | Teleso

\definice [dteleso]
%%%%%%%%%
{\em Tìleso\/} je mno¾ina $T$ se dvìma operacemi obvykle oznaèovanými
$+:T\times T\to T$ a $\cdot:T\times T\to T$, které mají následující vlastnosti:

(1) $T$ s operací \uv{$+$} je komutativní grupa. Neutrální prvek této grupy
je oznaèen symbolem $0$.

(2) $T\setminus\{0\}$ s operací \uv{$\cdot$} je komutativní
grupa. Jednotkový prvek této grupy se znaèí symbolem $1$.

(3) Operace \uv{$+$} a \uv{$\cdot$} splòují distributivní zákon:
$a\cdot(b+c) = a\cdot b + a\cdot c$.
\inl[tìleso, axiomy: tìlesa, zákon: distributivní, distributivní: zákon]

\poznamka
%%%%%%%%%
Nìkteøí autoøi v definici tìlesa nepo¾adují komutativitu grupy
vzhledem k násobení a pokud je splnìna, mluví o {\em komutativním
tìlese}. Existují pøíklady, kdy komutativita násobení není splnìna
Dùle¾itým pøíkladem jsou {\em kvaterniony\/}: 
èísla podobná komplexním, ale se tøemi nezávislými
imaginárními jednotkami. Kvaterniony se u¾ívají
napøíklad pøi popisu 3D~transformací v poèítaèové 
grafice\bcite[zara]. V~na¹em textu budeme u tìles v¾dy pøedpokládat
komutativitu obou operací.
\inl[tìleso: komutativní, komutativní: tìleso]
\inl[tìleso: nekomutativní, nekomutativní: tìleso]
\inl[kvaterniony]

\priklad
%%%%%%%%
Reálná èísla s operacemi sèítání a násobení tvoøí tìleso.
\inl[tìleso: R]

\priklad
%%%%%%%%
Racionální èísla jsou podtìlesem tìlesa reálných èísel. Podtìleso je
definováno v~souladu s~poznámkou\cite[podstruktura] jako podmno¾ina
tìlesa, která sama o sobì se stejnými operacemi tvoøí tìleso.
\inl[podtìleso]

\priklad
%%%%%%%%
Mno¾ina celých èísel s operacemi sèítání a násobení netvoøí tìleso,
proto¾e pro operaci násobení neexistuje pro v¹echna nenulová celá
èísla inverzní prvek jako celé èíslo.
Toto je pøíklad struktury, která má v¹echny vlastnosti tìlesa s výjimkou jediné:
není zaruèena existence inverzního prvku pro~násobení. Taková
struktura se nazývá {\em okruh}. 
\inl[okruh]

\priklad
%%%%%%%%
Mno¾ina komplexních èísel s operacemi sèítání a násobení tvoøí tìleso.
\inl[tìleso: C]

\veta [vteleso]
%%%%%
Pro libovolné prvky $a, b$ z tìlesa platí: 
$a\cdot b = 0$ právì tehdy, kdy¾ $a=0$ nebo $b=0$.

\dukaz
($\Rightarrow$):
$T\setminus\{0\}$ musí být podle vlastnosti (2) definice\cite[dteleso]
vzhledem k násobení grupa, tj. souèin
dvou nenulových prvkù musí být prvek nenulový. Jinými slovy, pokud
souèin vychází nulový, musí aspoò jeden z èinitelù být nula.

($\Leftarrow$): Je tøeba dokázat, ¾e $0\cdot a = 0$.
Proto¾e 0 je neutrální prvek vzhledem ke sèítání, platí $0+0=0$. 
Díky distributivnímu zákonu je 
$0\cdot a = (0+0)\cdot a = 0\cdot a + 0\cdot a$. K obìma stranám
rovnosti pøièteme opaèný prvek k prvku $0\cdot a$, tedy prvek $-\,0\cdot a$.
Na levé stranì dostáváme 0 a na pravé $0\cdot a$.

\okraj Galoisovo tìleso se dvìma prvky | Galoisovo teleso se dvema prvky

\priklad [pZ2]
%%%%%%%%
Tìleso musí podle definice obsahovat 0 a 1 a tyto dva prvky musejí být
rùzné. Tak¾e tìleso musí obsahovat aspoò dva prvky. Uká¾eme, ¾e
existuje tìleso, které obsahuje jen tyto dva prvky, tedy $T=\{0,1\}$.

\penalty-200

Operaci \uv{$+$} definujeme: $0+0=0, \ 0+1=1+0=1, \ 1+1=0$. Operaci
\uv{$\cdot$} definujeme jako obvyklé násobení:
$0\cdot0=0\cdot1=1\cdot0=0, \ 1\cdot1=1$. Mno¾ina $T=\{0,1\}$ s takto
zavedenými operacemi tvoøí tìleso.

Skuteènì, pro operaci \uv{$+$} platí asociativní zákon, 0 je neutrální
prvek, opaèný prvek k $0$ je $0$ a opaèný prvek k $1$ je $1$. Grupa
$T\setminus\{0\}$ vzhledem k násobení je jednoprvková a v¹echny
vlastnosti grupy zde platí zcela samozøejmì. Je rovnì¾ splnìn
distributivní zákon. 

Sèítání je v tomto tìlese toté¾ co odeèítání. Inverzní prvek k 1 je 1.

Tìlesa s koneènì mnoha prvky se z historických dùvodù nazývají {\em
Galoisova tìlesa}. 
V na¹em pøíkladì $T=\{0,1\}$ se tedy jedná o
Galoisovo tìleso se dvìma prvky.

Évariste Galois byl francouzský matematik, který bohu¾el zemøel
mlád  ve vìku 20 let na následky zranìní v souboji.
I jeho teorie dokazuje mimo jiné
nemo¾nost algebraického popisu koøenù polynomù stupnì vìt¹ího ne¾ 4. Tato teorie
je známìj¹í ne¾ Abelova, ov¹em byla zveøejnìna o pìt let pozdìji.
\inl[tìleso: Galoisovo, Galoisovo: tìleso, tìleso: koneèné, koneèné: tìleso]
\inl[tìleso: Z2, Z2, tìleso: GF2, GF2]
\inl[Galois Évariste]
\inl[Avel: Niels Henrik]

\poznamka
%%%%%%%%%
Je-li tøeba na dvouprvkové mno¾inì definovat operace sèítání a násobení
tak, abychom získali tìleso, není mo¾né to udìlat jinak, ne¾ 
v pøíkladu\cite[pZ2]. Pøedev¹ím 0 je neutrální prvek vzhledem ke
sèítání, tak¾e podle vlastnosti~(2) definice grupy\cite[dgrupa]
musí $0+0=0$, $0+1=1+0=1$. Dále mno¾ina $\{1\}$ musí být grupou
vzhledem k násobení, tak¾e musí $1\cdot1=1$. Dále musí platit
$0\cdot a=a\cdot 0=0$, jinak by nebyla splnìna vìta\cite[vteleso].
Zbývá otázka, zda mù¾eme definovat $1+1=1$. Nemù¾eme, proto¾e
pak by prvek~1 nemìl prvek opaèný.

\okraj {\tenrm GF($p$)}, ${\bf Z}_p$ | GF(p), Zp

\priklad [modulo]
%%%%%%%%
Na mno¾inì $\{0, 1, \ldots, p-1\}$ definujme operace \uv{$+$} a
\uv{$\cdot$} jako obvyklé sèítání a násobení, ov¹em na výsledek 
aplikujme proces \uv{modulo $p$}. Tak¾e napøíklad pro $p=5$
pracujeme s mno¾inou $\{0,1,2,3,4\}$ a platí
$4+3 = 2$, proto¾e zbytek po dìlení èísla 7 èíslem 5 je 2.
Nebo $4\cdot4 = 1$, proto¾e zbytek po dìlení èísla 16 èíslem 5 je 1.

Nech» nejprve $p$ není prvoèíslo, tj. je tvaru souèinu $p=m\,n$.
Pak $m\cdot n=0$ modulo $p$, a pøitom èísla $m$ a
$n$ jsou nenulová. Podle vìty\cite[vteleso] se nemù¾e jednat o tìleso,
proto¾e souèin nenulových èísel musí v~tìlese vyjít jako èíslo
nenulové.

Nech» $p$ je prvoèíslo. Uká¾eme, ¾e $M=\{0, 1, \ldots, p-1\}$
s~operacemi \uv{$+$, $\cdot$ modulo $p$} tvoøí tìleso. 
Pøedev¹ím $M$ se sèítáním modulo $p$ je komutativní grupa 
(viz pøíklad\cite[Gcyclic]). Operace násobení modulo~$p$ je
asociativní, komutativní a jednotkovým prvkem je èíslo~$1$.
Distributivní zákon plyne z~distributivního zákona bì¾ných operací 
\uv{$+$} a \uv{$\cdot$}.
Nejvíce práce dá nalezení inverzního prvku pro
$a\in M\setminus\{0\}$. Prvek $a$ nechme pevný a uva¾ujme 
v¹echna èísla \uv{$ak$ modulo $p$} pro $k\in\{1, 2, \ldots, p-1\}$. 
Tato èísla jsou pro rùzná~$k$ vzájemnì rùzná (viz ní¾e) a pokrývají 
tedy celou mno¾inu 
$\{1, 2, \ldots, p-1\}$. Musí tedy existovat takové~$k$, 
¾e $ak=1$~mod~$p$. Toto~$k$ je inverzním prvkem k~prvku $a$. 
V~úvaze je¹tì chybí obhájit, ¾e èísla \uv{$ak$~modulo~$p$} 
jsou pro rùzná~$k$ vzájemnì rùzná. 
Pøedpokládejme, ¾e existují èísla $k_1, k_2\in M\setminus\{0\}$,
$k_1\geq k_2$ taková, ¾e $ak_1=ak_2$~mod~$p$, tj. $a(k_1-k_2)=mp$ 
pro nìjaké $m\geq0$. Rovnost vydìlíme èíslem $a$.
Proto¾e $a<p$ a $p$ je prvoèíslo, existuje $m_1\geq0$, ¾e
po vydìlení èíslem~$a$ dostáváme $k_1-k_2=m_1p$. 
Vlevo je èíslo men¹í ne¾ $p$,
tak¾e musí být $m_1=0$, tj. $k_1=k_2$.

Podle poètu prvkù $p$ se toto tìleso
oznaèuje GF($p$). Jiné znaèení ${\bf Z}_p$ dává najevo, ¾e se jedná o
celá èísla \uv{modulo $p$}.
%
Pøedchozí pøíklad\cite[pZ2] definuje koneèné tìleso ${\bf Z}_p$ pro $p=2$.
\inl[tìleso: Z9p, Z9p, tìleso: GFp, GFp]

\definice
%%%%%%%%%
{\em Charakteristika tìlesa\/} udává nejmen¹í kladný poèet jednièek, 
jejich¾ souèet dává nulu. Tedy pokud je 
$\sum_1^\lambda 1=0$ a $\lambda$ je nejmen¹í kladné èíslo s
touto vlastností, pak tìleso má charakteristiku $\lambda$.
Pokud tato vlastnost není splnìna pro ¾ádný
poèet jednièek, je charakteristika rovna~$\infty$.
\inl[charakteristika tìlesa]

\priklad
%%%%%%%%
Charakteristika tìlesa reálných èísel je $\infty$. Charakteristika
tìlesa $\Z_p$ je $p$.

\veta [vcharakter]
%%%%%
Charakteristika tìlesa je nekoneèná nebo to je prvoèíslo.
\inl[charakteristika tìlesa]

\dukaz
%%%%%%
Sporem. Nech» pro charakteristiku $\lambda$ platí $\lambda=mn$, $m\not=\lambda$,
$n\not=\lambda$. Z~distributivního zákona plyne
$\left(\sum_1^m 1\right)\cdot\left(\sum_1^n 1\right) = 
 \sum_1^{mn} 1 = \sum_1^\lambda 1=0$.
Podle vìty\cite[vteleso] musí být aspoò jedna suma v závorce rovna
nule, proto¾e jejich souèin je nulový.
To je spor s~tím, ¾e $\lambda$ je nejmen¹í poèet jednièek,
jejich¾ souèet je nulový.

\pozn
%%%%%
Kromì GF($p$), kde $p$ je prvoèíslo, existují koneèná tìlesa s poètem
prvkù $p^m$, kde $p$ je prvoèíslo, $m$ je libovolná mocnina, znaèení:
GF($p^m$). Jak jsme ukázali v pøíkladì\cite[modulo], konstrukce operací pro
GF($p^m$) nemù¾e vycházet jen z my¹lenky \uv{modulo $p$}. Ve
skuteènosti je konstrukce tìlesa GF($p^m$) výraznì komplikovanìj¹í.
V následujícím pøíkladì je pro ilustraci popsáno tìleso GF($2^3$).

Z vìty\cite[vcharakter] plyne, ¾e i tìlesa  GF($p^m$)
musejí mít charakteristiku ve tvaru prvoèísla. Kdybychom zde mìli
prostor na podrobnìj¹í popis tìles GF($p^m$), shledali bychom, ¾e mají
charakteristiku~$p$.

Dá se dále ukázat, ¾e pokud má mít tìleso koneèný poèet prvkù, pak
tento poèet nemù¾e být jiný ne¾ $p^m$, kde $p$ je prvoèíslo a $m$
pøirozené èíslo. Navíc operace na koneèném tìlese lze definovat 
jediným mo¾ným zpùsobem (li¹it se mù¾e jen zpùsob oznaèení prvkù).
\inl[tìleso: GFpm, GFpm]

\priklad [teleso6]
%%%%%%%%
Uva¾ujme mno¾inu v¹ech uspoøádaných trojic prvkù ze $\Z_2$ indexovaných èísly. 
Nulová trojice nemá ¾ádný index a ostatní trojice mají pøiøazeny
indexy 0 a¾ 6:
$$
\{(0,0,0)_\ast,\ (1,0,0)_0,\ (0,1,0)_1,\ (0,0,1)_2,\ (1,1,0)_3,\ 
(0,1,1)_4,\ (1,1,1)_5,\ (1,0,1)_6\}.
$$
Prvky této mno¾iny budeme sèítat tak, ¾e si indexù
nebudeme v¹ímat a budeme sèítat jen uspoøádané trojice v aritmetice
$\Z_2$. Napøíklad $(1,1,0)_3+(0,1,1)_4=(1,0,1)_6$, proto¾e 
je $(1,1,0)+(0,1,1)=(1,0,1)$ v aritmetice $\Z_2$.

Výsledek násobení kteréhokoli prvku s prvkem $(0,0,0)_\ast$ definujeme
jako $(0,0,0)_\ast$. Jedná se o~nulový prvek tìlesa. Násobení
nenulových prvkù definujeme tak, ¾e si nev¹ímáme uspoøádaných trojic,
ale jen indexù. Ty seèteme a provedeme operaci 
modulo 7. 
Napøíklad $(0,1,1)_4 \cdot(1,1,1)_5=(0,0,1)_2$, 
proto¾e $4+5$\hbox{ modulo 7 = 2}.
%
Dá se ukázat, ¾e tento pøíklad splòuje axiomy tìlesa. Obsahuje $2^3$
prvkù, tak¾e se jedná o pøíklad tìlesa GF($2^3$). 

Jak ji¾ bylo øeèeno, je $(0,0,0)_\ast$ nulový prvek. Rovnì¾ je zøejmé,
¾e $(1,0,0)_0$ je jednotkový prvek tohoto tìlesa. Inverzní prvek
napøíklad k~$(0,0,1)_2$ je $(1,1,1)_5$, proto¾e 
$2+5$\hbox{ modulo 7 = 0}. Opaèný prvek k libovolnému prvku $x$ je
prvek $x$, proto¾e v aritmetice $\Z_2$ je $1+1=0$.
Charakteristika tohoto tìlesa je~2.

Prosím ètenáøe, aby se nesna¾il hrubou silou ovìøit platnost
distributivního zákona tohoto tìlesa (jde to, ale není to pøíli¹
úèelné) ani pøíli¹ nehloubal nad tím, proè
napøíklad trojice $(1,1,1)$ má index~5.
Pro odpovìdi na tyto otázky je potøeba pou¾ít vlastnosti
ireducibilních polynomù nad tìlesem $\Z_2$ (obecnì nad tìlesem 
$\Z_p$), co¾ bohu¾el pøekraèuje rámec tohoto úvodního textu.


\okraj Lineární prostor nad tìlesem | Linearni prostor nad telesem

\pozn
%%%%%
V definici lineárního prostoru\cite[dlp] jsme sice byli dostateènì
abstraktní (vektory, ani operace s nimi jsme blí¾e nespecifikovali),
ale pracovali jsme tam s docela konkrétní mno¾inou $\R$ reálných
èísel. Pokud v této definici nahradíme mno¾inu $\R$ pojmem tìleso (s
blí¾e nespecifikovanými prvky a operacemi), dostáváme lineární prostor
nad tìlesem. Mù¾eme pak pracovat s lineárním prostorem nad tìlesem
komplexních èísel, lineárním prostorem nad tìlesem ${\bf Z}_2$ atd.

Pokusíme se tedy do tøetice pøepsat definici lineárního prostoru,
tentokrát nad libovolným tìlesem.

\definice [dlpT]
%%%%%%%%%
Mno¾inu $L$ nazýváme {\em lineárním prostorem nad tìlesem $T$}, pokud
jsou definovány operace $+:L\times L\to L$ a $\cdot:T\times L\to L$
tak, ¾e $L$ tvoøí s operací $+$ komutativní grupu, a dále
$\forall \alpha, \beta\in T, \forall \vec x, \vec y\in L$:
$$\eqalign{
\bod (A) \alpha\cdot(\beta\cdot\vec x) = (\alpha\cdot\beta)\cdot\vec x, \cr
\bod (B) \alpha\cdot(\vec x + \vec y) = \alpha\cdot\vec x + \alpha\cdot\vec y, \cr
\bod (C) (\alpha+\beta)\cdot\vec x = \alpha\cdot\vec x + \beta\cdot\vec x, \cr
\bod (D) 1\cdot \vec x = \vec x. \cr}
$$
\par\inl[lineární: prostor, prostor: lineární, axiomy: lineárního prostoru]
\inl[lineární: prostor: nad tìlesem]

\pozn
%%%%%
Volíme-li za tìleso $T$ v této definici mno¾inu reálných èísel $\R$,
dostáváme vzhledem k~poznámce\cite[gdlp] definici 
lineárního prostoru\cite[dlp]. Abych uklidnil
ètenáøe, tak konstatuji, ¾e v dal¹ích kapitolách
tohoto textu nebudeme potøebovat lineární prostor v takové obecnosti
(nad libovolným tìlesem) a vystaèíme si vìt¹inou s~lineárním prostorem
nad reálnými èísly. Pokud tedy nebude výslovnì øeèeno jinak (napøíklad
lineární prostor nad $\Z_2$ studovaný v kapitole\kcite\ktere[kodovani]), pak
pojmem {\em lineární prostor\/} myslíme lineární prostor nad $\R$
a staèí pou¾ít definici\cite[dlp].

\priklad [LPTn]
%%%%%%%%
Vrátíme se k pøíkladu lineárního prostoru reálných uspoøádaných
$n$-tic\cite[LPRn] a zobecníme ho na lineární prostor
uspoøádaných $n$-tic prvkù libovolného tìlesa.

Nech» $T$ je tìleso.
Uva¾ujme mno¾inu uspoøádaných $n$-tic prvkù z tìlesa $T$ (oznaème ji
$T^n$) a definujme na ni operace 
$+: T^n\times T^n \to T^n$, $\cdot: T\times T^n \to
T^n$ takto: pro ka¾dé $(a_1,\ldots,a_n)\in T^n$,
$(b_1,\ldots,b_n)\in T^n$, $\alpha\in T$ je
\vskip-12pt
$$\eqalign{
(a_1,\ldots,a_n) + (b_1,\ldots,b_n) &\df= (a_1+b_1,\ldots,a_n+b_n),\cr
\alpha\cdot (a_1,\ldots,a_n) &\df= (\alpha\cdot a_1,\ldots,\alpha\cdot a_n).\cr}
$$
Snadno se dá ovìøit, ¾e
mno¾ina $T^n$ s~takto definovanými operacemi tvoøí lineární prostor
nad tìlesem~$T$.

\pozn
%%%%%
Volíme-li za tìleso $T = {\bf Z}_2$, je $T^n$ podle pøedchozího pøíkladu
diskrétní lineární prostor, který je pou¾íván v teorii
kódování. Jednotlivé vektory (tzv.~binární slova) jsou uspoøádané 
$n$-tice jednièek a nul. Tento lineární prostor má celkem 
$2^n$ rùzných vektorù.

\pozn
%%%%%
V pøípadì lineárního prostoru nad koneèným tìlesem dostáváme koneèný
lineární prostor. V tomto pøípadì tedy neplatí tvrzení
poznámky\cite[dvoubodovy]. Mù¾ete si v¹imnout, ¾e toto tvrzení se
opíralo o skuteènost, ¾e \uv{reálných èísel je nekoneènì mnoho}.
Poznámka\cite[dvoubodovy] zùstává v platnosti pro lineární prostory nad
nekoneènými tìlesy.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\kapitola [kodovani]
          Lineární algebra v teorii kódování | 
          Linearni algebra v teorii kodovani
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\pozn
%%%%%
Teorie kódování øe¹í otázku, jak pøevést danou informaci do slov,
která pou¾ívají znaky nìjaké abecedy (obvykle abecedy jednièek a nul)
pokud mo¾no efektivnì, tj. bez zbyteèného zatì¾ování pøenosových linek
a pamì»ových médií nadbyteènými informacemi. Typickým pøíkladem
kódování je ASCII kód, který písmenùm anglické abecedy a bì¾ným znakùm
pøiøazuje sedmibitová slova.  Navíc se pøi kódování èasto øe¹í otázka,
jakým zpùsobem efektivnì pøidat k zakódované informaci dodateèné bity
tak, aby byla informace odolná vùèi ¹umu na pøenosové lince nebo men¹ím chybám
na pamì»ovém médiu. Dekodér, tj. zaøízení, které má za úkol
restaurovat pùvodní informaci, mù¾e být postaven za nekvalitní linkou
a mù¾e tedy dostat informaci zkreslenou. Z vhodnì navr¾ených
dodateèných bitù mù¾e dekodér zjistit, zda informace pøi
prùchodu linkou byla po¹kozena a v lep¹ím pøípadì doká¾e chybu také
opravit.

Pøi návrhu vhodného kódování s mo¾ností detekce a opravy chyb se u¾ od
padesátých let minulého století pou¾ívala lineární algebra. Tuto
kapitolu zavr¹íme pøíkladem konstrukce tzv. lineárních Hammingových kódù. 
To samozøejmì zdaleka nepokrývá ve¹kerou problematiku teorie kódování,
zájemce o dal¹í studium této problematiky mù¾e pou¾ít tøeba\bcite[adamek].

Nìkteøí laici mo¾ná nerozli¹ují slovo kódování od slova
¹ifrování. ©ifrování je pøevod informace do takového stavu, aby ji
bylo mo¾né zpìtnì zrestaurovat jen povìøenými osobami. Tuto
problematiku, aèkoli matematicky rovnì¾ velmi zajímavou a ze
strategického hlediska velmi dùle¾itou, zde 
øe¹it nebudeme.
\inl[kódování, ¹ifrování]

\okraj Tìleso $\Z_2$ | Teleso Z2

\pozn
%%%%%
Definice lineárního prostoru\cite[dlp] pøedpokládá, ¾e skaláry (èísla,
kterými násobíme vektory) jsou reálná èísla. V této kapitole
budeme pracovat s modifikovanou definicí lineárního prostoru, kde
reálná èísla nahradíme tìlesem $\Z_2$. 
\inl[skalár, tìleso]

Poznamenávám, ¾e pojem tìlesa jsem pøesnì zavedl v textu
za poznámkou\cite[pteleso]. Pokud ètenáø tuto èást textu pøeskoèil,
mù¾e si pod pojmem tìleso zhruba pøedstavit mno¾inu s operacemi
sèítání a násobení. Tyto operace mají podobné vlastnosti, jako sèítání a
násobení reálných èísel (komutativita, asociativita, distributivita, atd.).

\definice [dZ2]
%%%%%%%%%
{\em Tìleso $\Z_2$} je dvoubodová mno¾ina $\{0, 1\}$, na které je
definováno sèítání $+:\Z_2\times\Z_2\to\Z_2$ a násobení 
$\cdot:\Z_2\times\Z_2\to\Z_2$ takto:
$$
  \def\|{\kern6pt\strut\vrule&\kern-3pt}
  \matrix { \phantom0\llap{+}  \| 0 & 1 \cr \noalign{\hrule}
             0 \| 0 & 1 \cr
             1 \| 1 & 0 \cr} \qquad \qquad
  \matrix { \phantom0\llap{$\cdot$}  \| 0 & 1 \cr \noalign{\hrule}
             0 \| 0 & 0 \cr
             1 \| 0 & 1 \cr}
$$
Tedy: \ $0+0=0$, \quad $0+1=1+0=1$, \quad $1+1=0$, \quad
$0\cdot0=0\cdot1=1\cdot0=0$, \quad $1\cdot1=1$.
\inl[tìleso: Z2, Z2, tìleso: koneèné, koneèné: tìleso]

\pozn
%%%%%
Sèítání na $\Z_2$ je shodné s logickou operací XOR (vyluèovací nebo) 
a násobení na $\Z_2$ je shodné s operací AND (logická konjunkce).

Nebo jinak: Násobení na $\Z_2$ je stejné, jako jsme zvyklí násobit
celá èísla, a sèítání skoro taky, a¾ na jedinou výjimku: $1+1=0$.

Nebo je¹tì jinak: Prvek 0 v $\Z_2$ si mù¾eme pøedstavit jako jakékoli sudé
èíslo a prvek 1 jako jakékoli èíslo liché. Sèítáme a násobíme pak sudá
èísla se sudými, s lichými atd. Tyto operace pak dávají jako výsledek
èísla sudá nebo lichá pøesnì podle pravidel poèítání v $\Z_2$.

Nebo je¹tì jinak: provedeme operaci sèítání a násobení jako v pøípadì
celých èísel, ale pokud výsledek padne mimo mno¾inu $\{0, 1\}$,
pou¾ijeme zbytek pøi dìlení výsledku èíslem 2.
\inl[souèet: v: Z2, násobení: v: Z2]

\priklad
%%%%%%%%
Na mno¾inì uspoøádaných $n$-tic prvkù ze $\Z_2$, tj. na mno¾inì
$\Z_2^n$, zavedeme operaci sèítání $+:\Z_2^n\times\Z_2^n\to\Z_2^n$ analogicky,
jako v pøípadì sèítání uspoøádaných $n$-tic reálných èísel, jen
samozøejmì pracujeme se sèítáním podle definice\cite[dZ2]. Pro
$(a_1,\ldots,a_n)\in \Z_2^n$ a
$(b_1,\ldots,b_n)\in \Z_2^n$ definujeme
$$
(a_1,\ldots,a_n) + (b_1,\ldots,b_n) \df= (a_1+b_1,\ldots,a_n+b_n).
$$
Napøíklad $(1,0,0,1,1) + (1,1,0,0,1) = (0,1,0,1,0)$.

Dále definujeme násobení tìchto uspoøádaných $n$-tic jednièkou a nulou
pøirozeným zpùsobem:
$$
1\cdot (a_1,\ldots,a_n) \df= (a_1,\ldots,a_n), \qquad
0\cdot (a_1,\ldots,a_n) \df= (0,\ldots,0).
$$
Pov¹imnìte si analogie s pøíklady\cite[LPRn] a\cite[LPTn].

Pokud nahradíme v definici lineárního prostoru\cite[dlp] mno¾inu
reálných èísel $\R$
nìjakým tìlesem, pak takovému lineárnímu prostoru øíkáme, ¾e je
definován \uv{nad
tìlesem} (podrobnìji viz definici\cite[dlpT]). V~tomto pøíkladì 
jsme zavedli na mno¾inì $\Z_2^n$ operace tak, ¾e dostáváme
{\em lineární prostor nad tìlesem~$\Z_2$}. 
\inl[prostor: Z2n]

Nulový vektor tohoto lineárního prostoru je vektor 
$(0,\ldots,0)$. Tento lineární prostor má celkem $2^n$ vektorù, které
mezi sebou umíme sèítat a samozøejmì tyto vektory umíme
násobit jednièkou nebo nulou.

\okraj Poèítání v~$\Z_2$ | Pocitani v Z2

\pozn
%%%%%
Na rozdíl od lineárních prostorù nad $\R$ ná¹ novì zavedený lineární
prostor nad $\Z_2$ má koneènì mnoho prvkù. To je jediný rozdíl
vzhledem k lineárním prostorùm, které jsme dosud studovali. V¹echny
ostatní vlastnosti zùstávají stejné.

\poznamka
%%%%%%%%%
Ka¾dý vektor z $\Z_2^n$ je sám sobì opaèným vektorem, tj.
$\forall \vec x\in\Z_2^n: \vec x = -\vec x$, neboli $\vec x+\vec x =
\vec o$. Díky tomu v tìlese $\Z_2$ a v lineárním prostoru nad tímto
tìlesem nemusíme rozli¹ovat mezi sèítáním a odèítáním. 

\priklad [Z2M]
%%%%%%%%
Najdeme dimenzi a bázi lineárního obalu ètyø vektorù v $\Z_2^5$:
$$
  M = \lob< (1,0,1,0,1), (1,1,0,0,1), (1,0,0,1,1), (0,1,1,0,0) >.
$$

{\bf Øe¹ení:}
Proto¾e Gaussova eliminace nemìní lineární obal, najdeme bázi
eliminací:
$$
  \matice {1&0&1&0&1\cr
           1&1&0&0&1\cr
           1&0&0&1&1\cr
           0&1&1&0&0} \sim
  \matice {1&0&1&0&1\cr
           0&1&1&0&0\cr
           0&0&1&1&0\cr
           0&1&1&0&0} \sim
  \matice {1&0&1&0&1\cr
           0&1&1&0&0\cr
           0&0&1&1&0\cr
           0&0&0&0&0}.
$$
Báze $M$ je tedy napøíklad $(1,0,1,0,1), (0,1,1,0,0), (0,0,1,1,0)$.
Dimenze $M$ je tøi.

\poznamka
%%%%%%%%%
Proto¾e $\Z_2^n$ obsahuje koneèný poèet vektorù, mù¾eme (na rozdíl od
lineárních prostorù nad $\R$) vypsat podprostor nebo lineární obal
výètem prvkù. Pro podprostor $M$ z pøedchozího pøíkladu platí:
$$
\eqalign{
  M &= \{ (0,0,0,0,0), (1,0,1,0,1), (0,1,1,0,0), (0,0,1,1,0),\cr 
    & \qquad      (1,1,0,0,1), (1,0,0,1,1), (0,1,0,1,0), (1,1,1,1,1) \}. \cr}
$$
Jak se dá takový výèet prvkù najít? Pøedev¹ím pro $\vec x \not=\vec o$
je $\lob<\vec x> = \{\vec o, \vec x\}$. Skuteènì, vektor $\vec x$
mù¾eme násobit jen jednièkou nebo nulou. To jsou v¹echny lineární
kombinace, které mù¾eme s~vektorem~$\vec x$ vytvoøit.
Mno¾ina $M$ má tøíprvkovou bázi $\{\vec a, \vec b, \vec c\}$. Tak¾e
pro sestavení lineárního obalu staèí najít v¹echny lineární kombinace
tìchto tøí vektorù:
$\vec o, \ \vec a, \ \vec b, \ \vec c, \ \vec a+\vec b, \ \vec a+\vec c, 
\ \vec b+\vec c, \ \vec a+\vec b+\vec c$. 

\priklad
%%%%%%%%
Zjistìte poèet prvkù lineárního 
(pod)prostoru nad $\Z_2$, který má dimenzi~$n$.

{\bf Øe¹ení:}
Má-li (pod)prostor dimenzi $n$, pak má $n$ prvkovou bázi $\vecc b_n$. 
Abychom získali v¹echny lineární kombinace tìchto vektorù, 
musíme ka¾dý vektor násobit jednièkou nebo nulou. Máme tedy $2^n$
lineárních kombinací. Tyto kombinace vyplòují celý lineární (pod)prostor a
jsou navzájem rùzné. Kdyby se toti¾ dvì 
lineární kombinace s~rùznými koeficienty
rovnaly, pak jejich odeètením dostáváme netriviální lineární kombinaci
rovnu nulovému vektoru. To je spor se skuteèností, ¾e $\vecc b_n$
je báze. 

Závìr: poèet prvkù lineárního (pod)prostoru nad $\Z_2$ dimenze $n$ je
$2^n$. Napøíklad podprostor $M$ z~pøíkladu\cite[Z2M] má dimenzi~3
a má tedy $2^3=8$ prvkù.  

\priklad
%%%%%%%%
Najdìte v¹echna øe¹ení $\vec x\in \Z_2^6$ homogenní soustavy rovnic 
$\A\,\vec x = \vec o$, je-li
$$
 \A = \pmatrix { 1&1&0&1&0&1\cr 1&0&1&1&0&0\cr 0&1&0&0&1&1\cr 
                 1&0&0&1&1&0\cr 1&1&1&0&0&1}.
$$

{\bf Øe¹ení:} Najdeme matici ekvivalentní soustavy s lineárnì
nezávislými øádky:
$$
\pmatrix { 1&1&0&1&0&1\cr 1&0&1&1&0&0\cr 0&1&0&0&1&1\cr 
                 1&0&0&1&1&0\cr 1&1&1&0&0&1} \sim
\pmatrix { 1&1&0&1&0&1\cr 0&1&1&0&0&1\cr 0&1&0&0&1&1\cr 
                 0&1&0&0&1&1\cr 0&0&1&1&0&0} \sim
\pmatrix { 1&1&0&1&0&1\cr 0&1&1&0&0&1\cr 0&0&1&0&1&0\cr 
                 0&0&0&1&1&0}.
$$
Hodnost matice soustavy je 4, dimenze prostoru je 6, tak¾e dimenze
mno¾iny øe¹ení je 2. Hledáme tedy dvì lineárnì nezávislá øe¹ení:
$(?,?,?,?,1,0)$ a $(?,?,?,?,0,1)$. Dosazením \uv{zespoda nahoru}
dostáváme následující øe¹ení: $(0,1,1,1,1,0)$, $(0,1,0,0,0,1)$.

Mno¾ina v¹ech øe¹ení je lineárním obalem tìchto dvou øe¹ení a obsahuje
$2^2=4$ vektory:
$$
  \lob<(0,1,1,1,1,0), (0,1,0,0,0,1)> =
  \{(0,0,0,0,0,0), (0,1,1,1,1,0), (0,1,0,0,0,1), (0,0,1,1,1,1)\}.
$$

\poznamka
%%%%%%%%%
Pøi hledání báze prostoru øe¹ení mù¾eme také vyu¾ít
vìtu\cite[genbasehomo]. V pøedchozím pøíkladì bychom pak pokraèovali 
v eliminaci zpìtným chodem:
$$
\pmatrix { 1&1&0&1&0&1\cr 0&1&1&0&0&1\cr 0&0&1&0&1&0\cr 
                 0&0&0&1&1&0} \sim
\pmatrix { 1&0&0&0&0&0\cr 0&1&0&0&1&1\cr 0&0&1&0&1&0\cr 
                 0&0&0&1&1&0}.
$$
Tvar matice $(\E|\C)$ odpovídá pøedpokladu vìty\cite[genbasehomo], tak¾e øádky
báze øe¹ení tvoøí matici:
$$
\pmatrix {0&1&1&1&1&0 \cr 0&1&0&0&0&1}.
$$
Poznamenejme, ¾e nemusíme pøecházet od matice $\C$ 
k~matici $-\C$, proto¾e v aritmetice $\Z_2$ jsou obì matice stejné.

\okraj Kód, kódové slovo | Kod, kodove slovo

\definice [dkod]
%%%%%%%%%
Nech» $A$ je koneèná mno¾ina (tzv. {\em abeceda}). Pak {\it slovo} je
libovolná koneèná posloupnost prvkù z $A$.

{\it Kódování\/} v obecném smyslu zahrnuje
(1) algoritmus,
kterým informace pøevádíme do posloupnosti slov (tzv. {\em kodér\/}) a
(2) algoritmus, kterým 
zpìtnì z~tìchto slov získáváme pùvodní informaci ({\em dekodér\/}).

Slova, která vytváøí kodér, se nazývají {\em kódová slova}. 
Mno¾ina v¹ech kódových slov se nazývá {\em kód}.

Je-li kód mno¾inou slov stejné délky (ka¾dé kódové slovo má
stejný poèet znakù abecedy), mluvíme o~tzv. {\it blokovém kódu}.
Blokový kód {\em délky $n$} znaèí, ¾e v¹echna kódová slova mají $n$ znakù abecedy.
\inl[abeceda, slovo, kódování, kodér, dekodér, slovo: kódové, kódové: slovo]
\inl[kód, kód: blokový, blokový: kód]

\poznamka
%%%%%%%%%
Typicky $A=\{0,1\}$, tj. abeceda se skládá jen ze dvou znakù
(tzv. bitù, anglicky bits, co¾ je pùvodnì zkratka z BInary digiTS) a
slova jsou posloupnosti tìchto bitù. 
\inl[bit]

\priklad
%%%%%%%%
ASCII kód je mno¾ina 7bitových slov, která reprezentují jednotlivá
písmena anglické abecedy a dal¹í bì¾né znaky (èíslice,
teèku, vykøièník, otazník, mezeru, {\tt\#} neboli vìzení atd.). Tato mno¾ina
obsahuje 91 slov, proto¾e v dobì vzniku tohoto kódu byl po¾adavek na
kódování 91 znakù. Kodér i dekodér pak pracují s tabulkou
tìchto znakù, u kterých jsou uvedena odpovídající kódová slova. Tato
tabulka mù¾e být na stranì kodéru technicky realizována tøeba
ovladaèem klávesnice a na stranì dekodéru fontem.

Jedná se o blokový kód. Od poèátku existence poèítaèù byl tento
blokový kód roz¹íøen o redundantní nulový bit na zaèátku, tak¾e èasto
je ASCII kód prezentován jako mno¾ina 8bitových slov. Pozdìji zaèal
být tento bit vyu¾íván pro rùzná roz¹íøení ASCII kódu, která zahrnují
i reprezentaci nìkterých písmen s diakritickými znaménky.
\inl[kód: ASCII, ASCII: kód]

\poznamka
%%%%%%%%%
Je potøeba si uvìdomit, ¾e slova jsou do pamì»ového média nebo do
pøenosové linky vkládána za sebou bez oddìlovaèù. Blokový kód má tu výhodu,
¾e dekodér doká¾e snadno rozdìlit tento \uv{tok znakù abecedy} na slova a
tìm pak pøidìlit význam napøíklad pomocí nìjaké tabulky. Nevýhoda
blokového kódu spoèívá v tom, ¾e plýtvá místem, nebo» tu¹íme, ¾e pokud
navrhneme pro èastìji se vyskytující slova krat¹í posloupnosti znakù,
celkový poèet znakù abecedy pro pøená¹ené/ukládané informace mù¾e být
men¹í. To ostatnì je (alespoò zhruba) i vlastnost pøirozeného jazyka.
Tam máme ov¹em abecedu rozsáhlej¹í (nebinární) a za prvek abecedy
mù¾eme pova¾ovat i mezeru: oddìlovaè mezi slovy, který dekodéru pomù¾e.
Nebo v Morseovì abecedì máme také tøi znaky: teèka, èárka a mezera.
Bez mezery by bylo dekódování morseovky nemo¾né.
Máme-li k dispozici jen binární abecedu $A=\{0,1\}$, pak je potøeba
pøi návrhu kódu se slovy nestejné délky myslet na mo¾nosti dekodéru.
Je to technicky mo¾né, ale není to obsahem tohoto textu.
Pøíkladem neblokového kódu je UTF8, který kóduje znaky abeced v¹ech
jazykù svìta. Písmena anglické abecedy a bì¾né znaky jsou 
reprezentovány 8bitovým slovem, ale písmena dal¹ích 
jazykù jsou kódována 16bitovým slovem nebo i del¹ím 
(24 bitù a 32 bitù).
\inl[UTF8: kód, kód: UTF8]

Nadále budeme pracovat jen s blokovými kódy nad binární abecedou.

\okraj Kódování s~detekcí a opravou chyb | Kodovani s detekci a opravou chyb

\poznamka
%%%%%%%%%
Nech» $K$ je blokový kód délky~$n$ nad binární abecedou $A$.
Pak platí $K\subseteq A^n$.

Pokud $K\not=A^n$, pak mezi uspoøádanými $n$-ticemi z~$A$ existují
nekódová slova, tj. taková, která kodér nikdy nevytvoøí
a která nemají pøidìlen význam. Pøijme-li dekodér (napø. za nekvalitní
linkou) nekódové slovo, je si jist, ¾e pøi pøenosu linkou do¹lo 
k chybì. Mù¾e napøíklad v takovém pøípadì po¾ádat pomocí jiných
technických prostøedkù kodér, aby vyslal slovo znovu. 
Nebo se mù¾e pokusit chybu opravit.

Tu¹íme jisté problémy: ¹um na lince mù¾e zpùsobit tak ne¹»asnou chybu,
¾e se z jednoho kódového slova stane jiné kódové slovo a dekodér nic
nepozná. Je tedy rozumné kódování navrhnout tak, aby napøíklad omezený
poèet chyb v jednom slovì (tj. zámìn nuly za jednièku a naopak)
zaruèil, ¾e se z~kódového slova stane slovo nekódové. 

Znovu mù¾eme hledat analogii v pøirozeném jazyce. Pøeklep ve slovì
jsme velmi èasto schopni detekovat i opravit. Nìkdy ale pøeklep mù¾e
zpùsobit, ¾e vzniká jiné bì¾né slovo jazyka. Èlovìk jako dekodér 
ani s tímto druhem chyby nemá vìt¹inou problém, proto¾e pracuje 
s kontextem celé vìty (vìt¹í skupiny slov). Takto inteligentní dekodér
ale nebude na¹ím cílem. Vystaèíme si s detekováním a opravováním chyb
jen na úrovni jednotlivých slov.

\definice [hammingd]
%%%%%%%%%
Nech» $A=\{0,1\}$.
{\em Hammingova velikost slova $\vec u\in A^n$} je poèet
jednièek v tomto slovì a znaèíme ji $\|\vec u\|$. 
{\em Hammingova vzdálenost slov $\vec v\in A^n$ a $\vec w\in A^n$}
je poèet bitù, ve kterých se tato dvì slova li¹í. Znaèíme ji
$\d(\vec v,\vec w)$.
\inl[velikost: slova: Hammingova, Hammingova: velikost slova]
\inl[vzdálenost: Hammingova, Hammingova: vzdálenost slov]

\poznamka [hammingp]
%%%%%%%%%
Nech»  $A=\{0,1\}$ a $\vec v, \vec w\in A^n$.
Pak $\vec v+\vec w$ (v aritmetice $\Z_2$) je slovo,
které má jednièky právì v~místech, kde se $\vec v$ a
$\vec w$ li¹í. Tak¾e platí: $\d(\vec v,\vec w)= \|\vec v+\vec w\|$.

\poznamka
%%%%%%%%%
Pøedpokládejme, ¾e $\vec v$ je slovo vyslané kodérem a $\vec w$
slovo pøijaté dekodérem. Pak $\d(\vec v,\vec w)$ udává poèet chyb ve
slovì, které vznikly bìhem pøenosu.

Poznámka v poznámce: pøedpokládáme, ¾e díky technickým parametrùm
zaøízení nikdy nedojde k~chybì, kdy se jednièka nebo nula ze slova
zcela vytratí nebo vznikne nová, tj. nikdy nehrozí riziko, ¾e by na
stranì dekodéru byl pøeèten jiný poèet jednièek a nul ne¾ byl vyslán
kodérem.

\priklad [kod2]
%%%%%%%%
Je dán tento kód: 
$K=\{0000, 0011, 0101, 1001, 0110, 1010, 1100, 1111\}$. Jedná se
o~blokový binární kód délky 4. Pro potøeby
tohoto pøíkladu nebudeme specifikovat druh informace, kterou
potøebujeme pøená¹et. Proto¾e kód obsahuje jen 8 slov, mù¾e být
pùvodní informace zapsána pomocí nìjaké 8 znakové abecedy.

Zajímavé na tomto kódu je, ¾e ka¾dé kódové slovo obsahuje sudý poèet
jednièek. Pokud dojde k~jediné chybì ve slovu, máme jistotu, ¾e
dekodér pøijme nekódové slovo (s lichým poètem jednièek) 
a ohlásí chybu. Je-li pravdìpodobnost výskytu dvou nebo více chyb v
jednom slovì zanedbatelná a nám postaèuje jen detekovat chyby (neopravovat
je), je toto rozumný návrh kódu.

Pov¹imneme si, ¾e minimální Hammingova vzdálenost mezi dvìma rùznými
kódovými slovy tohoto kódu je 2, tak¾e jedna chyba zpùsobí vytvoøení
nekódového slova. 

\priklad [kod4]
%%%%%%%%
Je dán blokový kód délky 8 bitù: 
$K=\{00000000, 00001111, 11110000, 11111111\}$.
Minimální Hammingova vzdálenost mezi kódovými slovy je~4, tak¾e ani tøi
chyby ve slovì nezpùsobí pøechod na jiné kódové slovo a dekodér
správnì detekuje chybu pøenosu. Dekodér dokonce doká¾e v tomto kódu opravit
jednu chybu a detekovat výskyt dvou chyb ve slovì. Chybu
opraví tak, ¾e se od pøijatého slova $\vec w$ vrátí ke kódovému
slovu $\vec v$ takovému, ¾e Hammingova vzdálenost 
$\d(\vec v,\vec w)=1$. Samozøejmì, nauèíme-li dekodér 
opravovat jednu chybu ve slovì, pak u¾ nemusí být schopen 
v¾dy správnì detekovat tøi chyby. Mù¾e se toti¾ stát, ¾e místo
toho opraví jeden bit a dostane jiné kódové slovo.

\priklad [vzdalenost+oprava]
%%%%%%%%
Nech» minimální Hammingova vzdálenost mezi kódovými slovy je $d>2$.
Rozhodnìte (A)~kolik chyb ve slovì mù¾e dekodér detekovat, pokud po
nìm nechceme, aby chyby opravoval, a (B)~kolik chyb ve slovì mù¾e
opravit a kolik jich mù¾e aspoò detekovat bez opravy.

Odpovìï: (A) Dekodér mù¾e spolehlivì detekovat nejvý¹e $d-1$ chyb. 
(B) Je-li $d$ sudé, mù¾e dekodér opravit jednu a¾ $d/2-1$ chyb a detekovat 
$d/2$ chyb bez opravy. Je-li $d$ liché, mù¾e
opravit jednu a¾ $(d-1)/2$ chyb a ¾ádné mno¾ství chyb nedetekuje bez opravy.
Je samozøejmì mo¾né i jiné rozvr¾ení. Napø. pro $d$ liché necháme
dekodér opravit nejvý¹e $(d-3)/2$ chyb a pøi výskytu $(d-1)/2$ nebo
$(d+1)/2$ chyb ve slovì jen chyby detekujeme bez opravy.
\inl[detekce chyb, oprava chyb]

\okraj Lineární kód | Linerani kod

\poznamka
%%%%%%%%%
Pøi návrhu dekodéru s detekcí nebo opravou chyb se s výhodou vyu¾ijí
nástroje lineární algebry, jako je násobení matic, vymezení
podprostorù a bází, øe¹ení homogenních soustav atd. Binární slova
délky $n$ budeme v tomto pøípadì pova¾ovat za vektory z~lineárního
prostoru $\Z_2^n$, tak¾e je mù¾eme sèítat. Ostatnì, u¾ v
poznámce\cite[hammingp] jsem zmínil sèítání slov $\vec v$ a $\vec
w$. V teorii kódování se binární slova zapisují jednièkami a nulami
bez mezer (viz pøíklady\cite[kod2] a\cite[kod4]), 
zatímco v lineární algebøe jsme
dosud zapisovali vektory do závorek a jejich slo¾ky oddìlovali èárkami.
Vìøím, ¾e nedojde k~nedorozumìní, pokud dále v textu o kódování budu
zapisovat vektory zpùsobem, jako v pøíkladu\cite[kod2].

\definice [dlkod]
%%%%%%%%%
Binární blokový kód $K$ délky $n$ je {\em lineární}, pokud $K$
tvoøí lineární podprostor lineárního prostoru $\Z_2^n$.
Jestli¾e dimenzi tohoto podprostoru oznaèíme $k$, pak mluvíme o 
{\em lineárním $(n,k)$ kódu}.
\inl[kód: lineární, lineární: kód]

\veta [nejmhm]
%%%%%
Nejmen¹í Hammingova vzdálenost mezi slovy lineárního kódu $K$ je rovna
nejmen¹í Hammingovì velikosti nenulového kódového slova.

\dukaz
Staèí si uvìdomit, ¾e pro $\vec v_1, \vec v_2\in K$ je 
$\|\vec v_1+\vec v_2\| = \d(\vec v_1,\vec v_2)$, a pøitom
$\vec v_1+\vec v_2\in K$, proto¾e $K$ je lineární kód.
Navíc $\|\vec v\| = \d(\vec v, \vec o)$.

\priklad
%%%%%%%%
Kód z pøíkladu\cite[kod2] je lineární, proto¾e $K$ tvoøí podprostor
lineárního prostoru $\Z_2^4$. Skuteènì, seèteme-li dva vektory se
sudým poètem jednièek, dostameme vektor se sudým poètem jednièek.
Výsledek násobení vektoru z~$K$ konstantou $\alpha$ zùstane v~$K$, proto¾e
v~$\Z_2$ èíslo $\alpha$ mù¾e být jen~0 nebo~1.

Báze kódu z pøíkladu\cite[kod2] je napøíklad 
$\{0011, 0101, 1100\}$, tak¾e dimenze kódu je 3 a jedná se tedy o
{\it lineární $(4,3)$ kód}.

\poznamka
%%%%%%%%%
Pøíklad\cite[kod2] ilustruje tzv. kódování s kontrolním
bitem parity. Pùvodní informaci s osmi znaky je mo¾né kódovat blokovým
binárním kódem $\{000, 001, 010, 011, 100, 101, 110, 111\}$, tedy
staèí nám tøi bity. Pokud chceme detekovat jednu chybu ve slovì,
pøidáme ètvrtý tzv. {\em kontrolní bit}, který nastavíme na 0, 
pokud je v pùvodním tøíbitovém slovì sudý poèet jednièek a 
nastavíme ho na 1, pokud je v pùvodním slovì lichý poèet jednièek. 
Dostáváme tak kód z~pøíkladu\cite[kod2].
\inl[kontrolní: bit]
\inl[kód: s kontrolním bitem parity]

Tento postup mù¾eme pou¾ít na jakýkoli \uv{výchozí} binární blokový
kód délky~$k$ se v¹emi $2^k$ kódovými slovy. Pøidáním kontrolního bitu 
parity dostáváme lineární $(k+1,k)$ kód, kterým jsme schopni detekovat jednu
chybu ve slovì. Dekodér pak odstraní kontrolní bit z ka¾dého pøijatého
slova a získá tím pùvodní kódovanou informaci.

\poznamka
%%%%%%%%%
Vstupní informace je èasto pøipravena u¾ jako posloupnost slov 
binárního blokového kódu
délky $k$, ve kterém v¹echna slova jsou kódová. Na¹ím úkolem je pak
roz¹íøit tento kód o dal¹ích $n-k$ tzv. {\em kontrolních bitù}, abychom
dostali lineární $(n,k)$ kód. Kodér tedy oèekává na vstupu libovolné
slovo délky $k$ a jeho úkolem je zkopírovat bity vstupu do výstupu
(tzv. {\em informaèní bity\/}) a pøidat $n-k$ kontrolních bitù.
Dekodér pak pou¾ije tyto kontrolní
bity pro detekci a pøípadnou opravu chyb a poté je odstraní a ponechá
jen informaèní bity. Cílem je navrhnout kódování, které má co nejmen¹í
{\em redundanci\/} (tj. pomìr poètu kontrolních bitù ku poètu
v¹ech pøená¹ených bitù ve slovì), proto¾e ta zatì¾uje linku 
nebo pamì»ové médium re¾ijními informacemi, které u¾ivatel ze svého
pohledu nevyu¾ije. 
Pøitom ale chceme co nejschopnìj¹í dekodér, který by detekoval a 
opravoval chyby a navíc by mìl pracovat efektivnì.
\inl[informaèní: bit, redundance]
\inl[kontrolní: bit]

Z pohledu lineární algebry je vý¹e popsaný pøechod od kódu 
délky $k$ na lineární kód délky $n>k$ lineární zobrazení $\a:\Z_2^k\to\Z_2^n$, 
které je prosté (jinak by docházelo ke ztrátì informace). 
Podle poznámky\cite[poznalob] mno¾ina obrazù tohoto zobrazení (neboli kód) tvoøí
lineární podporostor v~$\Z_2^n$. Bázi tohoto podprostoru mù¾eme hledat
tak, ¾e sepí¹eme bázi ve výchozím prostoru $\Z_2^k$ a najdeme její
obraz za pou¾ití zobrazení~$\a$. Tento obraz podle vìty\cite[zobnabasi]
jednoznaènì urèuje zobrazení $\a$ na celém $\Z_2^k$.

Kodérem je pøímo zobrazení $\a$ a mo¾ným
dekodérem je zobrazení inverzní k $\a$ definované na
$\a(Z_2^k)$. Ov¹em dekodér se musí umìt vyrovnat i se slovy, která
jsou nekódová, tj. nele¾í v~mno¾inì $\a(Z_2^k)$. 
To inverzní zobrazení k~$\a$ neumí.

\priklad [doublekod]
%%%%%%%%
Nech» je vstupní informace kódována binárním blokovým kódem délky
$k$ se v¹emi $2^k$ slovy.
Kodér této informace navrhneme tak, ¾e ka¾dé vstupní slovo zopakuje a vytvoøí
výstupní slovo délky $2k$. Tím vzniká lineární $(2k,k)$ kód.
Minimální Hammingova vzdálenost mezi dvìma kódovými slovy je~2, tak¾e
dekodér spolehlivì detekuje jednu chybu ve slovì. Za jistých okolností
mù¾e detekovat i více chyb ve slovì, pokud chyba v první polovinì
slova se nezopakuje na stejném bitu druhé poloviny slova. V~¾ádném
pøípadì ale dekodér nemù¾e odhalenou chybu spolehlivì opravit. Redundance je
pøíli¹ vysoká, a pøitom neumíme ani opravit chyby. Asi to nebude
nejlep¹í mo¾ný návrh kódování.
\inl[kód: opakovací]

\priklad
%%%%%%%%
Kód z pøíkladu\cite[kod4] je lineární.
Nevýhoda tohoto kódu ale spoèívá v tom, ¾e kódová slova mohou
reprezentovat jen ètyøi rozdílné stavy pùvodní informace, ale mají
pøíli¹ mnoho bitù, které zbyteènì zatì¾ují pamì»ové médium nebo
pøenosové linky. Proto se Hamming zamìøil na hledání jiných
vhodnìj¹ích lineárních kódù.

\okraj Generující a kontrolní matice | Generujici a kontrolni matice

\definice [dHG]
%%%%%%%%%
{\em Generující matice lineárního kódu $K$} je po øádcích zapsaná báze
tohoto kódu.

{\em Kontrolní matice lineárního kódu $K$} je taková matice $\H$ 
s lineárnì nezávislými øádky, pro kterou platí: mno¾ina øe¹ení 
homogenní soustavy $\H\,\vec x=\vec o$ je rovna kódu $K$.
\inl[matice: generující, generující: matice, matice: kontrolní, kontrolní: matice]

\veta [vlHG]
%%%%%
Nech» $\G$ je generující matice a $\H$ kontrolní matice lineárního
$(n,k)$ kódu. Pak $\G$ má $k$~øádkù a $\H$ má $n-k$ øádkù. Obì matice
mají $n$ sloupcù. Jinými slovy, generující matice má tolik øádkù, kolik
je v kódu informaèních bitù, kontrolní matice má tolik øádkù, kolik 
má kód kontrolních bitù a poèet sloupcù obou matic je roven poètu
pøená¹ených bitù v jednom slovì.

\dukaz
Matice $\G$ má $k$ øádkù, proto¾e báze prostoru dimenze
$k$ obsahuje $k$ vektorù. 
Poèet øádkù matice $H$ plyne z~vìty\cite[dimhomo].
Koneènì $n$ sloupcù obou matic plyne pøímo z definice tìchto matic.

\priklad [kod22]
%%%%%%%%
Kód z pøíkladu\cite[kod2] mù¾e mít následující generující matici:
$$
  \G = \pmatrix {1 & 0 & 0 & 1 \cr 0 & 1 & 0 & 1 \cr 0 & 0 & 1 & 1},
$$
proto¾e $\{1001, 0101, 0011\}$ je báze kódu $K$. Popí¹u, jak se
obvykle tato báze sestavuje. Vyjde se ze standardní báze vstupního kódu: 
$\{100, 010, 001\}$ a aplikuje se na ní zobrazení kodéru.
V¹echny tøi prvky této báze mají lichý poèet jednièek, tak¾e 
poslední kontrolní bit kodér nastaví na jednièku.

Kontrolní matice na¹eho kódu je
$$
  \H = \pmatrix {1 & 1 & 1 & 1},
$$
proto¾e mno¾ina øe¹ení rovnice $x_1+x_2+x_3+x_4=0$ je shodná s
mno¾inou slov, které mají sudý poèet jednièek (sèítáme jednièky modulo~2),
a to jsou právì v¹echna kódová slova.

\priklad [doublekod2]
%%%%%%%%
Kódujme vstupní informaci v blokovém kódu délky 4 podle
pøíkladu\cite[doublekod] (zdvojení slova). Dostáváme lineární 
(8,4) kód. Jeho generující matice je
$$
  \G = \pmatrix {
                 1&0&0&0&1&0&0&0\cr
                 0&1&0&0&0&1&0&0\cr 
                 0&0&1&0&0&0&1&0\cr 
                 0&0&0&1&0&0&0&1\cr }.
$$
K vytvoøení této báze jsem pou¾il stejný postup, jako v pøedchozím
pøíkladì. Na standardní bázi prostoru $\Z_2^4$ jsem aplikoval
zobrazení kodéru. Kontrolní matice je výjimeènì v tomto pøíkladì
$\H=\G$, proto¾e soustava rovnic
$$
\eqalign{
   x_1+x_5 &= 0 \cr x_2+x_6 &= 0 \cr x_3+x_7 &= 0 \cr x_4+x_8 &= 0
}
$$
má za øe¹ení právì taková slova, pro která první bit je roven pátému, druhý
¹estému, tøetí sedmému a ètvrtý osmému, tj. obì èásti slova se rovnají
a jedná se o kódové slovo.

\poznamka
%%%%%%%%%
Generující matice sama o sobì jednoznaènì urèuje lineární
kód. Kontrolní matice sama o sobì také jednoznaènì urèuje lineární kód. 
Tyto dvì matice jsou v následujícím \uv{duálním} vztahu:

\veta [vlHG2]
%%%%%
Nech» $\G$ je generující a $\H$ je kontrolní matice lineárního $(n,k)$
kódu.  Pak $\H\cdot\G^T = \O_1$ a také $\G\cdot\H^T = \O_2$, kde
$\O_1$ je nulová matice s $n-k$ øádky a $k$ sloupci a $\O_2=\O_1^T$.

\dukaz
Kód s uvedenými maticemi oznaèíme písmenem $K$.
Øádky matice $\G$ alias sloupce matice $\G^T$ jsou podle definice
generující matice prvky kódu~$K$. Podle definice kontrolní matice musí
tyto sloupce matice $\G^T$ alias prvky kódu $K$ být øe¹ením soustavy 
$\H\,\vec x=\vec o$.
Pøesnì to øíká vztah $\H\cdot\G^T = \O_1$, pokud jej rozepí¹eme po
jednotlivých sloupcích matice $\G^T$.

Vztah $\G\cdot\H^T = \O_2$ vzniká transponováním matic na levé i pravé
stranì vztahu $\H\cdot\G^T = \O_1$.

\poznamka [odGkH]
%%%%%%%%%
Pøedchozí vìta ukazuje, ¾e nejen øádky matice $\G$ øe¹í soustavu
$\H\vec x=\vec o$, ale také øádky matice $\H$ øe¹í soustavu $\G\vec
x=\vec o$. Známe-li jen jednu z tìchto matic, pak druhou lze najít
tak, ¾e najdeme bázi mno¾iny øe¹ení odpovídající homogenní soustavy rovnic a
zapí¹eme ji do øádkù.

Proto¾e velmi èasto je generující matice vytvoøena za pou¾ití
standardní báze vstupního prostoru $\Z_2^k$ a aplikací algoritmu kodéru
na tuto bázi, který kopíruje informaèní bity a 
pøidává kontrolní bity na konec slova,
je matice $\G$ èasto ve tvaru 
$\G = (\E|\C)$, kde $\E$ je jednotková matice typu $(k,k)$.
Matici $\H$ pak mù¾eme snadno najít podle vìty\cite[genbasehomo],
pøitom místo matice $-\C^T$ staèí pou¾ít matici $\C^T$, proto¾e 
v~aritmetice $\Z_2$ je $\C=-\C$. Dostáváme $\H=(\C^T|\E')$, kde $\E'$ je
jednotková matice typu $(n-k,n-k)$.

\priklad
%%%%%%%%
S vyu¾itím vìty\cite[genbasehomo] zkusíme sestavit kontrolní matice 
z pøíkladù\cite[kod22] a\cite[doublekod2], pokud je dána 
jen generující matice.

Pøíklad\cite[kod22]. Matice $\C$ z rovnosti $\G=(\E|\C)$ obsahuje
sloupec jednièek. $\C^T$ je tedy øádek jednièek, ke kterému podle
vìty\cite[genbasehomo] vpravo pøipí¹eme jednotkovou matici typu
$(1,1)$. Dostáváme matici $\H$.

Pøíklad\cite[doublekod2]. Matice $\C$ z rovnosti $\G=(\E|\C)$ je
jednotková matice, tak¾e $\C^T=\C$. K této jednotkové matici podle
vìty\cite[genbasehomo] pøipí¹eme jednotkovou matici typu $(4,4)$. Dostáváme tím
matici $\H$, která je výjimeènì rovna matici $\G$.

\definice [dsystemkod]
%%%%%%%%%
Pokud existuje generující matice lineárního kódu ve tvaru
$\G=(\E|\C)$, kde $\E$ je jednotková matice, nazýváme takový kód {\em
systematický}. 
\inl[kód: systematický, systematický: kód]

\poznamka [HGprechod]
%%%%%%%%%
Pøedchozí poznámka\cite[odGkH] ukazuje, ¾e pro systematické kódy mù¾eme z generující
matice snadno sestavit matici kontrolní ve tvaru $\H=(\C^T|\E')$.
Také obrácenì, pokud je dána kontrolní matice ve tvaru
$\H=(\C^T|\E')$, je mo¾né snadno pøejít k matici generující tvaru
$\G=(\E|\C)$. 

\poznamka
%%%%%%%%%
Nech» je dána generující matice, která není tvaru $(\E|\C)$. Proto¾e
generující matice obsahuje v øádcích bázi kódu, je mo¾né eliminací
této matice pøejít k jiné generující matici tého¾ kódu. Staèí si
uvìdomit, ¾e Gaussova eliminace nemìní lineární obal øádkù. Mù¾e se
tedy stát, ¾e po eliminaci dostaneme novou generující matici ve tvaru
$\G=(\E|\C)$ a shledáme, ¾e kód je systematický. 

Pokud ani po eliminaci generující matice nelze dosáhnout tvaru
$(\E|\C)$, jedná se o nesystematický kód. I v tomto pøípadì je ov¹em
eliminací mo¾né dospìt k matici, která se od matice $(\E|\C)$ li¹í jen
prohozením nìkterých sloupcù. Nesystematický kód se tedy od
systematického li¹í jen poøadím bitù v~jednotlivých kódových slovech.
Pøechod od generující matice ke kontrolní (nebo obrácenì) je u
nesystematického kódu obtí¾nìj¹í, proto¾e nelze pøímo pou¾ít
vìtu\cite[genbasehomo], 
ale pøed jejím pou¾itím musíme prohodit sloupce generující
matice, pak pøejít ke kontrolní matici a u ní prohodit sloupce zpìt. 
Podobnì bychom postupovali, pokud pøecházíme od kontrolní matice
nesystematického kódu k matici generující.
\inl[systematický: kód, kód: systematický, nesystematický: kód, kód: nesystematický]

Systematický kód získáme zaruèenì v pøípadì, kdy necháme kodér kopírovat
informaèní bity vstupního slova do výstupu 
a pak pøidat bity kontrolní. Pokud ale kodér informaèní 
bity \uv{promíchá} s bity kontrolními, pak kód nemusí být 
systematický.

\veta [HDE]
%%%%%
Kód je systematický právì tehdy, kdy¾ existuje kontrolní matice tohoto
kódu tvaru $(\C^T|\E')$, kde $\E'$ je jednotková matice.

\dukaz
Tvrzení vìty je dùsledkem skuteènosti, ¾e kód má
generující matici tvaru $\G=(\E|\C)$ právì tehdy, kdy¾ má kontrolní
matici tvaru $\H=(\C^T|\E')$.

\poznamka [elimH]
%%%%%%%%%
Je-li dána kontrolní matice v jiném tvaru ne¾ $(\C^T|\E')$, pak z toho
je¹tì neplyne, ¾e kód není systematický. Eliminací kontrolní matice
mù¾eme získat jinou kontrolní matici, která ov¹em pøíslu¹í stejnému
kódu. Staèí si uvìdomit, ¾e eliminací matice soustavy dostáváme
pøípadnì matici jiné soustavy, ale se stejnou mno¾inou øe¹ení.
Pokud tedy po eliminaci kontrolní matice získáme matici tvaru
$(\C^T|\E')$, pak je kód systematický. 


\okraj Kodér lineárního kódu | Koder linearniho kodu

\veta [koderzob]
%%%%%
Nech» $\G$ je generující matice lineárního $(n,k)$ kódu.
Nech» dále $\a: \Z_2^k\to\Z_2^n$ je lineární zobrazení,
které zobrazuje standardní bázi prostoru $\Z_2^k$ na øádky matice $\G$.
Pak matice $\G^T$ je maticí lineárního zobrazení 
$\a$ vzhledem ke standardním bázím.
\inl[kodér]

\dukaz
Matice lineárního zobrazení obsahuje podle definice\cite[matzob] 
ve sloupcích souøadnice obrazù báze vstupního prostoru 
vzhledem k bázi výstupního prostoru. V na¹em pøípadì generující matice
$\G$ obsahuje v øádcích souøadnice obrazù (pøi zobrazení $\a$)
standardní báze $\Z_2^k$ vzhledem ke standardní bázi v $\Z_2^n$.
Abychom z øádkù matice dostali sloupce podle definice matice 
lineárního zobrazení, staèí matici $\G$ transponovat.

\poznamka
%%%%%%%%%
Zobrazení $\a$ z pøedchozí vìty matematicky popisuje
kodér lineárního kódu. Jeho generující matice je $\G$. 
Vìta øíká, ¾e $\G^T$ je matice zobrazení
tohoto kodéru vzhledem ke standardním bázím. 
Vstupuje-li vektor $\vec u\in\Z_2^k$ do kodéru, 
pak jeho výstupem je
vektor~$\vec v\in\Z_2^n$, který spoèítáme podle vìty\cite[Aasour] jako souèin
matice zobrazení a vstupního vektoru:
$$
  \vec v^T = \G^T \cdot \vec u^T, \qquad \hbox{neboli:} \quad
  \vec v = \vec u \cdot \G.
$$

\poznamka [jenkontrolni]
%%%%%%%%%
Pokud kodér kopíruje $k$ vstupních bitù do výstupu 
a pak pøidá kontrolní bity, 
nemusíme prvních $k$ bitù výstupu poèítat maticovým
násobením. Staèí tímto násobením poèítat kontrolní bity.
Generující matice má v tomto pøípadì tvar $\G=(\E|\C)$.
Oznaèíme-li $\vec u$ slovo, které vstupuje do kodéru a $\vec v'$ vektor,
který obsahuje jen kontrolní bity výstupního slova, pak
platí:
$$
  \vec v' = \vec u \cdot \C.
$$

\okraj Dekodér lineárního kódu | Dekoder linearniho kodu

\poznamka
%%%%%%%%%
Dekodér pøi kontrole, zda se jedná o kódové
slovo, pou¾ije kontrolní matici. Nech» dekodér pøijme slovo $\vec w$. 
Pak $\H\cdot\vec w^T$ je
nulový vektor právì tehdy, kdy¾ je slovo $\vec w$ kódové. V takovém
pøípadì dekodér pøedpokládá, ¾e nedo¹lo pøi pøenosu slova k chybì,
odstraní kontrolní bity a tím získá pùvodní
informaci. 

Pokud $\H\cdot\vec w^T$ není nulový vektor,
dekodér má jistotu, ¾e do¹lo k chybì a ¾e $\vec w$ není kódové slovo.
Má-li chybu opravit, pak údaj $\H\cdot\vec w^T$ bude pøi opravì
potøebovat. Napí¹eme-li výsledek násobení $\H\cdot\vec w^T$ do øádku, 
dostáváme tzv. {\em syndrom} vektoru $\vec w$.
\inl[dekodér]

\definice [dsyndrom]
%%%%%%%%%
Nech» $\H$ je kontrolní matice lineárního kódu. {\em Syndrom\/} slova
$\vec w$ je vektor $\vec s$, pro který platí $\vec s^T=\H\cdot\vec w^T$.

Nech» $\vec v$ je slovo vyslané kodérem a $\vec w$ je slovo pøijaté
dekodérem. Pak $\vec e=\vec w-\vec v$ je {\it chybové slovo}.
Proto¾e v $\Z_2^n$ je $-\vec v= \vec v$, chybové slovo
lze poèítat jako $\vec w+\vec v$.
\inl[syndrom]

\poznamka
%%%%%%%%%
Jednièkové bity chybového slova oznaèují místa, kde do¹lo k
po¹kození slova $\vec v$. Úkolem dekodéru je na základì znalosti 
$\vec w$ zjistit chybové slovo $\vec e$. Pokud se mu to podaøí, pak
vypoète pùvodní informaci jako $\vec v=\vec w-\vec e$.

Ne¾ se pustíme do sestavování tabulky, podle které bude dekodér
opravovat chyby, je potøeba
si uvìdomit platnost dvou tvrzení. 
První z nich platí dokonce obecnì na
libovolném lineárním prostoru.

\veta [afinM1M2]
%%%%%
Nech» $K$ je lineární podprostor lineárního prostoru $L$ a
nech» $\vec e_1\in L$, $\vec e_2\in L$.
Pak mno¾iny 
$
    M_1=\{\vec e_1+\vec v; \  \vec v\in K\} $, $
    M_2=\{\vec e_2+\vec v; \  \vec v\in K\} 
$
jsou buï disjunktní nebo toto¾né.

\dukaz
Sporem. Pøedpokládáme, ¾e mno¾iny $M_1$ a $M_2$ mají spoleèný bod
$\vec a$ a pøitom nejsou toto¾né, tj. existuje vektor $\vec b\in M_1$,
který nele¾í v $M_2$.
Proto¾e $\vec a$ i $\vec b$ le¾í v mno¾inì $M_1$, je 
$\vec a=\vec e_1+\vec u$, $\vec b=\vec e_1+\vec v$, kde 
$\vec u$ i $\vec v$ le¾í v $K$.
Pak $\vec w=\vec b-\vec a=\vec v-\vec u$ le¾í v $K$, proto¾e $K$
je podprostor. Je tedy $\vec b=\vec a+\vec w$.
Proto¾e $\vec a$ le¾í i v mno¾inì $M_2$, je $\vec a=\vec e_2+\vec x$,
kde $\vec x\in K$. Dosadíme-li tento poznatek do vztahu pro $\vec b$,
dostaneme $\vec b=\vec e_2+\vec x+\vec w$. Proto¾e $K$ je podprostor,
$\vec x+\vec w$ le¾í v~$K$. Je tedy $\vec b=\vec e_2+\vec z$,
kde $\vec z\in K$. To ale znamená, ¾e $\vec b\in M_2$,
co¾ je sporu s pøedpokladem.

\veta [osyndromu]
%%%%%
Nech» $\vec v$ je kódové slovo a $\vec e$ je libovolné slovo. 
Pak slova $\vec e$ i $\vec e+\vec v$ mají stejný syndrom.
Jinými slovy kódová slova modifikovaná stejnou chybou
vytváøejí skupinu slov se spoleèným syndromem.

\dukaz
$\H\cdot(\vec e+\vec v)^T=\H\cdot\vec e^T+\H\cdot\vec v^T=
\H\cdot\vec e^T+\vec o^T=\H\cdot\vec e^T$.

\poznamka
%%%%%%%%%
Pokud po¾adujeme nejen detekci, ale i opravu chyb lineárního kódu, mù¾e dekodér 
pracovat s následující {\em tabulkou pro opravování chyb\/}:
\medskip\hbox to\hsize{\hfil\vbox{\offinterlineskip
  \halign{\hfil$#$\hfil \qquad \vrule height10pt depth5pt&&\qquad\hfil$#$\hfil\cr
     \vec o & \vec o & \vec v_2 & \vec v_3 & \dots & \vec v_{2^k} \cr
     \vec s_2 & \vec e_2 & \vec e_2+\vec v_2 & \vec e_2+\vec v_3 &
                \dots & \vec e_2+\vec v_{2^k} \cr
     \vec s_3 & \vec e_3 & \vec e_3+\vec v_2 & \vec e_3+\vec v_3 &
                \dots & \vec e_3+\vec v_{2^k} \cr
     \dots    & \dots \cr
     \vec s_{2^{(n-k)}} & \vec e_{2^{(n-k)}} & \vec e_{2^{(n-k)}}+\vec v_1 
             & \vec e_{2^{(n-k)}}+\vec v_2 &
               \dots & \vec e_{2^{(n-k)}}+\vec v_{2^k}\cr
  }}\hfil}\medskip

Vlevo od svislé èáry jsou syndromy, k tìm se vrátím pozdìji.  Nejprve
vysvìtlím obsah tabulky vpravo od svislé èáry.  Tam jsou rozmístìna
v¹echna slova lineárního prostoru $\Z_2^n$.  V prvním øádku jsou
kódová slova (je jich $2^k$) a v ostatních øádcích jsou slova
nekódová. Poèet øádkù je $2^{(n-k)}$, proto¾e tak získáme celkový
poèet slov $2^n=2^k\cdot2^{(n-k)}$.  V prvním sloupci (vpravo od èáry)
je nahoøe umístìno nulové slovo a pod ním jsou postupnì
v¹echna chybová slova, která chceme, aby dekodér umìl odhalit a chybu
opravit. Na ostatních pozicích tabulky jsou souèty chybového slova 
v~øádku s kódovým slovem ve sloupci.

Tabulku vytvoøíme tak, ¾e zapí¹eme nejprve do prvního øádku 
nulové kódové slovo a pak ostatní kódová slova (na poøadí
nezále¾í). Do druhého øádku napí¹eme nejprve chybové slovo, které
chceme dekodérem opravovat, a dále pøíslu¹né souèty. Chybové slovo
nesmí být slovem kódovým.
Na tøetím øádku napí¹eme dal¹í chybové slovo. Toto chybové slovo se
{\it nesmí vyskytovat nikde na pøedchozích øádcích}. K~nìmu do øádku
doplníme pøíslu¹né souèty. Tak postupujeme dále, a¾ vytvoøíme tabulku
s $2^{(n-k)}$ øádky.

První øádek tabulky obsahuje lineární prostor $K$, druhý øádek tabulky
obsahuje mno¾inu $K+\vec e_2$, která je podle vìty\cite[afinM1M2] 
disjunktní s $K$. Platí toti¾ $\vec e_2\not\in K$. Tøetí øádek
obsahuje mno¾inu $K+\vec e_3$, která je disjunktní s $K$ i s $K+\vec
e_2$, proto¾e $\vec e_3\not\in K$ a $\vec e_3\not\in K+\vec e_2$,
tak¾e mù¾eme dvakrát pou¾ít vìtu\cite[afinM1M2].
A~tak dále. Slova v jednom øádku jsou samozøejmì rùzná.
Máme tedy zaruèeno, ¾e ¾ádné slovo se v~tabulce neopakuje
a ¾e jsou vyèerpána v¹echna slova prostoru $\Z_2^n$.

Pokud nyní dekodér pøijme slovo $\vec w$, vyhledá ho v
tabulce. Napøíklad slovo na¹el na $i$-tém øádku tabulky. Dekodér na
základì toho rozhodne, ¾e do¹lo k chybì $\vec e_i$ a opraví ji tak, ¾e
provede $\vec w-\vec e_i$. (Místo odèítání mù¾e vykonat $\vec w+\vec
e_i$, proto¾e v aritmetice $\Z_2$ to dopadne stejnì). 
Pokud $\vec w$ bylo na $j$-tém sloupci tabulky,
dekodér se tímto postupem vrací ke kódovému slovu $\vec v_j$.

Aby dekodér nemusel prohledávat celou tabulku o $2^n$ slovech, vypoète
nejdøíve syndrom pøijatého vektoru: $\vec s^T = \H\cdot\vec w^T$.
Vlevo od svislé èáry jsou syndromy v¹ech slov, které jsou napsány 
vpravo na stejném øádku (viz vìta\cite[osyndromu]). Prohledáním 
tabulky syndromù a porovnáním se syndromem slova $\vec w$ 
dekodér odhalí správnì øádek tabulky, ve kterém slovo $\vec w$ le¾í. 
Dekodér tedy nemusí pracovat s celou tabulkou, ale jen se sloupcem syndromù a
sloupcem chybových slov.

\priklad
%%%%%%%%
Ne¾ se pustíme do formulace po¾adavkù na ideální kód pro opravu chyb,
zkusíme sestavit tabulku pro opravování chyb pro pøípad kódù, kde to
nebude pøíli¹ u¾iteèné: kód s kontrolním bitem parity a opakovací kód. Tím
odhalíme problémy, kterých bychom se mìli pøi návrhu kódù s opravou
chyb vyvarovat.

{\bf Lineární (4,3) kód s kontrolním bitem parity} má napøíklad
tuto tabulku pro opravování chyb:

\medskip\hbox to\hsize{\hfil\vbox{\offinterlineskip
  \halign{\hfil$#$\hfil \quad 
          \vrule height10pt depth5pt&&\quad\hfil$#$\hfil\cr
%\hbox{syndrom} & \vbox{\hbox{chybové}\smallskip\hbox{ slovo}} & \rlap{ostatní slova} \cr
0 & 0000 & 0011 & 0101 & 0110 & 1001 & 1010 & 1100 & 1111 \cr
1 & 1000 & 1011 & 1101 & 1110 & 0001 & 0010 & 0100 & 0111 \cr
  }}\hfil}\medskip
V této tabulce jsme zvolili chybové slovo 1000. Proto dekodér pøi
obdr¾ení nekódového slova opraví první bit.
Kdybychom zvolili jiné chybové slovo (napø. 0100), 
dostaneme jinou tabulku: druhý øádek bude obsahovat slova v jiném
poøadí. Dekodér podle takové pozmìnìné tabulky bude po pøijetí
nekódového slova opravovat jiný bit. Bohu¾el, nemáme ¾ádnou záruku, ¾e
dekodér opraví správný bit. Tabulka urèuje pevnì jeden bit, který bude
dekodér opravovat. Lep¹í by bylo, kdybychom 
v prvním sloupci s chybovými slovy mìli zapsána v¹echna chybová slova
tvaru 1000, 0100, 0010, 0001. To bychom ale potøebovali mít v tabulce
pìt øádkù a ne jen dva. Dva øádky v tabulce jsou dùsledkem toho, ¾e
kód pracuje jen s jedním kontrolním bitem a ¾e $2^1=2$. Mù¾eme tedy
øíci, ¾e pro úspì¹nou opravu chyb je jeden kontrolní bit málo. To
ostatnì èlovìk intuitivnì tu¹í i bez sestavování tabulek pro
opravování chyb.

{\bf Lineární (6,3) opakovací kód} s kontrolní i generující maticí
$$
  \H = \G =\pmatrix {1&0&0&1&0&0\cr0&1&0&0&1&0\cr0&0&1&0&0&1}
$$
mù¾e mít napøíklad následující tabulku pro opravování chyb:
 
\medskip\hbox to\hsize{\hfil\vbox{\offinterlineskip
  \halign{\hfil$#$\hfil \quad 
          \vrule height10pt depth5pt&&\quad\hfil$#$\hfil\cr
000 & 000000 & 100100 & 010010 & 001001 & 110110 & 011011 & 101101 & 111111 \cr
100 & 100000 & 000100 & 110010 & 101001 & 010110 & 111011 & 001101 & 011111 \cr
010 & 010000 & 110100 & 000010 & 011001 & 100110 & 001011 & 111101 & 101111 \cr
001 & 001000 & 101100 & 011010 & 000001 & 111110 & 010011 & 100101 & 110111 \cr
110 & 110000 & 010100 & 100010 & 111001 & 000110 & 101011 & 011101 & 001111 \cr
101 & 101000 & 001100 & 111010 & 100001 & 011110 & 110011 & 000101 & 010111 \cr
011 & 011000 & 111100 & 001010 & 010001 & 101110 & 000011 & 110101 & 100111 \cr
111 & 111000 & 011100 & 101010 & 110001 & 001110 & 100011 & 010101 & 000111 \cr
  }}\hfil}\medskip

Pokud dekodér pracuje podle této tabulky a pøijme napøíklad slovo
111110, vypoète nejdøíve syndrom $\H\cdot(111110)^T=(001)^T$,
Dekodér zjistil, ¾e slovo le¾í ve ètvrtém øádku tabulky. Tam je zvoleno
chybové slovo 001000, tak¾e dekodér opraví tøetí bit a z pøijatého
slova 111110 dostává kódové slovo 110110.

Jestli¾e pøedpokládáme, ¾e pøijaté slovo obsahuje jednu chybu, pak
vý¹e uvedená oprava nemusí být jediná mo¾ná. Opravou posledního bitu
ve slovì 111110 také dostáváme kódové slovo 111111. Problém tohoto
kódu z pohledu tabulky pro opravování chyb je, ¾e chybová slova s
jednou jednièkou se objeví dvì na spoleèném øádku tabulky. Na dal¹ích
øádcích (za ètvrtým øádkem) u¾ nemù¾eme pou¾ít chybové slovo 000001,
proto¾e toto slovo se na ètvrtém øádku u¾ objevilo. Pokud bychom na
ètvrtém øádku pou¾ili chybové slovo 000001, pak by se na tomto øádku
zase vyskytlo i 001000. Mno¾ina slov vedle konkrétního syndromu se
toti¾ nemù¾e zmìnit, proto¾e se jedná o mno¾inu øe¹ení soustavy
$\H\vec x^T =\vec s^T$.  Tak¾e bychom dostali sice jinou tabulku pro
opravování chyb, ale chybová slova s jednou jednièkou by se ani tak
nepodaøilo oddìlit do jednotlivých øádkù. Aèkoli (na rozdíl od kódu s
kontrolním bitem parity) máme v tabulce dostateèný poèet øádkù,
nemáme mo¾nost dostat v¹echna chybová slova s jednou jednièkou do
prvního sloupce tabulky. Dokonce jsme nuceni na posledním øádku
tabulky pou¾ít chybové slovo se tøemi jednièkami.

\poznamka [podminkykodu]
%%%%%%%%%
Nezdary pøi opravování chyb v pøedchozím pøíkladì nás inspirují 
k~formulaci podmínek na kód, který spolehlivì opravuje jednu chybu.

Pøedpokládáme lineární $(n,k)$ kód. Chybových slov s jednou jednièkou
je $n$ a potøebujeme je v¹echna rozmístit do prvního sloupce tabulky
pro opravování chyb. ®ádná jiná chybová slova se v tomto sloupci
nesmìjí objevit.  Z toho vyplývá, ¾e poèet øádkù tabulky musí být
$n+1$ (první øádek tabulky obsahuje samotný kód). Proto¾e poèet øádkù
tabulky je $2^{(n-k)}$, máme podmínku $2^{(n-k)}=n+1$. Oznaèíme-li
poèet kontrolních bitù $c=n-k$, pak je uvedená podmínka asi lépe
èitelná ve tvaru $n=2^c-1$. Celkový poèet bitù $n$ tedy musí být o
jednièku men¹í ne¾ mocnina dvojky a hodnota této mocniny udává poèet
kon\-trolních bitù. Postupnì pro $c=2,3,4,5,6,\dots$ dostáváme (3,1),
(7,4), (15,11), (31,26), (63,57),~\dots kódy.

Abychom mohli rozmístit v¹echna chybová slova s jednou jednièkou 
do prvního sloupce, potøebujeme je¹tì zaruèit, ¾e ¾ádné slovo s
jednou jednièkou není kódové slovo a ¾e
dvì slova s jednou jednièkou nebudou mít stejný syndrom.
Tuto podmínku nejlépe charakterizuje následující vìta.

\veta [syndrom1]
%%%%%
Slovo s jednou jednièkou je kódové právì tehdy, kdy¾ kontrolní
matice obsahuje nulový sloupec. Dvì rùzná slova s jednou jednièkou
mají spoleèný syndrom právì tehdy, kdy¾ kontrolní matice obsahuje
aspoò dva stejné sloupce.

\dukaz
Staèí si uvìdomit, ¾e syndrom slova s jednou jednièkou na $i$-tém
místì je roven $i$-tému sloupci kontrolní matice. To vyplývá 
z maticového násobení $\H\cdot\vec w^T=\vec s^T$.

\okraj {}Hammingùv kód | Hamminguv kod

\poznamka
%%%%%%%%%
Aby lineární $(n,k)$ kód opravoval v¹echny jednoduché chyby ve slovì,
je podle poznámky\cite[podminkykodu] nutné, aby $n=2^c-1$, kde
$c=n-k$, a dále podle vìty\cite[syndrom1] je nutné, aby kontrolní
matice nemìla ¾ádný sloupec nulový a v¹echny sloupce od sebe vzájemnì
rùzné. Tìch sloupcù musí být $n=2^c-1$, a pøitom vý¹ka sloupce je $c$.
Z toho nám vyplývá jediný mo¾ný tvar kontrolní matice (a¾ na poøadí sloupcù): 
v jednotlivých sloupcích kontrolní matice napí¹eme ve dvojkové
soustavì v¹echna èísla $1,2,3,\ldots, n$. Lineárnímu kódu s takovou
kontrolní maticí øíkáme {\em Hammingùv kód}.
\inl[kód: Hammingùv, Hammingùv: kód]

\priklad [hamming74]
%%%%%%%%
Uká¾eme si Hammingùv $(7,4)$ kód. Podle pøedchozí poznámky napí¹eme
ve dvojkové soustavì do sloupcù kontrolní matice èísla 1,2,3,4,5,6,7:
$$
  \H=\matice{0&0&0&1&1&1&1\cr
             0&1&1&0&0&1&1\cr
             1&0&1&0&1&0&1\cr}.
$$
Syndromy a první sloupec tabulky pro opravování chyb napí¹eme (kvùli
úspoøe místa v tomto textu) místo do
sloupcù do øádkù:

\medskip
\line{\hss\vbox{\halign{&\quad\hfil#\hfil\quad\cr
000    &001    &010    &011    &100    &101    &110    &111 \cr
0000000&1000000&0100000&0010000&0001000&0000100&0000010&00000001 \cr
}}\hss}
\medskip

Vidíme, ¾e pøi této volbì poøadí sloupcù kontrolní matice má dekodér
výraznì usnadnìnou práci: nemusí prohledávat v tabulce syndromù, aby
zjistil odpovídající chybové slovo. Staèí, aby interpretoval syndrom
jako èíslo zapsané ve dvojkové soustavì. Toto èíslo udává pozici bitu
chybového slova, kde se nalézá jednièka.

Jak tedy bude dekodér postupovat pøi obdr¾ení slova $\vec w$? Vypoète
syndrom pomocí $\vec s^T=\H\cdot\vec w^T$ a interpretuje jej jako èíslo
$i$ ve dvojkové soustavì. Je-li $i=0$, je $\vec w$ kódové slovo a
dekodér nic neopravuje. Je-li $i>0$, pak dekodér opraví v obdr¾eném
slovì $i$-tý bit.

Tím je kompletnì navr¾en dekodér Hammingova $(7,4)$ kódu a zbývá je¹tì
navrhnout kodér. Eliminací kontrolní matice pøecházíme
ke kontrolní matici stejného kódu (poznámka\cite[elimH]):
$$
  \H=\matice{0&0&0&1&1&1&1\cr
             0&1&1&0&0&1&1\cr
             1&0&1&0&1&0&1\cr} \sim
     \matice{1&0&1&1&0&1&0\cr
             1&1&0&0&1&1&0\cr
             1&0&1&0&1&0&1\cr} \sim
     \matice{0&1&1&1&1&0&0\cr
             1&1&0&0&1&1&0\cr
             1&0&1&0&1&0&1\cr} \sim
     \matice{0&1&1&1&1&0&0\cr
             1&0&1&1&0&1&0\cr
             1&1&0&1&0&0&1\cr} = \H'.
$$
Podle vìty\cite[HDE] se tedy jedná o systematický kód, proto¾e
$\H'=(\C^T|\E')$. Podle poznámky\cite[HGprechod] nyní pøejdeme ke generující
matici $\G=(\E|\C)$:
$$
  \G=\matice{1&0&0&0&0&1&1\cr
             0&1&0&0&1&0&1\cr
             0&0&1&0&1&1&0\cr
             0&0&0&1&1&1&1\cr}.
$$
Kodér necháme nejprve kopírovat první ètyøi informaèní bity do výstupu
a dal¹í tøi kontrolní bity $\vec v'$ poèítáme ze vstupního slova $\vec u$
podle poznámky\cite[jenkontrolni]:
$$
  \vec v' = \vec u \cdot \matice{0&1&1\cr
                                 1&0&1\cr
                                 1&1&0\cr
                                 1&1&1\cr}.
$$

\poznamka
%%%%%%%%%
Analogicky se postupuje pøi návrhu $(15,11)$, $(31,26)$, $(63,57)$
atd. Hammingových kódù. V¹imnìte si, ¾e s rostoucím $n$ se výraznì
zlep¹uje pomìr informaèních bitù ku celkovému poètu pøená¹ených bitù.
To je pro u¾ivatele, kteøí se zajímají jen o informaèní bity, dobrá
zpráva. Ov¹em prodlu¾ováním délky pøená¹ených slov se zase zvy¹uje
pravdìpodobnost výskytu více ne¾ jedné chyby ve slovì. Dekodér Hammingova
kódu v takovém pøípadì sel¾e.

\okraj Roz¹íøený Hammingùv kód | Rozsireny Hamminguv kod

\poznamka
%%%%%%%%%
Ve výpoèetní technice se pracuje s pøenosy 8 bitù, 16 bitù, 32 bitù
atd. Hammingùv kód pøedpokládá pøenos slov délky o jeden bit krat¹í. 
Co se zbylým bitem? Pou¾ijeme jej pro kontrolu parity.
Tím dostáváme {\em roz¹íøený Hammingùv kód}, který umo¾ní spolehlivì 
opravit jednu chybu a detekovat chyby dvì.
\inl[kód: Hammingùv: roz¹íøený, roz¹íøený: Hammingùv: kód]

\priklad
%%%%%%%%
K Hammingovu kódu $(7,4)$ pøidáme kontrolní bit parity a dostáváme
lineární $(8,4)$ kód s~následující kontrolní maticí:
$$
  \H=\matice{0&0&0&1&1&1&1&0\cr
             0&1&1&0&0&1&1&0\cr
             1&0&1&0&1&0&1&0\cr
             1&1&1&1&1&1&1&1\cr}.
$$
Tento kód umí opravit jednu chybu ve slovì a detekovat chyby dvì.
Jak dekodér mù¾e postupovat? Pøijme slovo $\vec w$ a vypoète syndrom
$\vec s^T=\H\cdot\vec w^T$. Je-li syndrom nulový vektor, je slovo
$\vec w$ kódové a dekodér nic neopravuje. Jsou-li první tøi bity
syndromu nulové a poslední nenulový, do¹lo pøi pøenosu jen k~chybì
posledního kontrolního bitu parity.
Je-li na prvních tøech pozicích syndromu aspoò jeden bit nenulový a
poslední
bit syndromu je rovnì¾ nenulový, do¹lo k lichému poètu chyb ve
slovì. Dekodér pøedpokládá, ¾e do¹lo k jediné chybì a podle prvních
tøech bitù syndromu zjistí, který bit ve slovì má opravit (stejnì jako
v~pøíkladu\cite[hamming74]). Je-li koneènì poslední bit syndromu
nulový, ale syndrom obsahuje aspoò jeden nenulový bit,
pak do¹lo k sudému poètu
chyb. Tento poèet chyb neumí dekodér opravit, ale detekuje
tento stav jako dvojnásobnou chybu.

\poznamka
%%%%%%%%%
V¹imnìte si, ¾e nejmen¹í Hammingova vzdálenost mezi dvìma 
slovy roz¹íøeného Hammingova kódu je 4. To je v~souladu
s~výsledky pøíkladu\cite[vzdalenost+oprava]. 

\icviceni 10

\ifbook
  \input polynomy
\fi

\kapitola [literatura] Literatura | Literatura

\bib [adamek] J. Adámek, {\it Foundations of Coding.}
     A Wiley-Interscience publication, New York 1991.
\bib [bartik] V. Bartík, {\it Úvod do algebry.}
     Text k pøedná¹ce 1996 na
     \urllink{http://math.feld.cvut.cz/bartik/}.
\bib [bartsch] H.--J. Bartsch, {\it Matematické vzorce.}
     Academia, Praha 2006 (4. vydání).
\bib [beezer] R. A. Beezer, {\it A First Course in Linear Algebra.}
     Tacoma, Washington, USA 2007. Text je mj. volnì dostupný
     na \urllink{http://linear.ups.edu/}.
\bib [bican] L. Bican, {\it Lineární algebra a geometrie.}
     Academia, Praha 2002.
\bib [birkhoff] G. Birkhoff, S. MacLane, {\it Algebra.}
     Chelsea Pub Co, (3rd edition) 1993.
     Existuje slovenský pøeklad star¹ího vydání
     {\it Prehµad modernej algebry}, Alfa, Bratislava, 1979.
\bib [cw]  Don Coppersmith and Shmuel Winograd. 
     {\it Matrix multiplication via arithmetic progressions.} 
     Journal of Symbolic Computation, 9:251?280, 1990.
\bib [demlova] M. Demlová, B. Pondìlíèek, {\it Úvod do algebry.}
     Vydavatelství ÈVUT, Praha 1996.
\bib [dont] M. Dont, {\it Elementy numerické lineární algebry.}
     Vydavatelství ÈVUT, Praha 2004. 
\bib [gelfand] I. M. Gelfand, {\it Lineární algebra.} Pøeklad
     M. Fiedler, ÈSAV, Praha 1953.
\bib [hefferon] J. Hefferon, {\it Linear Algebra.}
     Colchester, Vermont USA, volnì dostupné na \hfil\break
     \urllink{http://joshua.smcvt.edu/linearalgebra/}.
\bib [jilkova] S. Jílková, V. Maòasová, Z. Tischerová,
     {\it Lineární algebra -- úlohy.}
     Vydavatelství ÈVUT, Praha 1987.
\bib [kalousova] A. Kalousová, {\it Skripta z algebry.}
     Text volnì dostupný  napøíklad\hfil\break 
     z~\urllink{ftp://math.feld.cvut.cz/pub/kalous/Skripta/skripta.pdf}
\bib [kepka] T. Kepka, {\it Algebra.} Poznámky z pøedná¹ek
     na MFF UK dostupné napø. na\hfil\break 
     \urllink{http://lucy.troja.mff.cuni.cz/labtf/poznamky/}.
\bib [korinek] V. Koøínek, {\it Základy algebry.}
     Klasická uèebnice algebry, Academia, Praha 1956 (2. vydání).
\bib [krajnik] E. Krajník, {\it Základy maticového poètu.}
     Vydavatelství ÈVUT, Praha 2006.
\bib [mahel] V. Mahel \& kol. kat. matematiky, 
     {\it Sbírka úloh z lineární algebry a analytické geometrie.}
     Vydavatelství ÈVUT, Praha 1986.
\bib [matousek] J. Matou¹ek, {\it ©estnáct miniatur.}
     Volnì dostupný text s aplikacemi lineární algebry tam, kde bychom
     to mo¾ná neèekali, \urllink{http://kam.mff.cuni.cz/\string~matousek/la1.html}.
\bib [zahradnik] L. Motl, M. Zahradník, {\it Pìstujeme lineární algebru.}
     MFF UK, Praha 1994 (skriptum pøístupné na
     \urllink{http://www.kolej.mff.cuni.cz/\string~lmotm275/skripta/}).
\ifbook
\bib [olsak] P. Ol¹ák, {\it Lineární algebra.}
     Volnì dostupný text na \urllink{http://petr.olsak.net/linal.html}.
\else
\bib [olsak-ua] P. Ol¹ák, {\it Úvod do algebry, zejména lineární.}
     FEL ÈVUT, Praha 2007.
\fi
\bib [TBN] P. Ol¹ák, {\it \TeX{}book naruby.}
     Konvoj, Brno 2001 (2. vydání). Text volnì dostupný napøíklad na\hfil\break 
     \urllink{http://petr.olsak.net/tbn.html}.
\bib [prochazka] L. Procházka, {\it Algebra.} Academia, Praha 1990.
\bib [proskurjakov] I. V. Proskurjakov, {\it Sbornik zadaè po linìjnoj algebre.}
     Uzdavatìlstvo Nauka, Moskva 1970.
\bib [ptak]  P. Pták, {\it Introduction to Linear Algebra.}
     Vydavatelství ÈVUT, Praha 2006.
\bib [rektorys] K. Rektorys, {\it Pøehled u¾ité matematiky.}
     Prometheus, Praha 2003 (6. vydání).
\bib [vopenka] P. Vopìnka, {\it Úhelný kámen evropské vzdìlanosti a
     moci -- rozpravy s geometrií.}
     Práh, Praha 2003.
\bib [vyborny] K. Výborný, M. Zahradník \& kol. {\it Sbírka pøíkladù z
     lineární algebry.} Volnì dostupný text k nalezení napøíklad na 
     \urllink{http://www.kolej.mff.cuni.cz/\string~lmotm275/skripta/}.
\bib [zara] J. ®ára, B. Bene¹, J. Sochor, P. Felkel,
     {\it Moderní poèítaèová  grafika.} 
     Computer Press, 2005 (2. vydání).
%\bib [rozcestnik] Rozcestník volnì dostupných textù k algebøe 
%     v èe¹tinì:\hfil\break 
%     \urllink{http://home.pf.jcu.cz/\string~novakp08/Matematika/Algebra.htm}.

% \delejrejstrik

\end















